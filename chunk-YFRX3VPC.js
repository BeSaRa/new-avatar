import{B as ZP,F as ew,L as nw,O as sw,P as ow,S as aw,T as cw,U as uw,W as pw,X as lw,Y as hw,a as Tt,d as Ai,h as Oi,ha as Lr,i as gs,ja as Fc,ka as dw,l as $o,la as fw,m as Lc,o as Ko,r as YP,s as Di,x as QP,y as XP}from"./chunk-LMAAADYH.js";import{$ as qP,A as Ae,Aa as us,Ca as ps,Cb as It,Eb as et,F as kP,Fa as si,Ga as Ac,Gc as tw,H as NP,Hc as rw,I as qo,Ia as Gf,J as as,Ja as Uo,Jc as qc,Ka as dn,Kc as zc,L as ln,Lc as iw,Mb as vn,Nb as ls,Ob as hs,P as cs,Pb as _e,Qb as Bt,R as jP,Ra as BP,Rb as ds,S as LP,Sb as Yf,T as Tc,Tb as Xt,Ua as q,Ub as fs,Va as Ze,Vb as Ti,Wb as Qf,Xb as xc,Yb as Mc,a as mr,aa as ni,ab as UP,b as Vf,ba as Nr,ca as wt,cc as $P,d as h,db as vt,e as wM,eb as fn,f as DP,fa as Ft,fc as KP,g as Te,gb as Oc,h as v,hb as Jf,ia as zo,ic as Xf,j as ss,jc as GP,ka as hn,kb as jr,kc as Zf,la as W,m as $f,mb as WP,mc as kc,na as Qt,nb as Wo,nc as JP,ob as pe,p as ue,pa as Fo,pb as HP,q as xP,r as Kf,rb as VP,s as MP,sb as Et,sc as Nc,ta as zP,tb as Dc,ub as Ho,v as Ic,va as FP,vb as Vo,w as os,wa as _t,wb as N,xa as Rt,xb as F,xc as vs,ya as Ei,yb as de,za as Bo,zb as Ii,zc as jc}from"./chunk-2DHUEILY.js";var vv=h(fv=>{"use strict";Object.defineProperty(fv,"__esModule",{value:!0});fv.default=dk;var pu,hk=new Uint8Array(16);function dk(){if(!pu&&(pu=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!pu))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return pu(hk)}});var t_=h(lu=>{"use strict";Object.defineProperty(lu,"__esModule",{value:!0});lu.default=void 0;var fk=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;lu.default=fk});var Zo=h(hu=>{"use strict";Object.defineProperty(hu,"__esModule",{value:!0});hu.default=void 0;var vk=gk(t_());function gk(r){return r&&r.__esModule?r:{default:r}}function mk(r){return typeof r=="string"&&vk.default.test(r)}var yk=mk;hu.default=yk});var ta=h(ea=>{"use strict";Object.defineProperty(ea,"__esModule",{value:!0});ea.default=void 0;ea.unsafeStringify=r_;var Sk=Ck(Zo());function Ck(r){return r&&r.__esModule?r:{default:r}}var Ue=[];for(let r=0;r<256;++r)Ue.push((r+256).toString(16).slice(1));function r_(r,e=0){return Ue[r[e+0]]+Ue[r[e+1]]+Ue[r[e+2]]+Ue[r[e+3]]+"-"+Ue[r[e+4]]+Ue[r[e+5]]+"-"+Ue[r[e+6]]+Ue[r[e+7]]+"-"+Ue[r[e+8]]+Ue[r[e+9]]+"-"+Ue[r[e+10]]+Ue[r[e+11]]+Ue[r[e+12]]+Ue[r[e+13]]+Ue[r[e+14]]+Ue[r[e+15]]}function bk(r,e=0){let t=r_(r,e);if(!(0,Sk.default)(t))throw TypeError("Stringified UUID is invalid");return t}var Pk=bk;ea.default=Pk});var n_=h(du=>{"use strict";Object.defineProperty(du,"__esModule",{value:!0});du.default=void 0;var wk=Rk(vv()),_k=ta();function Rk(r){return r&&r.__esModule?r:{default:r}}var i_,gv,mv=0,yv=0;function Ek(r,e,t){let i=e&&t||0,n=e||new Array(16);r=r||{};let s=r.node||i_,o=r.clockseq!==void 0?r.clockseq:gv;if(s==null||o==null){let d=r.random||(r.rng||wk.default)();s==null&&(s=i_=[d[0]|1,d[1],d[2],d[3],d[4],d[5]]),o==null&&(o=gv=(d[6]<<8|d[7])&16383)}let a=r.msecs!==void 0?r.msecs:Date.now(),c=r.nsecs!==void 0?r.nsecs:yv+1,u=a-mv+(c-yv)/1e4;if(u<0&&r.clockseq===void 0&&(o=o+1&16383),(u<0||a>mv)&&r.nsecs===void 0&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");mv=a,yv=c,gv=o,a+=122192928e5;let p=((a&268435455)*1e4+c)%4294967296;n[i++]=p>>>24&255,n[i++]=p>>>16&255,n[i++]=p>>>8&255,n[i++]=p&255;let l=a/4294967296*1e4&268435455;n[i++]=l>>>8&255,n[i++]=l&255,n[i++]=l>>>24&15|16,n[i++]=l>>>16&255,n[i++]=o>>>8|128,n[i++]=o&255;for(let d=0;d<6;++d)n[i+d]=s[d];return e||(0,_k.unsafeStringify)(n)}var Ik=Ek;du.default=Ik});var Sv=h(fu=>{"use strict";Object.defineProperty(fu,"__esModule",{value:!0});fu.default=void 0;var Tk=Ak(Zo());function Ak(r){return r&&r.__esModule?r:{default:r}}function Ok(r){if(!(0,Tk.default)(r))throw TypeError("Invalid UUID");let e,t=new Uint8Array(16);return t[0]=(e=parseInt(r.slice(0,8),16))>>>24,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=e&255,t[4]=(e=parseInt(r.slice(9,13),16))>>>8,t[5]=e&255,t[6]=(e=parseInt(r.slice(14,18),16))>>>8,t[7]=e&255,t[8]=(e=parseInt(r.slice(19,23),16))>>>8,t[9]=e&255,t[10]=(e=parseInt(r.slice(24,36),16))/1099511627776&255,t[11]=e/4294967296&255,t[12]=e>>>24&255,t[13]=e>>>16&255,t[14]=e>>>8&255,t[15]=e&255,t}var Dk=Ok;fu.default=Dk});var Cv=h(mn=>{"use strict";Object.defineProperty(mn,"__esModule",{value:!0});mn.URL=mn.DNS=void 0;mn.default=jk;var xk=ta(),Mk=kk(Sv());function kk(r){return r&&r.__esModule?r:{default:r}}function Nk(r){r=unescape(encodeURIComponent(r));let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t));return e}var s_="6ba7b810-9dad-11d1-80b4-00c04fd430c8";mn.DNS=s_;var o_="6ba7b811-9dad-11d1-80b4-00c04fd430c8";mn.URL=o_;function jk(r,e,t){function i(n,s,o,a){var c;if(typeof n=="string"&&(n=Nk(n)),typeof s=="string"&&(s=(0,Mk.default)(s)),((c=s)===null||c===void 0?void 0:c.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+n.length);if(u.set(s),u.set(n,s.length),u=t(u),u[6]=u[6]&15|e,u[8]=u[8]&63|128,o){a=a||0;for(let p=0;p<16;++p)o[a+p]=u[p];return o}return(0,xk.unsafeStringify)(u)}try{i.name=r}catch{}return i.DNS=s_,i.URL=o_,i}});var c_=h(gu=>{"use strict";Object.defineProperty(gu,"__esModule",{value:!0});gu.default=void 0;function Lk(r){if(typeof r=="string"){let e=unescape(encodeURIComponent(r));r=new Uint8Array(e.length);for(let t=0;t<e.length;++t)r[t]=e.charCodeAt(t)}return qk(zk(Fk(r),r.length*8))}function qk(r){let e=[],t=r.length*32,i="0123456789abcdef";for(let n=0;n<t;n+=8){let s=r[n>>5]>>>n%32&255,o=parseInt(i.charAt(s>>>4&15)+i.charAt(s&15),16);e.push(o)}return e}function a_(r){return(r+64>>>9<<4)+14+1}function zk(r,e){r[e>>5]|=128<<e%32,r[a_(e)-1]=e;let t=1732584193,i=-271733879,n=-1732584194,s=271733878;for(let o=0;o<r.length;o+=16){let a=t,c=i,u=n,p=s;t=rt(t,i,n,s,r[o],7,-680876936),s=rt(s,t,i,n,r[o+1],12,-389564586),n=rt(n,s,t,i,r[o+2],17,606105819),i=rt(i,n,s,t,r[o+3],22,-1044525330),t=rt(t,i,n,s,r[o+4],7,-176418897),s=rt(s,t,i,n,r[o+5],12,1200080426),n=rt(n,s,t,i,r[o+6],17,-1473231341),i=rt(i,n,s,t,r[o+7],22,-45705983),t=rt(t,i,n,s,r[o+8],7,1770035416),s=rt(s,t,i,n,r[o+9],12,-1958414417),n=rt(n,s,t,i,r[o+10],17,-42063),i=rt(i,n,s,t,r[o+11],22,-1990404162),t=rt(t,i,n,s,r[o+12],7,1804603682),s=rt(s,t,i,n,r[o+13],12,-40341101),n=rt(n,s,t,i,r[o+14],17,-1502002290),i=rt(i,n,s,t,r[o+15],22,1236535329),t=it(t,i,n,s,r[o+1],5,-165796510),s=it(s,t,i,n,r[o+6],9,-1069501632),n=it(n,s,t,i,r[o+11],14,643717713),i=it(i,n,s,t,r[o],20,-373897302),t=it(t,i,n,s,r[o+5],5,-701558691),s=it(s,t,i,n,r[o+10],9,38016083),n=it(n,s,t,i,r[o+15],14,-660478335),i=it(i,n,s,t,r[o+4],20,-405537848),t=it(t,i,n,s,r[o+9],5,568446438),s=it(s,t,i,n,r[o+14],9,-1019803690),n=it(n,s,t,i,r[o+3],14,-187363961),i=it(i,n,s,t,r[o+8],20,1163531501),t=it(t,i,n,s,r[o+13],5,-1444681467),s=it(s,t,i,n,r[o+2],9,-51403784),n=it(n,s,t,i,r[o+7],14,1735328473),i=it(i,n,s,t,r[o+12],20,-1926607734),t=nt(t,i,n,s,r[o+5],4,-378558),s=nt(s,t,i,n,r[o+8],11,-2022574463),n=nt(n,s,t,i,r[o+11],16,1839030562),i=nt(i,n,s,t,r[o+14],23,-35309556),t=nt(t,i,n,s,r[o+1],4,-1530992060),s=nt(s,t,i,n,r[o+4],11,1272893353),n=nt(n,s,t,i,r[o+7],16,-155497632),i=nt(i,n,s,t,r[o+10],23,-1094730640),t=nt(t,i,n,s,r[o+13],4,681279174),s=nt(s,t,i,n,r[o],11,-358537222),n=nt(n,s,t,i,r[o+3],16,-722521979),i=nt(i,n,s,t,r[o+6],23,76029189),t=nt(t,i,n,s,r[o+9],4,-640364487),s=nt(s,t,i,n,r[o+12],11,-421815835),n=nt(n,s,t,i,r[o+15],16,530742520),i=nt(i,n,s,t,r[o+2],23,-995338651),t=st(t,i,n,s,r[o],6,-198630844),s=st(s,t,i,n,r[o+7],10,1126891415),n=st(n,s,t,i,r[o+14],15,-1416354905),i=st(i,n,s,t,r[o+5],21,-57434055),t=st(t,i,n,s,r[o+12],6,1700485571),s=st(s,t,i,n,r[o+3],10,-1894986606),n=st(n,s,t,i,r[o+10],15,-1051523),i=st(i,n,s,t,r[o+1],21,-2054922799),t=st(t,i,n,s,r[o+8],6,1873313359),s=st(s,t,i,n,r[o+15],10,-30611744),n=st(n,s,t,i,r[o+6],15,-1560198380),i=st(i,n,s,t,r[o+13],21,1309151649),t=st(t,i,n,s,r[o+4],6,-145523070),s=st(s,t,i,n,r[o+11],10,-1120210379),n=st(n,s,t,i,r[o+2],15,718787259),i=st(i,n,s,t,r[o+9],21,-343485551),t=ki(t,a),i=ki(i,c),n=ki(n,u),s=ki(s,p)}return[t,i,n,s]}function Fk(r){if(r.length===0)return[];let e=r.length*8,t=new Uint32Array(a_(e));for(let i=0;i<e;i+=8)t[i>>5]|=(r[i/8]&255)<<i%32;return t}function ki(r,e){let t=(r&65535)+(e&65535);return(r>>16)+(e>>16)+(t>>16)<<16|t&65535}function Bk(r,e){return r<<e|r>>>32-e}function vu(r,e,t,i,n,s){return ki(Bk(ki(ki(e,r),ki(i,s)),n),t)}function rt(r,e,t,i,n,s,o){return vu(e&t|~e&i,r,e,n,s,o)}function it(r,e,t,i,n,s,o){return vu(e&i|t&~i,r,e,n,s,o)}function nt(r,e,t,i,n,s,o){return vu(e^t^i,r,e,n,s,o)}function st(r,e,t,i,n,s,o){return vu(t^(e|~i),r,e,n,s,o)}var Uk=Lk;gu.default=Uk});var p_=h(mu=>{"use strict";Object.defineProperty(mu,"__esModule",{value:!0});mu.default=void 0;var Wk=u_(Cv()),Hk=u_(c_());function u_(r){return r&&r.__esModule?r:{default:r}}var Vk=(0,Wk.default)("v3",48,Hk.default),$k=Vk;mu.default=$k});var l_=h(yu=>{"use strict";Object.defineProperty(yu,"__esModule",{value:!0});yu.default=void 0;var Kk=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Gk={randomUUID:Kk};yu.default=Gk});var f_=h(Su=>{"use strict";Object.defineProperty(Su,"__esModule",{value:!0});Su.default=void 0;var h_=d_(l_()),Jk=d_(vv()),Yk=ta();function d_(r){return r&&r.__esModule?r:{default:r}}function Qk(r,e,t){if(h_.default.randomUUID&&!e&&!r)return h_.default.randomUUID();r=r||{};let i=r.random||(r.rng||Jk.default)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){t=t||0;for(let n=0;n<16;++n)e[t+n]=i[n];return e}return(0,Yk.unsafeStringify)(i)}var Xk=Qk;Su.default=Xk});var v_=h(Cu=>{"use strict";Object.defineProperty(Cu,"__esModule",{value:!0});Cu.default=void 0;function Zk(r,e,t,i){switch(r){case 0:return e&t^~e&i;case 1:return e^t^i;case 2:return e&t^e&i^t&i;case 3:return e^t^i}}function bv(r,e){return r<<e|r>>>32-e}function eN(r){let e=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof r=="string"){let o=unescape(encodeURIComponent(r));r=[];for(let a=0;a<o.length;++a)r.push(o.charCodeAt(a))}else Array.isArray(r)||(r=Array.prototype.slice.call(r));r.push(128);let i=r.length/4+2,n=Math.ceil(i/16),s=new Array(n);for(let o=0;o<n;++o){let a=new Uint32Array(16);for(let c=0;c<16;++c)a[c]=r[o*64+c*4]<<24|r[o*64+c*4+1]<<16|r[o*64+c*4+2]<<8|r[o*64+c*4+3];s[o]=a}s[n-1][14]=(r.length-1)*8/Math.pow(2,32),s[n-1][14]=Math.floor(s[n-1][14]),s[n-1][15]=(r.length-1)*8&4294967295;for(let o=0;o<n;++o){let a=new Uint32Array(80);for(let f=0;f<16;++f)a[f]=s[o][f];for(let f=16;f<80;++f)a[f]=bv(a[f-3]^a[f-8]^a[f-14]^a[f-16],1);let c=t[0],u=t[1],p=t[2],l=t[3],d=t[4];for(let f=0;f<80;++f){let g=Math.floor(f/20),m=bv(c,5)+Zk(g,u,p,l)+d+e[g]+a[f]>>>0;d=l,l=p,p=bv(u,30)>>>0,u=c,c=m}t[0]=t[0]+c>>>0,t[1]=t[1]+u>>>0,t[2]=t[2]+p>>>0,t[3]=t[3]+l>>>0,t[4]=t[4]+d>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var tN=eN;Cu.default=tN});var m_=h(bu=>{"use strict";Object.defineProperty(bu,"__esModule",{value:!0});bu.default=void 0;var rN=g_(Cv()),iN=g_(v_());function g_(r){return r&&r.__esModule?r:{default:r}}var nN=(0,rN.default)("v5",80,iN.default),sN=nN;bu.default=sN});var y_=h(Pu=>{"use strict";Object.defineProperty(Pu,"__esModule",{value:!0});Pu.default=void 0;var oN="00000000-0000-0000-0000-000000000000";Pu.default=oN});var S_=h(wu=>{"use strict";Object.defineProperty(wu,"__esModule",{value:!0});wu.default=void 0;var aN=cN(Zo());function cN(r){return r&&r.__esModule?r:{default:r}}function uN(r){if(!(0,aN.default)(r))throw TypeError("Invalid UUID");return parseInt(r.slice(14,15),16)}var pN=uN;wu.default=pN});var C_=h(Sr=>{"use strict";Object.defineProperty(Sr,"__esModule",{value:!0});Object.defineProperty(Sr,"NIL",{enumerable:!0,get:function(){return vN.default}});Object.defineProperty(Sr,"parse",{enumerable:!0,get:function(){return SN.default}});Object.defineProperty(Sr,"stringify",{enumerable:!0,get:function(){return yN.default}});Object.defineProperty(Sr,"v1",{enumerable:!0,get:function(){return lN.default}});Object.defineProperty(Sr,"v3",{enumerable:!0,get:function(){return hN.default}});Object.defineProperty(Sr,"v4",{enumerable:!0,get:function(){return dN.default}});Object.defineProperty(Sr,"v5",{enumerable:!0,get:function(){return fN.default}});Object.defineProperty(Sr,"validate",{enumerable:!0,get:function(){return mN.default}});Object.defineProperty(Sr,"version",{enumerable:!0,get:function(){return gN.default}});var lN=ai(n_()),hN=ai(p_()),dN=ai(f_()),fN=ai(m_()),vN=ai(y_()),gN=ai(S_()),mN=ai(Zo()),yN=ai(ta()),SN=ai(Sv());function ai(r){return r&&r.__esModule?r:{default:r}}});var Ni=h(Es=>{"use strict";Object.defineProperty(Es,"__esModule",{value:!0});Es.createNoDashGuid=Es.createGuid=void 0;var CN=C_(),b_=()=>CN.v4();Es.createGuid=b_;var bN=()=>b_().replace(new RegExp("-","g"),"").toUpperCase();Es.createNoDashGuid=bN});var Is=h(yn=>{"use strict";Object.defineProperty(yn,"__esModule",{value:!0});yn.PlatformEvent=yn.EventType=void 0;var PN=Ni(),wN;(function(r){r[r.Debug=0]="Debug",r[r.Info=1]="Info",r[r.Warning=2]="Warning",r[r.Error=3]="Error",r[r.None=4]="None"})(wN=yn.EventType||(yn.EventType={}));var Pv=class{constructor(e,t){this.privName=e,this.privEventId=PN.createNoDashGuid(),this.privEventTime=new Date().toISOString(),this.privEventType=t,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}};yn.PlatformEvent=Pv});var P_=h(be=>{"use strict";Object.defineProperty(be,"__esModule",{value:!0});be.AudioStreamNodeErrorEvent=be.AudioStreamNodeDetachedEvent=be.AudioStreamNodeAttachedEvent=be.AudioStreamNodeAttachingEvent=be.AudioStreamNodeEvent=be.AudioSourceErrorEvent=be.AudioSourceOffEvent=be.AudioSourceReadyEvent=be.AudioSourceInitializingEvent=be.AudioSourceEvent=void 0;var wv=Is(),ji=class extends wv.PlatformEvent{constructor(e,t,i=wv.EventType.Info){super(e,i),this.privAudioSourceId=t}get audioSourceId(){return this.privAudioSourceId}};be.AudioSourceEvent=ji;var _v=class extends ji{constructor(e){super("AudioSourceInitializingEvent",e)}};be.AudioSourceInitializingEvent=_v;var Rv=class extends ji{constructor(e){super("AudioSourceReadyEvent",e)}};be.AudioSourceReadyEvent=Rv;var Ev=class extends ji{constructor(e){super("AudioSourceOffEvent",e)}};be.AudioSourceOffEvent=Ev;var Iv=class extends ji{constructor(e,t){super("AudioSourceErrorEvent",e,wv.EventType.Error),this.privError=t}get error(){return this.privError}};be.AudioSourceErrorEvent=Iv;var Sn=class extends ji{constructor(e,t,i){super(e,t),this.privAudioNodeId=i}get audioNodeId(){return this.privAudioNodeId}};be.AudioStreamNodeEvent=Sn;var Tv=class extends Sn{constructor(e,t){super("AudioStreamNodeAttachingEvent",e,t)}};be.AudioStreamNodeAttachingEvent=Tv;var Av=class extends Sn{constructor(e,t){super("AudioStreamNodeAttachedEvent",e,t)}};be.AudioStreamNodeAttachedEvent=Av;var Ov=class extends Sn{constructor(e,t){super("AudioStreamNodeDetachedEvent",e,t)}};be.AudioStreamNodeDetachedEvent=Ov;var Dv=class extends Sn{constructor(e,t,i){super("AudioStreamNodeErrorEvent",e,t),this.privError=i}get error(){return this.privError}};be.AudioStreamNodeErrorEvent=Dv});var w_=h(De=>{"use strict";Object.defineProperty(De,"__esModule",{value:!0});De.ConnectionMessageSentEvent=De.ConnectionMessageReceivedEvent=De.ConnectionEstablishErrorEvent=De.ConnectionErrorEvent=De.ConnectionClosedEvent=De.ConnectionEstablishedEvent=De.ConnectionStartEvent=De.ConnectionEvent=De.ServiceEvent=void 0;var Cn=Is(),xv=class extends Cn.PlatformEvent{constructor(e,t,i=Cn.EventType.Info){super(e,i),this.privJsonResult=t}get jsonString(){return this.privJsonResult}};De.ServiceEvent=xv;var zr=class extends Cn.PlatformEvent{constructor(e,t,i=Cn.EventType.Info){super(e,i),this.privConnectionId=t}get connectionId(){return this.privConnectionId}};De.ConnectionEvent=zr;var Mv=class extends zr{constructor(e,t,i){super("ConnectionStartEvent",e),this.privUri=t,this.privHeaders=i}get uri(){return this.privUri}get headers(){return this.privHeaders}};De.ConnectionStartEvent=Mv;var kv=class extends zr{constructor(e){super("ConnectionEstablishedEvent",e)}};De.ConnectionEstablishedEvent=kv;var Nv=class extends zr{constructor(e,t,i){super("ConnectionClosedEvent",e,Cn.EventType.Debug),this.privReason=i,this.privStatusCode=t}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}};De.ConnectionClosedEvent=Nv;var jv=class extends zr{constructor(e,t,i){super("ConnectionErrorEvent",e,Cn.EventType.Debug),this.privMessage=t,this.privType=i}get message(){return this.privMessage}get type(){return this.privType}};De.ConnectionErrorEvent=jv;var Lv=class extends zr{constructor(e,t,i){super("ConnectionEstablishErrorEvent",e,Cn.EventType.Error),this.privStatusCode=t,this.privReason=i}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}};De.ConnectionEstablishErrorEvent=Lv;var qv=class extends zr{constructor(e,t,i){super("ConnectionMessageReceivedEvent",e),this.privNetworkReceivedTime=t,this.privMessage=i}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}};De.ConnectionMessageReceivedEvent=qv;var zv=class extends zr{constructor(e,t,i){super("ConnectionMessageSentEvent",e),this.privNetworkSentTime=t,this.privMessage=i}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}};De.ConnectionMessageSentEvent=zv});var Cr=h(Li=>{"use strict";Object.defineProperty(Li,"__esModule",{value:!0});Li.ObjectDisposedError=Li.InvalidOperationError=Li.ArgumentNullError=void 0;var Fv=class extends Error{constructor(e){super(e),this.name="ArgumentNull",this.message=e}};Li.ArgumentNullError=Fv;var Bv=class extends Error{constructor(e){super(e),this.name="InvalidOperation",this.message=e}};Li.InvalidOperationError=Bv;var Uv=class extends Error{constructor(e,t){super(t),this.name=e+"ObjectDisposed",this.message=t}};Li.ObjectDisposedError=Uv});var Hv=h(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});Pn.ConnectionMessage=Pn.MessageType=void 0;var _u=Cr(),_N=Ni(),bn;(function(r){r[r.Text=0]="Text",r[r.Binary=1]="Binary"})(bn=Pn.MessageType||(Pn.MessageType={}));var Wv=class{constructor(e,t,i,n){if(this.privBody=null,e===bn.Text&&t&&typeof t!="string")throw new _u.InvalidOperationError("Payload must be a string");if(e===bn.Binary&&t&&!(t instanceof ArrayBuffer))throw new _u.InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=e,this.privBody=t,this.privHeaders=i||{},this.privId=n||_N.createNoDashGuid(),this.messageType){case bn.Binary:this.privSize=this.binaryBody!==null?this.binaryBody.byteLength:0;break;case bn.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===bn.Binary)throw new _u.InvalidOperationError("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===bn.Text)throw new _u.InvalidOperationError("Not supported for text message");return this.privBody}get id(){return this.privId}};Pn.ConnectionMessage=Wv});var __=h(Ru=>{"use strict";Object.defineProperty(Ru,"__esModule",{value:!0});Ru.ConnectionOpenResponse=void 0;var Vv=class{constructor(e,t){this.privStatusCode=e,this.privReason=t}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}};Ru.ConnectionOpenResponse=Vv});var R_=h(Eu=>{"use strict";Object.defineProperty(Eu,"__esModule",{value:!0});Eu.DeferralMap=void 0;var $v=class{constructor(){this.privMap={}}add(e,t){this.privMap[e]=t}getId(e){return this.privMap[e]}complete(e,t){try{this.privMap[e].resolve(t)}catch(i){this.privMap[e].reject(i)}finally{this.privMap[e]=void 0}}};Eu.DeferralMap=$v});var Gv=h(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});Ts.SendingAgentContextMessageEvent=Ts.DialogEvent=void 0;var E_=Is(),Iu=class extends E_.PlatformEvent{constructor(e,t=E_.EventType.Info){super(e,t)}};Ts.DialogEvent=Iu;var Kv=class extends Iu{constructor(e){super("SendingAgentContextMessageEvent"),this.privAgentConfig=e}get agentConfig(){return this.privAgentConfig}};Ts.SendingAgentContextMessageEvent=Kv});var Yv=h(Tu=>{"use strict";Object.defineProperty(Tu,"__esModule",{value:!0});Tu.EventSource=void 0;var RN=Cr(),EN=Ni(),Jv=class{constructor(e){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=e}onEvent(e){if(this.isDisposed())throw new RN.ObjectDisposedError("EventSource");if(this.metadata)for(let t in this.metadata)t&&e.metadata&&(e.metadata[t]||(e.metadata[t]=this.metadata[t]));for(let t in this.privEventListeners)t&&this.privEventListeners[t]&&this.privEventListeners[t](e)}attach(e){let t=EN.createNoDashGuid();return this.privEventListeners[t]=e,{detach:()=>(delete this.privEventListeners[t],Promise.resolve())}}attachListener(e){return this.attach(t=>e.onEvent(t))}attachConsoleListener(e){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach(t=>e.onEvent(t)),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}};Tu.EventSource=Jv});var I_=h(Ou=>{"use strict";Object.defineProperty(Ou,"__esModule",{value:!0});Ou.Events=void 0;var IN=Cr(),TN=Yv(),Au=class r{static setEventSource(e){if(!e)throw new IN.ArgumentNullError("eventSource");r.privInstance=e}static get instance(){return r.privInstance}};Ou.Events=Au;Au.privInstance=new TN.EventSource});var A_=h(T_=>{"use strict";Object.defineProperty(T_,"__esModule",{value:!0})});var O_=h(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});ra.ConnectionState=void 0;var AN;(function(r){r[r.None=0]="None",r[r.Connected=1]="Connected",r[r.Connecting=2]="Connecting",r[r.Disconnected=3]="Disconnected"})(AN=ra.ConnectionState||(ra.ConnectionState={}))});var x_=h(D_=>{"use strict";Object.defineProperty(D_,"__esModule",{value:!0})});var k_=h(M_=>{"use strict";Object.defineProperty(M_,"__esModule",{value:!0})});var j_=h(N_=>{"use strict";Object.defineProperty(N_,"__esModule",{value:!0})});var q_=h(L_=>{"use strict";Object.defineProperty(L_,"__esModule",{value:!0})});var F_=h(z_=>{"use strict";Object.defineProperty(z_,"__esModule",{value:!0})});var U_=h(B_=>{"use strict";Object.defineProperty(B_,"__esModule",{value:!0})});var H_=h(W_=>{"use strict";Object.defineProperty(W_,"__esModule",{value:!0})});var $_=h(V_=>{"use strict";Object.defineProperty(V_,"__esModule",{value:!0})});var Xv=h(Du=>{"use strict";Object.defineProperty(Du,"__esModule",{value:!0});Du.List=void 0;var ON=Cr(),Qv=class r{constructor(e){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],e)for(let t of e)this.privList.push(t)}get(e){return this.throwIfDisposed(),this.privList[e]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(e){this.throwIfDisposed(),this.insertAt(this.privList.length,e)}insertAt(e,t){this.throwIfDisposed(),e===0?this.privList.unshift(t):e===this.privList.length?this.privList.push(t):this.privList.splice(e,0,t),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(e){return this.throwIfDisposed(),this.remove(e,1)[0]}remove(e,t){this.throwIfDisposed();let i=this.privList.splice(e,t);return this.triggerSubscriptions(this.privRemoveSubscriptions),i}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(e){this.throwIfDisposed();let t=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[t]=e,{detach:()=>(delete this.privAddSubscriptions[t],Promise.resolve())}}onRemoved(e){this.throwIfDisposed();let t=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[t]=e,{detach:()=>(delete this.privRemoveSubscriptions[t],Promise.resolve())}}onDisposed(e){this.throwIfDisposed();let t=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[t]=e,{detach:()=>(delete this.privDisposedSubscriptions[t],Promise.resolve())}}join(e){return this.throwIfDisposed(),this.privList.join(e)}toArray(){let e=Array();return this.privList.forEach(t=>{e.push(t)}),e}any(e){return this.throwIfDisposed(),e?this.where(e).length()>0:this.length()>0}all(e){return this.throwIfDisposed(),this.where(e).length()===this.length()}forEach(e){this.throwIfDisposed();for(let t=0;t<this.length();t++)e(this.privList[t],t)}select(e){this.throwIfDisposed();let t=[];for(let i=0;i<this.privList.length;i++)t.push(e(this.privList[i],i));return new r(t)}where(e){this.throwIfDisposed();let t=new r;for(let i=0;i<this.privList.length;i++)e(this.privList[i],i)&&t.add(this.privList[i]);return t}orderBy(e){this.throwIfDisposed();let i=this.toArray().sort(e);return new r(i)}orderByDesc(e){return this.throwIfDisposed(),this.orderBy((t,i)=>e(i,t))}clone(){return this.throwIfDisposed(),new r(this.toArray())}concat(e){return this.throwIfDisposed(),new r(this.privList.concat(e.toArray()))}concatArray(e){return this.throwIfDisposed(),new r(this.privList.concat(e))}isDisposed(){return this.privList==null}dispose(e){this.isDisposed()||(this.privDisposeReason=e,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new ON.ObjectDisposedError("List",this.privDisposeReason)}triggerSubscriptions(e){if(e)for(let t in e)t&&e[t]()}};Du.List=Qv});var tg=h(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.marshalPromiseToCallbacks=mt.Sink=mt.Deferred=mt.PromiseResultEventSource=mt.PromiseResult=mt.PromiseState=void 0;var ci;(function(r){r[r.None=0]="None",r[r.Resolved=1]="Resolved",r[r.Rejected=2]="Rejected"})(ci=mt.PromiseState||(mt.PromiseState={}));var xu=class{constructor(e){this.throwIfError=()=>{if(this.isError)throw this.error},e.on(t=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!1,this.privResult=t)},t=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!0,this.privError=t)})}get isCompleted(){return this.privIsCompleted}get isError(){return this.privIsError}get error(){return this.privError}get result(){return this.privResult}};mt.PromiseResult=xu;var Mu=class{constructor(){this.setResult=e=>{this.privOnSetResult(e)},this.setError=e=>{this.privOnSetError(e)},this.on=(e,t)=>{this.privOnSetResult=e,this.privOnSetError=t}}};mt.PromiseResultEventSource=Mu;var Zv=class{constructor(){this.resolve=e=>(this.privResolve(e),this),this.reject=e=>(this.privReject(e),this),this.privPromise=new Promise((e,t)=>{this.privResolve=e,this.privReject=t})}get promise(){return this.privPromise}};mt.Deferred=Zv;var eg=class{constructor(){this.privState=ci.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.privPromiseResultEvents=new Mu,this.privPromiseResult=new xu(this.privPromiseResultEvents)}get state(){return this.privState}get result(){return this.privPromiseResult}resolve(e){if(this.privState!==ci.None)throw new Error("'Cannot resolve a completed promise'");this.privState=ci.Resolved,this.privPromiseResultEvents.setResult(e);for(let t=0;t<this.privSuccessHandlers.length;t++)this.executeSuccessCallback(e,this.privSuccessHandlers[t],this.privErrorHandlers[t]);this.detachHandlers()}reject(e){if(this.privState!==ci.None)throw new Error("'Cannot reject a completed promise'");this.privState=ci.Rejected,this.privPromiseResultEvents.setError(e);for(let t of this.privErrorHandlers)this.executeErrorCallback(e,t);this.detachHandlers()}on(e,t){e==null&&(e=()=>{}),this.privState===ci.None?(this.privSuccessHandlers.push(e),this.privErrorHandlers.push(t)):(this.privState===ci.Resolved?this.executeSuccessCallback(this.privPromiseResult.result,e,t):this.privState===ci.Rejected&&this.executeErrorCallback(this.privPromiseResult.error,t),this.detachHandlers())}executeSuccessCallback(e,t,i){try{t(e)}catch(n){this.executeErrorCallback(`'Unhandled callback error: ${n}'`,i)}}executeErrorCallback(e,t){if(t)try{t(e)}catch(i){throw new Error(`'Unhandled callback error: ${i}. InnerError: ${e}'`)}else throw new Error(`'Unhandled error: ${e}'`)}detachHandlers(){this.privErrorHandlers=[],this.privSuccessHandlers=[]}};mt.Sink=eg;function DN(r,e,t){r.then(i=>{try{e&&e(i)}catch(n){if(t)try{if(n instanceof Error){let s=n;t(s.name+": "+s.message)}else t(n)}catch{}}},i=>{if(t)try{if(i instanceof Error){let n=i;t(n.name+": "+n.message)}else t(i)}catch{}})}mt.marshalPromiseToCallbacks=DN});var sg=h(Nu=>{"use strict";Object.defineProperty(Nu,"__esModule",{value:!0});Nu.Queue=void 0;var rg=Cr(),ig=Xv(),K_=tg(),ku=function(r){return r[r.Dequeue=0]="Dequeue",r[r.Peek=1]="Peek",r}(ku||{}),ng=class{constructor(e){this.privPromiseStore=new ig.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=e||new ig.List,this.privDetachables=[],this.privSubscribers=new ig.List,this.privDetachables.push(this.privList.onAdded(()=>this.drain()))}enqueue(e){this.throwIfDispose(),this.enqueueFromPromise(new Promise(t=>t(e)))}enqueueFromPromise(e){this.throwIfDispose(),e.then(t=>{this.privList.add(t)},()=>{})}dequeue(){this.throwIfDispose();let e=new K_.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:ku.Dequeue}),this.drain()),e.promise}peek(){this.throwIfDispose();let e=new K_.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:ku.Peek}),this.drain()),e.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return this.privSubscribers==null}drainAndDispose(e,t){return v(this,null,function*(){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=t,this.privIsDisposing=!0;let i=this.privSubscribers;if(i){for(;i.length()>0;)i.removeFirst().deferral.resolve(void 0);this.privSubscribers===i&&(this.privSubscribers=i)}for(let n of this.privDetachables)yield n.detach();if(this.privPromiseStore.length()>0&&e){let n=[];return this.privPromiseStore.toArray().forEach(s=>{n.push(s)}),Promise.all(n).finally(()=>{this.privSubscribers=null,this.privList.forEach(s=>{e(s)}),this.privList=null}).then()}else this.privSubscribers=null,this.privList=null}})}dispose(e){return v(this,null,function*(){yield this.drainAndDispose(null,e)})}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;let e=this.privSubscribers,t=this.privList;if(e&&t){for(;t.length()>0&&e.length()>0&&!this.privIsDisposing;){let i=e.removeFirst();if(i.type===ku.Peek)i.deferral.resolve(t.first());else{let n=t.removeFirst();i.deferral.resolve(n)}}this.privSubscribers===e&&(this.privSubscribers=e),this.privList===t&&(this.privList=t)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed())throw this.privDisposeReason?new rg.InvalidOperationError(this.privDisposeReason):new rg.ObjectDisposedError("Queue");if(this.privIsDisposing)throw new rg.InvalidOperationError("Queue disposing")}};Nu.Queue=ng});var G_=h(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:!0});Lu.RawWebsocketMessage=void 0;var ju=Hv(),ia=Cr(),xN=Ni(),og=class{constructor(e,t,i){if(this.privPayload=null,!t)throw new ia.ArgumentNullError("payload");if(e===ju.MessageType.Binary&&Object.getPrototypeOf(t).constructor.name!=="ArrayBuffer")throw new ia.InvalidOperationError("Payload must be ArrayBuffer");if(e===ju.MessageType.Text&&typeof t!="string")throw new ia.InvalidOperationError("Payload must be a string");this.privMessageType=e,this.privPayload=t,this.privId=i||xN.createNoDashGuid()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===ju.MessageType.Binary)throw new ia.InvalidOperationError("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===ju.MessageType.Text)throw new ia.InvalidOperationError("Not supported for text message");return this.privPayload}get id(){return this.privId}};Lu.RawWebsocketMessage=og});var J_=h(qu=>{"use strict";Object.defineProperty(qu,"__esModule",{value:!0});qu.RiffPcmEncoder=void 0;var ag=class{constructor(e,t){this.privActualSampleRate=e,this.privDesiredSampleRate=t}encode(e){let t=this.downSampleAudioFrame(e,this.privActualSampleRate,this.privDesiredSampleRate);if(!t)return null;let i=t.length*2,n=new ArrayBuffer(i),s=new DataView(n);return this.floatTo16BitPCM(s,0,t),n}setString(e,t,i){for(let n=0;n<i.length;n++)e.setUint8(t+n,i.charCodeAt(n))}floatTo16BitPCM(e,t,i){for(let n=0;n<i.length;n++,t+=2){let s=Math.max(-1,Math.min(1,i[n]));e.setInt16(t,s<0?s*32768:s*32767,!0)}}downSampleAudioFrame(e,t,i){if(!e)return null;if(i===t||i>t)return e;let n=t/i,s=Math.round(e.length/n),o=new Float32Array(s),a=0,c=0;for(;c<s;){let u=Math.round((c+1)*n),p=0,l=0;for(;a<u&&a<e.length;)p+=e[a++],l++;o[c++]=p/l}return o}};qu.RiffPcmEncoder=ag});var X_=h(zu=>{"use strict";Object.defineProperty(zu,"__esModule",{value:!0});zu.Stream=void 0;var Y_=Cr(),MN=Ni(),Q_=sg(),cg=class{constructor(e){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=e||MN.createNoDashGuid(),this.privReaderQueue=new Q_.Queue}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(e){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(e)}catch{}}read(){if(this.privIsReadEnded)throw new Y_.InvalidOperationError("Stream read has already finished");return this.privReaderQueue.dequeue().then(e=>v(this,null,function*(){return(e===void 0||e.isEnd)&&(yield this.privReaderQueue.dispose("End of stream reached")),e}))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new Q_.Queue)}throwIfClosed(){if(this.privIsWriteEnded)throw new Y_.InvalidOperationError("Stream closed")}};zu.Stream=cg});var Fu=h(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});na.TranslationStatus=void 0;var kN;(function(r){r[r.Success=0]="Success",r[r.Error=1]="Error"})(kN=na.TranslationStatus||(na.TranslationStatus={}))});var Z_=h(Bu=>{"use strict";Object.defineProperty(Bu,"__esModule",{value:!0});Bu.ChunkedArrayBufferStream=void 0;var NN=x(),ug=class extends NN.Stream{constructor(e,t){super(t),this.privTargetChunkSize=e,this.privNextBufferReadyBytes=0}writeStreamChunk(e){if(e.isEnd||this.privNextBufferReadyBytes===0&&e.buffer.byteLength===this.privTargetChunkSize){super.writeStreamChunk(e);return}let t=0;for(;t<e.buffer.byteLength;){this.privNextBufferToWrite===void 0&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=e.timeReceived);let i=Math.min(e.buffer.byteLength-t,this.privTargetChunkSize-this.privNextBufferReadyBytes),n=new Uint8Array(this.privNextBufferToWrite),s=new Uint8Array(e.buffer.slice(t,i+t));n.set(s,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=i,t+=i,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){this.privNextBufferReadyBytes!==0&&!this.isClosed&&super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}};Bu.ChunkedArrayBufferStream=ug});var tR=h(eR=>{"use strict";Object.defineProperty(eR,"__esModule",{value:!0})});var rR=h(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});Uu.Timeout=void 0;var Fr=class r{static load(){let e=new Map([[0,()=>{}]]),t=new Map,n="data:text/javascript;base64,"+btoa(`!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`),s=new Worker(n);return s.addEventListener("message",({data:c})=>{if(r.isCallNotification(c)){let{params:{timerId:u}}=c,p=e.get(u);if(typeof p=="number"){let l=t.get(p);if(l===void 0||l!==u)throw new Error("The timer is in an undefined state.")}else if(typeof p<"u")p(),e.delete(u);else throw new Error("The timer is in an undefined state.")}else if(r.isClearResponse(c)){let{id:u}=c,p=t.get(u);if(p===void 0)throw new Error("The timer is in an undefined state.");t.delete(u),e.delete(p)}else{let{error:{message:u}}=c;throw new Error(u)}}),{clearTimeout:c=>{let u=Math.random();t.set(u,c),e.set(c,u),s.postMessage({id:u,method:"clear",params:{timerId:c}})},setTimeout:(c,u)=>{let p=Math.random();return e.set(p,c),s.postMessage({id:null,method:"set",params:{delay:u,now:performance.now(),timerId:p}}),p}}}static loadWorkerTimers(){return()=>(r.workerTimers!==null||(r.workerTimers=r.load()),r.workerTimers)}static isCallNotification(e){return e.method!==void 0&&e.method==="call"}static isClearResponse(e){return e.error===null&&typeof e.id=="number"}};Uu.Timeout=Fr;Fr.workerTimers=null;Fr.clearTimeout=r=>Fr.timers().clearTimeout(r);Fr.setTimeout=(r,e)=>Fr.timers().setTimeout(r,e);Fr.timers=Fr.loadWorkerTimers()});var iR=h(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.OCSPCacheUpdateErrorEvent=J.OCSPResponseRetrievedEvent=J.OCSPCacheFetchErrorEvent=J.OCSPVerificationFailedEvent=J.OCSPCacheHitEvent=J.OCSPCacheEntryNeedsRefreshEvent=J.OCSPCacheEntryExpiredEvent=J.OCSPWSUpgradeStartedEvent=J.OCSPStapleReceivedEvent=J.OCSPCacheUpdateCompleteEvent=J.OCSPDiskCacheStoreEvent=J.OCSPMemoryCacheStoreEvent=J.OCSPCacheUpdateNeededEvent=J.OCSPDiskCacheHitEvent=J.OCSPCacheMissEvent=J.OCSPMemoryCacheHitEvent=J.OCSPEvent=void 0;var We=Is(),Ne=class extends We.PlatformEvent{constructor(e,t,i){super(e,t),this.privSignature=i}};J.OCSPEvent=Ne;var pg=class extends Ne{constructor(e){super("OCSPMemoryCacheHitEvent",We.EventType.Debug,e)}};J.OCSPMemoryCacheHitEvent=pg;var lg=class extends Ne{constructor(e){super("OCSPCacheMissEvent",We.EventType.Debug,e)}};J.OCSPCacheMissEvent=lg;var hg=class extends Ne{constructor(e){super("OCSPDiskCacheHitEvent",We.EventType.Debug,e)}};J.OCSPDiskCacheHitEvent=hg;var dg=class extends Ne{constructor(e){super("OCSPCacheUpdateNeededEvent",We.EventType.Debug,e)}};J.OCSPCacheUpdateNeededEvent=dg;var fg=class extends Ne{constructor(e){super("OCSPMemoryCacheStoreEvent",We.EventType.Debug,e)}};J.OCSPMemoryCacheStoreEvent=fg;var vg=class extends Ne{constructor(e){super("OCSPDiskCacheStoreEvent",We.EventType.Debug,e)}};J.OCSPDiskCacheStoreEvent=vg;var gg=class extends Ne{constructor(e){super("OCSPCacheUpdateCompleteEvent",We.EventType.Debug,e)}};J.OCSPCacheUpdateCompleteEvent=gg;var mg=class extends Ne{constructor(){super("OCSPStapleReceivedEvent",We.EventType.Debug,"")}};J.OCSPStapleReceivedEvent=mg;var yg=class extends Ne{constructor(e){super("OCSPWSUpgradeStartedEvent",We.EventType.Debug,e)}};J.OCSPWSUpgradeStartedEvent=yg;var Sg=class extends Ne{constructor(e,t){super("OCSPCacheEntryExpiredEvent",We.EventType.Debug,e),this.privExpireTime=t}};J.OCSPCacheEntryExpiredEvent=Sg;var Cg=class extends Ne{constructor(e,t,i){super("OCSPCacheEntryNeedsRefreshEvent",We.EventType.Debug,e),this.privExpireTime=i,this.privStartTime=t}};J.OCSPCacheEntryNeedsRefreshEvent=Cg;var bg=class extends Ne{constructor(e,t,i){super("OCSPCacheHitEvent",We.EventType.Debug,e),this.privExpireTime=i,this.privExpireTimeString=new Date(i).toLocaleDateString(),this.privStartTime=t,this.privStartTimeString=new Date(t).toLocaleTimeString()}};J.OCSPCacheHitEvent=bg;var Pg=class extends Ne{constructor(e,t){super("OCSPVerificationFailedEvent",We.EventType.Debug,e),this.privError=t}};J.OCSPVerificationFailedEvent=Pg;var wg=class extends Ne{constructor(e,t){super("OCSPCacheFetchErrorEvent",We.EventType.Debug,e),this.privError=t}};J.OCSPCacheFetchErrorEvent=wg;var _g=class extends Ne{constructor(e){super("OCSPResponseRetrievedEvent",We.EventType.Debug,e)}};J.OCSPResponseRetrievedEvent=_g;var Rg=class extends Ne{constructor(e,t){super("OCSPCacheUpdateErrorEvent",We.EventType.Debug,e),this.privError=t}};J.OCSPCacheUpdateErrorEvent=Rg});var sR=h(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});Wu.BackgroundEvent=void 0;var nR=x(),Eg=class extends nR.PlatformEvent{constructor(e){super("BackgroundEvent",nR.EventType.Error),this.privError=e}get error(){return this.privError}};Wu.BackgroundEvent=Eg});var x=h(H=>{"use strict";var jN=H&&H.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),te=H&&H.__exportStar||function(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&jN(e,r,t)};Object.defineProperty(H,"__esModule",{value:!0});te(P_(),H);te(w_(),H);te(Hv(),H);te(__(),H);te(R_(),H);te(Gv(),H);te(Cr(),H);te(I_(),H);te(Yv(),H);te(Ni(),H);te(A_(),H);te(O_(),H);te(x_(),H);te(k_(),H);te(j_(),H);te(q_(),H);te(F_(),H);te(U_(),H);te(H_(),H);te($_(),H);te(Xv(),H);te(Is(),H);te(tg(),H);te(sg(),H);te(G_(),H);te(J_(),H);te(X_(),H);var LN=Fu();Object.defineProperty(H,"TranslationStatus",{enumerable:!0,get:function(){return LN.TranslationStatus}});te(Z_(),H);te(tR(),H);te(rR(),H);te(iR(),H);te(sR(),H)});var ot=h(Hu=>{"use strict";Object.defineProperty(Hu,"__esModule",{value:!0});Hu.HeaderNames=void 0;var Ut=class{};Hu.HeaderNames=Ut;Ut.AuthKey="Ocp-Apim-Subscription-Key";Ut.Authorization="Authorization";Ut.SpIDAuthKey="Apim-Subscription-Id";Ut.ConnectionId="X-ConnectionId";Ut.ContentType="Content-Type";Ut.CustomCommandsAppId="X-CommandsAppId";Ut.Path="Path";Ut.RequestId="X-RequestId";Ut.RequestStreamId="X-StreamId";Ut.RequestTimestamp="X-Timestamp"});var $u=h(Vu=>{"use strict";Object.defineProperty(Vu,"__esModule",{value:!0});Vu.AuthInfo=void 0;var Ig=class{constructor(e,t){this.privHeaderName=e,this.privToken=t}get headerName(){return this.privHeaderName}get token(){return this.privToken}};Vu.AuthInfo=Ig});var oR=h(Ku=>{"use strict";Object.defineProperty(Ku,"__esModule",{value:!0});Ku.CognitiveSubscriptionKeyAuthentication=void 0;var qN=x(),zN=ot(),FN=$u(),Tg=class{constructor(e){if(!e)throw new qN.ArgumentNullError("subscriptionKey");this.privAuthInfo=new FN.AuthInfo(zN.HeaderNames.AuthKey,e)}fetch(e){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(e){return Promise.resolve(this.privAuthInfo)}};Ku.CognitiveSubscriptionKeyAuthentication=Tg});var pR=h(Ju=>{"use strict";Object.defineProperty(Ju,"__esModule",{value:!0});Ju.CognitiveTokenAuthentication=void 0;var aR=x(),cR=$u(),uR=ot(),Gu=class r{constructor(e,t){if(!e)throw new aR.ArgumentNullError("fetchCallback");if(!t)throw new aR.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=e,this.privFetchOnExpiryCallback=t}fetch(e){return this.privFetchCallback(e).then(t=>new cR.AuthInfo(uR.HeaderNames.Authorization,t===void 0?void 0:r.privTokenPrefix+t))}fetchOnExpiry(e){return this.privFetchOnExpiryCallback(e).then(t=>new cR.AuthInfo(uR.HeaderNames.Authorization,t===void 0?void 0:r.privTokenPrefix+t))}};Ju.CognitiveTokenAuthentication=Gu;Gu.privTokenPrefix="Bearer "});var hR=h(lR=>{"use strict";Object.defineProperty(lR,"__esModule",{value:!0})});var fR=h(dR=>{"use strict";Object.defineProperty(dR,"__esModule",{value:!0})});var Ag=h(()=>{"use strict"});var Og=h(Yu=>{"use strict";Object.defineProperty(Yu,"__esModule",{value:!0});Yu.LogLevel=void 0;var BN=x();Object.defineProperty(Yu,"LogLevel",{enumerable:!0,get:function(){return BN.EventType}})});var j=h(Qu=>{"use strict";Object.defineProperty(Qu,"__esModule",{value:!0});Qu.Contracts=void 0;var Dg=class r{static throwIfNullOrUndefined(e,t){if(e==null)throw new Error("throwIfNullOrUndefined:"+t)}static throwIfNull(e,t){if(e===null)throw new Error("throwIfNull:"+t)}static throwIfNullOrWhitespace(e,t){if(r.throwIfNullOrUndefined(e,t),(""+e).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+t)}static throwIfNullOrTooLong(e,t,i){if(r.throwIfNullOrUndefined(e,t),(""+e).length>i)throw new Error("throwIfNullOrTooLong:"+t+" (more than "+i.toString()+" characters)")}static throwIfNullOrTooShort(e,t,i){if(r.throwIfNullOrUndefined(e,t),(""+e).length<i)throw new Error("throwIfNullOrTooShort:"+t+" (less than "+i.toString()+" characters)")}static throwIfDisposed(e){if(e)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(e,t){if(r.throwIfNullOrUndefined(e,t),e.length===0)throw new Error("throwIfArrayEmptyOrWhitespace:"+t);for(let i of e)r.throwIfNullOrWhitespace(i,t)}static throwIfFileDoesNotExist(e,t){r.throwIfNullOrWhitespace(e,t)}static throwIfNotUndefined(e,t){if(e!==void 0)throw new Error("throwIfNotUndefined:"+t)}};Qu.Contracts=Dg});var gR=h(Br=>{"use strict";var UN=Br&&Br.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),WN=Br&&Br.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),HN=Br&&Br.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.hasOwnProperty.call(r,t)&&UN(e,r,t);return WN(e,r),e};Object.defineProperty(Br,"__esModule",{value:!0});Br.ConsoleLoggingListener=void 0;var vR=HN(Ag()),sa=Og(),VN=j(),xg=class{constructor(e=sa.LogLevel.None){this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=e}set logPath(e){VN.Contracts.throwIfNullOrUndefined(vR.openSync,`
File System access not available`),this.privLogPath=e}set enableConsoleOutput(e){this.privEnableConsoleOutput=e}onEvent(e){if(e.eventType>=this.privLogLevelFilter){let t=this.toString(e);if(this.logCallback&&this.logCallback(t),this.privLogPath&&vR.writeFileSync(this.privLogPath,t+`
`,{flag:"a+"}),this.privEnableConsoleOutput)switch(e.eventType){case sa.LogLevel.Debug:console.debug(t);break;case sa.LogLevel.Info:console.info(t);break;case sa.LogLevel.Warning:console.warn(t);break;case sa.LogLevel.Error:console.error(t);break;default:console.log(t);break}}}toString(e){let t=[`${e.eventTime}`,`${e.name}`],i=e;for(let n in i)if(n&&e.hasOwnProperty(n)&&n!=="eventTime"&&n!=="eventType"&&n!=="eventId"&&n!=="name"&&n!=="constructor"){let s=i[n],o="<NULL>";s!=null&&(typeof s=="number"||typeof s=="string"?o=s.toString():o=JSON.stringify(s)),t.push(`${n}: ${o}`)}return t.join(" | ")}};Br.ConsoleLoggingListener=xg});var yR=h(mR=>{"use strict";Object.defineProperty(mR,"__esModule",{value:!0})});var qi=h(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.AudioStreamFormatImpl=ui.AudioStreamFormat=ui.AudioFormatTag=void 0;var oa;(function(r){r[r.PCM=1]="PCM",r[r.MuLaw=2]="MuLaw",r[r.Siren=3]="Siren",r[r.MP3=4]="MP3",r[r.SILKSkype=5]="SILKSkype",r[r.OGG_OPUS=6]="OGG_OPUS",r[r.WEBM_OPUS=7]="WEBM_OPUS",r[r.ALaw=8]="ALaw",r[r.FLAC=9]="FLAC",r[r.OPUS=10]="OPUS",r[r.AMR_WB=11]="AMR_WB",r[r.G722=12]="G722"})(oa=ui.AudioFormatTag||(ui.AudioFormatTag={}));var Xu=class{static getDefaultInputFormat(){return As.getDefaultInputFormat()}static getWaveFormat(e,t,i,n){return new As(e,t,i,n)}static getWaveFormatPCM(e,t,i){return new As(e,t,i)}};ui.AudioStreamFormat=Xu;var As=class r extends Xu{constructor(e=16e3,t=16,i=1,n=oa.PCM){super();let s=!0;switch(n){case oa.PCM:this.formatTag=1;break;case oa.ALaw:this.formatTag=6;break;case oa.MuLaw:this.formatTag=7;break;default:s=!1}if(this.bitsPerSample=t,this.samplesPerSec=e,this.channels=i,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),s){this.privHeader=new ArrayBuffer(44);let o=new DataView(this.privHeader);this.setString(o,0,"RIFF"),o.setUint32(4,0,!0),this.setString(o,8,"WAVEfmt "),o.setUint32(16,16,!0),o.setUint16(20,this.formatTag,!0),o.setUint16(22,this.channels,!0),o.setUint32(24,this.samplesPerSec,!0),o.setUint32(28,this.avgBytesPerSec,!0),o.setUint16(32,this.channels*(this.bitsPerSample/8),!0),o.setUint16(34,this.bitsPerSample,!0),this.setString(o,36,"data"),o.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new r}static getAudioContext(e){let t=window.AudioContext||window.webkitAudioContext||!1;if(t)return e!==void 0&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new t({sampleRate:e}):new t;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(e,t,i){for(let n=0;n<i.length;n++)e.setUint8(t+n,i.charCodeAt(n))}};ui.AudioStreamFormatImpl=As});var bR=h(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.MicAudioSource=wn.AudioWorkletSourceURLPropertyName=void 0;var SR=T(),He=x(),CR=qi();wn.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";var Zu=class r{constructor(e,t,i,n){this.privRecorder=e,this.deviceId=t,this.privStreams={},this.privOutputChunkSize=r.AUDIOFORMAT.avgBytesPerSec/10,this.privId=i||He.createNoDashGuid(),this.privEvents=new He.EventSource,this.privMediaStream=n||null,this.privIsClosing=!1}get format(){return Promise.resolve(r.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new He.Deferred;try{this.createAudioContext()}catch(i){if(i instanceof Error){let n=i;this.privInitializeDeferral.reject(n.name+": "+n.message)}else this.privInitializeDeferral.reject(i);return this.privInitializeDeferral.promise}let e=window.navigator,t=e.getUserMedia||e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia;if(e.mediaDevices&&(t=(i,n,s)=>{e.mediaDevices.getUserMedia(i).then(n).catch(s)}),t){let i=()=>{this.onEvent(new He.AudioSourceInitializingEvent(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new He.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()):t({audio:this.deviceId?{deviceId:this.deviceId}:!0,video:!1},n=>{this.privMediaStream=n,this.onEvent(new He.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()},n=>{let s=`Error occurred during microphone initialization: ${n}`;this.privInitializeDeferral.reject(s),this.onEvent(new He.AudioSourceErrorEvent(this.privId,s))})};this.privContext.state==="suspended"?this.privContext.resume().then(i).catch(n=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${n}`)}):i()}else{let i="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(i),this.onEvent(new He.AudioSourceErrorEvent(i,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(e){return this.onEvent(new He.AudioStreamNodeAttachingEvent(this.privId,e)),this.listen(e).then(t=>(this.onEvent(new He.AudioStreamNodeAttachedEvent(this.privId,e)),{detach:()=>v(this,null,function*(){return t.readEnded(),delete this.privStreams[e],this.onEvent(new He.AudioStreamNodeDetachedEvent(this.privId,e)),this.turnOff()}),id:()=>e,read:()=>t.read()}))}detach(e){e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new He.AudioStreamNodeDetachedEvent(this.privId,e)))}turnOff(){return v(this,null,function*(){for(let e in this.privStreams)if(e){let t=this.privStreams[e];t&&t.close()}this.onEvent(new He.AudioSourceOffEvent(this.privId)),this.privInitializeDeferral&&(yield this.privInitializeDeferral,this.privInitializeDeferral=null),yield this.destroyAudioContext()})}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then(e=>({bitspersample:r.AUDIOFORMAT.bitsPerSample,channelcount:r.AUDIOFORMAT.channels,connectivity:SR.connectivity.Unknown,manufacturer:"Speech SDK",model:e,samplerate:r.AUDIOFORMAT.samplesPerSec,type:SR.type.Microphones}))}setProperty(e,t){if(e===wn.AudioWorkletSourceURLPropertyName)this.privRecorder.setWorkletUrl(t);else throw new Error("Property '"+e+"' is not supported on Microphone.")}getMicrophoneLabel(){let e="microphone";if(this.privMicrophoneLabel!==void 0)return Promise.resolve(this.privMicrophoneLabel);if(this.privMediaStream===void 0||!this.privMediaStream.active)return Promise.resolve(e);this.privMicrophoneLabel=e;let t=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(t===void 0)return Promise.resolve(this.privMicrophoneLabel);let i=new He.Deferred;return navigator.mediaDevices.enumerateDevices().then(n=>{for(let s of n)if(s.deviceId===t){this.privMicrophoneLabel=s.label;break}i.resolve(this.privMicrophoneLabel)},()=>i.resolve(this.privMicrophoneLabel)),i.promise}listen(e){return v(this,null,function*(){yield this.turnOn();let t=new He.ChunkedArrayBufferStream(this.privOutputChunkSize,e);this.privStreams[e]=t;try{this.privRecorder.record(this.privContext,this.privMediaStream,t)}catch(n){throw this.onEvent(new He.AudioStreamNodeErrorEvent(this.privId,e,n)),n}return t})}onEvent(e){this.privEvents.onEvent(e),He.Events.instance.onEvent(e)}createAudioContext(){this.privContext||(this.privContext=CR.AudioStreamFormatImpl.getAudioContext(r.AUDIOFORMAT.samplesPerSec))}destroyAudioContext(){return v(this,null,function*(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let e=!1;"close"in this.privContext&&(e=!0),e?this.privIsClosing||(this.privIsClosing=!0,yield this.privContext.close(),this.privContext=null,this.privIsClosing=!1):this.privContext!==null&&this.privContext.state==="running"&&(yield this.privContext.suspend())})}};wn.MicAudioSource=Zu;Zu.AUDIOFORMAT=CR.AudioStreamFormat.getDefaultInputFormat()});var wR=h(ep=>{"use strict";Object.defineProperty(ep,"__esModule",{value:!0});ep.FileAudioSource=void 0;var PR=T(),Ot=x(),$N=qi(),Mg=class{constructor(e,t,i){this.privStreams={},this.privHeaderEnd=44,this.privId=i||Ot.createNoDashGuid(),this.privEvents=new Ot.EventSource,this.privSource=e,typeof window<"u"&&typeof Blob<"u"&&this.privSource instanceof Blob?this.privFilename=e.name:this.privFilename=t||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){let e=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new Ot.AudioSourceErrorEvent(e,"")),Promise.reject(e)}this.onEvent(new Ot.AudioSourceInitializingEvent(this.privId)),this.onEvent(new Ot.AudioSourceReadyEvent(this.privId))}id(){return this.privId}attach(e){return v(this,null,function*(){this.onEvent(new Ot.AudioStreamNodeAttachingEvent(this.privId,e));let t=yield this.upload(e);return this.onEvent(new Ot.AudioStreamNodeAttachedEvent(this.privId,e)),Promise.resolve({detach:()=>v(this,null,function*(){t.readEnded(),delete this.privStreams[e],this.onEvent(new Ot.AudioStreamNodeDetachedEvent(this.privId,e)),yield this.turnOff()}),id:()=>e,read:()=>t.read()})})}detach(e){e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new Ot.AudioStreamNodeDetachedEvent(this.privId,e)))}turnOff(){for(let e in this.privStreams)if(e){let t=this.privStreams[e];t&&!t.isClosed&&t.close()}return this.onEvent(new Ot.AudioSourceOffEvent(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then(e=>Promise.resolve({bitspersample:e.bitsPerSample,channelcount:e.channels,connectivity:PR.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:e.samplesPerSec,type:PR.type.File}))}readHeader(){let t=this.privSource.slice(0,4296),i=new Ot.Deferred,n=s=>{let o=new DataView(s),a=f=>String.fromCharCode(o.getUint8(f),o.getUint8(f+1),o.getUint8(f+2),o.getUint8(f+3));if(a(0)!=="RIFF"){i.reject("Invalid WAV header in file, RIFF was not found");return}if(a(8)!=="WAVE"||a(12)!=="fmt "){i.reject("Invalid WAV header in file, WAVEfmt was not found");return}let c=o.getInt32(16,!0),u=o.getUint16(22,!0),p=o.getUint32(24,!0),l=o.getUint16(34,!0),d=36+Math.max(c-16,0);for(;a(d)!=="data";d+=2)if(d>4288){i.reject("Invalid WAV header in file, data block was not found");return}this.privHeaderEnd=d+8,i.resolve($N.AudioStreamFormat.getWaveFormatPCM(p,l,u))};if(typeof window<"u"&&typeof Blob<"u"&&t instanceof Blob){let s=new FileReader;s.onload=o=>{let a=o.target.result;n(a)},s.readAsArrayBuffer(t)}else{let s=t;n(s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength))}return i.promise}upload(e){return v(this,null,function*(){let t=i=>{let n=`Error occurred while processing '${this.privFilename}'. ${i}`;throw this.onEvent(new Ot.AudioStreamNodeErrorEvent(this.privId,e,n)),new Error(n)};try{yield this.turnOn();let i=yield this.privAudioFormatPromise,n=new Ot.ChunkedArrayBufferStream(i.avgBytesPerSec/10,e);this.privStreams[e]=n;let s=this.privSource.slice(this.privHeaderEnd),o=a=>{n.isClosed||(n.writeStreamChunk({buffer:a,isEnd:!1,timeReceived:Date.now()}),n.close())};if(typeof window<"u"&&typeof Blob<"u"&&s instanceof Blob){let a=new FileReader;a.onerror=c=>t(c.toString()),a.onload=c=>{let u=c.target.result;o(u)},a.readAsArrayBuffer(s)}else{let a=s;o(a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength))}return n}catch(i){t(i)}})}onEvent(e){this.privEvents.onEvent(e),Ot.Events.instance.onEvent(e)}};ep.FileAudioSource=Mg});var _R=h(tp=>{"use strict";Object.defineProperty(tp,"__esModule",{value:!0});tp.PcmRecorder=void 0;var KN=x(),kg=class{constructor(e){this.privStopInputOnRelease=e}record(e,t,i){let s=new KN.RiffPcmEncoder(e.sampleRate,16e3),o=e.createMediaStreamSource(t),a=()=>{let u=(()=>{let p=0;try{return e.createScriptProcessor(p,1,1)}catch{p=2048;let d=e.sampleRate;for(;p<16384&&d>=32e3;)p<<=1,d>>=1;return e.createScriptProcessor(p,1,1)}})();u.onaudioprocess=p=>{let l=p.inputBuffer.getChannelData(0);if(i&&!i.isClosed){let d=s.encode(l);d&&i.writeStreamChunk({buffer:d,isEnd:!1,timeReceived:Date.now()})}},o.connect(u),u.connect(e.destination),this.privMediaResources={scriptProcessorNode:u,source:o,stream:t}},c=!!this.privSpeechProcessorScript&&this.privSpeechProcessorScript.toLowerCase()==="ignore";if(e.audioWorklet&&!c){if(!this.privSpeechProcessorScript){let u=`class SP extends AudioWorkletProcessor {
                    constructor(options) {
                      super(options);
                    }
                    process(inputs, outputs) {
                      const input = inputs[0];
                      const output = [];
                      for (let channel = 0; channel < input.length; channel += 1) {
                        output[channel] = input[channel];
                      }
                      this.port.postMessage(output[0]);
                      return true;
                    }
                  }
                  registerProcessor('speech-processor', SP);`,p=new Blob([u],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(p)}e.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{let u=new AudioWorkletNode(e,"speech-processor");u.port.onmessage=p=>{let l=p.data;if(i&&!i.isClosed){let d=s.encode(l);d&&i.writeStreamChunk({buffer:d,isEnd:!1,timeReceived:Date.now()})}},o.connect(u),u.connect(e.destination),this.privMediaResources={scriptProcessorNode:u,source:o,stream:t}}).catch(()=>{a()})}else try{a()}catch(u){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${u}`)}}releaseMediaResources(e){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(e.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach(t=>t.stop()),this.privMediaResources.source=null))}setWorkletUrl(e){this.privSpeechProcessorScript=e}};tp.PcmRecorder=kg});var Ng=h(()=>{"use strict"});var jg=h(()=>{"use strict"});var qg=h((_V,Lg)=>{"use strict";var Os=typeof Reflect=="object"?Reflect:null,RR=Os&&typeof Os.apply=="function"?Os.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)},rp;Os&&typeof Os.ownKeys=="function"?rp=Os.ownKeys:Object.getOwnPropertySymbols?rp=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:rp=function(e){return Object.getOwnPropertyNames(e)};function GN(r){console&&console.warn&&console.warn(r)}var IR=Number.isNaN||function(e){return e!==e};function ae(){ae.init.call(this)}Lg.exports=ae;Lg.exports.once=XN;ae.EventEmitter=ae;ae.prototype._events=void 0;ae.prototype._eventsCount=0;ae.prototype._maxListeners=void 0;var ER=10;function ip(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(ae,"defaultMaxListeners",{enumerable:!0,get:function(){return ER},set:function(r){if(typeof r!="number"||r<0||IR(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");ER=r}});ae.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ae.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||IR(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function TR(r){return r._maxListeners===void 0?ae.defaultMaxListeners:r._maxListeners}ae.prototype.getMaxListeners=function(){return TR(this)};ae.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")RR(c,this,t);else for(var u=c.length,p=MR(c,u),i=0;i<u;++i)RR(p[i],this,t);return!0};function AR(r,e,t,i){var n,s,o;if(ip(t),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),s=r._events),o=s[e]),o===void 0)o=s[e]=t,++r._eventsCount;else if(typeof o=="function"?o=s[e]=i?[t,o]:[o,t]:i?o.unshift(t):o.push(t),n=TR(r),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=o.length,GN(a)}return r}ae.prototype.addListener=function(e,t){return AR(this,e,t,!1)};ae.prototype.on=ae.prototype.addListener;ae.prototype.prependListener=function(e,t){return AR(this,e,t,!0)};function JN(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function OR(r,e,t){var i={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},n=JN.bind(i);return n.listener=t,i.wrapFn=n,n}ae.prototype.once=function(e,t){return ip(t),this.on(e,OR(this,e,t)),this};ae.prototype.prependOnceListener=function(e,t){return ip(t),this.prependListener(e,OR(this,e,t)),this};ae.prototype.removeListener=function(e,t){var i,n,s,o,a;if(ip(t),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===t||i[o].listener===t){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():YN(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};ae.prototype.off=ae.prototype.removeListener;ae.prototype.removeAllListeners=function(e){var t,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this};function DR(r,e,t){var i=r._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?t?[n.listener||n]:[n]:t?QN(n):MR(n,n.length)}ae.prototype.listeners=function(e){return DR(this,e,!0)};ae.prototype.rawListeners=function(e){return DR(this,e,!1)};ae.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):xR.call(r,e)};ae.prototype.listenerCount=xR;function xR(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}ae.prototype.eventNames=function(){return this._eventsCount>0?rp(this._events):[]};function MR(r,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=r[i];return t}function YN(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function QN(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function XN(r,e){return new Promise(function(t,i){function n(o){r.removeListener(e,s),i(o)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",n),t([].slice.call(arguments))}kR(r,e,s,{once:!0}),e!=="error"&&ZN(r,n,{once:!0})})}function ZN(r,e,t){typeof r.on=="function"&&kR(r,"error",e,t)}function kR(r,e,t,i){if(typeof r.on=="function")i.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function n(s){i.once&&r.removeEventListener(e,n),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var jR=h((RV,NR)=>{"use strict";var Ds=1e3,xs=Ds*60,Ms=xs*60,_n=Ms*24,ej=_n*7,tj=_n*365.25;NR.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return rj(r);if(t==="number"&&isFinite(r))return e.long?nj(r):ij(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function rj(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return t*tj;case"weeks":case"week":case"w":return t*ej;case"days":case"day":case"d":return t*_n;case"hours":case"hour":case"hrs":case"hr":case"h":return t*Ms;case"minutes":case"minute":case"mins":case"min":case"m":return t*xs;case"seconds":case"second":case"secs":case"sec":case"s":return t*Ds;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function ij(r){var e=Math.abs(r);return e>=_n?Math.round(r/_n)+"d":e>=Ms?Math.round(r/Ms)+"h":e>=xs?Math.round(r/xs)+"m":e>=Ds?Math.round(r/Ds)+"s":r+"ms"}function nj(r){var e=Math.abs(r);return e>=_n?np(r,e,_n,"day"):e>=Ms?np(r,e,Ms,"hour"):e>=xs?np(r,e,xs,"minute"):e>=Ds?np(r,e,Ds,"second"):r+" ms"}function np(r,e,t,i){var n=e>=t*1.5;return Math.round(r/t)+" "+i+(n?"s":"")}});var qR=h((EV,LR)=>{"use strict";function sj(r){t.debug=t,t.default=t,t.coerce=c,t.disable=s,t.enable=n,t.enabled=o,t.humanize=jR(),t.destroy=u,Object.keys(r).forEach(p=>{t[p]=r[p]}),t.names=[],t.skips=[],t.formatters={};function e(p){let l=0;for(let d=0;d<p.length;d++)l=(l<<5)-l+p.charCodeAt(d),l|=0;return t.colors[Math.abs(l)%t.colors.length]}t.selectColor=e;function t(p){let l,d=null,f,g;function m(...y){if(!m.enabled)return;let w=m,b=Number(new Date),C=b-(l||b);w.diff=C,w.prev=l,w.curr=b,l=b,y[0]=t.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let R=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(D,ee)=>{if(D==="%%")return"%";R++;let $=t.formatters[ee];if(typeof $=="function"){let X=y[R];D=$.call(w,X),y.splice(R,1),R--}return D}),t.formatArgs.call(w,y),(w.log||t.log).apply(w,y)}return m.namespace=p,m.useColors=t.useColors(),m.color=t.selectColor(p),m.extend=i,m.destroy=t.destroy,Object.defineProperty(m,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(f!==t.namespaces&&(f=t.namespaces,g=t.enabled(p)),g),set:y=>{d=y}}),typeof t.init=="function"&&t.init(m),m}function i(p,l){let d=t(this.namespace+(typeof l>"u"?":":l)+p);return d.log=this.log,d}function n(p){t.save(p),t.namespaces=p,t.names=[],t.skips=[];let l,d=(typeof p=="string"?p:"").split(/[\s,]+/),f=d.length;for(l=0;l<f;l++)d[l]&&(p=d[l].replace(/\*/g,".*?"),p[0]==="-"?t.skips.push(new RegExp("^"+p.slice(1)+"$")):t.names.push(new RegExp("^"+p+"$")))}function s(){let p=[...t.names.map(a),...t.skips.map(a).map(l=>"-"+l)].join(",");return t.enable(""),p}function o(p){if(p[p.length-1]==="*")return!0;let l,d;for(l=0,d=t.skips.length;l<d;l++)if(t.skips[l].test(p))return!1;for(l=0,d=t.names.length;l<d;l++)if(t.names[l].test(p))return!0;return!1}function a(p){return p.toString().substring(2,p.toString().length-2).replace(/\.\*\?$/,"*")}function c(p){return p instanceof Error?p.stack||p.message:p}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}LR.exports=sj});var zg=h((Wt,sp)=>{"use strict";Wt.formatArgs=aj;Wt.save=cj;Wt.load=uj;Wt.useColors=oj;Wt.storage=pj();Wt.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Wt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function oj(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let r;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(r=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(r[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function aj(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+sp.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,i=0;r[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(t++,n==="%c"&&(i=t))}),r.splice(i,0,e)}Wt.log=console.debug||console.log||(()=>{});function cj(r){try{r?Wt.storage.setItem("debug",r):Wt.storage.removeItem("debug")}catch{}}function uj(){let r;try{r=Wt.storage.getItem("debug")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function pj(){try{return localStorage}catch{}}sp.exports=qR()(Wt);var{formatters:lj}=sp.exports;lj.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var zR=h(Fg=>{"use strict";Object.defineProperty(Fg,"__esModule",{value:!0});function hj(r){return function(e,t){return new Promise((i,n)=>{r.call(this,e,t,(s,o)=>{s?n(s):i(o)})})}}Fg.default=hj});var UR=h((Ug,BR)=>{"use strict";var FR=Ug&&Ug.__importDefault||function(r){return r&&r.__esModule?r:{default:r}},dj=qg(),fj=FR(zg()),vj=FR(zR()),aa=fj.default("agent-base");function gj(r){return!!r&&typeof r.addRequest=="function"}function Bg(){let{stack:r}=new Error;return typeof r!="string"?!1:r.split(`
`).some(e=>e.indexOf("(https.js:")!==-1||e.indexOf("node:https:")!==-1)}function op(r,e){return new op.Agent(r,e)}(function(r){class e extends dj.EventEmitter{constructor(i,n){super();let s=n;typeof i=="function"?this.callback=i:i&&(s=i),this.timeout=null,s&&typeof s.timeout=="number"&&(this.timeout=s.timeout),this.maxFreeSockets=1,this.maxSockets=1,this.maxTotalSockets=1/0,this.sockets={},this.freeSockets={},this.requests={},this.options={}}get defaultPort(){return typeof this.explicitDefaultPort=="number"?this.explicitDefaultPort:Bg()?443:80}set defaultPort(i){this.explicitDefaultPort=i}get protocol(){return typeof this.explicitProtocol=="string"?this.explicitProtocol:Bg()?"https:":"http:"}set protocol(i){this.explicitProtocol=i}callback(i,n,s){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')}addRequest(i,n){let s=Object.assign({},n);typeof s.secureEndpoint!="boolean"&&(s.secureEndpoint=Bg()),s.host==null&&(s.host="localhost"),s.port==null&&(s.port=s.secureEndpoint?443:80),s.protocol==null&&(s.protocol=s.secureEndpoint?"https:":"http:"),s.host&&s.path&&delete s.path,delete s.agent,delete s.hostname,delete s._defaultAgent,delete s.defaultPort,delete s.createConnection,i._last=!0,i.shouldKeepAlive=!1;let o=!1,a=null,c=s.timeout||this.timeout,u=f=>{i._hadError||(i.emit("error",f),i._hadError=!0)},p=()=>{a=null,o=!0;let f=new Error(`A "socket" was not created for HTTP request before ${c}ms`);f.code="ETIMEOUT",u(f)},l=f=>{o||(a!==null&&(clearTimeout(a),a=null),u(f))},d=f=>{if(o)return;if(a!=null&&(clearTimeout(a),a=null),gj(f)){aa("Callback returned another Agent instance %o",f.constructor.name),f.addRequest(i,s);return}if(f){f.once("free",()=>{this.freeSocket(f,s)}),i.onSocket(f);return}let g=new Error(`no Duplex stream was returned to agent-base for \`${i.method} ${i.path}\``);u(g)};if(typeof this.callback!="function"){u(new Error("`callback` is not defined"));return}this.promisifiedCallback||(this.callback.length>=3?(aa("Converting legacy callback function to promise"),this.promisifiedCallback=vj.default(this.callback)):this.promisifiedCallback=this.callback),typeof c=="number"&&c>0&&(a=setTimeout(p,c)),"port"in s&&typeof s.port!="number"&&(s.port=Number(s.port));try{aa("Resolving socket for %o request: %o",s.protocol,`${i.method} ${i.path}`),Promise.resolve(this.promisifiedCallback(i,s)).then(d,l)}catch(f){Promise.reject(f).catch(l)}}freeSocket(i,n){aa("Freeing socket %o %o",i.constructor.name,n),i.destroy()}destroy(){aa("Destroying agent %o",this.constructor.name)}}r.Agent=e,r.prototype=r.Agent.prototype})(op||(op={}));BR.exports=op});var WR=h((ks,Ns)=>{"use strict";(function(r){var e=typeof ks=="object"&&ks&&!ks.nodeType&&ks,t=typeof Ns=="object"&&Ns&&!Ns.nodeType&&Ns,i=typeof global=="object"&&global;(i.global===i||i.window===i||i.self===i)&&(r=i);var n,s=2147483647,o=36,a=1,c=26,u=38,p=700,l=72,d=128,f="-",g=/^xn--/,m=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,w={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},b=o-a,C=Math.floor,R=String.fromCharCode,A;function D(O){throw new RangeError(w[O])}function ee(O,L){for(var Z=O.length,me=[];Z--;)me[Z]=L(O[Z]);return me}function $(O,L){var Z=O.split("@"),me="";Z.length>1&&(me=Z[0]+"@",O=Z[1]),O=O.replace(y,".");var we=O.split("."),ft=ee(we,L).join(".");return me+ft}function X(O){for(var L=[],Z=0,me=O.length,we,ft;Z<me;)we=O.charCodeAt(Z++),we>=55296&&we<=56319&&Z<me?(ft=O.charCodeAt(Z++),(ft&64512)==56320?L.push(((we&1023)<<10)+(ft&1023)+65536):(L.push(we),Z--)):L.push(we);return L}function le(O){return ee(O,function(L){var Z="";return L>65535&&(L-=65536,Z+=R(L>>>10&1023|55296),L=56320|L&1023),Z+=R(L),Z}).join("")}function qt(O){return O-48<10?O-22:O-65<26?O-65:O-97<26?O-97:o}function Pt(O,L){return O+22+75*(O<26)-((L!=0)<<5)}function Ie(O,L,Z){var me=0;for(O=Z?C(O/p):O>>1,O+=C(O/L);O>b*c>>1;me+=o)O=C(O/b);return C(me+(b+1)*O/(O+u))}function ht(O){var L=[],Z=O.length,me,we=0,ft=d,Be=l,zt,vr,kr,ii,Xe,Yt,gr,Ri,pn;for(zt=O.lastIndexOf(f),zt<0&&(zt=0),vr=0;vr<zt;++vr)O.charCodeAt(vr)>=128&&D("not-basic"),L.push(O.charCodeAt(vr));for(kr=zt>0?zt+1:0;kr<Z;){for(ii=we,Xe=1,Yt=o;kr>=Z&&D("invalid-input"),gr=qt(O.charCodeAt(kr++)),(gr>=o||gr>C((s-we)/Xe))&&D("overflow"),we+=gr*Xe,Ri=Yt<=Be?a:Yt>=Be+c?c:Yt-Be,!(gr<Ri);Yt+=o)pn=o-Ri,Xe>C(s/pn)&&D("overflow"),Xe*=pn;me=L.length+1,Be=Ie(we-ii,me,ii==0),C(we/me)>s-ft&&D("overflow"),ft+=C(we/me),we%=me,L.splice(we++,0,ft)}return le(L)}function dt(O){var L,Z,me,we,ft,Be,zt,vr,kr,ii,Xe,Yt=[],gr,Ri,pn,Hf;for(O=X(O),gr=O.length,L=d,Z=0,ft=l,Be=0;Be<gr;++Be)Xe=O[Be],Xe<128&&Yt.push(R(Xe));for(me=we=Yt.length,we&&Yt.push(f);me<gr;){for(zt=s,Be=0;Be<gr;++Be)Xe=O[Be],Xe>=L&&Xe<zt&&(zt=Xe);for(Ri=me+1,zt-L>C((s-Z)/Ri)&&D("overflow"),Z+=(zt-L)*Ri,L=zt,Be=0;Be<gr;++Be)if(Xe=O[Be],Xe<L&&++Z>s&&D("overflow"),Xe==L){for(vr=Z,kr=o;ii=kr<=ft?a:kr>=ft+c?c:kr-ft,!(vr<ii);kr+=o)Hf=vr-ii,pn=o-ii,Yt.push(R(Pt(ii+Hf%pn,0))),vr=C(Hf/pn);Yt.push(R(Pt(vr,0))),ft=Ie(Z,Ri,me==we),Z=0,++me}++Z,++L}return Yt.join("")}function Jt(O){return $(O,function(L){return g.test(L)?ht(L.slice(4).toLowerCase()):L})}function un(O){return $(O,function(L){return m.test(L)?"xn--"+dt(L):L})}if(n={version:"1.4.1",ucs2:{decode:X,encode:le},decode:ht,encode:dt,toASCII:un,toUnicode:Jt},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return n});else if(e&&t)if(Ns.exports==e)t.exports=n;else for(A in n)n.hasOwnProperty(A)&&(e[A]=n[A]);else r.punycode=n})(ks)});var pi=h((TV,HR)=>{"use strict";HR.exports=TypeError});var VR=h(()=>{"use strict"});var la=h((DV,l0)=>{"use strict";var Xg=typeof Map=="function"&&Map.prototype,Wg=Object.getOwnPropertyDescriptor&&Xg?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,cp=Xg&&Wg&&typeof Wg.get=="function"?Wg.get:null,$R=Xg&&Map.prototype.forEach,Zg=typeof Set=="function"&&Set.prototype,Hg=Object.getOwnPropertyDescriptor&&Zg?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,up=Zg&&Hg&&typeof Hg.get=="function"?Hg.get:null,KR=Zg&&Set.prototype.forEach,mj=typeof WeakMap=="function"&&WeakMap.prototype,ua=mj?WeakMap.prototype.has:null,yj=typeof WeakSet=="function"&&WeakSet.prototype,pa=yj?WeakSet.prototype.has:null,Sj=typeof WeakRef=="function"&&WeakRef.prototype,GR=Sj?WeakRef.prototype.deref:null,Cj=Boolean.prototype.valueOf,bj=Object.prototype.toString,Pj=Function.prototype.toString,wj=String.prototype.match,em=String.prototype.slice,zi=String.prototype.replace,_j=String.prototype.toUpperCase,JR=String.prototype.toLowerCase,n0=RegExp.prototype.test,YR=Array.prototype.concat,Ur=Array.prototype.join,Rj=Array.prototype.slice,QR=Math.floor,Kg=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Vg=Object.getOwnPropertySymbols,Gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,js=typeof Symbol=="function"&&typeof Symbol.iterator=="object",at=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===js||!0)?Symbol.toStringTag:null,s0=Object.prototype.propertyIsEnumerable,XR=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(r){return r.__proto__}:null);function ZR(r,e){if(r===1/0||r===-1/0||r!==r||r&&r>-1e3&&r<1e3||n0.call(/e/,e))return e;var t=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof r=="number"){var i=r<0?-QR(-r):QR(r);if(i!==r){var n=String(i),s=em.call(e,n.length+1);return zi.call(n,t,"$&_")+"."+zi.call(zi.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return zi.call(e,t,"$&_")}var Jg=VR(),e0=Jg.custom,t0=c0(e0)?e0:null,o0={__proto__:null,double:'"',single:"'"},Ej={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};l0.exports=function r(e,t,i,n){var s=t||{};if(li(s,"quoteStyle")&&!li(o0,s.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(li(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=li(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(li(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(li(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return p0(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var c=String(e);return a?ZR(e,c):c}if(typeof e=="bigint"){var u=String(e)+"n";return a?ZR(e,u):u}var p=typeof s.depth>"u"?5:s.depth;if(typeof i>"u"&&(i=0),i>=p&&p>0&&typeof e=="object")return Yg(e)?"[Array]":"[Object]";var l=Hj(s,i);if(typeof n>"u")n=[];else if(u0(n,e)>=0)return"[Circular]";function d(Ie,ht,dt){if(ht&&(n=Rj.call(n),n.push(ht)),dt){var Jt={depth:s.depth};return li(s,"quoteStyle")&&(Jt.quoteStyle=s.quoteStyle),r(Ie,Jt,i+1,n)}return r(Ie,s,i+1,n)}if(typeof e=="function"&&!r0(e)){var f=Nj(e),g=ap(e,d);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(g.length>0?" { "+Ur.call(g,", ")+" }":"")}if(c0(e)){var m=js?zi.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Gg.call(e);return typeof e=="object"&&!js?ca(m):m}if(Bj(e)){for(var y="<"+JR.call(String(e.nodeName)),w=e.attributes||[],b=0;b<w.length;b++)y+=" "+w[b].name+"="+a0(Ij(w[b].value),"double",s);return y+=">",e.childNodes&&e.childNodes.length&&(y+="..."),y+="</"+JR.call(String(e.nodeName))+">",y}if(Yg(e)){if(e.length===0)return"[]";var C=ap(e,d);return l&&!Wj(C)?"["+Qg(C,l)+"]":"[ "+Ur.call(C,", ")+" ]"}if(Aj(e)){var R=ap(e,d);return!("cause"in Error.prototype)&&"cause"in e&&!s0.call(e,"cause")?"{ ["+String(e)+"] "+Ur.call(YR.call("[cause]: "+d(e.cause),R),", ")+" }":R.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Ur.call(R,", ")+" }"}if(typeof e=="object"&&o){if(t0&&typeof e[t0]=="function"&&Jg)return Jg(e,{depth:p-i});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(jj(e)){var A=[];return $R&&$R.call(e,function(Ie,ht){A.push(d(ht,e,!0)+" => "+d(Ie,e))}),i0("Map",cp.call(e),A,l)}if(zj(e)){var D=[];return KR&&KR.call(e,function(Ie){D.push(d(Ie,e))}),i0("Set",up.call(e),D,l)}if(Lj(e))return $g("WeakMap");if(Fj(e))return $g("WeakSet");if(qj(e))return $g("WeakRef");if(Dj(e))return ca(d(Number(e)));if(Mj(e))return ca(d(Kg.call(e)));if(xj(e))return ca(Cj.call(e));if(Oj(e))return ca(d(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof global<"u"&&e===global)return"{ [object globalThis] }";if(!Tj(e)&&!r0(e)){var ee=ap(e,d),$=XR?XR(e)===Object.prototype:e instanceof Object||e.constructor===Object,X=e instanceof Object?"":"null prototype",le=!$&&at&&Object(e)===e&&at in e?em.call(Fi(e),8,-1):X?"Object":"",qt=$||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",Pt=qt+(le||X?"["+Ur.call(YR.call([],le||[],X||[]),": ")+"] ":"");return ee.length===0?Pt+"{}":l?Pt+"{"+Qg(ee,l)+"}":Pt+"{ "+Ur.call(ee,", ")+" }"}return String(e)};function a0(r,e,t){var i=t.quoteStyle||e,n=o0[i];return n+r+n}function Ij(r){return zi.call(String(r),/"/g,"&quot;")}function Yg(r){return Fi(r)==="[object Array]"&&(!at||!(typeof r=="object"&&at in r))}function Tj(r){return Fi(r)==="[object Date]"&&(!at||!(typeof r=="object"&&at in r))}function r0(r){return Fi(r)==="[object RegExp]"&&(!at||!(typeof r=="object"&&at in r))}function Aj(r){return Fi(r)==="[object Error]"&&(!at||!(typeof r=="object"&&at in r))}function Oj(r){return Fi(r)==="[object String]"&&(!at||!(typeof r=="object"&&at in r))}function Dj(r){return Fi(r)==="[object Number]"&&(!at||!(typeof r=="object"&&at in r))}function xj(r){return Fi(r)==="[object Boolean]"&&(!at||!(typeof r=="object"&&at in r))}function c0(r){if(js)return r&&typeof r=="object"&&r instanceof Symbol;if(typeof r=="symbol")return!0;if(!r||typeof r!="object"||!Gg)return!1;try{return Gg.call(r),!0}catch{}return!1}function Mj(r){if(!r||typeof r!="object"||!Kg)return!1;try{return Kg.call(r),!0}catch{}return!1}var kj=Object.prototype.hasOwnProperty||function(r){return r in this};function li(r,e){return kj.call(r,e)}function Fi(r){return bj.call(r)}function Nj(r){if(r.name)return r.name;var e=wj.call(Pj.call(r),/^function\s*([\w$]+)/);return e?e[1]:null}function u0(r,e){if(r.indexOf)return r.indexOf(e);for(var t=0,i=r.length;t<i;t++)if(r[t]===e)return t;return-1}function jj(r){if(!cp||!r||typeof r!="object")return!1;try{cp.call(r);try{up.call(r)}catch{return!0}return r instanceof Map}catch{}return!1}function Lj(r){if(!ua||!r||typeof r!="object")return!1;try{ua.call(r,ua);try{pa.call(r,pa)}catch{return!0}return r instanceof WeakMap}catch{}return!1}function qj(r){if(!GR||!r||typeof r!="object")return!1;try{return GR.call(r),!0}catch{}return!1}function zj(r){if(!up||!r||typeof r!="object")return!1;try{up.call(r);try{cp.call(r)}catch{return!0}return r instanceof Set}catch{}return!1}function Fj(r){if(!pa||!r||typeof r!="object")return!1;try{pa.call(r,pa);try{ua.call(r,ua)}catch{return!0}return r instanceof WeakSet}catch{}return!1}function Bj(r){return!r||typeof r!="object"?!1:typeof HTMLElement<"u"&&r instanceof HTMLElement?!0:typeof r.nodeName=="string"&&typeof r.getAttribute=="function"}function p0(r,e){if(r.length>e.maxStringLength){var t=r.length-e.maxStringLength,i="... "+t+" more character"+(t>1?"s":"");return p0(em.call(r,0,e.maxStringLength),e)+i}var n=Ej[e.quoteStyle||"single"];n.lastIndex=0;var s=zi.call(zi.call(r,n,"\\$1"),/[\x00-\x1f]/g,Uj);return a0(s,"single",e)}function Uj(r){var e=r.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+_j.call(e.toString(16))}function ca(r){return"Object("+r+")"}function $g(r){return r+" { ? }"}function i0(r,e,t,i){var n=i?Qg(t,i):Ur.call(t,", ");return r+" ("+e+") {"+n+"}"}function Wj(r){for(var e=0;e<r.length;e++)if(u0(r[e],`
`)>=0)return!1;return!0}function Hj(r,e){var t;if(r.indent==="	")t="	";else if(typeof r.indent=="number"&&r.indent>0)t=Ur.call(Array(r.indent+1)," ");else return null;return{base:t,prev:Ur.call(Array(e+1),t)}}function Qg(r,e){if(r.length===0)return"";var t=`
`+e.prev+e.base;return t+Ur.call(r,","+t)+`
`+e.prev}function ap(r,e){var t=Yg(r),i=[];if(t){i.length=r.length;for(var n=0;n<r.length;n++)i[n]=li(r,n)?e(r[n],r):""}var s=typeof Vg=="function"?Vg(r):[],o;if(js){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var c in r)li(r,c)&&(t&&String(Number(c))===c&&c<r.length||js&&o["$"+c]instanceof Symbol||(n0.call(/[^\w$]/,c)?i.push(e(c,r)+": "+e(r[c],r)):i.push(c+": "+e(r[c],r))));if(typeof Vg=="function")for(var u=0;u<s.length;u++)s0.call(r,s[u])&&i.push("["+e(s[u])+"]: "+e(r[s[u]],r));return i}});var d0=h((xV,h0)=>{"use strict";var Vj=la(),$j=pi(),pp=function(r,e,t){for(var i=r,n;(n=i.next)!=null;i=n)if(n.key===e)return i.next=n.next,t||(n.next=r.next,r.next=n),n},Kj=function(r,e){if(r){var t=pp(r,e);return t&&t.value}},Gj=function(r,e,t){var i=pp(r,e);i?i.value=t:r.next={key:e,next:r.next,value:t}},Jj=function(r,e){return r?!!pp(r,e):!1},Yj=function(r,e){if(r)return pp(r,e,!0)};h0.exports=function(){var e,t={assert:function(i){if(!t.has(i))throw new $j("Side channel does not contain "+Vj(i))},delete:function(i){var n=e&&e.next,s=Yj(e,i);return s&&n&&n===s&&(e=void 0),!!s},get:function(i){return Kj(e,i)},has:function(i){return Jj(e,i)},set:function(i,n){e||(e={next:void 0}),Gj(e,i,n)}};return t}});var v0=h((MV,f0)=>{"use strict";f0.exports=Object});var m0=h((kV,g0)=>{"use strict";g0.exports=Error});var S0=h((NV,y0)=>{"use strict";y0.exports=EvalError});var b0=h((jV,C0)=>{"use strict";C0.exports=RangeError});var w0=h((LV,P0)=>{"use strict";P0.exports=ReferenceError});var tm=h((qV,_0)=>{"use strict";_0.exports=SyntaxError});var E0=h((zV,R0)=>{"use strict";R0.exports=URIError});var T0=h((FV,I0)=>{"use strict";I0.exports=Math.abs});var O0=h((BV,A0)=>{"use strict";A0.exports=Math.floor});var x0=h((UV,D0)=>{"use strict";D0.exports=Math.max});var k0=h((WV,M0)=>{"use strict";M0.exports=Math.min});var j0=h((HV,N0)=>{"use strict";N0.exports=Math.pow});var q0=h((VV,L0)=>{"use strict";L0.exports=Object.getOwnPropertyDescriptor});var Ls=h(($V,z0)=>{"use strict";var lp=q0();if(lp)try{lp([],"length")}catch{lp=null}z0.exports=lp});var ha=h((KV,F0)=>{"use strict";var hp=Object.defineProperty||!1;if(hp)try{hp({},"a",{value:1})}catch{hp=!1}F0.exports=hp});var dp=h((GV,B0)=>{"use strict";B0.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),i=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var n=42;e[t]=n;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,t);if(a.value!==n||a.enumerable!==!0)return!1}return!0}});var H0=h((JV,W0)=>{"use strict";var U0=typeof Symbol<"u"&&Symbol,Qj=dp();W0.exports=function(){return typeof U0!="function"||typeof Symbol!="function"||typeof U0("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Qj()}});var K0=h((YV,$0)=>{"use strict";var Xj="Function.prototype.bind called on incompatible ",Zj=Object.prototype.toString,eL=Math.max,tL="[object Function]",V0=function(e,t){for(var i=[],n=0;n<e.length;n+=1)i[n]=e[n];for(var s=0;s<t.length;s+=1)i[s+e.length]=t[s];return i},rL=function(e,t){for(var i=[],n=t||0,s=0;n<e.length;n+=1,s+=1)i[s]=e[n];return i},iL=function(r,e){for(var t="",i=0;i<r.length;i+=1)t+=r[i],i+1<r.length&&(t+=e);return t};$0.exports=function(e){var t=this;if(typeof t!="function"||Zj.apply(t)!==tL)throw new TypeError(Xj+t);for(var i=rL(arguments,1),n,s=function(){if(this instanceof n){var p=t.apply(this,V0(i,arguments));return Object(p)===p?p:this}return t.apply(e,V0(i,arguments))},o=eL(0,t.length-i.length),a=[],c=0;c<o;c++)a[c]="$"+c;if(n=Function("binder","return function ("+iL(a,",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n}});var qs=h((QV,G0)=>{"use strict";var nL=K0();G0.exports=Function.prototype.bind||nL});var fp=h((XV,J0)=>{"use strict";J0.exports=Function.prototype.call});var vp=h((ZV,Y0)=>{"use strict";Y0.exports=Function.prototype.apply});var X0=h((e9,Q0)=>{"use strict";Q0.exports=typeof Reflect<"u"&&Reflect&&Reflect.apply});var rm=h((t9,Z0)=>{"use strict";var sL=qs(),oL=vp(),aL=fp(),cL=X0();Z0.exports=cL||sL.call(aL,oL)});var gp=h((r9,eE)=>{"use strict";var uL=qs(),pL=pi(),lL=fp(),hL=rm();eE.exports=function(e){if(e.length<1||typeof e[0]!="function")throw new pL("a function is required");return hL(uL,lL,e)}});var oE=h((i9,sE)=>{"use strict";var dL=gp(),tE=Ls(),iE;try{iE=[].__proto__===Array.prototype}catch(r){if(!r||typeof r!="object"||!("code"in r)||r.code!=="ERR_PROTO_ACCESS")throw r}var im=!!iE&&tE&&tE(Object.prototype,"__proto__"),nE=Object,rE=nE.getPrototypeOf;sE.exports=im&&typeof im.get=="function"?dL([im.get]):typeof rE=="function"?function(e){return rE(e==null?e:nE(e))}:!1});var cE=h((n9,aE)=>{"use strict";var fL=Function.prototype.call,vL=Object.prototype.hasOwnProperty,gL=qs();aE.exports=gL.call(fL,vL)});var Ws=h((s9,vE)=>{"use strict";var Y,hE=v0(),mL=m0(),yL=S0(),SL=b0(),CL=w0(),Us=tm(),Bs=pi(),bL=E0(),PL=T0(),wL=O0(),_L=x0(),RL=k0(),EL=j0(),dE=Function,nm=function(r){try{return dE('"use strict"; return ('+r+").constructor;")()}catch{}},da=Ls(),IL=ha(),sm=function(){throw new Bs},TL=da?function(){try{return arguments.callee,sm}catch{try{return da(arguments,"callee").get}catch{return sm}}}():sm,zs=H0()(),AL=oE(),qe=typeof Reflect=="function"&&Reflect.getPrototypeOf||hE.getPrototypeOf||AL,fE=vp(),fa=fp(),Fs={},OL=typeof Uint8Array>"u"||!qe?Y:qe(Uint8Array),Rn={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Y:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Y:ArrayBuffer,"%ArrayIteratorPrototype%":zs&&qe?qe([][Symbol.iterator]()):Y,"%AsyncFromSyncIteratorPrototype%":Y,"%AsyncFunction%":Fs,"%AsyncGenerator%":Fs,"%AsyncGeneratorFunction%":Fs,"%AsyncIteratorPrototype%":Fs,"%Atomics%":typeof Atomics>"u"?Y:Atomics,"%BigInt%":typeof BigInt>"u"?Y:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Y:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Y:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Y:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":mL,"%eval%":eval,"%EvalError%":yL,"%Float32Array%":typeof Float32Array>"u"?Y:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Y:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Y:FinalizationRegistry,"%Function%":dE,"%GeneratorFunction%":Fs,"%Int8Array%":typeof Int8Array>"u"?Y:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Y:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Y:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":zs&&qe?qe(qe([][Symbol.iterator]())):Y,"%JSON%":typeof JSON=="object"?JSON:Y,"%Map%":typeof Map>"u"?Y:Map,"%MapIteratorPrototype%":typeof Map>"u"||!zs||!qe?Y:qe(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":hE,"%Object.getOwnPropertyDescriptor%":da,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Y:Promise,"%Proxy%":typeof Proxy>"u"?Y:Proxy,"%RangeError%":SL,"%ReferenceError%":CL,"%Reflect%":typeof Reflect>"u"?Y:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Y:Set,"%SetIteratorPrototype%":typeof Set>"u"||!zs||!qe?Y:qe(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Y:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":zs&&qe?qe(""[Symbol.iterator]()):Y,"%Symbol%":zs?Symbol:Y,"%SyntaxError%":Us,"%ThrowTypeError%":TL,"%TypedArray%":OL,"%TypeError%":Bs,"%Uint8Array%":typeof Uint8Array>"u"?Y:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Y:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Y:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Y:Uint32Array,"%URIError%":bL,"%WeakMap%":typeof WeakMap>"u"?Y:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Y:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Y:WeakSet,"%Function.prototype.call%":fa,"%Function.prototype.apply%":fE,"%Object.defineProperty%":IL,"%Math.abs%":PL,"%Math.floor%":wL,"%Math.max%":_L,"%Math.min%":RL,"%Math.pow%":EL};if(qe)try{null.error}catch(r){uE=qe(qe(r)),Rn["%Error.prototype%"]=uE}var uE,DL=function r(e){var t;if(e==="%AsyncFunction%")t=nm("async function () {}");else if(e==="%GeneratorFunction%")t=nm("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=nm("async function* () {}");else if(e==="%AsyncGenerator%"){var i=r("%AsyncGeneratorFunction%");i&&(t=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var n=r("%AsyncGenerator%");n&&qe&&(t=qe(n.prototype))}return Rn[e]=t,t},pE={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},va=qs(),mp=cE(),xL=va.call(fa,Array.prototype.concat),ML=va.call(fE,Array.prototype.splice),lE=va.call(fa,String.prototype.replace),yp=va.call(fa,String.prototype.slice),kL=va.call(fa,RegExp.prototype.exec),NL=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,jL=/\\(\\)?/g,LL=function(e){var t=yp(e,0,1),i=yp(e,-1);if(t==="%"&&i!=="%")throw new Us("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&t!=="%")throw new Us("invalid intrinsic syntax, expected opening `%`");var n=[];return lE(e,NL,function(s,o,a,c){n[n.length]=a?lE(c,jL,"$1"):o||s}),n},qL=function(e,t){var i=e,n;if(mp(pE,i)&&(n=pE[i],i="%"+n[0]+"%"),mp(Rn,i)){var s=Rn[i];if(s===Fs&&(s=DL(i)),typeof s>"u"&&!t)throw new Bs("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:s}}throw new Us("intrinsic "+e+" does not exist!")};vE.exports=function(e,t){if(typeof e!="string"||e.length===0)throw new Bs("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new Bs('"allowMissing" argument must be a boolean');if(kL(/^%?[^%]*%?$/,e)===null)throw new Us("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=LL(e),n=i.length>0?i[0]:"",s=qL("%"+n+"%",t),o=s.name,a=s.value,c=!1,u=s.alias;u&&(n=u[0],ML(i,xL([0,1],u)));for(var p=1,l=!0;p<i.length;p+=1){var d=i[p],f=yp(d,0,1),g=yp(d,-1);if((f==='"'||f==="'"||f==="`"||g==='"'||g==="'"||g==="`")&&f!==g)throw new Us("property names with quotes must have matching quotes");if((d==="constructor"||!l)&&(c=!0),n+="."+d,o="%"+n+"%",mp(Rn,o))a=Rn[o];else if(a!=null){if(!(d in a)){if(!t)throw new Bs("base intrinsic for "+e+" exists, but the property is not available.");return}if(da&&p+1>=i.length){var m=da(a,d);l=!!m,l&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[d]}else l=mp(a,d),a=a[d];l&&!c&&(Rn[o]=a)}}return a}});var om=h((o9,yE)=>{"use strict";var gE=Ws(),mE=gp(),zL=mE([gE("%String.prototype.indexOf%")]);yE.exports=function(e,t){var i=gE(e,!!t);return typeof i=="function"&&zL(e,".prototype.")>-1?mE([i]):i}});var am=h((a9,CE)=>{"use strict";var FL=Ws(),ga=om(),BL=la(),UL=pi(),SE=FL("%Map%",!0),WL=ga("Map.prototype.get",!0),HL=ga("Map.prototype.set",!0),VL=ga("Map.prototype.has",!0),$L=ga("Map.prototype.delete",!0),KL=ga("Map.prototype.size",!0);CE.exports=!!SE&&function(){var e,t={assert:function(i){if(!t.has(i))throw new UL("Side channel does not contain "+BL(i))},delete:function(i){if(e){var n=$L(e,i);return KL(e)===0&&(e=void 0),n}return!1},get:function(i){if(e)return WL(e,i)},has:function(i){return e?VL(e,i):!1},set:function(i,n){e||(e=new SE),HL(e,i,n)}};return t}});var PE=h((c9,bE)=>{"use strict";var GL=Ws(),Cp=om(),JL=la(),Sp=am(),YL=pi(),Hs=GL("%WeakMap%",!0),QL=Cp("WeakMap.prototype.get",!0),XL=Cp("WeakMap.prototype.set",!0),ZL=Cp("WeakMap.prototype.has",!0),eq=Cp("WeakMap.prototype.delete",!0);bE.exports=Hs?function(){var e,t,i={assert:function(n){if(!i.has(n))throw new YL("Side channel does not contain "+JL(n))},delete:function(n){if(Hs&&n&&(typeof n=="object"||typeof n=="function")){if(e)return eq(e,n)}else if(Sp&&t)return t.delete(n);return!1},get:function(n){return Hs&&n&&(typeof n=="object"||typeof n=="function")&&e?QL(e,n):t&&t.get(n)},has:function(n){return Hs&&n&&(typeof n=="object"||typeof n=="function")&&e?ZL(e,n):!!t&&t.has(n)},set:function(n,s){Hs&&n&&(typeof n=="object"||typeof n=="function")?(e||(e=new Hs),XL(e,n,s)):Sp&&(t||(t=Sp()),t.set(n,s))}};return i}:Sp});var _E=h((u9,wE)=>{"use strict";var tq=pi(),rq=la(),iq=d0(),nq=am(),sq=PE(),oq=sq||nq||iq;wE.exports=function(){var e,t={assert:function(i){if(!t.has(i))throw new tq("Side channel does not contain "+rq(i))},delete:function(i){return!!e&&e.delete(i)},get:function(i){return e&&e.get(i)},has:function(i){return!!e&&e.has(i)},set:function(i,n){e||(e=oq()),e.set(i,n)}};return t}});var bp=h((p9,RE)=>{"use strict";var aq=String.prototype.replace,cq=/%20/g,cm={RFC1738:"RFC1738",RFC3986:"RFC3986"};RE.exports={default:cm.RFC3986,formatters:{RFC1738:function(r){return aq.call(r,cq,"+")},RFC3986:function(r){return String(r)}},RFC1738:cm.RFC1738,RFC3986:cm.RFC3986}});var lm=h((l9,IE)=>{"use strict";var uq=bp(),um=Object.prototype.hasOwnProperty,En=Array.isArray,Wr=function(){for(var r=[],e=0;e<256;++e)r.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return r}(),pq=function(e){for(;e.length>1;){var t=e.pop(),i=t.obj[t.prop];if(En(i)){for(var n=[],s=0;s<i.length;++s)typeof i[s]<"u"&&n.push(i[s]);t.obj[t.prop]=n}}},EE=function(e,t){for(var i=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)typeof e[n]<"u"&&(i[n]=e[n]);return i},lq=function r(e,t,i){if(!t)return e;if(typeof t!="object"){if(En(e))e.push(t);else if(e&&typeof e=="object")(i&&(i.plainObjects||i.allowPrototypes)||!um.call(Object.prototype,t))&&(e[t]=!0);else return[e,t];return e}if(!e||typeof e!="object")return[e].concat(t);var n=e;return En(e)&&!En(t)&&(n=EE(e,i)),En(e)&&En(t)?(t.forEach(function(s,o){if(um.call(e,o)){var a=e[o];a&&typeof a=="object"&&s&&typeof s=="object"?e[o]=r(a,s,i):e.push(s)}else e[o]=s}),e):Object.keys(t).reduce(function(s,o){var a=t[o];return um.call(s,o)?s[o]=r(s[o],a,i):s[o]=a,s},n)},hq=function(e,t){return Object.keys(t).reduce(function(i,n){return i[n]=t[n],i},e)},dq=function(r,e,t){var i=r.replace(/\+/g," ");if(t==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},pm=1024,fq=function(e,t,i,n,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),i==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(f){return"%26%23"+parseInt(f.slice(2),16)+"%3B"});for(var a="",c=0;c<o.length;c+=pm){for(var u=o.length>=pm?o.slice(c,c+pm):o,p=[],l=0;l<u.length;++l){var d=u.charCodeAt(l);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||s===uq.RFC1738&&(d===40||d===41)){p[p.length]=u.charAt(l);continue}if(d<128){p[p.length]=Wr[d];continue}if(d<2048){p[p.length]=Wr[192|d>>6]+Wr[128|d&63];continue}if(d<55296||d>=57344){p[p.length]=Wr[224|d>>12]+Wr[128|d>>6&63]+Wr[128|d&63];continue}l+=1,d=65536+((d&1023)<<10|u.charCodeAt(l)&1023),p[p.length]=Wr[240|d>>18]+Wr[128|d>>12&63]+Wr[128|d>>6&63]+Wr[128|d&63]}a+=p.join("")}return a},vq=function(e){for(var t=[{obj:{o:e},prop:"o"}],i=[],n=0;n<t.length;++n)for(var s=t[n],o=s.obj[s.prop],a=Object.keys(o),c=0;c<a.length;++c){var u=a[c],p=o[u];typeof p=="object"&&p!==null&&i.indexOf(p)===-1&&(t.push({obj:o,prop:u}),i.push(p))}return pq(t),e},gq=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},mq=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},yq=function(e,t){return[].concat(e,t)},Sq=function(e,t){if(En(e)){for(var i=[],n=0;n<e.length;n+=1)i.push(t(e[n]));return i}return t(e)};IE.exports={arrayToObject:EE,assign:hq,combine:yq,compact:vq,decode:dq,encode:fq,isBuffer:mq,isRegExp:gq,maybeMap:Sq,merge:lq}});var ME=h((h9,xE)=>{"use strict";var AE=_E(),Pp=lm(),ma=bp(),Cq=Object.prototype.hasOwnProperty,OE={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},Hr=Array.isArray,bq=Array.prototype.push,DE=function(r,e){bq.apply(r,Hr(e)?e:[e])},Pq=Date.prototype.toISOString,TE=ma.default,je={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Pp.encode,encodeValuesOnly:!1,format:TE,formatter:ma.formatters[TE],indices:!1,serializeDate:function(e){return Pq.call(e)},skipNulls:!1,strictNullHandling:!1},wq=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},hm={},_q=function r(e,t,i,n,s,o,a,c,u,p,l,d,f,g,m,y,w,b){for(var C=e,R=b,A=0,D=!1;(R=R.get(hm))!==void 0&&!D;){var ee=R.get(e);if(A+=1,typeof ee<"u"){if(ee===A)throw new RangeError("Cyclic object value");D=!0}typeof R.get(hm)>"u"&&(A=0)}if(typeof p=="function"?C=p(t,C):C instanceof Date?C=f(C):i==="comma"&&Hr(C)&&(C=Pp.maybeMap(C,function(Z){return Z instanceof Date?f(Z):Z})),C===null){if(o)return u&&!y?u(t,je.encoder,w,"key",g):t;C=""}if(wq(C)||Pp.isBuffer(C)){if(u){var $=y?t:u(t,je.encoder,w,"key",g);return[m($)+"="+m(u(C,je.encoder,w,"value",g))]}return[m(t)+"="+m(String(C))]}var X=[];if(typeof C>"u")return X;var le;if(i==="comma"&&Hr(C))y&&u&&(C=Pp.maybeMap(C,u)),le=[{value:C.length>0?C.join(",")||null:void 0}];else if(Hr(p))le=p;else{var qt=Object.keys(C);le=l?qt.sort(l):qt}var Pt=c?t.replace(/\./g,"%2E"):t,Ie=n&&Hr(C)&&C.length===1?Pt+"[]":Pt;if(s&&Hr(C)&&C.length===0)return Ie+"[]";for(var ht=0;ht<le.length;++ht){var dt=le[ht],Jt=typeof dt=="object"&&typeof dt.value<"u"?dt.value:C[dt];if(!(a&&Jt===null)){var un=d&&c?dt.replace(/\./g,"%2E"):dt,O=Hr(C)?typeof i=="function"?i(Ie,un):Ie:Ie+(d?"."+un:"["+un+"]");b.set(e,A);var L=AE();L.set(hm,b),DE(X,r(Jt,O,i,n,s,o,a,c,i==="comma"&&y&&Hr(C)?null:u,p,l,d,f,g,m,y,w,L))}}return X},Rq=function(e){if(!e)return je;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var t=e.charset||je.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=ma.default;if(typeof e.format<"u"){if(!Cq.call(ma.formatters,e.format))throw new TypeError("Unknown format option provided.");i=e.format}var n=ma.formatters[i],s=je.filter;(typeof e.filter=="function"||Hr(e.filter))&&(s=e.filter);var o;if(e.arrayFormat in OE?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=je.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:je.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:je.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:je.allowEmptyArrays,arrayFormat:o,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:je.charsetSentinel,commaRoundTrip:e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?je.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:je.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:je.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:je.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:je.encodeValuesOnly,filter:s,format:i,formatter:n,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:je.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:je.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:je.strictNullHandling}};xE.exports=function(r,e){var t=r,i=Rq(e),n,s;typeof i.filter=="function"?(s=i.filter,t=s("",t)):Hr(i.filter)&&(s=i.filter,n=s);var o=[];if(typeof t!="object"||t===null)return"";var a=OE[i.arrayFormat],c=a==="comma"&&i.commaRoundTrip;n||(n=Object.keys(t)),i.sort&&n.sort(i.sort);for(var u=AE(),p=0;p<n.length;++p){var l=n[p];i.skipNulls&&t[l]===null||DE(o,_q(t[l],l,a,c,i.allowEmptyArrays,i.strictNullHandling,i.skipNulls,i.encodeDotInKeys,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,u))}var d=o.join(i.delimiter),f=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),d.length>0?f+d:""}});var jE=h((d9,NE)=>{"use strict";var Vs=lm(),dm=Object.prototype.hasOwnProperty,Eq=Array.isArray,Pe={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:Vs.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1},Iq=function(r){return r.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},kE=function(r,e){return r&&typeof r=="string"&&e.comma&&r.indexOf(",")>-1?r.split(","):r},Tq="utf8=%26%2310003%3B",Aq="utf8=%E2%9C%93",Oq=function(e,t){var i={__proto__:null},n=t.ignoreQueryPrefix?e.replace(/^\?/,""):e;n=n.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var s=t.parameterLimit===1/0?void 0:t.parameterLimit,o=n.split(t.delimiter,s),a=-1,c,u=t.charset;if(t.charsetSentinel)for(c=0;c<o.length;++c)o[c].indexOf("utf8=")===0&&(o[c]===Aq?u="utf-8":o[c]===Tq&&(u="iso-8859-1"),a=c,c=o.length);for(c=0;c<o.length;++c)if(c!==a){var p=o[c],l=p.indexOf("]="),d=l===-1?p.indexOf("="):l+1,f,g;d===-1?(f=t.decoder(p,Pe.decoder,u,"key"),g=t.strictNullHandling?null:""):(f=t.decoder(p.slice(0,d),Pe.decoder,u,"key"),g=Vs.maybeMap(kE(p.slice(d+1),t),function(y){return t.decoder(y,Pe.decoder,u,"value")})),g&&t.interpretNumericEntities&&u==="iso-8859-1"&&(g=Iq(g)),p.indexOf("[]=")>-1&&(g=Eq(g)?[g]:g);var m=dm.call(i,f);m&&t.duplicates==="combine"?i[f]=Vs.combine(i[f],g):(!m||t.duplicates==="last")&&(i[f]=g)}return i},Dq=function(r,e,t,i){for(var n=i?e:kE(e,t),s=r.length-1;s>=0;--s){var o,a=r[s];if(a==="[]"&&t.parseArrays)o=t.allowEmptyArrays&&(n===""||t.strictNullHandling&&n===null)?[]:[].concat(n);else{o=t.plainObjects?Object.create(null):{};var c=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,u=t.decodeDotInKeys?c.replace(/%2E/g,"."):c,p=parseInt(u,10);!t.parseArrays&&u===""?o={0:n}:!isNaN(p)&&a!==u&&String(p)===u&&p>=0&&t.parseArrays&&p<=t.arrayLimit?(o=[],o[p]=n):u!=="__proto__"&&(o[u]=n)}n=o}return n},xq=function(e,t,i,n){if(e){var s=i.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,c=i.depth>0&&o.exec(s),u=c?s.slice(0,c.index):s,p=[];if(u){if(!i.plainObjects&&dm.call(Object.prototype,u)&&!i.allowPrototypes)return;p.push(u)}for(var l=0;i.depth>0&&(c=a.exec(s))!==null&&l<i.depth;){if(l+=1,!i.plainObjects&&dm.call(Object.prototype,c[1].slice(1,-1))&&!i.allowPrototypes)return;p.push(c[1])}if(c){if(i.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+i.depth+" and strictDepth is true");p.push("["+s.slice(c.index)+"]")}return Dq(p,t,i,n)}},Mq=function(e){if(!e)return Pe;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=typeof e.charset>"u"?Pe.charset:e.charset,i=typeof e.duplicates>"u"?Pe.duplicates:e.duplicates;if(i!=="combine"&&i!=="first"&&i!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var n=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:Pe.allowDots:!!e.allowDots;return{allowDots:n,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Pe.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:Pe.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:Pe.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:Pe.arrayLimit,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Pe.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:Pe.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:Pe.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:Pe.decoder,delimiter:typeof e.delimiter=="string"||Vs.isRegExp(e.delimiter)?e.delimiter:Pe.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:Pe.depth,duplicates:i,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:Pe.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:Pe.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:Pe.plainObjects,strictDepth:typeof e.strictDepth=="boolean"?!!e.strictDepth:Pe.strictDepth,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Pe.strictNullHandling}};NE.exports=function(r,e){var t=Mq(e);if(r===""||r===null||typeof r>"u")return t.plainObjects?Object.create(null):{};for(var i=typeof r=="string"?Oq(r,t):r,n=t.plainObjects?Object.create(null):{},s=Object.keys(i),o=0;o<s.length;++o){var a=s[o],c=xq(a,i[a],t,typeof r=="string");n=Vs.merge(n,c,t)}return t.allowSparse===!0?n:Vs.compact(n)}});var qE=h((f9,LE)=>{"use strict";var kq=ME(),Nq=jE(),jq=bp();LE.exports={formats:jq,parse:Nq,stringify:kq}});var UE=h(Ks=>{"use strict";var Lq=WR();function er(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var qq=/^([a-z0-9.+-]+:)/i,zq=/:[0-9]*$/,Fq=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,Bq=["<",">",'"',"`"," ","\r",`
`,"	"],Uq=["{","}","|","\\","^","`"].concat(Bq),fm=["'"].concat(Uq),zE=["%","/","?",";","#"].concat(fm),FE=["/","?","#"],Wq=255,BE=/^[+a-z0-9A-Z_-]{0,63}$/,Hq=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Vq={javascript:!0,"javascript:":!0},vm={javascript:!0,"javascript:":!0},$s={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},gm=qE();function ya(r,e,t){if(r&&typeof r=="object"&&r instanceof er)return r;var i=new er;return i.parse(r,e,t),i}er.prototype.parse=function(r,e,t){if(typeof r!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof r);var i=r.indexOf("?"),n=i!==-1&&i<r.indexOf("#")?"?":"#",s=r.split(n),o=/\\/g;s[0]=s[0].replace(o,"/"),r=s.join(n);var a=r;if(a=a.trim(),!t&&r.split("#").length===1){var c=Fq.exec(a);if(c)return this.path=a,this.href=a,this.pathname=c[1],c[2]?(this.search=c[2],e?this.query=gm.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var u=qq.exec(a);if(u){u=u[0];var p=u.toLowerCase();this.protocol=p,a=a.substr(u.length)}if(t||u||a.match(/^\/\/[^@/]+@[^@/]+/)){var l=a.substr(0,2)==="//";l&&!(u&&vm[u])&&(a=a.substr(2),this.slashes=!0)}if(!vm[u]&&(l||u&&!$s[u])){for(var d=-1,f=0;f<FE.length;f++){var g=a.indexOf(FE[f]);g!==-1&&(d===-1||g<d)&&(d=g)}var m,y;d===-1?y=a.lastIndexOf("@"):y=a.lastIndexOf("@",d),y!==-1&&(m=a.slice(0,y),a=a.slice(y+1),this.auth=decodeURIComponent(m)),d=-1;for(var f=0;f<zE.length;f++){var g=a.indexOf(zE[f]);g!==-1&&(d===-1||g<d)&&(d=g)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var w=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!w)for(var b=this.hostname.split(/\./),f=0,C=b.length;f<C;f++){var R=b[f];if(R&&!R.match(BE)){for(var A="",D=0,ee=R.length;D<ee;D++)R.charCodeAt(D)>127?A+="x":A+=R[D];if(!A.match(BE)){var $=b.slice(0,f),X=b.slice(f+1),le=R.match(Hq);le&&($.push(le[1]),X.unshift(le[2])),X.length&&(a="/"+X.join(".")+a),this.hostname=$.join(".");break}}}this.hostname.length>Wq?this.hostname="":this.hostname=this.hostname.toLowerCase(),w||(this.hostname=Lq.toASCII(this.hostname));var qt=this.port?":"+this.port:"",Pt=this.hostname||"";this.host=Pt+qt,this.href+=this.host,w&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!Vq[p])for(var f=0,C=fm.length;f<C;f++){var Ie=fm[f];if(a.indexOf(Ie)!==-1){var ht=encodeURIComponent(Ie);ht===Ie&&(ht=escape(Ie)),a=a.split(Ie).join(ht)}}var dt=a.indexOf("#");dt!==-1&&(this.hash=a.substr(dt),a=a.slice(0,dt));var Jt=a.indexOf("?");if(Jt!==-1?(this.search=a.substr(Jt),this.query=a.substr(Jt+1),e&&(this.query=gm.parse(this.query)),a=a.slice(0,Jt)):e&&(this.search="",this.query={}),a&&(this.pathname=a),$s[p]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var qt=this.pathname||"",un=this.search||"";this.path=qt+un}return this.href=this.format(),this};function $q(r){return typeof r=="string"&&(r=ya(r)),r instanceof er?r.format():er.prototype.format.call(r)}er.prototype.format=function(){var r=this.auth||"";r&&(r=encodeURIComponent(r),r=r.replace(/%3A/i,":"),r+="@");var e=this.protocol||"",t=this.pathname||"",i=this.hash||"",n=!1,s="";this.host?n=r+this.host:this.hostname&&(n=r+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=gm.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||$s[e])&&n!==!1?(n="//"+(n||""),t&&t.charAt(0)!=="/"&&(t="/"+t)):n||(n=""),i&&i.charAt(0)!=="#"&&(i="#"+i),o&&o.charAt(0)!=="?"&&(o="?"+o),t=t.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+n+t+o+i};function Kq(r,e){return ya(r,!1,!0).resolve(e)}er.prototype.resolve=function(r){return this.resolveObject(ya(r,!1,!0)).format()};function Gq(r,e){return r?ya(r,!1,!0).resolveObject(e):e}er.prototype.resolveObject=function(r){if(typeof r=="string"){var e=new er;e.parse(r,!1,!0),r=e}for(var t=new er,i=Object.keys(this),n=0;n<i.length;n++){var s=i[n];t[s]=this[s]}if(t.hash=r.hash,r.href==="")return t.href=t.format(),t;if(r.slashes&&!r.protocol){for(var o=Object.keys(r),a=0;a<o.length;a++){var c=o[a];c!=="protocol"&&(t[c]=r[c])}return $s[t.protocol]&&t.hostname&&!t.pathname&&(t.pathname="/",t.path=t.pathname),t.href=t.format(),t}if(r.protocol&&r.protocol!==t.protocol){if(!$s[r.protocol]){for(var u=Object.keys(r),p=0;p<u.length;p++){var l=u[p];t[l]=r[l]}return t.href=t.format(),t}if(t.protocol=r.protocol,!r.host&&!vm[r.protocol]){for(var C=(r.pathname||"").split("/");C.length&&!(r.host=C.shift()););r.host||(r.host=""),r.hostname||(r.hostname=""),C[0]!==""&&C.unshift(""),C.length<2&&C.unshift(""),t.pathname=C.join("/")}else t.pathname=r.pathname;if(t.search=r.search,t.query=r.query,t.host=r.host||"",t.auth=r.auth,t.hostname=r.hostname||r.host,t.port=r.port,t.pathname||t.search){var d=t.pathname||"",f=t.search||"";t.path=d+f}return t.slashes=t.slashes||r.slashes,t.href=t.format(),t}var g=t.pathname&&t.pathname.charAt(0)==="/",m=r.host||r.pathname&&r.pathname.charAt(0)==="/",y=m||g||t.host&&r.pathname,w=y,b=t.pathname&&t.pathname.split("/")||[],C=r.pathname&&r.pathname.split("/")||[],R=t.protocol&&!$s[t.protocol];if(R&&(t.hostname="",t.port=null,t.host&&(b[0]===""?b[0]=t.host:b.unshift(t.host)),t.host="",r.protocol&&(r.hostname=null,r.port=null,r.host&&(C[0]===""?C[0]=r.host:C.unshift(r.host)),r.host=null),y=y&&(C[0]===""||b[0]==="")),m)t.host=r.host||r.host===""?r.host:t.host,t.hostname=r.hostname||r.hostname===""?r.hostname:t.hostname,t.search=r.search,t.query=r.query,b=C;else if(C.length)b||(b=[]),b.pop(),b=b.concat(C),t.search=r.search,t.query=r.query;else if(r.search!=null){if(R){t.host=b.shift(),t.hostname=t.host;var A=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;A&&(t.auth=A.shift(),t.hostname=A.shift(),t.host=t.hostname)}return t.search=r.search,t.query=r.query,(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t}if(!b.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;for(var D=b.slice(-1)[0],ee=(t.host||r.host||b.length>1)&&(D==="."||D==="..")||D==="",$=0,X=b.length;X>=0;X--)D=b[X],D==="."?b.splice(X,1):D===".."?(b.splice(X,1),$++):$&&(b.splice(X,1),$--);if(!y&&!w)for(;$--;$)b.unshift("..");y&&b[0]!==""&&(!b[0]||b[0].charAt(0)!=="/")&&b.unshift(""),ee&&b.join("/").substr(-1)!=="/"&&b.push("");var le=b[0]===""||b[0]&&b[0].charAt(0)==="/";if(R){t.hostname=le?"":b.length?b.shift():"",t.host=t.hostname;var A=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;A&&(t.auth=A.shift(),t.hostname=A.shift(),t.host=t.hostname)}return y=y||t.host&&b.length,y&&!le&&b.unshift(""),b.length>0?t.pathname=b.join("/"):(t.pathname=null,t.path=null),(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=r.auth||t.auth,t.slashes=t.slashes||r.slashes,t.href=t.format(),t};er.prototype.parseHost=function(){var r=this.host,e=zq.exec(r);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),r=r.substr(0,r.length-e.length)),r&&(this.hostname=r)};Ks.parse=ya;Ks.resolve=Kq;Ks.resolveObject=Gq;Ks.format=$q;Ks.Url=er});var wp=h((g9,WE)=>{"use strict";var Jq=dp();WE.exports=function(){return Jq()&&!!Symbol.toStringTag}});var mm=h((m9,$E)=>{"use strict";var HE=ha(),Yq=tm(),Gs=pi(),VE=Ls();$E.exports=function(e,t,i){if(!e||typeof e!="object"&&typeof e!="function")throw new Gs("`obj` must be an object or a function`");if(typeof t!="string"&&typeof t!="symbol")throw new Gs("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Gs("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Gs("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Gs("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Gs("`loose`, if provided, must be a boolean");var n=arguments.length>3?arguments[3]:null,s=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,c=!!VE&&VE(e,t);if(HE)HE(e,t,{configurable:o===null&&c?c.configurable:!o,enumerable:n===null&&c?c.enumerable:!n,value:i,writable:s===null&&c?c.writable:!s});else if(a||!n&&!s&&!o)e[t]=i;else throw new Yq("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}});var Sm=h((y9,GE)=>{"use strict";var ym=ha(),KE=function(){return!!ym};KE.hasArrayLengthDefineBug=function(){if(!ym)return null;try{return ym([],"length",{value:1}).length!==1}catch{return!0}};GE.exports=KE});var ZE=h((S9,XE)=>{"use strict";var Qq=Ws(),JE=mm(),Xq=Sm()(),YE=Ls(),QE=pi(),Zq=Qq("%Math.floor%");XE.exports=function(e,t){if(typeof e!="function")throw new QE("`fn` is not a function");if(typeof t!="number"||t<0||t>4294967295||Zq(t)!==t)throw new QE("`length` must be a positive 32-bit integer");var i=arguments.length>2&&!!arguments[2],n=!0,s=!0;if("length"in e&&YE){var o=YE(e,"length");o&&!o.configurable&&(n=!1),o&&!o.writable&&(s=!1)}return(n||s||!i)&&(Xq?JE(e,"length",t,!0,!0):JE(e,"length",t)),e}});var tI=h((C9,eI)=>{"use strict";var ez=qs(),tz=vp(),rz=rm();eI.exports=function(){return rz(ez,tz,arguments)}});var Sa=h((b9,_p)=>{"use strict";var iz=ZE(),rI=ha(),nz=gp(),iI=tI();_p.exports=function(e){var t=nz(arguments),i=e.length-(arguments.length-1);return iz(t,1+(i>0?i:0),!0)};rI?rI(_p.exports,"apply",{value:iI}):_p.exports.apply=iI});var Ca=h((P9,oI)=>{"use strict";var nI=Ws(),sI=Sa(),sz=sI(nI("String.prototype.indexOf"));oI.exports=function(e,t){var i=nI(e,!!t);return typeof i=="function"&&sz(e,".prototype.")>-1?sI(i):i}});var uI=h((w9,cI)=>{"use strict";var oz=wp()(),az=Ca(),Cm=az("Object.prototype.toString"),Rp=function(e){return oz&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:Cm(e)==="[object Arguments]"},aI=function(e){return Rp(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&Cm(e)!=="[object Array]"&&Cm(e.callee)==="[object Function]"},cz=function(){return Rp(arguments)}();Rp.isLegacyArguments=aI;cI.exports=cz?Rp:aI});var hI=h((_9,lI)=>{"use strict";var uz=Object.prototype.toString,pz=Function.prototype.toString,lz=/^\s*(?:function)?\*/,pI=wp()(),bm=Object.getPrototypeOf,hz=function(){if(!pI)return!1;try{return Function("return function*() {}")()}catch{}},Pm;lI.exports=function(e){if(typeof e!="function")return!1;if(lz.test(pz.call(e)))return!0;if(!pI){var t=uz.call(e);return t==="[object GeneratorFunction]"}if(!bm)return!1;if(typeof Pm>"u"){var i=hz();Pm=i?bm(i):!1}return bm(e)===Pm}});var gI=h((R9,vI)=>{"use strict";var fI=Function.prototype.toString,Js=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,_m,Ep;if(typeof Js=="function"&&typeof Object.defineProperty=="function")try{_m=Object.defineProperty({},"length",{get:function(){throw Ep}}),Ep={},Js(function(){throw 42},null,_m)}catch(r){r!==Ep&&(Js=null)}else Js=null;var dz=/^\s*class\b/,Rm=function(e){try{var t=fI.call(e);return dz.test(t)}catch{return!1}},wm=function(e){try{return Rm(e)?!1:(fI.call(e),!0)}catch{return!1}},Ip=Object.prototype.toString,fz="[object Object]",vz="[object Function]",gz="[object GeneratorFunction]",mz="[object HTMLAllCollection]",yz="[object HTML document.all class]",Sz="[object HTMLCollection]",Cz=typeof Symbol=="function"&&!!Symbol.toStringTag,bz=!(0 in[,]),Em=function(){return!1};typeof document=="object"&&(dI=document.all,Ip.call(dI)===Ip.call(document.all)&&(Em=function(e){if((bz||!e)&&(typeof e>"u"||typeof e=="object"))try{var t=Ip.call(e);return(t===mz||t===yz||t===Sz||t===fz)&&e("")==null}catch{}return!1}));var dI;vI.exports=Js?function(e){if(Em(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;try{Js(e,null,_m)}catch(t){if(t!==Ep)return!1}return!Rm(e)&&wm(e)}:function(e){if(Em(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;if(Cz)return wm(e);if(Rm(e))return!1;var t=Ip.call(e);return t!==vz&&t!==gz&&!/^\[object HTML/.test(t)?!1:wm(e)}});var SI=h((E9,yI)=>{"use strict";var Pz=gI(),wz=Object.prototype.toString,mI=Object.prototype.hasOwnProperty,_z=function(e,t,i){for(var n=0,s=e.length;n<s;n++)mI.call(e,n)&&(i==null?t(e[n],n,e):t.call(i,e[n],n,e))},Rz=function(e,t,i){for(var n=0,s=e.length;n<s;n++)i==null?t(e.charAt(n),n,e):t.call(i,e.charAt(n),n,e)},Ez=function(e,t,i){for(var n in e)mI.call(e,n)&&(i==null?t(e[n],n,e):t.call(i,e[n],n,e))},Iz=function(e,t,i){if(!Pz(t))throw new TypeError("iterator must be a function");var n;arguments.length>=3&&(n=i),wz.call(e)==="[object Array]"?_z(e,t,n):typeof e=="string"?Rz(e,t,n):Ez(e,t,n)};yI.exports=Iz});var bI=h((I9,CI)=>{"use strict";CI.exports=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]});var wI=h((T9,PI)=>{"use strict";var Im=bI(),Tz=typeof globalThis>"u"?global:globalThis;PI.exports=function(){for(var e=[],t=0;t<Im.length;t++)typeof Tz[Im[t]]=="function"&&(e[e.length]=Im[t]);return e}});var xm=h((A9,II)=>{"use strict";var Ap=SI(),Az=wI(),_I=Sa(),Om=Ca(),Tp=Ls(),Oz=Om("Object.prototype.toString"),EI=wp()(),RI=typeof globalThis>"u"?global:globalThis,Am=Az(),Dm=Om("String.prototype.slice"),Tm=Object.getPrototypeOf,Dz=Om("Array.prototype.indexOf",!0)||function(e,t){for(var i=0;i<e.length;i+=1)if(e[i]===t)return i;return-1},Op={__proto__:null};EI&&Tp&&Tm?Ap(Am,function(r){var e=new RI[r];if(Symbol.toStringTag in e){var t=Tm(e),i=Tp(t,Symbol.toStringTag);if(!i){var n=Tm(t);i=Tp(n,Symbol.toStringTag)}Op["$"+r]=_I(i.get)}}):Ap(Am,function(r){var e=new RI[r],t=e.slice||e.set;t&&(Op["$"+r]=_I(t))});var xz=function(e){var t=!1;return Ap(Op,function(i,n){if(!t)try{"$"+i(e)===n&&(t=Dm(n,1))}catch{}}),t},Mz=function(e){var t=!1;return Ap(Op,function(i,n){if(!t)try{i(e),t=Dm(n,1)}catch{}}),t};II.exports=function(e){if(!e||typeof e!="object")return!1;if(!EI){var t=Dm(Oz(e),8,-1);return Dz(Am,t)>-1?t:t!=="Object"?!1:Mz(e)}return Tp?xz(e):null}});var AI=h((O9,TI)=>{"use strict";var kz=xm();TI.exports=function(e){return!!kz(e)}});var WI=h(K=>{"use strict";var Nz=uI(),jz=hI(),br=xm(),OI=AI();function Ys(r){return r.call.bind(r)}var DI=typeof BigInt<"u",xI=typeof Symbol<"u",tr=Ys(Object.prototype.toString),Lz=Ys(Number.prototype.valueOf),qz=Ys(String.prototype.valueOf),zz=Ys(Boolean.prototype.valueOf);DI&&(MI=Ys(BigInt.prototype.valueOf));var MI;xI&&(kI=Ys(Symbol.prototype.valueOf));var kI;function Pa(r,e){if(typeof r!="object")return!1;try{return e(r),!0}catch{return!1}}K.isArgumentsObject=Nz;K.isGeneratorFunction=jz;K.isTypedArray=OI;function Fz(r){return typeof Promise<"u"&&r instanceof Promise||r!==null&&typeof r=="object"&&typeof r.then=="function"&&typeof r.catch=="function"}K.isPromise=Fz;function Bz(r){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(r):OI(r)||jI(r)}K.isArrayBufferView=Bz;function Uz(r){return br(r)==="Uint8Array"}K.isUint8Array=Uz;function Wz(r){return br(r)==="Uint8ClampedArray"}K.isUint8ClampedArray=Wz;function Hz(r){return br(r)==="Uint16Array"}K.isUint16Array=Hz;function Vz(r){return br(r)==="Uint32Array"}K.isUint32Array=Vz;function $z(r){return br(r)==="Int8Array"}K.isInt8Array=$z;function Kz(r){return br(r)==="Int16Array"}K.isInt16Array=Kz;function Gz(r){return br(r)==="Int32Array"}K.isInt32Array=Gz;function Jz(r){return br(r)==="Float32Array"}K.isFloat32Array=Jz;function Yz(r){return br(r)==="Float64Array"}K.isFloat64Array=Yz;function Qz(r){return br(r)==="BigInt64Array"}K.isBigInt64Array=Qz;function Xz(r){return br(r)==="BigUint64Array"}K.isBigUint64Array=Xz;function Dp(r){return tr(r)==="[object Map]"}Dp.working=typeof Map<"u"&&Dp(new Map);function Zz(r){return typeof Map>"u"?!1:Dp.working?Dp(r):r instanceof Map}K.isMap=Zz;function xp(r){return tr(r)==="[object Set]"}xp.working=typeof Set<"u"&&xp(new Set);function e2(r){return typeof Set>"u"?!1:xp.working?xp(r):r instanceof Set}K.isSet=e2;function Mp(r){return tr(r)==="[object WeakMap]"}Mp.working=typeof WeakMap<"u"&&Mp(new WeakMap);function t2(r){return typeof WeakMap>"u"?!1:Mp.working?Mp(r):r instanceof WeakMap}K.isWeakMap=t2;function km(r){return tr(r)==="[object WeakSet]"}km.working=typeof WeakSet<"u"&&km(new WeakSet);function r2(r){return km(r)}K.isWeakSet=r2;function kp(r){return tr(r)==="[object ArrayBuffer]"}kp.working=typeof ArrayBuffer<"u"&&kp(new ArrayBuffer);function NI(r){return typeof ArrayBuffer>"u"?!1:kp.working?kp(r):r instanceof ArrayBuffer}K.isArrayBuffer=NI;function Np(r){return tr(r)==="[object DataView]"}Np.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&Np(new DataView(new ArrayBuffer(1),0,1));function jI(r){return typeof DataView>"u"?!1:Np.working?Np(r):r instanceof DataView}K.isDataView=jI;var Mm=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function ba(r){return tr(r)==="[object SharedArrayBuffer]"}function LI(r){return typeof Mm>"u"?!1:(typeof ba.working>"u"&&(ba.working=ba(new Mm)),ba.working?ba(r):r instanceof Mm)}K.isSharedArrayBuffer=LI;function i2(r){return tr(r)==="[object AsyncFunction]"}K.isAsyncFunction=i2;function n2(r){return tr(r)==="[object Map Iterator]"}K.isMapIterator=n2;function s2(r){return tr(r)==="[object Set Iterator]"}K.isSetIterator=s2;function o2(r){return tr(r)==="[object Generator]"}K.isGeneratorObject=o2;function a2(r){return tr(r)==="[object WebAssembly.Module]"}K.isWebAssemblyCompiledModule=a2;function qI(r){return Pa(r,Lz)}K.isNumberObject=qI;function zI(r){return Pa(r,qz)}K.isStringObject=zI;function FI(r){return Pa(r,zz)}K.isBooleanObject=FI;function BI(r){return DI&&Pa(r,MI)}K.isBigIntObject=BI;function UI(r){return xI&&Pa(r,kI)}K.isSymbolObject=UI;function c2(r){return qI(r)||zI(r)||FI(r)||BI(r)||UI(r)}K.isBoxedPrimitive=c2;function u2(r){return typeof Uint8Array<"u"&&(NI(r)||LI(r))}K.isAnyArrayBuffer=u2;["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(r){Object.defineProperty(K,r,{enumerable:!1,value:function(){throw new Error(r+" is not supported in userland")}})})});var VI=h((x9,HI)=>{"use strict";HI.exports=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}});var $I=h((M9,Nm)=>{"use strict";typeof Object.create=="function"?Nm.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Nm.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}});var An=h(G=>{"use strict";var KI=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),i={},n=0;n<t.length;n++)i[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return i},p2=/%[sdj%]/g;G.format=function(r){if(!Up(r)){for(var e=[],t=0;t<arguments.length;t++)e.push(Bi(arguments[t]));return e.join(" ")}for(var t=1,i=arguments,n=i.length,s=String(r).replace(p2,function(a){if(a==="%%")return"%";if(t>=n)return a;switch(a){case"%s":return String(i[t++]);case"%d":return Number(i[t++]);case"%j":try{return JSON.stringify(i[t++])}catch{return"[Circular]"}default:return a}}),o=i[t];t<n;o=i[++t])Bp(o)||!Qs(o)?s+=" "+o:s+=" "+Bi(o);return s};G.deprecate=function(r,e){if(typeof process<"u"&&process.noDeprecation===!0)return r;if(typeof process>"u")return function(){return G.deprecate(r,e).apply(this,arguments)};var t=!1;function i(){if(!t){if(process.throwDeprecation)throw new Error(e);process.traceDeprecation?console.trace(e):console.error(e),t=!0}return r.apply(this,arguments)}return i};var jp={},GI=/^$/;process.env.NODE_DEBUG&&(Lp=process.env.NODE_DEBUG,Lp=Lp.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),GI=new RegExp("^"+Lp+"$","i"));var Lp;G.debuglog=function(r){if(r=r.toUpperCase(),!jp[r])if(GI.test(r)){var e=process.pid;jp[r]=function(){var t=G.format.apply(G,arguments);console.error("%s %d: %s",r,e,t)}}else jp[r]=function(){};return jp[r]};function Bi(r,e){var t={seen:[],stylize:h2};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),zm(e)?t.showHidden=e:e&&G._extend(t,e),Tn(t.showHidden)&&(t.showHidden=!1),Tn(t.depth)&&(t.depth=2),Tn(t.colors)&&(t.colors=!1),Tn(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=l2),zp(t,r,t.depth)}G.inspect=Bi;Bi.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Bi.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function l2(r,e){var t=Bi.styles[e];return t?"\x1B["+Bi.colors[t][0]+"m"+r+"\x1B["+Bi.colors[t][1]+"m":r}function h2(r,e){return r}function d2(r){var e={};return r.forEach(function(t,i){e[t]=!0}),e}function zp(r,e,t){if(r.customInspect&&e&&qp(e.inspect)&&e.inspect!==G.inspect&&!(e.constructor&&e.constructor.prototype===e)){var i=e.inspect(t,r);return Up(i)||(i=zp(r,i,t)),i}var n=f2(r,e);if(n)return n;var s=Object.keys(e),o=d2(s);if(r.showHidden&&(s=Object.getOwnPropertyNames(e)),_a(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return jm(e);if(s.length===0){if(qp(e)){var a=e.name?": "+e.name:"";return r.stylize("[Function"+a+"]","special")}if(wa(e))return r.stylize(RegExp.prototype.toString.call(e),"regexp");if(Fp(e))return r.stylize(Date.prototype.toString.call(e),"date");if(_a(e))return jm(e)}var c="",u=!1,p=["{","}"];if(JI(e)&&(u=!0,p=["[","]"]),qp(e)){var l=e.name?": "+e.name:"";c=" [Function"+l+"]"}if(wa(e)&&(c=" "+RegExp.prototype.toString.call(e)),Fp(e)&&(c=" "+Date.prototype.toUTCString.call(e)),_a(e)&&(c=" "+jm(e)),s.length===0&&(!u||e.length==0))return p[0]+c+p[1];if(t<0)return wa(e)?r.stylize(RegExp.prototype.toString.call(e),"regexp"):r.stylize("[Object]","special");r.seen.push(e);var d;return u?d=v2(r,e,t,o,s):d=s.map(function(f){return qm(r,e,t,o,f,u)}),r.seen.pop(),g2(d,c,p)}function f2(r,e){if(Tn(e))return r.stylize("undefined","undefined");if(Up(e)){var t="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(t,"string")}if(YI(e))return r.stylize(""+e,"number");if(zm(e))return r.stylize(""+e,"boolean");if(Bp(e))return r.stylize("null","null")}function jm(r){return"["+Error.prototype.toString.call(r)+"]"}function v2(r,e,t,i,n){for(var s=[],o=0,a=e.length;o<a;++o)QI(e,String(o))?s.push(qm(r,e,t,i,String(o),!0)):s.push("");return n.forEach(function(c){c.match(/^\d+$/)||s.push(qm(r,e,t,i,c,!0))}),s}function qm(r,e,t,i,n,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]},c.get?c.set?a=r.stylize("[Getter/Setter]","special"):a=r.stylize("[Getter]","special"):c.set&&(a=r.stylize("[Setter]","special")),QI(i,n)||(o="["+n+"]"),a||(r.seen.indexOf(c.value)<0?(Bp(t)?a=zp(r,c.value,null):a=zp(r,c.value,t-1),a.indexOf(`
`)>-1&&(s?a=a.split(`
`).map(function(u){return"  "+u}).join(`
`).slice(2):a=`
`+a.split(`
`).map(function(u){return"   "+u}).join(`
`))):a=r.stylize("[Circular]","special")),Tn(o)){if(s&&n.match(/^\d+$/))return a;o=JSON.stringify(""+n),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.slice(1,-1),o=r.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=r.stylize(o,"string"))}return o+": "+a}function g2(r,e,t){var i=0,n=r.reduce(function(s,o){return i++,o.indexOf(`
`)>=0&&i++,s+o.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?t[0]+(e===""?"":e+`
 `)+" "+r.join(`,
  `)+" "+t[1]:t[0]+e+" "+r.join(", ")+" "+t[1]}G.types=WI();function JI(r){return Array.isArray(r)}G.isArray=JI;function zm(r){return typeof r=="boolean"}G.isBoolean=zm;function Bp(r){return r===null}G.isNull=Bp;function m2(r){return r==null}G.isNullOrUndefined=m2;function YI(r){return typeof r=="number"}G.isNumber=YI;function Up(r){return typeof r=="string"}G.isString=Up;function y2(r){return typeof r=="symbol"}G.isSymbol=y2;function Tn(r){return r===void 0}G.isUndefined=Tn;function wa(r){return Qs(r)&&Fm(r)==="[object RegExp]"}G.isRegExp=wa;G.types.isRegExp=wa;function Qs(r){return typeof r=="object"&&r!==null}G.isObject=Qs;function Fp(r){return Qs(r)&&Fm(r)==="[object Date]"}G.isDate=Fp;G.types.isDate=Fp;function _a(r){return Qs(r)&&(Fm(r)==="[object Error]"||r instanceof Error)}G.isError=_a;G.types.isNativeError=_a;function qp(r){return typeof r=="function"}G.isFunction=qp;function S2(r){return r===null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||typeof r=="symbol"||typeof r>"u"}G.isPrimitive=S2;G.isBuffer=VI();function Fm(r){return Object.prototype.toString.call(r)}function Lm(r){return r<10?"0"+r.toString(10):r.toString(10)}var C2=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function b2(){var r=new Date,e=[Lm(r.getHours()),Lm(r.getMinutes()),Lm(r.getSeconds())].join(":");return[r.getDate(),C2[r.getMonth()],e].join(" ")}G.log=function(){console.log("%s - %s",b2(),G.format.apply(G,arguments))};G.inherits=$I();G._extend=function(r,e){if(!e||!Qs(e))return r;for(var t=Object.keys(e),i=t.length;i--;)r[t[i]]=e[t[i]];return r};function QI(r,e){return Object.prototype.hasOwnProperty.call(r,e)}var In=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;G.promisify=function(e){if(typeof e!="function")throw new TypeError('The "original" argument must be of type Function');if(In&&e[In]){var t=e[In];if(typeof t!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,In,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var i,n,s=new Promise(function(c,u){i=c,n=u}),o=[],a=0;a<arguments.length;a++)o.push(arguments[a]);o.push(function(c,u){c?n(c):i(u)});try{e.apply(this,o)}catch(c){n(c)}return s}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),In&&Object.defineProperty(t,In,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,KI(e))};G.promisify.custom=In;function P2(r,e){if(!r){var t=new Error("Promise was rejected with a falsy value");t.reason=r,r=t}return e(r)}function w2(r){if(typeof r!="function")throw new TypeError('The "original" argument must be of type Function');function e(){for(var t=[],i=0;i<arguments.length;i++)t.push(arguments[i]);var n=t.pop();if(typeof n!="function")throw new TypeError("The last argument must be of type Function");var s=this,o=function(){return n.apply(s,arguments)};r.apply(this,t).then(function(a){process.nextTick(o.bind(null,null,a))},function(a){process.nextTick(P2.bind(null,a,o))})}return Object.setPrototypeOf(e,Object.getPrototypeOf(r)),Object.defineProperties(e,KI(r)),e}G.callbackify=w2});var Wm=h((N9,tT)=>{"use strict";function Ui(r){"@babel/helpers - typeof";return Ui=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ui(r)}function XI(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,R2(i.key),i)}}function _2(r,e,t){return e&&XI(r.prototype,e),t&&XI(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function R2(r){var e=E2(r,"string");return Ui(e)==="symbol"?e:String(e)}function E2(r,e){if(Ui(r)!=="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,e||"default");if(Ui(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function I2(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function T2(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Um(r,e)}function Um(r,e){return Um=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},Um(r,e)}function A2(r){var e=x2();return function(){var i=Wp(r),n;if(e){var s=Wp(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return O2(this,n)}}function O2(r,e){if(e&&(Ui(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return D2(r)}function D2(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function x2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wp(r){return Wp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Wp(r)}var eT={},Xs,Bm;function Ra(r,e,t){t||(t=Error);function i(s,o,a){return typeof e=="string"?e:e(s,o,a)}var n=function(s){T2(a,s);var o=A2(a);function a(c,u,p){var l;return I2(this,a),l=o.call(this,i(c,u,p)),l.code=r,l}return _2(a)}(t);eT[r]=n}function ZI(r,e){if(Array.isArray(r)){var t=r.length;return r=r.map(function(i){return String(i)}),t>2?"one of ".concat(e," ").concat(r.slice(0,t-1).join(", "),", or ")+r[t-1]:t===2?"one of ".concat(e," ").concat(r[0]," or ").concat(r[1]):"of ".concat(e," ").concat(r[0])}else return"of ".concat(e," ").concat(String(r))}function M2(r,e,t){return r.substr(!t||t<0?0:+t,e.length)===e}function k2(r,e,t){return(t===void 0||t>r.length)&&(t=r.length),r.substring(t-e.length,t)===e}function N2(r,e,t){return typeof t!="number"&&(t=0),t+e.length>r.length?!1:r.indexOf(e,t)!==-1}Ra("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError);Ra("ERR_INVALID_ARG_TYPE",function(r,e,t){Xs===void 0&&(Xs=Hp()),Xs(typeof r=="string","'name' must be a string");var i;typeof e=="string"&&M2(e,"not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";var n;if(k2(r," argument"))n="The ".concat(r," ").concat(i," ").concat(ZI(e,"type"));else{var s=N2(r,".")?"property":"argument";n='The "'.concat(r,'" ').concat(s," ").concat(i," ").concat(ZI(e,"type"))}return n+=". Received type ".concat(Ui(t)),n},TypeError);Ra("ERR_INVALID_ARG_VALUE",function(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"is invalid";Bm===void 0&&(Bm=An());var i=Bm.inspect(e);return i.length>128&&(i="".concat(i.slice(0,128),"...")),"The argument '".concat(r,"' ").concat(t,". Received ").concat(i)},TypeError,RangeError);Ra("ERR_INVALID_RETURN_VALUE",function(r,e,t){var i;return t&&t.constructor&&t.constructor.name?i="instance of ".concat(t.constructor.name):i="type ".concat(Ui(t)),"Expected ".concat(r,' to be returned from the "').concat(e,'"')+" function but got ".concat(i,".")},TypeError);Ra("ERR_MISSING_ARGS",function(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];Xs===void 0&&(Xs=Hp()),Xs(e.length>0,"At least one arg needs to be specified");var i="The ",n=e.length;switch(e=e.map(function(s){return'"'.concat(s,'"')}),n){case 1:i+="".concat(e[0]," argument");break;case 2:i+="".concat(e[0]," and ").concat(e[1]," arguments");break;default:i+=e.slice(0,n-1).join(", "),i+=", and ".concat(e[n-1]," arguments");break}return"".concat(i," must be specified")},TypeError);tT.exports.codes=eT});var lT=h((j9,pT)=>{"use strict";function rT(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),t.push.apply(t,i)}return t}function iT(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?rT(Object(t),!0).forEach(function(i){j2(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):rT(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}function j2(r,e,t){return e=aT(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function L2(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function nT(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,aT(i.key),i)}}function q2(r,e,t){return e&&nT(r.prototype,e),t&&nT(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function aT(r){var e=z2(r,"string");return Dt(e)==="symbol"?e:String(e)}function z2(r,e){if(Dt(r)!=="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,e||"default");if(Dt(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function F2(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Aa(r,e)}function B2(r){var e=uT();return function(){var i=Oa(r),n;if(e){var s=Oa(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return cT(this,n)}}function cT(r,e){if(e&&(Dt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hm(r)}function Hm(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Vm(r){var e=typeof Map=="function"?new Map:void 0;return Vm=function(i){if(i===null||!U2(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(i))return e.get(i);e.set(i,n)}function n(){return Vp(i,arguments,Oa(this).constructor)}return n.prototype=Object.create(i.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Aa(n,i)},Vm(r)}function Vp(r,e,t){return uT()?Vp=Reflect.construct.bind():Vp=function(n,s,o){var a=[null];a.push.apply(a,s);var c=Function.bind.apply(n,a),u=new c;return o&&Aa(u,o.prototype),u},Vp.apply(null,arguments)}function uT(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function U2(r){return Function.toString.call(r).indexOf("[native code]")!==-1}function Aa(r,e){return Aa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},Aa(r,e)}function Oa(r){return Oa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Oa(r)}function Dt(r){"@babel/helpers - typeof";return Dt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dt(r)}var W2=An(),$m=W2.inspect,H2=Wm(),V2=H2.codes.ERR_INVALID_ARG_TYPE;function sT(r,e,t){return(t===void 0||t>r.length)&&(t=r.length),r.substring(t-e.length,t)===e}function $2(r,e){if(e=Math.floor(e),r.length==0||e==0)return"";var t=r.length*e;for(e=Math.floor(Math.log(e)/Math.log(2));e;)r+=r,e--;return r+=r.substring(0,t-r.length),r}var Pr="",Ea="",Ia="",Ve="",On={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"},K2=10;function oT(r){var e=Object.keys(r),t=Object.create(Object.getPrototypeOf(r));return e.forEach(function(i){t[i]=r[i]}),Object.defineProperty(t,"message",{value:r.message}),t}function Ta(r){return $m(r,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function G2(r,e,t){var i="",n="",s=0,o="",a=!1,c=Ta(r),u=c.split(`
`),p=Ta(e).split(`
`),l=0,d="";if(t==="strictEqual"&&Dt(r)==="object"&&Dt(e)==="object"&&r!==null&&e!==null&&(t="strictEqualObject"),u.length===1&&p.length===1&&u[0]!==p[0]){var f=u[0].length+p[0].length;if(f<=K2){if((Dt(r)!=="object"||r===null)&&(Dt(e)!=="object"||e===null)&&(r!==0||e!==0))return"".concat(On[t],`

`)+"".concat(u[0]," !== ").concat(p[0],`
`)}else if(t!=="strictEqualObject"){var g=process.stderr&&process.stderr.isTTY?process.stderr.columns:80;if(f<g){for(;u[0][l]===p[0][l];)l++;l>2&&(d=`
  `.concat($2(" ",l),"^"),l=0)}}}for(var m=u[u.length-1],y=p[p.length-1];m===y&&(l++<2?o=`
  `.concat(m).concat(o):i=m,u.pop(),p.pop(),!(u.length===0||p.length===0));)m=u[u.length-1],y=p[p.length-1];var w=Math.max(u.length,p.length);if(w===0){var b=c.split(`
`);if(b.length>30)for(b[26]="".concat(Pr,"...").concat(Ve);b.length>27;)b.pop();return"".concat(On.notIdentical,`

`).concat(b.join(`
`),`
`)}l>3&&(o=`
`.concat(Pr,"...").concat(Ve).concat(o),a=!0),i!==""&&(o=`
  `.concat(i).concat(o),i="");var C=0,R=On[t]+`
`.concat(Ea,"+ actual").concat(Ve," ").concat(Ia,"- expected").concat(Ve),A=" ".concat(Pr,"...").concat(Ve," Lines skipped");for(l=0;l<w;l++){var D=l-s;if(u.length<l+1)D>1&&l>2&&(D>4?(n+=`
`.concat(Pr,"...").concat(Ve),a=!0):D>3&&(n+=`
  `.concat(p[l-2]),C++),n+=`
  `.concat(p[l-1]),C++),s=l,i+=`
`.concat(Ia,"-").concat(Ve," ").concat(p[l]),C++;else if(p.length<l+1)D>1&&l>2&&(D>4?(n+=`
`.concat(Pr,"...").concat(Ve),a=!0):D>3&&(n+=`
  `.concat(u[l-2]),C++),n+=`
  `.concat(u[l-1]),C++),s=l,n+=`
`.concat(Ea,"+").concat(Ve," ").concat(u[l]),C++;else{var ee=p[l],$=u[l],X=$!==ee&&(!sT($,",")||$.slice(0,-1)!==ee);X&&sT(ee,",")&&ee.slice(0,-1)===$&&(X=!1,$+=","),X?(D>1&&l>2&&(D>4?(n+=`
`.concat(Pr,"...").concat(Ve),a=!0):D>3&&(n+=`
  `.concat(u[l-2]),C++),n+=`
  `.concat(u[l-1]),C++),s=l,n+=`
`.concat(Ea,"+").concat(Ve," ").concat($),i+=`
`.concat(Ia,"-").concat(Ve," ").concat(ee),C+=2):(n+=i,i="",(D===1||l===0)&&(n+=`
  `.concat($),C++))}if(C>20&&l<w-2)return"".concat(R).concat(A,`
`).concat(n,`
`).concat(Pr,"...").concat(Ve).concat(i,`
`)+"".concat(Pr,"...").concat(Ve)}return"".concat(R).concat(a?A:"",`
`).concat(n).concat(i).concat(o).concat(d)}var J2=function(r,e){F2(i,r);var t=B2(i);function i(n){var s;if(L2(this,i),Dt(n)!=="object"||n===null)throw new V2("options","Object",n);var o=n.message,a=n.operator,c=n.stackStartFn,u=n.actual,p=n.expected,l=Error.stackTraceLimit;if(Error.stackTraceLimit=0,o!=null)s=t.call(this,String(o));else if(process.stderr&&process.stderr.isTTY&&(process.stderr&&process.stderr.getColorDepth&&process.stderr.getColorDepth()!==1?(Pr="\x1B[34m",Ea="\x1B[32m",Ve="\x1B[39m",Ia="\x1B[31m"):(Pr="",Ea="",Ve="",Ia="")),Dt(u)==="object"&&u!==null&&Dt(p)==="object"&&p!==null&&"stack"in u&&u instanceof Error&&"stack"in p&&p instanceof Error&&(u=oT(u),p=oT(p)),a==="deepStrictEqual"||a==="strictEqual")s=t.call(this,G2(u,p,a));else if(a==="notDeepStrictEqual"||a==="notStrictEqual"){var d=On[a],f=Ta(u).split(`
`);if(a==="notStrictEqual"&&Dt(u)==="object"&&u!==null&&(d=On.notStrictEqualObject),f.length>30)for(f[26]="".concat(Pr,"...").concat(Ve);f.length>27;)f.pop();f.length===1?s=t.call(this,"".concat(d," ").concat(f[0])):s=t.call(this,"".concat(d,`

`).concat(f.join(`
`),`
`))}else{var g=Ta(u),m="",y=On[a];a==="notDeepEqual"||a==="notEqual"?(g="".concat(On[a],`

`).concat(g),g.length>1024&&(g="".concat(g.slice(0,1021),"..."))):(m="".concat(Ta(p)),g.length>512&&(g="".concat(g.slice(0,509),"...")),m.length>512&&(m="".concat(m.slice(0,509),"...")),a==="deepEqual"||a==="equal"?g="".concat(y,`

`).concat(g,`

should equal

`):m=" ".concat(a," ").concat(m)),s=t.call(this,"".concat(g).concat(m))}return Error.stackTraceLimit=l,s.generatedMessage=!o,Object.defineProperty(Hm(s),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),s.code="ERR_ASSERTION",s.actual=u,s.expected=p,s.operator=a,Error.captureStackTrace&&Error.captureStackTrace(Hm(s),c),s.stack,s.name="AssertionError",cT(s)}return q2(i,[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:e,value:function(s,o){return $m(this,iT(iT({},o),{},{customInspect:!1,depth:0}))}}]),i}(Vm(Error),$m.custom);pT.exports=J2});var Km=h((L9,dT)=>{"use strict";var hT=Object.prototype.toString;dT.exports=function(e){var t=hT.call(e),i=t==="[object Arguments]";return i||(i=t!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&hT.call(e.callee)==="[object Function]"),i}});var PT=h((q9,bT)=>{"use strict";var CT;Object.keys||(Da=Object.prototype.hasOwnProperty,Gm=Object.prototype.toString,fT=Km(),Jm=Object.prototype.propertyIsEnumerable,vT=!Jm.call({toString:null},"toString"),gT=Jm.call(function(){},"prototype"),xa=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],$p=function(r){var e=r.constructor;return e&&e.prototype===r},mT={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},yT=function(){if(typeof window>"u")return!1;for(var r in window)try{if(!mT["$"+r]&&Da.call(window,r)&&window[r]!==null&&typeof window[r]=="object")try{$p(window[r])}catch{return!0}}catch{return!0}return!1}(),ST=function(r){if(typeof window>"u"||!yT)return $p(r);try{return $p(r)}catch{return!1}},CT=function(e){var t=e!==null&&typeof e=="object",i=Gm.call(e)==="[object Function]",n=fT(e),s=t&&Gm.call(e)==="[object String]",o=[];if(!t&&!i&&!n)throw new TypeError("Object.keys called on a non-object");var a=gT&&i;if(s&&e.length>0&&!Da.call(e,0))for(var c=0;c<e.length;++c)o.push(String(c));if(n&&e.length>0)for(var u=0;u<e.length;++u)o.push(String(u));else for(var p in e)!(a&&p==="prototype")&&Da.call(e,p)&&o.push(String(p));if(vT)for(var l=ST(e),d=0;d<xa.length;++d)!(l&&xa[d]==="constructor")&&Da.call(e,xa[d])&&o.push(xa[d]);return o});var Da,Gm,fT,Jm,vT,gT,xa,$p,mT,yT,ST;bT.exports=CT});var Ym=h((z9,RT)=>{"use strict";var Y2=Array.prototype.slice,Q2=Km(),wT=Object.keys,Kp=wT?function(e){return wT(e)}:PT(),_T=Object.keys;Kp.shim=function(){if(Object.keys){var e=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);e||(Object.keys=function(i){return Q2(i)?_T(Y2.call(i)):_T(i)})}else Object.keys=Kp;return Object.keys||Kp};RT.exports=Kp});var DT=h((F9,OT)=>{"use strict";var X2=Ym(),TT=dp()(),AT=Ca(),ET=Object,Z2=AT("Array.prototype.push"),IT=AT("Object.prototype.propertyIsEnumerable"),eF=TT?Object.getOwnPropertySymbols:null;OT.exports=function(e,t){if(e==null)throw new TypeError("target must be an object");var i=ET(e);if(arguments.length===1)return i;for(var n=1;n<arguments.length;++n){var s=ET(arguments[n]),o=X2(s),a=TT&&(Object.getOwnPropertySymbols||eF);if(a)for(var c=a(s),u=0;u<c.length;++u){var p=c[u];IT(s,p)&&Z2(o,p)}for(var l=0;l<o.length;++l){var d=o[l];if(IT(s,d)){var f=s[d];i[d]=f}}}return i}});var MT=h((B9,xT)=>{"use strict";var Qm=DT(),tF=function(){if(!Object.assign)return!1;for(var r="abcdefghijklmnopqrst",e=r.split(""),t={},i=0;i<e.length;++i)t[e[i]]=e[i];var n=Object.assign({},t),s="";for(var o in n)s+=o;return r!==s},rF=function(){if(!Object.assign||!Object.preventExtensions)return!1;var r=Object.preventExtensions({1:2});try{Object.assign(r,"xy")}catch{return r[1]==="y"}return!1};xT.exports=function(){return!Object.assign||tF()||rF()?Qm:Object.assign}});var Xm=h((U9,NT)=>{"use strict";var kT=function(r){return r!==r};NT.exports=function(e,t){return e===0&&t===0?1/e===1/t:!!(e===t||kT(e)&&kT(t))}});var Gp=h((W9,jT)=>{"use strict";var iF=Xm();jT.exports=function(){return typeof Object.is=="function"?Object.is:iF}});var Ma=h((H9,FT)=>{"use strict";var nF=Ym(),sF=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",oF=Object.prototype.toString,aF=Array.prototype.concat,LT=mm(),cF=function(r){return typeof r=="function"&&oF.call(r)==="[object Function]"},qT=Sm()(),uF=function(r,e,t,i){if(e in r){if(i===!0){if(r[e]===t)return}else if(!cF(i)||!i())return}qT?LT(r,e,t,!0):LT(r,e,t)},zT=function(r,e){var t=arguments.length>2?arguments[2]:{},i=nF(e);sF&&(i=aF.call(i,Object.getOwnPropertySymbols(e)));for(var n=0;n<i.length;n+=1)uF(r,i[n],e[i[n]],t[i[n]])};zT.supportsDescriptors=!!qT;FT.exports=zT});var UT=h((V9,BT)=>{"use strict";var pF=Gp(),lF=Ma();BT.exports=function(){var e=pF();return lF(Object,{is:e},{is:function(){return Object.is!==e}}),e}});var $T=h(($9,VT)=>{"use strict";var hF=Ma(),dF=Sa(),fF=Xm(),WT=Gp(),vF=UT(),HT=dF(WT(),Object);hF(HT,{getPolyfill:WT,implementation:fF,shim:vF});VT.exports=HT});var Zm=h((K9,KT)=>{"use strict";KT.exports=function(e){return e!==e}});var ey=h((G9,GT)=>{"use strict";var gF=Zm();GT.exports=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:gF}});var YT=h((J9,JT)=>{"use strict";var mF=Ma(),yF=ey();JT.exports=function(){var e=yF();return mF(Number,{isNaN:e},{isNaN:function(){return Number.isNaN!==e}}),e}});var eA=h((Y9,ZT)=>{"use strict";var SF=Sa(),CF=Ma(),bF=Zm(),QT=ey(),PF=YT(),XT=SF(QT(),Number);CF(XT,{getPolyfill:QT,implementation:bF,shim:PF});ZT.exports=XT});var CA=h((Q9,SA)=>{"use strict";function tA(r,e){return EF(r)||RF(r,e)||_F(r,e)||wF()}function wF(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _F(r,e){if(r){if(typeof r=="string")return rA(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return rA(r,e)}}function rA(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=r[t];return i}function RF(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var i,n,s,o,a=[],c=!0,u=!1;try{if(s=(t=t.call(r)).next,e===0){if(Object(t)!==t)return;c=!1}else for(;!(c=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);c=!0);}catch(p){u=!0,n=p}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw n}}return a}}function EF(r){if(Array.isArray(r))return r}function rr(r){"@babel/helpers - typeof";return rr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rr(r)}var IF=/a/g.flags!==void 0,tl=function(e){var t=[];return e.forEach(function(i){return t.push(i)}),t},iA=function(e){var t=[];return e.forEach(function(i,n){return t.push([n,i])}),t},fA=Object.is?Object.is:$T(),Zp=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},ty=Number.isNaN?Number.isNaN:eA();function iy(r){return r.call.bind(r)}var Na=iy(Object.prototype.hasOwnProperty),el=iy(Object.prototype.propertyIsEnumerable),nA=iy(Object.prototype.toString),yt=An().types,TF=yt.isAnyArrayBuffer,AF=yt.isArrayBufferView,sA=yt.isDate,Jp=yt.isMap,oA=yt.isRegExp,Yp=yt.isSet,OF=yt.isNativeError,DF=yt.isBoxedPrimitive,aA=yt.isNumberObject,cA=yt.isStringObject,uA=yt.isBooleanObject,pA=yt.isBigIntObject,xF=yt.isSymbolObject,MF=yt.isFloat32Array,kF=yt.isFloat64Array;function NF(r){if(r.length===0||r.length>10)return!0;for(var e=0;e<r.length;e++){var t=r.charCodeAt(e);if(t<48||t>57)return!0}return r.length===10&&r>=Math.pow(2,32)}function Qp(r){return Object.keys(r).filter(NF).concat(Zp(r).filter(Object.prototype.propertyIsEnumerable.bind(r)))}function vA(r,e){if(r===e)return 0;for(var t=r.length,i=e.length,n=0,s=Math.min(t,i);n<s;++n)if(r[n]!==e[n]){t=r[n],i=e[n];break}return t<i?-1:i<t?1:0}var Xp=void 0,jF=!0,LF=!1,ry=0,ny=1,gA=2,mA=3;function qF(r,e){return IF?r.source===e.source&&r.flags===e.flags:RegExp.prototype.toString.call(r)===RegExp.prototype.toString.call(e)}function zF(r,e){if(r.byteLength!==e.byteLength)return!1;for(var t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}function FF(r,e){return r.byteLength!==e.byteLength?!1:vA(new Uint8Array(r.buffer,r.byteOffset,r.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))===0}function BF(r,e){return r.byteLength===e.byteLength&&vA(new Uint8Array(r),new Uint8Array(e))===0}function UF(r,e){return aA(r)?aA(e)&&fA(Number.prototype.valueOf.call(r),Number.prototype.valueOf.call(e)):cA(r)?cA(e)&&String.prototype.valueOf.call(r)===String.prototype.valueOf.call(e):uA(r)?uA(e)&&Boolean.prototype.valueOf.call(r)===Boolean.prototype.valueOf.call(e):pA(r)?pA(e)&&BigInt.prototype.valueOf.call(r)===BigInt.prototype.valueOf.call(e):xF(e)&&Symbol.prototype.valueOf.call(r)===Symbol.prototype.valueOf.call(e)}function ir(r,e,t,i){if(r===e)return r!==0?!0:t?fA(r,e):!0;if(t){if(rr(r)!=="object")return typeof r=="number"&&ty(r)&&ty(e);if(rr(e)!=="object"||r===null||e===null||Object.getPrototypeOf(r)!==Object.getPrototypeOf(e))return!1}else{if(r===null||rr(r)!=="object")return e===null||rr(e)!=="object"?r==e:!1;if(e===null||rr(e)!=="object")return!1}var n=nA(r),s=nA(e);if(n!==s)return!1;if(Array.isArray(r)){if(r.length!==e.length)return!1;var o=Qp(r,Xp),a=Qp(e,Xp);return o.length!==a.length?!1:ka(r,e,t,i,ny,o)}if(n==="[object Object]"&&(!Jp(r)&&Jp(e)||!Yp(r)&&Yp(e)))return!1;if(sA(r)){if(!sA(e)||Date.prototype.getTime.call(r)!==Date.prototype.getTime.call(e))return!1}else if(oA(r)){if(!oA(e)||!qF(r,e))return!1}else if(OF(r)||r instanceof Error){if(r.message!==e.message||r.name!==e.name)return!1}else if(AF(r)){if(!t&&(MF(r)||kF(r))){if(!zF(r,e))return!1}else if(!FF(r,e))return!1;var c=Qp(r,Xp),u=Qp(e,Xp);return c.length!==u.length?!1:ka(r,e,t,i,ry,c)}else{if(Yp(r))return!Yp(e)||r.size!==e.size?!1:ka(r,e,t,i,gA);if(Jp(r))return!Jp(e)||r.size!==e.size?!1:ka(r,e,t,i,mA);if(TF(r)){if(!BF(r,e))return!1}else if(DF(r)&&!UF(r,e))return!1}return ka(r,e,t,i,ry)}function lA(r,e){return e.filter(function(t){return el(r,t)})}function ka(r,e,t,i,n,s){if(arguments.length===5){s=Object.keys(r);var o=Object.keys(e);if(s.length!==o.length)return!1}for(var a=0;a<s.length;a++)if(!Na(e,s[a]))return!1;if(t&&arguments.length===5){var c=Zp(r);if(c.length!==0){var u=0;for(a=0;a<c.length;a++){var p=c[a];if(el(r,p)){if(!el(e,p))return!1;s.push(p),u++}else if(el(e,p))return!1}var l=Zp(e);if(c.length!==l.length&&lA(e,l).length!==u)return!1}else{var d=Zp(e);if(d.length!==0&&lA(e,d).length!==0)return!1}}if(s.length===0&&(n===ry||n===ny&&r.length===0||r.size===0))return!0;if(i===void 0)i={val1:new Map,val2:new Map,position:0};else{var f=i.val1.get(r);if(f!==void 0){var g=i.val2.get(e);if(g!==void 0)return f===g}i.position++}i.val1.set(r,i.position),i.val2.set(e,i.position);var m=KF(r,e,t,s,i,n);return i.val1.delete(r),i.val2.delete(e),m}function hA(r,e,t,i){for(var n=tl(r),s=0;s<n.length;s++){var o=n[s];if(ir(e,o,t,i))return r.delete(o),!0}return!1}function yA(r){switch(rr(r)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":r=+r;case"number":if(ty(r))return!1}return!0}function WF(r,e,t){var i=yA(t);return i??(e.has(i)&&!r.has(i))}function HF(r,e,t,i,n){var s=yA(t);if(s!=null)return s;var o=e.get(s);return o===void 0&&!e.has(s)||!ir(i,o,!1,n)?!1:!r.has(s)&&ir(i,o,!1,n)}function VF(r,e,t,i){for(var n=null,s=tl(r),o=0;o<s.length;o++){var a=s[o];if(rr(a)==="object"&&a!==null)n===null&&(n=new Set),n.add(a);else if(!e.has(a)){if(t||!WF(r,e,a))return!1;n===null&&(n=new Set),n.add(a)}}if(n!==null){for(var c=tl(e),u=0;u<c.length;u++){var p=c[u];if(rr(p)==="object"&&p!==null){if(!hA(n,p,t,i))return!1}else if(!t&&!r.has(p)&&!hA(n,p,t,i))return!1}return n.size===0}return!0}function dA(r,e,t,i,n,s){for(var o=tl(r),a=0;a<o.length;a++){var c=o[a];if(ir(t,c,n,s)&&ir(i,e.get(c),n,s))return r.delete(c),!0}return!1}function $F(r,e,t,i){for(var n=null,s=iA(r),o=0;o<s.length;o++){var a=tA(s[o],2),c=a[0],u=a[1];if(rr(c)==="object"&&c!==null)n===null&&(n=new Set),n.add(c);else{var p=e.get(c);if(p===void 0&&!e.has(c)||!ir(u,p,t,i)){if(t||!HF(r,e,c,u,i))return!1;n===null&&(n=new Set),n.add(c)}}}if(n!==null){for(var l=iA(e),d=0;d<l.length;d++){var f=tA(l[d],2),g=f[0],m=f[1];if(rr(g)==="object"&&g!==null){if(!dA(n,r,g,m,t,i))return!1}else if(!t&&(!r.has(g)||!ir(r.get(g),m,!1,i))&&!dA(n,r,g,m,!1,i))return!1}return n.size===0}return!0}function KF(r,e,t,i,n,s){var o=0;if(s===gA){if(!VF(r,e,t,n))return!1}else if(s===mA){if(!$F(r,e,t,n))return!1}else if(s===ny)for(;o<r.length;o++)if(Na(r,o)){if(!Na(e,o)||!ir(r[o],e[o],t,n))return!1}else{if(Na(e,o))return!1;for(var a=Object.keys(r);o<a.length;o++){var c=a[o];if(!Na(e,c)||!ir(r[c],e[c],t,n))return!1}return a.length===Object.keys(e).length}for(o=0;o<i.length;o++){var u=i[o];if(!ir(r[u],e[u],t,n))return!1}return!0}function GF(r,e){return ir(r,e,LF)}function JF(r,e){return ir(r,e,jF)}SA.exports={isDeepEqual:GF,isDeepStrictEqual:JF}});var Hp=h((X9,qA)=>{"use strict";function wr(r){"@babel/helpers - typeof";return wr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wr(r)}function bA(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,QF(i.key),i)}}function YF(r,e,t){return e&&bA(r.prototype,e),t&&bA(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function QF(r){var e=XF(r,"string");return wr(e)==="symbol"?e:String(e)}function XF(r,e){if(wr(r)!=="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,e||"default");if(wr(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function ZF(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var eB=Wm(),ja=eB.codes,PA=ja.ERR_AMBIGUOUS_ARGUMENT,Zs=ja.ERR_INVALID_ARG_TYPE,tB=ja.ERR_INVALID_ARG_VALUE,rB=ja.ERR_INVALID_RETURN_VALUE,Hi=ja.ERR_MISSING_ARGS,Vi=lT(),iB=An(),rl=iB.inspect,EA=An().types,nB=EA.isPromise,il=EA.isRegExp,sB=MT()(),IA=Gp()(),nl=Ca()("RegExp.prototype.test"),Wi,sl;function La(){var r=CA();Wi=r.isDeepEqual,sl=r.isDeepStrictEqual}var wA=!1,he=qA.exports=sy,ol={};function _r(r){throw r.message instanceof Error?r.message:new Vi(r)}function TA(r,e,t,i,n){var s=arguments.length,o;if(s===0)o="Failed";else if(s===1)t=r,r=void 0;else{if(wA===!1){wA=!0;var a=process.emitWarning?process.emitWarning:console.warn.bind(console);a("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094")}s===2&&(i="!=")}if(t instanceof Error)throw t;var c={actual:r,expected:e,operator:i===void 0?"fail":i,stackStartFn:n||TA};t!==void 0&&(c.message=t);var u=new Vi(c);throw o&&(u.message=o,u.generatedMessage=!0),u}he.fail=TA;he.AssertionError=Vi;function AA(r,e,t,i){if(!t){var n=!1;if(e===0)n=!0,i="No value argument passed to `assert.ok()`";else if(i instanceof Error)throw i;var s=new Vi({actual:t,expected:!0,message:i,operator:"==",stackStartFn:r});throw s.generatedMessage=n,s}}function sy(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];AA.apply(void 0,[sy,e.length].concat(e))}he.ok=sy;he.equal=function r(e,t,i){if(arguments.length<2)throw new Hi("actual","expected");e!=t&&_r({actual:e,expected:t,message:i,operator:"==",stackStartFn:r})};he.notEqual=function r(e,t,i){if(arguments.length<2)throw new Hi("actual","expected");e==t&&_r({actual:e,expected:t,message:i,operator:"!=",stackStartFn:r})};he.deepEqual=function r(e,t,i){if(arguments.length<2)throw new Hi("actual","expected");Wi===void 0&&La(),Wi(e,t)||_r({actual:e,expected:t,message:i,operator:"deepEqual",stackStartFn:r})};he.notDeepEqual=function r(e,t,i){if(arguments.length<2)throw new Hi("actual","expected");Wi===void 0&&La(),Wi(e,t)&&_r({actual:e,expected:t,message:i,operator:"notDeepEqual",stackStartFn:r})};he.deepStrictEqual=function r(e,t,i){if(arguments.length<2)throw new Hi("actual","expected");Wi===void 0&&La(),sl(e,t)||_r({actual:e,expected:t,message:i,operator:"deepStrictEqual",stackStartFn:r})};he.notDeepStrictEqual=OA;function OA(r,e,t){if(arguments.length<2)throw new Hi("actual","expected");Wi===void 0&&La(),sl(r,e)&&_r({actual:r,expected:e,message:t,operator:"notDeepStrictEqual",stackStartFn:OA})}he.strictEqual=function r(e,t,i){if(arguments.length<2)throw new Hi("actual","expected");IA(e,t)||_r({actual:e,expected:t,message:i,operator:"strictEqual",stackStartFn:r})};he.notStrictEqual=function r(e,t,i){if(arguments.length<2)throw new Hi("actual","expected");IA(e,t)&&_r({actual:e,expected:t,message:i,operator:"notStrictEqual",stackStartFn:r})};var _A=YF(function r(e,t,i){var n=this;ZF(this,r),t.forEach(function(s){s in e&&(i!==void 0&&typeof i[s]=="string"&&il(e[s])&&nl(e[s],i[s])?n[s]=i[s]:n[s]=e[s])})});function oB(r,e,t,i,n,s){if(!(t in r)||!sl(r[t],e[t])){if(!i){var o=new _A(r,n),a=new _A(e,n,r),c=new Vi({actual:o,expected:a,operator:"deepStrictEqual",stackStartFn:s});throw c.actual=r,c.expected=e,c.operator=s.name,c}_r({actual:r,expected:e,message:i,operator:s.name,stackStartFn:s})}}function DA(r,e,t,i){if(typeof e!="function"){if(il(e))return nl(e,r);if(arguments.length===2)throw new Zs("expected",["Function","RegExp"],e);if(wr(r)!=="object"||r===null){var n=new Vi({actual:r,expected:e,message:t,operator:"deepStrictEqual",stackStartFn:i});throw n.operator=i.name,n}var s=Object.keys(e);if(e instanceof Error)s.push("name","message");else if(s.length===0)throw new tB("error",e,"may not be an empty object");return Wi===void 0&&La(),s.forEach(function(o){typeof r[o]=="string"&&il(e[o])&&nl(e[o],r[o])||oB(r,e,o,t,s,i)}),!0}return e.prototype!==void 0&&r instanceof e?!0:Error.isPrototypeOf(e)?!1:e.call({},r)===!0}function xA(r){if(typeof r!="function")throw new Zs("fn","Function",r);try{r()}catch(e){return e}return ol}function RA(r){return nB(r)||r!==null&&wr(r)==="object"&&typeof r.then=="function"&&typeof r.catch=="function"}function MA(r){return Promise.resolve().then(function(){var e;if(typeof r=="function"){if(e=r(),!RA(e))throw new rB("instance of Promise","promiseFn",e)}else if(RA(r))e=r;else throw new Zs("promiseFn",["Function","Promise"],r);return Promise.resolve().then(function(){return e}).then(function(){return ol}).catch(function(t){return t})})}function kA(r,e,t,i){if(typeof t=="string"){if(arguments.length===4)throw new Zs("error",["Object","Error","Function","RegExp"],t);if(wr(e)==="object"&&e!==null){if(e.message===t)throw new PA("error/message",'The error message "'.concat(e.message,'" is identical to the message.'))}else if(e===t)throw new PA("error/message",'The error "'.concat(e,'" is identical to the message.'));i=t,t=void 0}else if(t!=null&&wr(t)!=="object"&&typeof t!="function")throw new Zs("error",["Object","Error","Function","RegExp"],t);if(e===ol){var n="";t&&t.name&&(n+=" (".concat(t.name,")")),n+=i?": ".concat(i):".";var s=r.name==="rejects"?"rejection":"exception";_r({actual:void 0,expected:t,operator:r.name,message:"Missing expected ".concat(s).concat(n),stackStartFn:r})}if(t&&!DA(e,t,i,r))throw e}function NA(r,e,t,i){if(e!==ol){if(typeof t=="string"&&(i=t,t=void 0),!t||DA(e,t)){var n=i?": ".concat(i):".",s=r.name==="doesNotReject"?"rejection":"exception";_r({actual:e,expected:t,operator:r.name,message:"Got unwanted ".concat(s).concat(n,`
`)+'Actual message: "'.concat(e&&e.message,'"'),stackStartFn:r})}throw e}}he.throws=function r(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];kA.apply(void 0,[r,xA(e)].concat(i))};he.rejects=function r(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return MA(e).then(function(s){return kA.apply(void 0,[r,s].concat(i))})};he.doesNotThrow=function r(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];NA.apply(void 0,[r,xA(e)].concat(i))};he.doesNotReject=function r(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return MA(e).then(function(s){return NA.apply(void 0,[r,s].concat(i))})};he.ifError=function r(e){if(e!=null){var t="ifError got unwanted exception: ";wr(e)==="object"&&typeof e.message=="string"?e.message.length===0&&e.constructor?t+=e.constructor.name:t+=e.message:t+=rl(e);var i=new Vi({actual:e,expected:null,operator:"ifError",message:t,stackStartFn:r}),n=e.stack;if(typeof n=="string"){var s=n.split(`
`);s.shift();for(var o=i.stack.split(`
`),a=0;a<s.length;a++){var c=o.indexOf(s[a]);if(c!==-1){o=o.slice(0,c);break}}i.stack="".concat(o.join(`
`),`
`).concat(s.join(`
`))}throw i}};function jA(r,e,t,i,n){if(!il(e))throw new Zs("regexp","RegExp",e);var s=n==="match";if(typeof r!="string"||nl(e,r)!==s){if(t instanceof Error)throw t;var o=!t;t=t||(typeof r!="string"?'The "string" argument must be of type string. Received type '+"".concat(wr(r)," (").concat(rl(r),")"):(s?"The input did not match the regular expression ":"The input was expected to not match the regular expression ")+"".concat(rl(e),`. Input:

`).concat(rl(r),`
`));var a=new Vi({actual:r,expected:e,message:t,operator:n,stackStartFn:i});throw a.generatedMessage=o,a}}he.match=function r(e,t,i){jA(e,t,i,r,"match")};he.doesNotMatch=function r(e,t,i){jA(e,t,i,r,"doesNotMatch")};function LA(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];AA.apply(void 0,[LA,e.length].concat(e))}he.strict=sB(LA,he,{equal:he.strictEqual,deepEqual:he.deepStrictEqual,notEqual:he.notStrictEqual,notDeepEqual:he.notDeepStrictEqual});he.strict.strict=he.strict});var zA=h(oy=>{"use strict";Object.defineProperty(oy,"__esModule",{value:!0});function aB(r){return function(e,t){return new Promise((i,n)=>{r.call(this,e,t,(s,o)=>{s?n(s):i(o)})})}}oy.default=aB});var BA=h((cy,FA)=>{"use strict";var cB=cy&&cy.__importDefault||function(r){return r&&r.__esModule?r:{default:r}},uB=qg(),pB=cB(zA());function lB(r){return!!r&&typeof r.addRequest=="function"}function hB(r){return!!r&&typeof r.addRequest=="function"}function ay(){let{stack:r}=new Error;return typeof r!="string"?!1:r.split(`
`).some(e=>e.indexOf("(https.js:")!==-1)}function eo(r,e){return new eo.Agent(r,e)}(function(r){class e extends uB.EventEmitter{constructor(i,n){super(),this.promisifiedCallback=void 0;let s=n;typeof i=="function"?this.callback=i:i&&(s=i),this.timeout=null,s&&typeof s.timeout=="number"&&(this.timeout=s.timeout),this.options=s||{},this.maxFreeSockets=1,this.maxSockets=1,this.sockets=[],this.requests=[]}get defaultPort(){return typeof this.explicitDefaultPort=="number"?this.explicitDefaultPort:ay()?443:80}set defaultPort(i){this.explicitDefaultPort=i}get protocol(){return typeof this.explicitProtocol=="string"?this.explicitProtocol:ay()?"https:":"http:"}set protocol(i){this.explicitProtocol=i}callback(i,n,s){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')}addRequest(i,n){let s=Object.assign({},n);typeof s.secureEndpoint!="boolean"&&(s.secureEndpoint=ay()),s.host==null&&(s.host="localhost"),s.port==null&&(s.port=s.secureEndpoint?443:80);let o=Object.assign(Object.assign({},this.options),s);o.host&&o.path&&delete o.path,delete o.agent,delete o.hostname,delete o._defaultAgent,delete o.defaultPort,delete o.createConnection,i._last=!0,i.shouldKeepAlive=!1;let a=!1,c=null,u=this.timeout,p=this.freeSocket;function l(m){i._hadError||(i.emit("error",m),i._hadError=!0)}function d(){c=null,a=!0;let m=new Error(`A "socket" was not created for HTTP request before ${u}ms`);m.code="ETIMEOUT",l(m)}function f(m){a||(c!==null&&(clearTimeout(c),c=null),l(m))}function g(m){let y;function w(){p(y,o)}if(a)return;if(c!=null&&(clearTimeout(c),c=null),lB(m)||hB(m)){m.addRequest(i,o);return}if(m){y=m,y.on("free",w),i.onSocket(y);return}let b=new Error(`no Duplex stream was returned to agent-base for \`${i.method} ${i.path}\``);l(b)}if(typeof this.callback!="function"){l(new Error("`callback` is not defined"));return}this.promisifiedCallback||(this.callback.length>=3?this.promisifiedCallback=pB.default(this.callback):this.promisifiedCallback=this.callback),typeof u=="number"&&u>0&&(c=setTimeout(d,u)),"port"in o&&typeof o.port!="number"&&(o.port=Number(o.port));try{Promise.resolve(this.promisifiedCallback(i,o)).then(g,f)}catch(m){Promise.reject(m).catch(f)}}freeSocket(i,n){i.destroy()}destroy(){}}r.Agent=e})(eo||(eo={}));eo.prototype=eo.Agent.prototype;FA.exports=eo});var $A=h((e$,VA)=>{"use strict";var UA=Ng(),WA=jg(),dB=UE(),fB=Hp(),HA=BA(),vB=An().inherits,Dn=zg()("https-proxy-agent");VA.exports=qa;function qa(r){if(!(this instanceof qa))return new qa(r);if(typeof r=="string"&&(r=dB.parse(r)),!r)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");Dn("creating new HttpsProxyAgent instance: %o",r),HA.call(this,r);var e=Object.assign({},r);this.secureProxy=e.protocol?/^https:?$/i.test(e.protocol):!1,e.host=e.hostname||e.host,e.port=+e.port||(this.secureProxy?443:80),this.secureProxy&&!("ALPNProtocols"in e)&&(e.ALPNProtocols=["http 1.1"]),e.host&&e.path&&(delete e.path,delete e.pathname),this.proxy=e}vB(qa,HA);qa.prototype.callback=function(e,t,i){var n=this.proxy,s;this.secureProxy?s=WA.connect(n):s=UA.connect(n);var o=[],a=0;function c(){var C=s.read();C?f(C):s.once("readable",c)}function u(){s.removeListener("end",l),s.removeListener("error",d),s.removeListener("close",p),s.removeListener("readable",c)}function p(C){Dn("onclose had error %o",C)}function l(){Dn("onend")}function d(C){u(),i(C)}function f(C){o.push(C),a+=C.length;var R=Buffer.concat(o,a),A=R.toString("ascii");if(!~A.indexOf(`\r
\r
`)){Dn("have not received end of HTTP headers yet..."),c();return}var D=A.substring(0,A.indexOf(`\r
`)),ee=+D.split(" ")[1];if(Dn("got proxy server response: %o",D),ee==200){var $=s;o=R=null,t.secureEndpoint&&(Dn("upgrading proxy-connected socket to TLS connection: %o",t.host),t.socket=s,t.servername=t.servername||t.host,t.host=null,t.hostname=null,t.port=null,$=WA.connect(t)),u(),e.once("socket",gB),i(null,$)}else u(),s.destroy(),s=new UA.Socket,s.readable=!0,o=R,e.once("socket",g),i(null,s)}function g(C){Dn("replaying proxy buffer for failed request"),fB(C.listenerCount("data")>0),C.push(o),o=null}s.on("error",d),s.on("close",p),s.on("end",l),c();var m=t.host+":"+t.port,y="CONNECT "+m+` HTTP/1.1\r
`,w=Object.assign({},n.headers);n.auth&&(w["Proxy-Authorization"]="Basic "+Buffer.from(n.auth).toString("base64"));var b=t.host;mB(t.port,t.secureEndpoint)||(b+=":"+t.port),w.Host=b,w.Connection="close",Object.keys(w).forEach(function(C){y+=C+": "+w[C]+`\r
`}),s.write(y+`\r
`)};function gB(r){r.resume()}function mB(r,e){return!!(!e&&r===80||e&&r===443)}});var GA=h((t$,KA)=>{"use strict";KA.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}});var py=h(nr=>{"use strict";var yB=nr&&nr.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),SB=nr&&nr.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),JA=nr&&nr.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.hasOwnProperty.call(r,t)&&yB(e,r,t);return SB(e,r),e},uy=nr&&nr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(nr,"__esModule",{value:!0});nr.WebsocketMessageAdapter=void 0;var CB=JA(Ng()),bB=JA(jg()),PB=uy(UR()),wB=uy($A()),_B=uy(GA()),RB=ot(),B=x(),al=class r{constructor(e,t,i,n,s,o){if(!e)throw new B.ArgumentNullError("uri");if(!i)throw new B.ArgumentNullError("messageFormatter");this.proxyInfo=n,this.privConnectionEvents=new B.EventSource,this.privConnectionId=t,this.privMessageFormatter=i,this.privConnectionState=B.ConnectionState.None,this.privUri=e,this.privHeaders=s,this.privEnableCompression=o,this.privHeaders[RB.HeaderNames.ConnectionId]=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===B.ConnectionState.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new B.Deferred,this.privCertificateValidatedDeferral=new B.Deferred,this.privConnectionState=B.ConnectionState.Connecting;try{if(typeof WebSocket<"u"&&!r.forceNpmWebSocket)this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);else{let e={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression};this.privCertificateValidatedDeferral.resolve(),e.agent=this.getAgent();let i=new URL(this.privUri).protocol;i?.toLocaleLowerCase()==="wss:"?i="https:":i?.toLocaleLowerCase()==="ws:"&&(i="http:"),e.agent.protocol=i,this.privWebsocketClient=new _B.default(this.privUri,e)}this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new B.Queue,this.privDisconnectDeferral=new B.Deferred,this.privSendMessageQueue=new B.Queue,this.processSendQueue().catch(e=>{B.Events.instance.onEvent(new B.BackgroundEvent(e))})}catch(e){return this.privConnectionEstablishDeferral.resolve(new B.ConnectionOpenResponse(500,e)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new B.ConnectionStartEvent(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then(()=>{this.privConnectionState=B.ConnectionState.Connected,this.onEvent(new B.ConnectionEstablishedEvent(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new B.ConnectionOpenResponse(200,""))},e=>{this.privConnectionEstablishDeferral.reject(e)})},this.privWebsocketClient.onerror=e=>{this.onEvent(new B.ConnectionErrorEvent(this.privConnectionId,e.message,e.type)),this.privLastErrorReceived=e.message},this.privWebsocketClient.onclose=e=>{this.privConnectionState===B.ConnectionState.Connecting?(this.privConnectionState=B.ConnectionState.Disconnected,this.privConnectionEstablishDeferral.resolve(new B.ConnectionOpenResponse(e.code,e.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=B.ConnectionState.Disconnected,this.privWebsocketClient=null,this.onEvent(new B.ConnectionClosedEvent(this.privConnectionId,e.code,e.reason))),this.onClose(e.code,e.reason).catch(t=>{B.Events.instance.onEvent(new B.BackgroundEvent(t))})},this.privWebsocketClient.onmessage=e=>{let t=new Date().toISOString();if(this.privConnectionState===B.ConnectionState.Connected){let i=new B.Deferred;if(this.privReceivingMessageQueue.enqueueFromPromise(i.promise),e.data instanceof ArrayBuffer){let n=new B.RawWebsocketMessage(B.MessageType.Binary,e.data);this.privMessageFormatter.toConnectionMessage(n).then(s=>{this.onEvent(new B.ConnectionMessageReceivedEvent(this.privConnectionId,t,s)),i.resolve(s)},s=>{i.reject(`Invalid binary message format. Error: ${s}`)})}else{let n=new B.RawWebsocketMessage(B.MessageType.Text,e.data);this.privMessageFormatter.toConnectionMessage(n).then(s=>{this.onEvent(new B.ConnectionMessageReceivedEvent(this.privConnectionId,t,s)),i.resolve(s)},s=>{i.reject(`Invalid text message format. Error: ${s}`)})}}},this.privConnectionEstablishDeferral.promise}send(e){if(this.privConnectionState!==B.ConnectionState.Connected)return Promise.reject(`Cannot send on connection that is in ${B.ConnectionState[this.privConnectionState]} state`);let t=new B.Deferred,i=new B.Deferred;return this.privSendMessageQueue.enqueueFromPromise(i.promise),this.privMessageFormatter.fromConnectionMessage(e).then(n=>{i.resolve({Message:e,RawWebsocketMessage:n,sendStatusDeferral:t})},n=>{i.reject(`Error formatting the message. ${n}`)}),t.promise}read(){return this.privConnectionState!==B.ConnectionState.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(e){if(this.privWebsocketClient)this.privConnectionState!==B.ConnectionState.Disconnected&&this.privWebsocketClient.close(1e3,e||"Normal closure by client");else return Promise.resolve();return this.privDisconnectDeferral.promise}get events(){return this.privConnectionEvents}sendRawMessage(e){try{if(!e)return Promise.resolve();if(this.onEvent(new B.ConnectionMessageSentEvent(this.privConnectionId,new Date().toISOString(),e.Message)),this.isWebsocketOpen)this.privWebsocketClient.send(e.RawWebsocketMessage.payload);else return Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+e.Message.id+" "+new Error().stack);return Promise.resolve()}catch(t){return Promise.reject(`websocket send error: ${t}`)}}onClose(e,t){return v(this,null,function*(){let i=`Connection closed. ${e}: ${t}`;this.privConnectionState=B.ConnectionState.Disconnected,this.privDisconnectDeferral.resolve(),yield this.privReceivingMessageQueue.drainAndDispose(()=>{},i),yield this.privSendMessageQueue.drainAndDispose(n=>{n.sendStatusDeferral.reject(i)},i)})}processSendQueue(){return v(this,null,function*(){for(;;){let t=yield this.privSendMessageQueue.dequeue();if(!t)return;try{yield this.sendRawMessage(t),t.sendStatusDeferral.resolve()}catch(i){t.sendStatusDeferral.reject(i)}}})}onEvent(e){this.privConnectionEvents.onEvent(e),B.Events.instance.onEvent(e)}getAgent(){let e=new PB.default.Agent(this.createConnection);return this.proxyInfo!==void 0&&this.proxyInfo.HostName!==void 0&&this.proxyInfo.Port>0&&(e.proxyInfo=this.proxyInfo),e}static GetProxyAgent(e){let t={host:e.HostName,port:e.Port};return e.UserName?t.headers={"Proxy-Authentication":"Basic "+new Buffer(`${e.UserName}:${e.Password===void 0?"":e.Password}`).toString("base64")}:t.headers={},t.headers.requestOCSP="true",new wB.default(t)}createConnection(e,t){let i;if(t=Vf(mr({},t),{requestOCSP:!0,servername:t.host}),this.proxyInfo){let s=r.GetProxyAgent(this.proxyInfo);i=new Promise((o,a)=>{s.callback(e,t,(c,u)=>{c?a(c):o(u)})})}else t.secureEndpoint?i=Promise.resolve(bB.connect(t)):i=Promise.resolve(CB.connect(t));return i}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}};nr.WebsocketMessageAdapter=al;al.forceNpmWebSocket=!1});var YA=h(cl=>{"use strict";Object.defineProperty(cl,"__esModule",{value:!0});cl.WebsocketConnection=void 0;var ly=x(),EB=py(),hy=class{constructor(e,t,i,n,s,o=!1,a){if(this.privIsDisposed=!1,!e)throw new ly.ArgumentNullError("uri");if(!n)throw new ly.ArgumentNullError("messageFormatter");this.privMessageFormatter=n;let c="",u=0;if(t){for(let p in t)if(p){c+=u===0&&e.indexOf("?")===-1?"?":"&";let l=encodeURIComponent(p);c+=l;let d=t[p];d&&(d=encodeURIComponent(d),c+=`=${d}`),u++}}if(i){for(let p in i)if(p){c+=u===0&&e.indexOf("?")===-1?"?":"&";let l=encodeURIComponent(i[p]);c+=`${p}=${l}`,u++}}this.privUri=e+c,this.privId=a||ly.createNoDashGuid(),this.privConnectionMessageAdapter=new EB.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,s,i,o)}dispose(){return v(this,null,function*(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&(yield this.privConnectionMessageAdapter.close())})}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(e){return this.privConnectionMessageAdapter.send(e)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}};cl.WebsocketConnection=hy});var QA=h(ul=>{"use strict";Object.defineProperty(ul,"__esModule",{value:!0});ul.ReplayableAudioNode=void 0;var dy=class{constructor(e,t){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=e,this.privBytesPerSecond=t}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&this.privBuffers.length!==0){let e=this.privReplayOffset-this.privBufferStartOffset,t=Math.round(e*this.privBytesPerSecond*1e-7);t%2!==0&&t++;let i=0;for(;i<this.privBuffers.length&&t>=this.privBuffers[i].chunk.buffer.byteLength;)t-=this.privBuffers[i++].chunk.buffer.byteLength;if(i<this.privBuffers.length){let n=this.privBuffers[i].chunk.buffer.slice(t);return this.privReplayOffset+=n.byteLength/this.privBytesPerSecond*1e7,i===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:n,isEnd:!1,timeReceived:this.privBuffers[i].chunk.timeReceived})}}return this.privAudioNode.read().then(e=>(e&&e.buffer&&(this.privBuffers.push(new fy(e,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=e.buffer.byteLength),e))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&this.privBuffers.length!==0&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(e){if(this.privBuffers===void 0||this.privBuffers.length===0)return;this.privLastShrinkOffset=e;let t=e-this.privBufferStartOffset,i=Math.round(t*this.privBytesPerSecond*1e-7),n=0;for(;n<this.privBuffers.length&&i>=this.privBuffers[n].chunk.buffer.byteLength;)i-=this.privBuffers[n++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(e-i/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(n)}findTimeAtOffset(e){if(e<this.privBufferStartOffset||this.privBuffers===void 0)return 0;for(let t of this.privBuffers){let i=t.byteOffset/this.privBytesPerSecond*1e7,n=i+t.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(e>=i&&e<=n)return t.chunk.timeReceived}return 0}};ul.ReplayableAudioNode=dy;var fy=class{constructor(e,t,i){this.chunk=e,this.serial=t,this.byteOffset=i}}});var my=h(Vr=>{"use strict";var IB=Vr&&Vr.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),TB=Vr&&Vr.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),AB=Vr&&Vr.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.hasOwnProperty.call(r,t)&&IB(e,r,t);return TB(e,r),e};Object.defineProperty(Vr,"__esModule",{value:!0});Vr.AudioFileWriter=void 0;var za=AB(Ag()),vy=j(),gy=class{constructor(e){vy.Contracts.throwIfNullOrUndefined(za.openSync,`
File System access not available, please use Push or PullAudioOutputStream`),this.privFd=za.openSync(e,"w")}set format(e){vy.Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=e;let t=0;this.privAudioFormat.hasHeader&&(t=this.privAudioFormat.header.byteLength),this.privFd!==void 0&&(this.privWriteStream=za.createWriteStream("",{fd:this.privFd,start:t,autoClose:!1}))}write(e){vy.Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),this.privWriteStream!==void 0&&this.privWriteStream.write(new Uint8Array(e.slice(0)))}close(){this.privFd!==void 0&&(this.privWriteStream.on("finish",()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),za.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),za.closeSync(this.privFd),this.privFd=void 0}),this.privWriteStream.end())}id(){return this.privId}};Vr.AudioFileWriter=gy});var yy=h(sr=>{"use strict";Object.defineProperty(sr,"__esModule",{value:!0});sr.PullAudioInputStreamImpl=sr.PullAudioInputStream=sr.PushAudioInputStreamImpl=sr.PushAudioInputStream=sr.AudioInputStream=void 0;var pl=T(),$e=x(),XA=Ni(),OB=P(),DB=qi(),Fa=class{constructor(){}static createPushStream(e){return Ba.create(e)}static createPullStream(e,t){return Ua.create(e,t)}};sr.AudioInputStream=Fa;var Ba=class extends Fa{static create(e){return new ll(e)}};sr.PushAudioInputStream=Ba;var ll=class extends Ba{constructor(e){super(),e===void 0?this.privFormat=DB.AudioStreamFormatImpl.getDefaultInputFormat():this.privFormat=e,this.privEvents=new $e.EventSource,this.privId=XA.createNoDashGuid(),this.privStream=new $e.ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(e){this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new $e.AudioSourceInitializingEvent(this.privId)),this.onEvent(new $e.AudioSourceReadyEvent(this.privId))}attach(e){return v(this,null,function*(){this.onEvent(new $e.AudioStreamNodeAttachingEvent(this.privId,e)),yield this.turnOn();let t=this.privStream;return this.onEvent(new $e.AudioStreamNodeAttachedEvent(this.privId,e)),{detach:()=>v(this,null,function*(){return this.onEvent(new $e.AudioStreamNodeDetachedEvent(this.privId,e)),this.turnOff()}),id:()=>e,read:()=>t.read()}})}detach(e){this.onEvent(new $e.AudioStreamNodeDetachedEvent(this.privId,e))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:pl.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:pl.type.Stream})}onEvent(e){this.privEvents.onEvent(e),$e.Events.instance.onEvent(e)}toBuffer(e){let t=Buffer.alloc(e.byteLength),i=new Uint8Array(e);for(let n=0;n<t.length;++n)t[n]=i[n];return t}};sr.PushAudioInputStreamImpl=ll;var Ua=class extends Fa{constructor(){super()}static create(e,t){return new hl(e,t)}};sr.PullAudioInputStream=Ua;var hl=class extends Ua{constructor(e,t){super(),t===void 0?this.privFormat=OB.AudioStreamFormat.getDefaultInputFormat():this.privFormat=t,this.privEvents=new $e.EventSource,this.privId=XA.createNoDashGuid(),this.privCallback=e,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new $e.AudioSourceInitializingEvent(this.privId)),this.onEvent(new $e.AudioSourceReadyEvent(this.privId))}attach(e){return v(this,null,function*(){return this.onEvent(new $e.AudioStreamNodeAttachingEvent(this.privId,e)),yield this.turnOn(),this.onEvent(new $e.AudioStreamNodeAttachedEvent(this.privId,e)),{detach:()=>(this.privCallback.close(),this.onEvent(new $e.AudioStreamNodeDetachedEvent(this.privId,e)),this.turnOff()),id:()=>e,read:()=>{let t=0,i;for(;t<this.privBufferSize;){let n=new ArrayBuffer(this.privBufferSize-t),s=this.privCallback.read(n);if(i===void 0?i=n:new Int8Array(i).set(new Int8Array(n),t),s===0)break;t+=s}return Promise.resolve({buffer:i.slice(0,t),isEnd:this.privIsClosed||t===0,timeReceived:Date.now()})}}})}detach(e){this.onEvent(new $e.AudioStreamNodeDetachedEvent(this.privId,e))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:pl.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:pl.type.Stream})}onEvent(e){this.privEvents.onEvent(e),$e.Events.instance.onEvent(e)}};sr.PullAudioInputStreamImpl=hl});var Sy=h(Wa=>{"use strict";Object.defineProperty(Wa,"__esModule",{value:!0});Wa.SpeechSynthesisOutputFormat=void 0;var xB;(function(r){r[r.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",r[r.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",r[r.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",r[r.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",r[r.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",r[r.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",r[r.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",r[r.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",r[r.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",r[r.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",r[r.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",r[r.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",r[r.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",r[r.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",r[r.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",r[r.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",r[r.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",r[r.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",r[r.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",r[r.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",r[r.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",r[r.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",r[r.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",r[r.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",r[r.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",r[r.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",r[r.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",r[r.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",r[r.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",r[r.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",r[r.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",r[r.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",r[r.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",r[r.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",r[r.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",r[r.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",r[r.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm",r[r.AmrWb16000Hz=37]="AmrWb16000Hz",r[r.G72216Khz64Kbps=38]="G72216Khz64Kbps"})(xB=Wa.SpeechSynthesisOutputFormat||(Wa.SpeechSynthesisOutputFormat={}))});var to=h(fl=>{"use strict";Object.defineProperty(fl,"__esModule",{value:!0});fl.AudioOutputFormatImpl=void 0;var V=Sy(),U=qi(),dl=class r extends U.AudioStreamFormatImpl{constructor(e,t,i,n,s,o,a,c,u){super(i,o,t,e),this.formatTag=e,this.avgBytesPerSec=n,this.blockAlign=s,this.priAudioFormatString=a,this.priRequestAudioFormatString=c,this.priHasHeader=u}static fromSpeechSynthesisOutputFormat(e){return e===void 0?r.getDefaultOutputFormat():r.fromSpeechSynthesisOutputFormatString(r.SpeechSynthesisOutputFormatToString[e])}static fromSpeechSynthesisOutputFormatString(e){switch(e){case"raw-8khz-8bit-mono-mulaw":return new r(U.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,e,e,!1);case"riff-16khz-16kbps-mono-siren":return new r(U.AudioFormatTag.Siren,1,16e3,2e3,40,0,e,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new r(U.AudioFormatTag.Siren,1,16e3,2e3,40,0,e,e,!1);case"audio-16khz-32kbitrate-mono-mp3":return new r(U.AudioFormatTag.MP3,1,16e3,4096,2,16,e,e,!1);case"audio-16khz-128kbitrate-mono-mp3":return new r(U.AudioFormatTag.MP3,1,16e3,16384,2,16,e,e,!1);case"audio-16khz-64kbitrate-mono-mp3":return new r(U.AudioFormatTag.MP3,1,16e3,8192,2,16,e,e,!1);case"audio-24khz-48kbitrate-mono-mp3":return new r(U.AudioFormatTag.MP3,1,24e3,6144,2,16,e,e,!1);case"audio-24khz-96kbitrate-mono-mp3":return new r(U.AudioFormatTag.MP3,1,24e3,12288,2,16,e,e,!1);case"audio-24khz-160kbitrate-mono-mp3":return new r(U.AudioFormatTag.MP3,1,24e3,20480,2,16,e,e,!1);case"raw-16khz-16bit-mono-truesilk":return new r(U.AudioFormatTag.SILKSkype,1,16e3,32e3,2,16,e,e,!1);case"riff-8khz-16bit-mono-pcm":return new r(U.AudioFormatTag.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new r(U.AudioFormatTag.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new r(U.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new r(U.AudioFormatTag.PCM,1,16e3,32e3,2,16,e,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new r(U.AudioFormatTag.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new r(U.AudioFormatTag.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new r(U.AudioFormatTag.OGG_OPUS,1,16e3,8192,2,16,e,e,!1);case"ogg-24khz-16bit-mono-opus":return new r(U.AudioFormatTag.OGG_OPUS,1,24e3,8192,2,16,e,e,!1);case"raw-48khz-16bit-mono-pcm":return new r(U.AudioFormatTag.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new r(U.AudioFormatTag.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new r(U.AudioFormatTag.MP3,1,48e3,12288,2,16,e,e,!1);case"audio-48khz-192kbitrate-mono-mp3":return new r(U.AudioFormatTag.MP3,1,48e3,24576,2,16,e,e,!1);case"ogg-48khz-16bit-mono-opus":return new r(U.AudioFormatTag.OGG_OPUS,1,48e3,12e3,2,16,e,e,!1);case"webm-16khz-16bit-mono-opus":return new r(U.AudioFormatTag.WEBM_OPUS,1,16e3,4e3,2,16,e,e,!1);case"webm-24khz-16bit-mono-opus":return new r(U.AudioFormatTag.WEBM_OPUS,1,24e3,6e3,2,16,e,e,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new r(U.AudioFormatTag.WEBM_OPUS,1,24e3,3e3,2,16,e,e,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new r(U.AudioFormatTag.OPUS,1,16e3,4e3,2,16,e,e,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new r(U.AudioFormatTag.OPUS,1,24e3,6e3,2,16,e,e,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new r(U.AudioFormatTag.OPUS,1,24e3,3e3,2,16,e,e,!1);case"audio-24khz-16bit-mono-flac":return new r(U.AudioFormatTag.FLAC,1,24e3,24e3,2,16,e,e,!1);case"audio-48khz-16bit-mono-flac":return new r(U.AudioFormatTag.FLAC,1,48e3,3e4,2,16,e,e,!1);case"raw-24khz-16bit-mono-truesilk":return new r(U.AudioFormatTag.SILKSkype,1,24e3,48e3,2,16,e,e,!1);case"raw-8khz-8bit-mono-alaw":return new r(U.AudioFormatTag.ALaw,1,8e3,8e3,1,8,e,e,!1);case"riff-8khz-8bit-mono-alaw":return new r(U.AudioFormatTag.ALaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new r(U.AudioFormatTag.PCM,1,22050,44100,2,16,e,e,!1);case"riff-22050hz-16bit-mono-pcm":return new r(U.AudioFormatTag.PCM,1,22050,44100,2,16,e,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new r(U.AudioFormatTag.PCM,1,44100,88200,2,16,e,e,!1);case"riff-44100hz-16bit-mono-pcm":return new r(U.AudioFormatTag.PCM,1,44100,88200,2,16,e,"raw-44100hz-16bit-mono-pcm",!0);case"amr-wb-16000h":return new r(U.AudioFormatTag.AMR_WB,1,16e3,3052,2,16,e,e,!1);case"g722-16khz-64kbps":return new r(U.AudioFormatTag.G722,1,16e3,8e3,2,16,e,e,!1);case"riff-16khz-16bit-mono-pcm":default:return new r(U.AudioFormatTag.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return r.fromSpeechSynthesisOutputFormatString(typeof window<"u"?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(e){if(this.priHasHeader){let t=new DataView(this.privHeader);t.setUint32(4,e+this.privHeader.byteLength-8,!0),t.setUint32(40,e,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}addHeader(e){if(!this.hasHeader)return e;this.updateHeader(e.byteLength);let t=new Uint8Array(e.byteLength+this.header.byteLength);return t.set(new Uint8Array(this.header),0),t.set(new Uint8Array(e),this.header.byteLength),t.buffer}};fl.AudioOutputFormatImpl=dl;dl.SpeechSynthesisOutputFormatToString={[V.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[V.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[V.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[V.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[V.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[V.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[V.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[V.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[V.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[V.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[V.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[V.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[V.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[V.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[V.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[V.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[V.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[V.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[V.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[V.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[V.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[V.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[V.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[V.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[V.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[V.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[V.SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[V.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[V.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[V.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[V.SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[V.SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[V.SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[V.SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[V.SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[V.SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[V.SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm",[V.SpeechSynthesisOutputFormat.AmrWb16000Hz]:"amr-wb-16000hz",[V.SpeechSynthesisOutputFormat.G72216Khz64Kbps]:"g722-16khz-64kbps"}});var xn=h(or=>{"use strict";Object.defineProperty(or,"__esModule",{value:!0});or.PushAudioOutputStreamImpl=or.PushAudioOutputStream=or.PullAudioOutputStreamImpl=or.PullAudioOutputStream=or.AudioOutputStream=void 0;var Cy=x(),MB=j(),kB=to(),Ha=class{constructor(){}static createPullStream(){return Va.create()}};or.AudioOutputStream=Ha;var Va=class extends Ha{static create(){return new vl}};or.PullAudioOutputStream=Va;var vl=class extends Va{constructor(){super(),this.privId=Cy.createNoDashGuid(),this.privStream=new Cy.Stream}set format(e){e==null&&(this.privFormat=kB.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=e}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}read(e){return v(this,null,function*(){let t=new Int8Array(e),i=0;if(this.privLastChunkView!==void 0){if(this.privLastChunkView.length>e.byteLength)return t.set(this.privLastChunkView.slice(0,e.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(e.byteLength),Promise.resolve(e.byteLength);t.set(this.privLastChunkView),i=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;i<e.byteLength&&!this.privStream.isReadEnded;){let n=yield this.privStream.read();if(n!==void 0&&!n.isEnd){let s;n.buffer.byteLength>e.byteLength-i?(s=n.buffer.slice(0,e.byteLength-i),this.privLastChunkView=new Int8Array(n.buffer.slice(e.byteLength-i))):s=n.buffer,t.set(new Int8Array(s),i),i+=s.byteLength}else this.privStream.readEnded()}return i})}write(e){MB.Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}};or.PullAudioOutputStreamImpl=vl;var gl=class extends Ha{constructor(){super()}static create(e){return new ml(e)}};or.PushAudioOutputStream=gl;var ml=class extends gl{constructor(e){super(),this.privId=Cy.createNoDashGuid(),this.privCallback=e}set format(e){}write(e){this.privCallback.write&&this.privCallback.write(e)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}};or.PushAudioOutputStreamImpl=ml});var by=h($i=>{"use strict";Object.defineProperty($i,"__esModule",{value:!0});$i.AudioOutputConfigImpl=$i.AudioConfigImpl=$i.AudioConfig=void 0;var Mn=Le(),NB=j(),kn=P(),jB=my(),LB=yy(),qB=xn(),$a=class r{static fromDefaultMicrophoneInput(){let e=new Mn.PcmRecorder(!0);return new hi(new Mn.MicAudioSource(e))}static fromMicrophoneInput(e){let t=new Mn.PcmRecorder(!0);return new hi(new Mn.MicAudioSource(t,e))}static fromWavFileInput(e,t="unnamedBuffer.wav"){return new hi(new Mn.FileAudioSource(e,t))}static fromStreamInput(e){if(e instanceof kn.PullAudioInputStreamCallback)return new hi(new LB.PullAudioInputStreamImpl(e));if(e instanceof kn.AudioInputStream)return new hi(e);if(typeof MediaStream<"u"&&e instanceof MediaStream){let t=new Mn.PcmRecorder(!1);return new hi(new Mn.MicAudioSource(t,null,null,e))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new di(new kn.SpeakerAudioDestination)}static fromSpeakerOutput(e){if(e===void 0)return r.fromDefaultSpeakerOutput();if(e instanceof kn.SpeakerAudioDestination)return new di(e);throw new Error("Not Supported Type")}static fromAudioFileOutput(e){return new di(new jB.AudioFileWriter(e))}static fromStreamOutput(e){if(e instanceof kn.PushAudioOutputStreamCallback)return new di(new qB.PushAudioOutputStreamImpl(e));if(e instanceof kn.PushAudioOutputStream)return new di(e);if(e instanceof kn.PullAudioOutputStream)return new di(e);throw new Error("Not Supported Type")}};$i.AudioConfig=$a;var hi=class extends $a{constructor(e){super(),this.privSource=e}get format(){return this.privSource.format}close(e,t){this.privSource.turnOff().then(()=>{e&&e()},i=>{t&&t(i)})}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(e){return this.privSource.attach(e)}detach(e){return this.privSource.detach(e)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(e,t){if(NB.Contracts.throwIfNull(t,"value"),this.privSource.setProperty!==void 0)this.privSource.setProperty(e,t);else throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(e,t){if(this.privSource.getProperty!==void 0)return this.privSource.getProperty(e,t);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}};$i.AudioConfigImpl=hi;var di=class extends $a{constructor(e){super(),this.privDestination=e}set format(e){this.privDestination.format=e}write(e){this.privDestination.write(e)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}};$i.AudioOutputConfigImpl=di});var ZA=h(Ka=>{"use strict";Object.defineProperty(Ka,"__esModule",{value:!0});Ka.CancellationReason=void 0;var zB;(function(r){r[r.Error=0]="Error",r[r.EndOfStream=1]="EndOfStream"})(zB=Ka.CancellationReason||(Ka.CancellationReason={}))});var e1=h(yl=>{"use strict";Object.defineProperty(yl,"__esModule",{value:!0});yl.PullAudioInputStreamCallback=void 0;var Py=class{};yl.PullAudioInputStreamCallback=Py});var t1=h(Sl=>{"use strict";Object.defineProperty(Sl,"__esModule",{value:!0});Sl.PushAudioOutputStreamCallback=void 0;var wy=class{};Sl.PushAudioOutputStreamCallback=wy});var i1=h(Cl=>{"use strict";Object.defineProperty(Cl,"__esModule",{value:!0});Cl.KeywordRecognitionModel=void 0;var r1=j(),_y=class{constructor(){this.privDisposed=!1}static fromFile(e){throw r1.Contracts.throwIfFileDoesNotExist(e,"fileName"),new Error("Not yet implemented.")}static fromStream(e){throw r1.Contracts.throwIfNull(e,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}};Cl.KeywordRecognitionModel=_y});var n1=h(bl=>{"use strict";Object.defineProperty(bl,"__esModule",{value:!0});bl.SessionEventArgs=void 0;var Ry=class{constructor(e){this.privSessionId=e}get sessionId(){return this.privSessionId}};bl.SessionEventArgs=Ry});var s1=h(Pl=>{"use strict";Object.defineProperty(Pl,"__esModule",{value:!0});Pl.RecognitionEventArgs=void 0;var FB=P(),Ey=class extends FB.SessionEventArgs{constructor(e,t){super(t),this.privOffset=e}get offset(){return this.privOffset}};Pl.RecognitionEventArgs=Ey});var o1=h(Ga=>{"use strict";Object.defineProperty(Ga,"__esModule",{value:!0});Ga.OutputFormat=void 0;var BB;(function(r){r[r.Simple=0]="Simple",r[r.Detailed=1]="Detailed"})(BB=Ga.OutputFormat||(Ga.OutputFormat={}))});var a1=h(wl=>{"use strict";Object.defineProperty(wl,"__esModule",{value:!0});wl.IntentRecognitionEventArgs=void 0;var UB=P(),Iy=class extends UB.RecognitionEventArgs{constructor(e,t,i){super(t,i),this.privResult=e}get result(){return this.privResult}};wl.IntentRecognitionEventArgs=Iy});var c1=h(_l=>{"use strict";Object.defineProperty(_l,"__esModule",{value:!0});_l.RecognitionResult=void 0;var Ty=class{constructor(e,t,i,n,s,o,a,c,u,p){this.privResultId=e,this.privReason=t,this.privText=i,this.privDuration=n,this.privOffset=s,this.privLanguage=o,this.privLanguageDetectionConfidence=a,this.privErrorDetails=c,this.privJson=u,this.privProperties=p}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}};_l.RecognitionResult=Ty});var u1=h(Rl=>{"use strict";Object.defineProperty(Rl,"__esModule",{value:!0});Rl.SpeechRecognitionResult=void 0;var WB=P(),Ay=class extends WB.RecognitionResult{constructor(e,t,i,n,s,o,a,c,u,p,l){super(e,t,i,n,s,o,a,u,p,l),this.privSpeakerId=c}get speakerId(){return this.privSpeakerId}};Rl.SpeechRecognitionResult=Ay});var p1=h(El=>{"use strict";Object.defineProperty(El,"__esModule",{value:!0});El.IntentRecognitionResult=void 0;var HB=P(),Oy=class extends HB.SpeechRecognitionResult{constructor(e,t,i,n,s,o,a,c,u,p,l){super(t,i,n,s,o,a,c,void 0,u,p,l),this.privIntentId=e}get intentId(){return this.privIntentId}};El.IntentRecognitionResult=Oy});var l1=h(no=>{"use strict";Object.defineProperty(no,"__esModule",{value:!0});no.LanguageUnderstandingModelImpl=no.LanguageUnderstandingModel=void 0;var ro=j(),Il=class{constructor(){}static fromEndpoint(e){ro.Contracts.throwIfNull(e,"uri"),ro.Contracts.throwIfNullOrWhitespace(e.hostname,"uri");let t=new io,i=e.host.indexOf(".");if(i===-1)throw new Error("Could not determine region from endpoint");t.region=e.host.substr(0,i);let n=e.pathname.lastIndexOf("/")+1;if(n===-1)throw new Error("Could not determine appId from endpoint");if(t.appId=e.pathname.substr(n),t.subscriptionKey=e.searchParams.get("subscription-key"),t.subscriptionKey===void 0)throw new Error("Could not determine subscription key from endpoint");return t}static fromAppId(e){ro.Contracts.throwIfNullOrWhitespace(e,"appId");let t=new io;return t.appId=e,t}static fromSubscription(e,t,i){ro.Contracts.throwIfNullOrWhitespace(e,"subscriptionKey"),ro.Contracts.throwIfNullOrWhitespace(t,"appId"),ro.Contracts.throwIfNullOrWhitespace(i,"region");let n=new io;return n.appId=t,n.region=i,n.subscriptionKey=e,n}};no.LanguageUnderstandingModel=Il;var io=class extends Il{};no.LanguageUnderstandingModelImpl=io});var d1=h(Ki=>{"use strict";Object.defineProperty(Ki,"__esModule",{value:!0});Ki.MeetingTranscriptionEventArgs=Ki.ConversationTranscriptionEventArgs=Ki.SpeechRecognitionEventArgs=void 0;var h1=P(),Tl=class extends h1.RecognitionEventArgs{constructor(e,t,i){super(t,i),this.privResult=e}get result(){return this.privResult}};Ki.SpeechRecognitionEventArgs=Tl;var Dy=class extends h1.RecognitionEventArgs{constructor(e,t,i){super(t,i),this.privResult=e}get result(){return this.privResult}};Ki.ConversationTranscriptionEventArgs=Dy;var xy=class extends Tl{};Ki.MeetingTranscriptionEventArgs=xy});var so=h(Al=>{"use strict";Object.defineProperty(Al,"__esModule",{value:!0});Al.CancellationEventArgsBase=void 0;var VB=P(),My=class extends VB.RecognitionEventArgs{constructor(e,t,i,n,s){super(n,s),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=i}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};Al.CancellationEventArgsBase=My});var f1=h(Ol=>{"use strict";Object.defineProperty(Ol,"__esModule",{value:!0});Ol.SpeechRecognitionCanceledEventArgs=void 0;var $B=so(),ky=class extends $B.CancellationEventArgsBase{};Ol.SpeechRecognitionCanceledEventArgs=ky});var v1=h(Dl=>{"use strict";Object.defineProperty(Dl,"__esModule",{value:!0});Dl.TranslationRecognitionEventArgs=void 0;var KB=P(),Ny=class extends KB.RecognitionEventArgs{constructor(e,t,i){super(t,i),this.privResult=e}get result(){return this.privResult}};Dl.TranslationRecognitionEventArgs=Ny});var g1=h(xl=>{"use strict";Object.defineProperty(xl,"__esModule",{value:!0});xl.TranslationSynthesisEventArgs=void 0;var GB=P(),jy=class extends GB.SessionEventArgs{constructor(e,t){super(t),this.privResult=e}get result(){return this.privResult}};xl.TranslationSynthesisEventArgs=jy});var qy=h(Ml=>{"use strict";Object.defineProperty(Ml,"__esModule",{value:!0});Ml.TranslationRecognitionResult=void 0;var JB=P(),Ly=class r extends JB.SpeechRecognitionResult{constructor(e,t,i,n,s,o,a,c,u,p,l){super(t,i,n,s,o,a,c,void 0,u,p,l),this.privTranslations=e}static fromSpeechRecognitionResult(e){return new r(void 0,e.resultId,e.reason,e.text,e.duration,e.offset,e.language,e.languageDetectionConfidence,e.errorDetails,e.json,e.properties)}get translations(){return this.privTranslations}};Ml.TranslationRecognitionResult=Ly});var m1=h(kl=>{"use strict";Object.defineProperty(kl,"__esModule",{value:!0});kl.TranslationSynthesisResult=void 0;var zy=class{constructor(e,t){this.privReason=e,this.privAudio=t}get audio(){return this.privAudio}get reason(){return this.privReason}};kl.TranslationSynthesisResult=zy});var y1=h(Ja=>{"use strict";Object.defineProperty(Ja,"__esModule",{value:!0});Ja.ResultReason=void 0;var YB;(function(r){r[r.NoMatch=0]="NoMatch",r[r.Canceled=1]="Canceled",r[r.RecognizingSpeech=2]="RecognizingSpeech",r[r.RecognizedSpeech=3]="RecognizedSpeech",r[r.RecognizedKeyword=4]="RecognizedKeyword",r[r.RecognizingIntent=5]="RecognizingIntent",r[r.RecognizedIntent=6]="RecognizedIntent",r[r.TranslatingSpeech=7]="TranslatingSpeech",r[r.TranslatedSpeech=8]="TranslatedSpeech",r[r.SynthesizingAudio=9]="SynthesizingAudio",r[r.SynthesizingAudioCompleted=10]="SynthesizingAudioCompleted",r[r.SynthesizingAudioStarted=11]="SynthesizingAudioStarted",r[r.EnrollingVoiceProfile=12]="EnrollingVoiceProfile",r[r.EnrolledVoiceProfile=13]="EnrolledVoiceProfile",r[r.RecognizedSpeakers=14]="RecognizedSpeakers",r[r.RecognizedSpeaker=15]="RecognizedSpeaker",r[r.ResetVoiceProfile=16]="ResetVoiceProfile",r[r.DeletedVoiceProfile=17]="DeletedVoiceProfile",r[r.VoicesListRetrieved=18]="VoicesListRetrieved",r[r.TranslatingParticipantSpeech=19]="TranslatingParticipantSpeech",r[r.TranslatedParticipantSpeech=20]="TranslatedParticipantSpeech",r[r.TranslatedInstantMessage=21]="TranslatedInstantMessage",r[r.TranslatedParticipantInstantMessage=22]="TranslatedParticipantInstantMessage"})(YB=Ja.ResultReason||(Ja.ResultReason={}))});var S1=h(oo=>{"use strict";Object.defineProperty(oo,"__esModule",{value:!0});oo.SpeechConfigImpl=oo.SpeechConfig=void 0;var Ya=T(),Nn=j(),z=P(),Nl=class{constructor(){}static fromSubscription(e,t){Nn.Contracts.throwIfNullOrWhitespace(e,"subscriptionKey"),Nn.Contracts.throwIfNullOrWhitespace(t,"region");let i=new jn;return i.setProperty(z.PropertyId.SpeechServiceConnection_Region,t),i.setProperty(z.PropertyId.SpeechServiceConnection_IntentRegion,t),i.setProperty(z.PropertyId.SpeechServiceConnection_Key,e),i}static fromEndpoint(e,t){Nn.Contracts.throwIfNull(e,"endpoint");let i=new jn;return i.setProperty(z.PropertyId.SpeechServiceConnection_Endpoint,e.href),t!==void 0&&i.setProperty(z.PropertyId.SpeechServiceConnection_Key,t),i}static fromHost(e,t){Nn.Contracts.throwIfNull(e,"hostName");let i=new jn;return i.setProperty(z.PropertyId.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(e.port===""?"":":"+e.port)),t!==void 0&&i.setProperty(z.PropertyId.SpeechServiceConnection_Key,t),i}static fromAuthorizationToken(e,t){Nn.Contracts.throwIfNull(e,"authorizationToken"),Nn.Contracts.throwIfNullOrWhitespace(t,"region");let i=new jn;return i.setProperty(z.PropertyId.SpeechServiceConnection_Region,t),i.setProperty(z.PropertyId.SpeechServiceConnection_IntentRegion,t),i.authorizationToken=e,i}close(){}};oo.SpeechConfig=Nl;var jn=class r extends Nl{constructor(){super(),this.privProperties=new z.PropertyCollection,this.speechRecognitionLanguage="en-US",this.outputFormat=z.OutputFormat.Simple}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(z.PropertyId.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(z.PropertyId.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(z.PropertyId.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(z.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.privProperties.setProperty(z.PropertyId.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return this.privProperties.getProperty(z.PropertyId.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(e){this.privProperties.setProperty(z.PropertyId.SpeechServiceConnection_RecoLanguage,e)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(z.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(e){this.privProperties.setProperty(z.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,e)}get outputFormat(){return z.OutputFormat[this.privProperties.getProperty(Ya.OutputFormatPropertyName,void 0)]}set outputFormat(e){this.privProperties.setProperty(Ya.OutputFormatPropertyName,z.OutputFormat[e])}get endpointId(){return this.privProperties.getProperty(z.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privProperties.setProperty(z.PropertyId.SpeechServiceConnection_EndpointId,e)}setProperty(e,t){Nn.Contracts.throwIfNull(t,"value"),this.privProperties.setProperty(e,t)}getProperty(e,t){return this.privProperties.getProperty(e,t)}setProxy(e,t,i,n){this.setProperty(z.PropertyId[z.PropertyId.SpeechServiceConnection_ProxyHostName],e),this.setProperty(z.PropertyId[z.PropertyId.SpeechServiceConnection_ProxyPort],t),this.setProperty(z.PropertyId[z.PropertyId.SpeechServiceConnection_ProxyUserName],i),this.setProperty(z.PropertyId[z.PropertyId.SpeechServiceConnection_ProxyPassword],n)}setServiceProperty(e,t){let i=JSON.parse(this.privProperties.getProperty(Ya.ServicePropertiesPropertyName,"{}"));i[e]=t,this.privProperties.setProperty(Ya.ServicePropertiesPropertyName,JSON.stringify(i))}setProfanity(e){this.privProperties.setProperty(z.PropertyId.SpeechServiceResponse_ProfanityOption,z.ProfanityOption[e])}enableAudioLogging(){this.privProperties.setProperty(z.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(z.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privProperties.setProperty(Ya.ForceDictationPropertyName,"true")}clone(){let e=new r;return e.privProperties=this.privProperties.clone(),e}get speechSynthesisLanguage(){return this.privProperties.getProperty(z.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(e){this.privProperties.setProperty(z.PropertyId.SpeechServiceConnection_SynthLanguage,e)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(z.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(e){this.privProperties.setProperty(z.PropertyId.SpeechServiceConnection_SynthVoice,e)}get speechSynthesisOutputFormat(){return z.SpeechSynthesisOutputFormat[this.privProperties.getProperty(z.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(e){this.privProperties.setProperty(z.PropertyId.SpeechServiceConnection_SynthOutputFormat,z.SpeechSynthesisOutputFormat[e])}};oo.SpeechConfigImpl=jn});var C1=h(ao=>{"use strict";Object.defineProperty(ao,"__esModule",{value:!0});ao.SpeechTranslationConfigImpl=ao.SpeechTranslationConfig=void 0;var Qa=T(),Rr=j(),k=P(),jl=class extends k.SpeechConfig{constructor(){super()}static fromSubscription(e,t){Rr.Contracts.throwIfNullOrWhitespace(e,"subscriptionKey"),Rr.Contracts.throwIfNullOrWhitespace(t,"region");let i=new Ln;return i.properties.setProperty(k.PropertyId.SpeechServiceConnection_Key,e),i.properties.setProperty(k.PropertyId.SpeechServiceConnection_Region,t),i}static fromAuthorizationToken(e,t){Rr.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),Rr.Contracts.throwIfNullOrWhitespace(t,"region");let i=new Ln;return i.properties.setProperty(k.PropertyId.SpeechServiceAuthorization_Token,e),i.properties.setProperty(k.PropertyId.SpeechServiceConnection_Region,t),i}static fromHost(e,t){Rr.Contracts.throwIfNull(e,"hostName");let i=new Ln;return i.setProperty(k.PropertyId.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(e.port===""?"":":"+e.port)),t!==void 0&&i.setProperty(k.PropertyId.SpeechServiceConnection_Key,t),i}static fromEndpoint(e,t){Rr.Contracts.throwIfNull(e,"endpoint"),Rr.Contracts.throwIfNull(t,"subscriptionKey");let i=new Ln;return i.properties.setProperty(k.PropertyId.SpeechServiceConnection_Endpoint,e.href),i.properties.setProperty(k.PropertyId.SpeechServiceConnection_Key,t),i}};ao.SpeechTranslationConfig=jl;var Ln=class extends jl{constructor(){super(),this.privSpeechProperties=new k.PropertyCollection,this.outputFormat=k.OutputFormat.Simple}set authorizationToken(e){Rr.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(k.PropertyId.SpeechServiceAuthorization_Token,e)}set speechRecognitionLanguage(e){Rr.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(k.PropertyId.SpeechServiceConnection_RecoLanguage,e)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(k.PropertyId[k.PropertyId.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(k.PropertyId[k.PropertyId.SpeechServiceConnection_Key])}get outputFormat(){return k.OutputFormat[this.privSpeechProperties.getProperty(Qa.OutputFormatPropertyName,void 0)]}set outputFormat(e){this.privSpeechProperties.setProperty(Qa.OutputFormatPropertyName,k.OutputFormat[e])}get endpointId(){return this.privSpeechProperties.getProperty(k.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privSpeechProperties.setProperty(k.PropertyId.SpeechServiceConnection_EndpointId,e)}addTargetLanguage(e){Rr.Contracts.throwIfNullOrWhitespace(e,"value");let t=this.targetLanguages;t.includes(e)||(t.push(e),this.privSpeechProperties.setProperty(k.PropertyId.SpeechServiceConnection_TranslationToLanguages,t.join(",")))}get targetLanguages(){return this.privSpeechProperties.getProperty(k.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?this.privSpeechProperties.getProperty(k.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(k.PropertyId[k.PropertyId.SpeechServiceConnection_TranslationVoice])}set voiceName(e){Rr.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(k.PropertyId.SpeechServiceConnection_TranslationVoice,e)}get region(){return this.privSpeechProperties.getProperty(k.PropertyId.SpeechServiceConnection_Region)}setProxy(e,t,i,n){this.setProperty(k.PropertyId[k.PropertyId.SpeechServiceConnection_ProxyHostName],e),this.setProperty(k.PropertyId[k.PropertyId.SpeechServiceConnection_ProxyPort],t),this.setProperty(k.PropertyId[k.PropertyId.SpeechServiceConnection_ProxyUserName],i),this.setProperty(k.PropertyId[k.PropertyId.SpeechServiceConnection_ProxyPassword],n)}getProperty(e,t){return this.privSpeechProperties.getProperty(e,t)}setProperty(e,t){this.privSpeechProperties.setProperty(e,t)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(e,t){let i=JSON.parse(this.privSpeechProperties.getProperty(Qa.ServicePropertiesPropertyName,"{}"));i[e]=t,this.privSpeechProperties.setProperty(Qa.ServicePropertiesPropertyName,JSON.stringify(i))}setProfanity(e){this.privSpeechProperties.setProperty(k.PropertyId.SpeechServiceResponse_ProfanityOption,k.ProfanityOption[e])}enableAudioLogging(){this.privSpeechProperties.setProperty(k.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(k.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(Qa.ForceDictationPropertyName,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(k.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(e){this.privSpeechProperties.setProperty(k.PropertyId.SpeechServiceConnection_SynthLanguage,e)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(k.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(e){this.privSpeechProperties.setProperty(k.PropertyId.SpeechServiceConnection_SynthVoice,e)}get speechSynthesisOutputFormat(){return k.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(k.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(e){this.privSpeechProperties.setProperty(k.PropertyId.SpeechServiceConnection_SynthOutputFormat,k.SpeechSynthesisOutputFormat[e])}};ao.SpeechTranslationConfigImpl=Ln});var By=h(Ll=>{"use strict";Object.defineProperty(Ll,"__esModule",{value:!0});Ll.PropertyCollection=void 0;var b1=P(),Fy=class r{constructor(){this.privKeys=[],this.privValues=[]}getProperty(e,t){let i;typeof e=="string"?i=e:i=b1.PropertyId[e];for(let n=0;n<this.privKeys.length;n++)if(this.privKeys[n]===i)return this.privValues[n];if(t!==void 0)return String(t)}setProperty(e,t){let i;typeof e=="string"?i=e:i=b1.PropertyId[e];for(let n=0;n<this.privKeys.length;n++)if(this.privKeys[n]===i){this.privValues[n]=t;return}this.privKeys.push(i),this.privValues.push(t)}clone(){let e=new r;for(let t=0;t<this.privKeys.length;t++)e.privKeys.push(this.privKeys[t]),e.privValues.push(this.privValues[t]);return e}mergeTo(e){this.privKeys.forEach(t=>{if(e.getProperty(t,void 0)===void 0){let i=this.getProperty(t);e.setProperty(t,i)}})}get keys(){return this.privKeys}};Ll.PropertyCollection=Fy});var ql=h(Xa=>{"use strict";Object.defineProperty(Xa,"__esModule",{value:!0});Xa.PropertyId=void 0;var QB;(function(r){r[r.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",r[r.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",r[r.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",r[r.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",r[r.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",r[r.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",r[r.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",r[r.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",r[r.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",r[r.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",r[r.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",r[r.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",r[r.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",r[r.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",r[r.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",r[r.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",r[r.Speech_SessionId=16]="Speech_SessionId",r[r.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",r[r.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",r[r.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",r[r.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",r[r.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",r[r.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",r[r.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",r[r.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",r[r.CancellationDetails_Reason=25]="CancellationDetails_Reason",r[r.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",r[r.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",r[r.LanguageUnderstandingServiceResponse_JsonResult=28]="LanguageUnderstandingServiceResponse_JsonResult",r[r.SpeechServiceConnection_Url=29]="SpeechServiceConnection_Url",r[r.SpeechServiceConnection_InitialSilenceTimeoutMs=30]="SpeechServiceConnection_InitialSilenceTimeoutMs",r[r.SpeechServiceConnection_EndSilenceTimeoutMs=31]="SpeechServiceConnection_EndSilenceTimeoutMs",r[r.Speech_SegmentationSilenceTimeoutMs=32]="Speech_SegmentationSilenceTimeoutMs",r[r.SpeechServiceConnection_EnableAudioLogging=33]="SpeechServiceConnection_EnableAudioLogging",r[r.SpeechServiceConnection_LanguageIdMode=34]="SpeechServiceConnection_LanguageIdMode",r[r.SpeechServiceConnection_RecognitionEndpointVersion=35]="SpeechServiceConnection_RecognitionEndpointVersion",r[r.SpeechServiceConnection_SpeakerIdMode=36]="SpeechServiceConnection_SpeakerIdMode",r[r.SpeechServiceResponse_ProfanityOption=37]="SpeechServiceResponse_ProfanityOption",r[r.SpeechServiceResponse_PostProcessingOption=38]="SpeechServiceResponse_PostProcessingOption",r[r.SpeechServiceResponse_RequestWordLevelTimestamps=39]="SpeechServiceResponse_RequestWordLevelTimestamps",r[r.SpeechServiceResponse_StablePartialResultThreshold=40]="SpeechServiceResponse_StablePartialResultThreshold",r[r.SpeechServiceResponse_OutputFormatOption=41]="SpeechServiceResponse_OutputFormatOption",r[r.SpeechServiceResponse_TranslationRequestStablePartialResult=42]="SpeechServiceResponse_TranslationRequestStablePartialResult",r[r.SpeechServiceResponse_RequestWordBoundary=43]="SpeechServiceResponse_RequestWordBoundary",r[r.SpeechServiceResponse_RequestPunctuationBoundary=44]="SpeechServiceResponse_RequestPunctuationBoundary",r[r.SpeechServiceResponse_RequestSentenceBoundary=45]="SpeechServiceResponse_RequestSentenceBoundary",r[r.Conversation_ApplicationId=46]="Conversation_ApplicationId",r[r.Conversation_DialogType=47]="Conversation_DialogType",r[r.Conversation_Initial_Silence_Timeout=48]="Conversation_Initial_Silence_Timeout",r[r.Conversation_From_Id=49]="Conversation_From_Id",r[r.Conversation_Conversation_Id=50]="Conversation_Conversation_Id",r[r.Conversation_Custom_Voice_Deployment_Ids=51]="Conversation_Custom_Voice_Deployment_Ids",r[r.Conversation_Speech_Activity_Template=52]="Conversation_Speech_Activity_Template",r[r.Conversation_Request_Bot_Status_Messages=53]="Conversation_Request_Bot_Status_Messages",r[r.Conversation_Agent_Connection_Id=54]="Conversation_Agent_Connection_Id",r[r.SpeechServiceConnection_Host=55]="SpeechServiceConnection_Host",r[r.ConversationTranslator_Host=56]="ConversationTranslator_Host",r[r.ConversationTranslator_Name=57]="ConversationTranslator_Name",r[r.ConversationTranslator_CorrelationId=58]="ConversationTranslator_CorrelationId",r[r.ConversationTranslator_Token=59]="ConversationTranslator_Token",r[r.PronunciationAssessment_ReferenceText=60]="PronunciationAssessment_ReferenceText",r[r.PronunciationAssessment_GradingSystem=61]="PronunciationAssessment_GradingSystem",r[r.PronunciationAssessment_Granularity=62]="PronunciationAssessment_Granularity",r[r.PronunciationAssessment_EnableMiscue=63]="PronunciationAssessment_EnableMiscue",r[r.PronunciationAssessment_Json=64]="PronunciationAssessment_Json",r[r.PronunciationAssessment_Params=65]="PronunciationAssessment_Params",r[r.SpeakerRecognition_Api_Version=66]="SpeakerRecognition_Api_Version",r[r.WebWorkerLoadType=67]="WebWorkerLoadType",r[r.TalkingAvatarService_WebRTC_SDP=68]="TalkingAvatarService_WebRTC_SDP"})(QB=Xa.PropertyId||(Xa.PropertyId={}))});var w1=h(Bl=>{"use strict";Object.defineProperty(Bl,"__esModule",{value:!0});Bl.Recognizer=void 0;var qn=T(),P1=x(),zl=j(),Fl=P(),Uy=class r{constructor(e,t,i){this.audioConfig=e!==void 0?e:Fl.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=t.clone(),this.privConnectionFactory=i,this.implCommonRecognizerSetup()}close(e,t){zl.Contracts.throwIfDisposed(this.privDisposed),P1.marshalPromiseToCallbacks(this.dispose(!0),e,t)}get internalData(){return this.privReco}dispose(e){return v(this,null,function*(){this.privDisposed||(this.privDisposed=!0,e&&this.privReco&&(yield this.privReco.audioSource.turnOff(),yield this.privReco.dispose()))})}static get telemetryEnabled(){return qn.ServiceRecognizerBase.telemetryDataEnabled}static enableTelemetry(e){qn.ServiceRecognizerBase.telemetryDataEnabled=e}implCommonRecognizerSetup(){let e=typeof window<"u"?"Browser":"Node",t="unknown",i="unknown";typeof navigator<"u"&&(e=e+"/"+navigator.platform,t=navigator.userAgent,i=navigator.appVersion);let n=this.createRecognizerConfig(new qn.SpeechServiceConfig(new qn.Context(new qn.OS(e,t,i))));this.privReco=this.createServiceRecognizer(r.getAuthFromProperties(this.privProperties),this.privConnectionFactory,this.audioConfig,n)}recognizeOnceAsyncImpl(e){return v(this,null,function*(){zl.Contracts.throwIfDisposed(this.privDisposed);let t=new P1.Deferred;yield this.implRecognizerStop(),yield this.privReco.recognize(e,t.resolve,t.reject);let i=yield t.promise;return yield this.implRecognizerStop(),i})}startContinuousRecognitionAsyncImpl(e){return v(this,null,function*(){zl.Contracts.throwIfDisposed(this.privDisposed),yield this.implRecognizerStop(),yield this.privReco.recognize(e,void 0,void 0)})}stopContinuousRecognitionAsyncImpl(){return v(this,null,function*(){zl.Contracts.throwIfDisposed(this.privDisposed),yield this.implRecognizerStop()})}implRecognizerStop(){return v(this,null,function*(){this.privReco&&(yield this.privReco.stopRecognizing())})}static getAuthFromProperties(e){let t=e.getProperty(Fl.PropertyId.SpeechServiceConnection_Key,void 0);return t&&t!==""?new qn.CognitiveSubscriptionKeyAuthentication(t):new qn.CognitiveTokenAuthentication(()=>{let n=e.getProperty(Fl.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(n)},()=>{let n=e.getProperty(Fl.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(n)})}};Bl.Recognizer=Uy});var _1=h(Wl=>{"use strict";Object.defineProperty(Wl,"__esModule",{value:!0});Wl.SpeechRecognizer=void 0;var co=T(),Ul=x(),Gi=j(),xt=P(),Wy=class r extends xt.Recognizer{constructor(e,t){let i=e;Gi.Contracts.throwIfNull(i,"speechConfig"),Gi.Contracts.throwIfNullOrWhitespace(i.properties.getProperty(xt.PropertyId.SpeechServiceConnection_RecoLanguage),xt.PropertyId[xt.PropertyId.SpeechServiceConnection_RecoLanguage]),super(t,i.properties,new co.SpeechConnectionFactory),this.privDisposedRecognizer=!1}static FromConfig(e,t,i){let n=e;return t.properties.mergeTo(n.properties),new r(e,i)}get endpointId(){return Gi.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(xt.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(xt.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){Gi.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(xt.PropertyId.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return Gi.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(xt.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return Gi.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(co.OutputFormatPropertyName,xt.OutputFormat[xt.OutputFormat.Simple])===xt.OutputFormat[xt.OutputFormat.Simple]?xt.OutputFormat.Simple:xt.OutputFormat.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(e,t){Ul.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(co.RecognitionMode.Interactive),e,t)}startContinuousRecognitionAsync(e,t){Ul.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(co.RecognitionMode.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){Ul.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),e,t)}startKeywordRecognitionAsync(e,t,i){Gi.Contracts.throwIfNull(e,"model"),i&&i("Not yet implemented.")}stopKeywordRecognitionAsync(e){e&&e()}close(e,t){Gi.Contracts.throwIfDisposed(this.privDisposedRecognizer),Ul.marshalPromiseToCallbacks(this.dispose(!0),e,t)}dispose(e){return v(this,null,function*(){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,yield this.implRecognizerStop()),yield Te(r.prototype,this,"dispose").call(this,e))})}createRecognizerConfig(e){return new co.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,i,n){let s=i;return new co.SpeechServiceRecognizer(e,t,s,n,this)}};Wl.SpeechRecognizer=Wy});var R1=h(Vl=>{"use strict";Object.defineProperty(Vl,"__esModule",{value:!0});Vl.IntentRecognizer=void 0;var zn=T(),Hl=x(),ct=j(),fi=P(),Hy=class r extends fi.Recognizer{constructor(e,t){ct.Contracts.throwIfNullOrUndefined(e,"speechConfig");let i=e;ct.Contracts.throwIfNullOrUndefined(i,"speechConfig"),super(t,i.properties,new zn.IntentConnectionFactory),this.privAddedIntents=[],this.privAddedLmIntents={},this.privDisposedIntentRecognizer=!1,this.privProperties=i.properties,ct.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(fi.PropertyId.SpeechServiceConnection_RecoLanguage),fi.PropertyId[fi.PropertyId.SpeechServiceConnection_RecoLanguage])}get speechRecognitionLanguage(){return ct.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(fi.PropertyId.SpeechServiceConnection_RecoLanguage)}get authorizationToken(){return this.properties.getProperty(fi.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(fi.PropertyId.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}recognizeOnceAsync(e,t){if(ct.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){let i=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",i.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(i.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}Hl.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(zn.RecognitionMode.Interactive),e,t)}startContinuousRecognitionAsync(e,t){if(Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){let i=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",i.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(i.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}Hl.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(zn.RecognitionMode.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){Hl.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),e,t)}startKeywordRecognitionAsync(e,t,i){ct.Contracts.throwIfNull(e,"model"),i&&i("Not yet implemented.")}stopKeywordRecognitionAsync(e,t){if(e)try{e()}catch(i){t&&t(i)}}addIntent(e,t){ct.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),ct.Contracts.throwIfNullOrWhitespace(t,"intentId"),ct.Contracts.throwIfNullOrWhitespace(e,"simplePhrase"),this.privAddedIntents.push([t,e])}addIntentWithLanguageModel(e,t,i){ct.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),ct.Contracts.throwIfNullOrWhitespace(e,"intentId"),ct.Contracts.throwIfNull(t,"model");let n=t;ct.Contracts.throwIfNullOrWhitespace(n.appId,"model.appId"),this.privAddedLmIntents[e]=new zn.AddedLmIntent(n,i)}addAllIntents(e,t){ct.Contracts.throwIfNull(e,"model");let i=e;ct.Contracts.throwIfNullOrWhitespace(i.appId,"model.appId"),this.privUmbrellaIntent=new zn.AddedLmIntent(i,t)}close(e,t){ct.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),Hl.marshalPromiseToCallbacks(this.dispose(!0),e,t)}createRecognizerConfig(e){return new zn.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,i,n){let s=i;return new zn.IntentServiceRecognizer(e,t,s,n,this)}dispose(e){return v(this,null,function*(){this.privDisposedIntentRecognizer||e&&(this.privDisposedIntentRecognizer=!0,yield Te(r.prototype,this,"dispose").call(this,e))})}buildSpeechContext(){let e,t,i,n=[];this.privUmbrellaIntent!==void 0&&(e=this.privUmbrellaIntent.modelImpl.appId,t=this.privUmbrellaIntent.modelImpl.region,i=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(let s of Object.keys(this.privAddedLmIntents)){let o=this.privAddedLmIntents[s];if(e===void 0)e=o.modelImpl.appId;else if(e!==o.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(t===void 0)t=o.modelImpl.region;else if(t!==o.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(i===void 0)i=o.modelImpl.subscriptionKey;else if(i!==o.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");let a="luis/"+e+"-PRODUCTION#"+s;n.push(a)}return{Intent:{id:e,key:i===void 0?this.privProperties.getProperty(fi.PropertyId[fi.PropertyId.SpeechServiceConnection_Key]):i,provider:"LUIS"},ReferenceGrammars:this.privUmbrellaIntent===void 0?n:["luis/"+e+"-PRODUCTION"]}}};Vl.IntentRecognizer=Hy});var E1=h(Za=>{"use strict";Object.defineProperty(Za,"__esModule",{value:!0});Za.VoiceProfileType=void 0;var XB;(function(r){r[r.TextIndependentIdentification=0]="TextIndependentIdentification",r[r.TextDependentVerification=1]="TextDependentVerification",r[r.TextIndependentVerification=2]="TextIndependentVerification"})(XB=Za.VoiceProfileType||(Za.VoiceProfileType={}))});var Ky=h(uo=>{"use strict";Object.defineProperty(uo,"__esModule",{value:!0});uo.ConnectionMessageImpl=uo.ConnectionMessage=void 0;var I1=ot(),T1=x(),ZB=By(),e3=ql(),Vy=class{};uo.ConnectionMessage=Vy;var $y=class{constructor(e){this.privConnectionMessage=e,this.privProperties=new ZB.PropertyCollection,this.privConnectionMessage.headers[I1.HeaderNames.ConnectionId]&&this.privProperties.setProperty(e3.PropertyId.Speech_SessionId,this.privConnectionMessage.headers[I1.HeaderNames.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach(t=>{this.privProperties.setProperty(t,this.privConnectionMessage.headers[t])})}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find(e=>e.toLowerCase()==="path".toLowerCase())]}get isTextMessage(){return this.privConnectionMessage.messageType===T1.MessageType.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===T1.MessageType.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}};uo.ConnectionMessageImpl=$y});var Qy=h($l=>{"use strict";Object.defineProperty($l,"__esModule",{value:!0});$l.Connection=void 0;var Gy=T(),Jy=x(),A1=Ky(),t3=j(),ec=P(),Yy=class r{static fromRecognizer(e){let t=e.internalData,i=new r;return i.privInternalData=t,i.setupEvents(),i}static fromSynthesizer(e){let t=e.internalData,i=new r;return i.privInternalData=t,i.setupEvents(),i}openConnection(e,t){Jy.marshalPromiseToCallbacks(this.privInternalData.connect(),e,t)}closeConnection(e,t){if(this.privInternalData instanceof Gy.SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");Jy.marshalPromiseToCallbacks(this.privInternalData.disconnect(),e,t)}setMessageProperty(e,t,i){if(t3.Contracts.throwIfNullOrWhitespace(t,"propertyName"),this.privInternalData instanceof Gy.ServiceRecognizerBase){if(e.toLowerCase()!=="speech.context")throw new Error("Only speech.context message property sets are currently supported for recognizer");this.privInternalData.speechContext.setSection(t,i)}else if(this.privInternalData instanceof Gy.SynthesisAdapterBase){if(e.toLowerCase()!=="synthesis.context")throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");this.privInternalData.synthesisContext.setSection(t,i)}}sendMessageAsync(e,t,i,n){Jy.marshalPromiseToCallbacks(this.privInternalData.sendNetworkMessage(e,t),i,n)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach(e=>{e.name==="ConnectionEstablishedEvent"?this.connected&&this.connected(new ec.ConnectionEventArgs(e.connectionId)):e.name==="ConnectionClosedEvent"?this.disconnected&&this.disconnected(new ec.ConnectionEventArgs(e.connectionId)):e.name==="ConnectionMessageSentEvent"?this.messageSent&&this.messageSent(new ec.ConnectionMessageEventArgs(new A1.ConnectionMessageImpl(e.message))):e.name==="ConnectionMessageReceivedEvent"&&this.messageReceived&&this.messageReceived(new ec.ConnectionMessageEventArgs(new A1.ConnectionMessageImpl(e.message)))}),this.privServiceEventListener=this.privInternalData.serviceEvents.attach(e=>{this.receivedServiceMessage&&this.receivedServiceMessage(new ec.ServiceEventArgs(e.jsonString,e.name))})}};$l.Connection=Yy});var O1=h(Gl=>{"use strict";Object.defineProperty(Gl,"__esModule",{value:!0});Gl.TranslationRecognizer=void 0;var tc=T(),Kl=x(),r3=Qy(),Er=j(),Se=P(),Xy=class r extends Se.Recognizer{constructor(e,t,i){let n=e;Er.Contracts.throwIfNull(n,"speechConfig"),super(t,n.properties,i||new tc.TranslationConnectionFactory),this.privDisposedTranslationRecognizer=!1,this.properties.getProperty(Se.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&Er.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(Se.PropertyId.SpeechServiceConnection_TranslationVoice),Se.PropertyId[Se.PropertyId.SpeechServiceConnection_TranslationVoice]),Er.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(Se.PropertyId.SpeechServiceConnection_TranslationToLanguages),Se.PropertyId[Se.PropertyId.SpeechServiceConnection_TranslationToLanguages]),Er.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(Se.PropertyId.SpeechServiceConnection_RecoLanguage),Se.PropertyId[Se.PropertyId.SpeechServiceConnection_RecoLanguage])}static FromConfig(e,t,i){let n=e;return t.properties.mergeTo(n.properties),new r(e,i)}get speechRecognitionLanguage(){return Er.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(Se.PropertyId.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return Er.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(Se.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return Er.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(Se.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(Se.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(Se.PropertyId.SpeechServiceAuthorization_Token,e)}recognizeOnceAsync(e,t){Er.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),Kl.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(tc.RecognitionMode.Interactive),e,t)}startContinuousRecognitionAsync(e,t){Kl.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(tc.RecognitionMode.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){Kl.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),e,t)}removeTargetLanguage(e){if(Er.Contracts.throwIfNullOrUndefined(e,"language to be removed"),this.properties.getProperty(Se.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0){let t=this.properties.getProperty(Se.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),i=t.indexOf(e);i>-1&&(t.splice(i,1),this.properties.setProperty(Se.PropertyId.SpeechServiceConnection_TranslationToLanguages,t.join(",")),this.updateLanguages(t))}}addTargetLanguage(e){Er.Contracts.throwIfNullOrUndefined(e,"language to be added");let t=[];this.properties.getProperty(Se.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?(t=this.properties.getProperty(Se.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),t.includes(e)||(t.push(e),this.properties.setProperty(Se.PropertyId.SpeechServiceConnection_TranslationToLanguages,t.join(",")))):(this.properties.setProperty(Se.PropertyId.SpeechServiceConnection_TranslationToLanguages,e),t=[e]),this.updateLanguages(t)}close(e,t){Er.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),Kl.marshalPromiseToCallbacks(this.dispose(!0),e,t)}onConnection(){}dispose(e){return v(this,null,function*(){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,e&&(yield this.implRecognizerStop(),yield Te(r.prototype,this,"dispose").call(this,e)))})}createRecognizerConfig(e){return new tc.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,i,n){let s=i;return new tc.TranslationServiceRecognizer(e,t,s,n,this)}updateLanguages(e){let t=r3.Connection.fromRecognizer(this);t&&(t.setMessageProperty("speech.context","translationcontext",{to:e}),t.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:e})))}};Gl.TranslationRecognizer=Xy});var D1=h(Jl=>{"use strict";Object.defineProperty(Jl,"__esModule",{value:!0});Jl.Translations=void 0;var i3=P(),Zy=class{constructor(){this.privMap=new i3.PropertyCollection}get languages(){return this.privMap.keys}get(e,t){return this.privMap.getProperty(e,t)}set(e,t){this.privMap.setProperty(e,t)}};Jl.Translations=Zy});var x1=h(rc=>{"use strict";Object.defineProperty(rc,"__esModule",{value:!0});rc.NoMatchReason=void 0;var n3;(function(r){r[r.NotRecognized=0]="NotRecognized",r[r.InitialSilenceTimeout=1]="InitialSilenceTimeout",r[r.InitialBabbleTimeout=2]="InitialBabbleTimeout"})(n3=rc.NoMatchReason||(rc.NoMatchReason={}))});var M1=h(Ql=>{"use strict";Object.defineProperty(Ql,"__esModule",{value:!0});Ql.NoMatchDetails=void 0;var eS=T(),Yl=P(),tS=class r{constructor(e){this.privReason=e}static fromResult(e){let t=eS.SimpleSpeechPhrase.fromJSON(e.json),i=Yl.NoMatchReason.NotRecognized;switch(t.RecognitionStatus){case eS.RecognitionStatus.BabbleTimeout:i=Yl.NoMatchReason.InitialBabbleTimeout;break;case eS.RecognitionStatus.InitialSilenceTimeout:i=Yl.NoMatchReason.InitialSilenceTimeout;break;default:i=Yl.NoMatchReason.NotRecognized;break}return new r(i)}get reason(){return this.privReason}};Ql.NoMatchDetails=tS});var k1=h(Xl=>{"use strict";Object.defineProperty(Xl,"__esModule",{value:!0});Xl.TranslationRecognitionCanceledEventArgs=void 0;var rS=class{constructor(e,t,i,n,s){this.privCancelReason=t,this.privErrorDetails=i,this.privResult=s,this.privSessionId=e,this.privErrorCode=n}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};Xl.TranslationRecognitionCanceledEventArgs=rS});var N1=h(Zl=>{"use strict";Object.defineProperty(Zl,"__esModule",{value:!0});Zl.IntentRecognitionCanceledEventArgs=void 0;var s3=P(),iS=class extends s3.IntentRecognitionEventArgs{constructor(e,t,i,n,s,o){super(n,s,o),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=i}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};Zl.IntentRecognitionCanceledEventArgs=iS});var sS=h(eh=>{"use strict";Object.defineProperty(eh,"__esModule",{value:!0});eh.CancellationDetailsBase=void 0;var nS=class{constructor(e,t,i){this.privReason=e,this.privErrorDetails=t,this.privErrorCode=i}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}};eh.CancellationDetailsBase=nS});var j1=h(rh=>{"use strict";Object.defineProperty(rh,"__esModule",{value:!0});rh.CancellationDetails=void 0;var th=T(),o3=sS(),po=P(),oS=class r extends o3.CancellationDetailsBase{constructor(e,t,i){super(e,t,i)}static fromResult(e){let t=po.CancellationReason.Error,i=po.CancellationErrorCode.NoError;if(e instanceof po.RecognitionResult&&e.json){let n=th.SimpleSpeechPhrase.fromJSON(e.json);t=th.EnumTranslation.implTranslateCancelResult(n.RecognitionStatus)}return e.properties&&(i=po.CancellationErrorCode[e.properties.getProperty(th.CancellationErrorCodePropertyName,po.CancellationErrorCode[po.CancellationErrorCode.NoError])]),new r(t,e.errorDetails||th.EnumTranslation.implTranslateErrorDetails(i),i)}};rh.CancellationDetails=oS});var L1=h(ic=>{"use strict";Object.defineProperty(ic,"__esModule",{value:!0});ic.CancellationErrorCode=void 0;var a3;(function(r){r[r.NoError=0]="NoError",r[r.AuthenticationFailure=1]="AuthenticationFailure",r[r.BadRequestParameters=2]="BadRequestParameters",r[r.TooManyRequests=3]="TooManyRequests",r[r.ConnectionFailure=4]="ConnectionFailure",r[r.ServiceTimeout=5]="ServiceTimeout",r[r.ServiceError=6]="ServiceError",r[r.RuntimeError=7]="RuntimeError",r[r.Forbidden=8]="Forbidden"})(a3=ic.CancellationErrorCode||(ic.CancellationErrorCode={}))});var q1=h(ih=>{"use strict";Object.defineProperty(ih,"__esModule",{value:!0});ih.ConnectionEventArgs=void 0;var c3=P(),aS=class extends c3.SessionEventArgs{};ih.ConnectionEventArgs=aS});var z1=h(nh=>{"use strict";Object.defineProperty(nh,"__esModule",{value:!0});nh.ServiceEventArgs=void 0;var u3=P(),cS=class extends u3.SessionEventArgs{constructor(e,t,i){super(i),this.privJsonResult=e,this.privEventName=t}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}};nh.ServiceEventArgs=cS});var F1=h(sh=>{"use strict";Object.defineProperty(sh,"__esModule",{value:!0});sh.PhraseListGrammar=void 0;var uS=class r{constructor(e){this.privGrammerBuilder=e.dynamicGrammar}static fromRecognizer(e){let t=e.internalData;return new r(t)}addPhrase(e){this.privGrammerBuilder.addPhrase(e)}addPhrases(e){this.privGrammerBuilder.addPhrase(e)}clear(){this.privGrammerBuilder.clearPhrases()}};sh.PhraseListGrammar=uS});var ah=h(lo=>{"use strict";Object.defineProperty(lo,"__esModule",{value:!0});lo.DialogServiceConfigImpl=lo.DialogServiceConfig=void 0;var p3=j(),nc=P(),oh=class{constructor(){}set applicationId(e){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}};lo.DialogServiceConfig=oh;var pS=class extends oh{constructor(){super(),this.privSpeechConfig=new nc.SpeechConfigImpl}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(e){p3.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechConfig.speechRecognitionLanguage=e}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(e){this.privSpeechConfig.outputFormat=e}setProperty(e,t){this.privSpeechConfig.setProperty(e,t)}getProperty(e,t){return this.privSpeechConfig.getProperty(e)}setProxy(e,t,i,n){this.setProperty(nc.PropertyId.SpeechServiceConnection_ProxyHostName,e),this.setProperty(nc.PropertyId.SpeechServiceConnection_ProxyPort,`${t}`),i&&this.setProperty(nc.PropertyId.SpeechServiceConnection_ProxyUserName,i),n&&this.setProperty(nc.PropertyId.SpeechServiceConnection_ProxyPassword,n)}setServiceProperty(e,t,i){this.privSpeechConfig.setServiceProperty(e,t)}close(){}};lo.DialogServiceConfigImpl=pS});var B1=h(ch=>{"use strict";Object.defineProperty(ch,"__esModule",{value:!0});ch.BotFrameworkConfig=void 0;var Fn=j(),vi=ah(),Mt=P(),lS=class extends vi.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(e,t,i){Fn.Contracts.throwIfNullOrWhitespace(e,"subscription"),Fn.Contracts.throwIfNullOrWhitespace(t,"region");let n=new vi.DialogServiceConfigImpl;return n.setProperty(Mt.PropertyId.Conversation_DialogType,vi.DialogServiceConfig.DialogTypes.BotFramework),n.setProperty(Mt.PropertyId.SpeechServiceConnection_Key,e),n.setProperty(Mt.PropertyId.SpeechServiceConnection_Region,t),i&&n.setProperty(Mt.PropertyId.Conversation_ApplicationId,i),n}static fromAuthorizationToken(e,t,i){Fn.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),Fn.Contracts.throwIfNullOrWhitespace(t,"region");let n=new vi.DialogServiceConfigImpl;return n.setProperty(Mt.PropertyId.Conversation_DialogType,vi.DialogServiceConfig.DialogTypes.BotFramework),n.setProperty(Mt.PropertyId.SpeechServiceAuthorization_Token,e),n.setProperty(Mt.PropertyId.SpeechServiceConnection_Region,t),i&&n.setProperty(Mt.PropertyId.Conversation_ApplicationId,i),n}static fromHost(e,t,i){Fn.Contracts.throwIfNullOrUndefined(e,"host");let n=e instanceof URL?e:new URL(`wss://${e}.convai.speech.azure.us`);Fn.Contracts.throwIfNullOrUndefined(n,"resolvedHost");let s=new vi.DialogServiceConfigImpl;return s.setProperty(Mt.PropertyId.Conversation_DialogType,vi.DialogServiceConfig.DialogTypes.BotFramework),s.setProperty(Mt.PropertyId.SpeechServiceConnection_Host,n.toString()),t!==void 0&&s.setProperty(Mt.PropertyId.SpeechServiceConnection_Key,t),s}static fromEndpoint(e,t){Fn.Contracts.throwIfNull(e,"endpoint");let i=new vi.DialogServiceConfigImpl;return i.setProperty(Mt.PropertyId.Conversation_DialogType,vi.DialogServiceConfig.DialogTypes.BotFramework),i.setProperty(Mt.PropertyId.SpeechServiceConnection_Endpoint,e.toString()),t!==void 0&&i.setProperty(Mt.PropertyId.SpeechServiceConnection_Key,t),i}};ch.BotFrameworkConfig=lS});var U1=h(uh=>{"use strict";Object.defineProperty(uh,"__esModule",{value:!0});uh.CustomCommandsConfig=void 0;var Bn=j(),sc=ah(),$r=P(),hS=class extends sc.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(e,t,i){Bn.Contracts.throwIfNullOrWhitespace(e,"applicationId"),Bn.Contracts.throwIfNullOrWhitespace(t,"subscription"),Bn.Contracts.throwIfNullOrWhitespace(i,"region");let n=new sc.DialogServiceConfigImpl;return n.setProperty($r.PropertyId.Conversation_DialogType,sc.DialogServiceConfig.DialogTypes.CustomCommands),n.setProperty($r.PropertyId.Conversation_ApplicationId,e),n.setProperty($r.PropertyId.SpeechServiceConnection_Key,t),n.setProperty($r.PropertyId.SpeechServiceConnection_Region,i),n}static fromAuthorizationToken(e,t,i){Bn.Contracts.throwIfNullOrWhitespace(e,"applicationId"),Bn.Contracts.throwIfNullOrWhitespace(t,"authorizationToken"),Bn.Contracts.throwIfNullOrWhitespace(i,"region");let n=new sc.DialogServiceConfigImpl;return n.setProperty($r.PropertyId.Conversation_DialogType,sc.DialogServiceConfig.DialogTypes.CustomCommands),n.setProperty($r.PropertyId.Conversation_ApplicationId,e),n.setProperty($r.PropertyId.SpeechServiceAuthorization_Token,t),n.setProperty($r.PropertyId.SpeechServiceConnection_Region,i),n}set applicationId(e){Bn.Contracts.throwIfNullOrWhitespace(e,"value"),this.setProperty($r.PropertyId.Conversation_ApplicationId,e)}get applicationId(){return this.getProperty($r.PropertyId.Conversation_ApplicationId)}};uh.CustomCommandsConfig=hS});var gi=h(ph=>{"use strict";Object.defineProperty(ph,"__esModule",{value:!0});ph.QueryParameterNames=void 0;var ve=class{};ph.QueryParameterNames=ve;ve.BotId="botid";ve.CustomSpeechDeploymentId="cid";ve.CustomVoiceDeploymentId="deploymentId";ve.EnableAudioLogging="storeAudio";ve.EnableLanguageId="lidEnabled";ve.EnableWordLevelTimestamps="wordLevelTimestamps";ve.EndSilenceTimeoutMs="endSilenceTimeoutMs";ve.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs";ve.Format="format";ve.InitialSilenceTimeoutMs="initialSilenceTimeoutMs";ve.Language="language";ve.Profanity="profanity";ve.RequestBotStatusMessages="enableBotMessageStatus";ve.StableIntermediateThreshold="stableIntermediateThreshold";ve.StableTranslation="stableTranslation";ve.TestHooks="testhooks";ve.Postprocessing="postprocessing";ve.CtsMeetingId="meetingId";ve.CtsDeviceId="deviceId";ve.CtsIsParticipant="isParticipant";ve.EnableAvatar="enableTalkingAvatar"});var ar=h(lh=>{"use strict";Object.defineProperty(lh,"__esModule",{value:!0});lh.ConnectionFactoryBase=void 0;var l3=T(),Ji=P(),Yi=gi(),dS=class{static getHostSuffix(e){if(e){if(e.toLowerCase().startsWith("china"))return".azure.cn";if(e.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(e,t,i){new Map([[Ji.PropertyId.Speech_SegmentationSilenceTimeoutMs,Yi.QueryParameterNames.SegmentationSilenceTimeoutMs],[Ji.PropertyId.SpeechServiceConnection_EnableAudioLogging,Yi.QueryParameterNames.EnableAudioLogging],[Ji.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,Yi.QueryParameterNames.EndSilenceTimeoutMs],[Ji.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,Yi.QueryParameterNames.InitialSilenceTimeoutMs],[Ji.PropertyId.SpeechServiceResponse_PostProcessingOption,Yi.QueryParameterNames.Postprocessing],[Ji.PropertyId.SpeechServiceResponse_ProfanityOption,Yi.QueryParameterNames.Profanity],[Ji.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,Yi.QueryParameterNames.EnableWordLevelTimestamps],[Ji.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,Yi.QueryParameterNames.StableIntermediateThreshold]]).forEach((o,a)=>{this.setUrlParameter(a,o,e,t,i)});let s=JSON.parse(e.parameters.getProperty(l3.ServicePropertiesPropertyName,"{}"));Object.keys(s).forEach(o=>{t[o]=s[o]})}setUrlParameter(e,t,i,n,s){let o=i.parameters.getProperty(e,void 0);o&&(!s||s.search(t)===-1)&&(n[t]=o.toLocaleLowerCase())}};lh.ConnectionFactoryBase=dS});var $1=h(dh=>{"use strict";Object.defineProperty(dh,"__esModule",{value:!0});dh.DialogConnectionFactory=void 0;var W1=Le(),h3=T(),Ht=P(),H1=ar(),d3=T(),V1=ot(),hh=gi(),oc=class r extends H1.ConnectionFactoryBase{create(e,t,i){let n=e.parameters.getProperty(Ht.PropertyId.Conversation_ApplicationId,""),s=e.parameters.getProperty(Ht.PropertyId.Conversation_DialogType),o=e.parameters.getProperty(Ht.PropertyId.SpeechServiceConnection_Region),a=e.parameters.getProperty(Ht.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),c=e.parameters.getProperty(Ht.PropertyId.Conversation_Request_Bot_Status_Messages,"true"),u={};u[V1.HeaderNames.ConnectionId]=i,u[hh.QueryParameterNames.Format]=e.parameters.getProperty(h3.OutputFormatPropertyName,Ht.OutputFormat[Ht.OutputFormat.Simple]).toLowerCase(),u[hh.QueryParameterNames.Language]=a,u[hh.QueryParameterNames.RequestBotStatusMessages]=c,n&&(u[hh.QueryParameterNames.BotId]=n,s===Ht.DialogServiceConfig.DialogTypes.CustomCommands&&(u[V1.HeaderNames.CustomCommandsAppId]=n));let p=s===Ht.DialogServiceConfig.DialogTypes.CustomCommands?"commands/":"",l=s===Ht.DialogServiceConfig.DialogTypes.CustomCommands?"v1":s===Ht.DialogServiceConfig.DialogTypes.BotFramework?"v3":"v0",d={};t.token!=null&&t.token!==""&&(d[t.headerName]=t.token);let f=e.parameters.getProperty(Ht.PropertyId.SpeechServiceConnection_Endpoint,"");if(!f){let m=H1.ConnectionFactoryBase.getHostSuffix(o),y=e.parameters.getProperty(Ht.PropertyId.SpeechServiceConnection_Host,`wss://${o}.${r.BaseUrl}${m}`);f=`${y.endsWith("/")?y:y+"/"}${p}${r.ApiKey}/${l}`}this.setCommonUrlParams(e,u,f);let g=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new W1.WebsocketConnection(f,u,d,new d3.WebsocketMessageFormatter,W1.ProxyInfo.fromRecognizerConfig(e),g,i)}};dh.DialogConnectionFactory=oc;oc.ApiKey="api";oc.BaseUrl="convai.speech"});var K1=h(vh=>{"use strict";Object.defineProperty(vh,"__esModule",{value:!0});vh.DialogServiceConnector=void 0;var f3=$1(),fS=T(),ho=x(),fh=j(),v3=P(),Qi=ql(),vS=class r extends v3.Recognizer{constructor(e,t){let i=e;fh.Contracts.throwIfNull(e,"dialogConfig"),super(t,i.properties,new f3.DialogConnectionFactory),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=i.properties.clone();let n=this.buildAgentConfig();this.privReco.agentConfig.set(n)}connect(e,t){ho.marshalPromiseToCallbacks(this.privReco.connect(),e,t)}disconnect(e,t){ho.marshalPromiseToCallbacks(this.privReco.disconnect(),e,t)}get authorizationToken(){return this.properties.getProperty(Qi.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){fh.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Qi.PropertyId.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(Qi.PropertyId.Conversation_Speech_Activity_Template)}set speechActivityTemplate(e){this.properties.setProperty(Qi.PropertyId.Conversation_Speech_Activity_Template,e)}listenOnceAsync(e,t){if(this.isTurnComplete){fh.Contracts.throwIfDisposed(this.privIsDisposed);let n=v(this,null,function*(){yield this.privReco.connect(),yield this.implRecognizerStop(),this.isTurnComplete=!1;let s=new ho.Deferred;yield this.privReco.recognize(fS.RecognitionMode.Conversation,s.resolve,s.reject);let o=yield s.promise;return yield this.implRecognizerStop(),o});n.catch(()=>{this.dispose(!0).catch(()=>{})}),ho.marshalPromiseToCallbacks(n.finally(()=>{this.isTurnComplete=!0}),e,t)}}sendActivityAsync(e,t,i){ho.marshalPromiseToCallbacks(this.privReco.sendMessage(e),t,i)}close(e,t){fh.Contracts.throwIfDisposed(this.privIsDisposed),ho.marshalPromiseToCallbacks(this.dispose(!0),e,t)}dispose(e){return v(this,null,function*(){this.privIsDisposed||e&&(this.privIsDisposed=!0,yield this.implRecognizerStop(),yield Te(r.prototype,this,"dispose").call(this,e))})}createRecognizerConfig(e){return new fS.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,i,n){let s=i;return new fS.DialogServiceAdapter(e,t,s,n,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(Qi.PropertyId.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(Qi.PropertyId.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(Qi.PropertyId.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(Qi.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}};vh.DialogServiceConnector=vS});var G1=h(gh=>{"use strict";Object.defineProperty(gh,"__esModule",{value:!0});gh.ActivityReceivedEventArgs=void 0;var gS=class{constructor(e,t){this.privActivity=e,this.privAudioStream=t}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}};gh.ActivityReceivedEventArgs=gS});var J1=h(mh=>{"use strict";Object.defineProperty(mh,"__esModule",{value:!0});mh.TurnStatusResponsePayload=void 0;var mS=class r{constructor(e){this.privMessageStatusResponse=JSON.parse(e)}static fromJSON(e){return new r(e)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}};mh.TurnStatusResponsePayload=mS});var Y1=h(yh=>{"use strict";Object.defineProperty(yh,"__esModule",{value:!0});yh.TurnStatusReceivedEventArgs=void 0;var g3=J1(),yS=class{constructor(e){this.privTurnStatus=g3.TurnStatusResponsePayload.fromJSON(e)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}};yh.TurnStatusReceivedEventArgs=yS});var Q1=h(ac=>{"use strict";Object.defineProperty(ac,"__esModule",{value:!0});ac.ServicePropertyChannel=void 0;var m3;(function(r){r[r.UriQueryParameter=0]="UriQueryParameter"})(m3=ac.ServicePropertyChannel||(ac.ServicePropertyChannel={}))});var X1=h(cc=>{"use strict";Object.defineProperty(cc,"__esModule",{value:!0});cc.ProfanityOption=void 0;var y3;(function(r){r[r.Masked=0]="Masked",r[r.Removed=1]="Removed",r[r.Raw=2]="Raw"})(y3=cc.ProfanityOption||(cc.ProfanityOption={}))});var Z1=h(Sh=>{"use strict";Object.defineProperty(Sh,"__esModule",{value:!0});Sh.BaseAudioPlayer=void 0;var S3=Cr(),C3=P(),b3=qi(),SS=class{constructor(e){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,e===void 0&&(e=C3.AudioStreamFormat.getDefaultInputFormat()),this.init(e)}playAudioSample(e,t,i){try{this.ensureInitializedContext();let n=this.formatAudioData(e),s=new Float32Array(this.samples.length+n.length);s.set(this.samples,0),s.set(n,this.samples.length),this.samples=s,t&&t()}catch(n){i&&i(n)}}stopAudio(e,t){this.audioContext!==null&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then(()=>{e&&e()},i=>{t&&t(i)}),this.audioContext=null)}init(e){this.audioFormat=e,this.samples=new Float32Array}ensureInitializedContext(){if(this.audioContext===null){this.createAudioContext();let e=200;this.autoUpdateBufferTimer=setInterval(()=>{this.updateAudioBuffer()},e)}}createAudioContext(){this.audioContext=b3.AudioStreamFormatImpl.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(e){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(e),128);case 16:return this.formatArrayBuffer(new Int16Array(e),32768);case 32:return this.formatArrayBuffer(new Int32Array(e),2147483648);default:throw new S3.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(e,t){let i=new Float32Array(e.length);for(let n=0;n<e.length;n++)i[n]=e[n]/t;return i}updateAudioBuffer(){if(this.samples.length===0)return;let e=this.audioFormat.channels,t=this.audioContext.createBufferSource(),i=this.samples.length/e,n=this.audioContext.createBuffer(e,i,this.audioFormat.samplesPerSec);for(let s=0;s<e;s++){let o=s,a=n.getChannelData(s);for(let c=0;c<this.samples.length;c++,o+=e)a[c]=this.samples[o]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),t.buffer=n,t.connect(this.gainNode),t.start(this.startTime),this.startTime+=n.duration,this.samples=new Float32Array}playAudio(e){return v(this,null,function*(){this.audioContext===null&&this.createAudioContext();let t=this.audioContext.createBufferSource(),i=this.audioContext.destination;yield this.audioContext.decodeAudioData(e,n=>{t.buffer=n,t.connect(i),t.start(0)})})}};Sh.BaseAudioPlayer=SS});var eO=h(Ch=>{"use strict";Object.defineProperty(Ch,"__esModule",{value:!0});Ch.ConnectionMessageEventArgs=void 0;var CS=class{constructor(e){this.privConnectionMessage=e}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}};Ch.ConnectionMessageEventArgs=CS});var tO=h(bh=>{"use strict";Object.defineProperty(bh,"__esModule",{value:!0});bh.VoiceProfile=void 0;var bS=class{constructor(e,t){this.privId=e,this.privProfileType=t}get profileId(){return this.privId}get profileType(){return this.privProfileType}};bh.VoiceProfile=bS});var iO=h(fo=>{"use strict";Object.defineProperty(fo,"__esModule",{value:!0});fo.VoiceProfileEnrollmentCancellationDetails=fo.VoiceProfileEnrollmentResult=void 0;var rO=T(),Ke=P(),PS=class r{constructor(e,t,i){this.privReason=e,this.privProperties=new Ke.PropertyCollection,this.privReason!==Ke.ResultReason.Canceled?t&&(this.privDetails=JSON.parse(t),this.privDetails.enrollmentStatus.toLowerCase()==="enrolling"&&(this.privReason=Ke.ResultReason.EnrollingVoiceProfile)):(this.privErrorDetails=i,this.privProperties.setProperty(rO.CancellationErrorCodePropertyName,Ke.CancellationErrorCode[Ke.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get enrollmentsCount(){return this.privDetails.enrollmentsCount}get enrollmentsLength(){return this.privDetails.enrollmentsLength}get properties(){return this.privProperties}get enrollmentResultDetails(){return this.privDetails}get errorDetails(){return this.privErrorDetails}static FromIdentificationProfileList(e){let t=[];for(let i of e.value){let n=i.enrollmentStatus.toLowerCase()==="enrolling"?Ke.ResultReason.EnrollingVoiceProfile:i.enrollmentStatus.toLowerCase()==="enrolled"?Ke.ResultReason.EnrolledVoiceProfile:Ke.ResultReason.Canceled,s=new r(n,null,null);s.privDetails=this.getIdentificationDetails(i),t.push(s)}return t}static FromVerificationProfileList(e){let t=[];for(let i of e.value){let n=i.enrollmentStatus.toLowerCase()==="enrolling"?Ke.ResultReason.EnrollingVoiceProfile:i.enrollmentStatus.toLowerCase()==="enrolled"?Ke.ResultReason.EnrolledVoiceProfile:Ke.ResultReason.Canceled,s=new r(n,null,null);s.privDetails=this.getVerificationDetails(i),t.push(s)}return t}static getIdentificationDetails(e){return{audioLength:e.audioLength?parseFloat(e.audioLength):0,audioSpeechLength:e.audioSpeechLength?parseFloat(e.audioSpeechLength):0,enrollmentStatus:e.enrollmentStatus,enrollmentsCount:e.enrollmentsCount||0,enrollmentsLength:e.enrollmentsLength?parseFloat(e.enrollmentsLength):0,enrollmentsSpeechLength:e.enrollmentsSpeechLength?parseFloat(e.enrollmentsSpeechLength):0,profileId:e.profileId||e.identificationProfileId,remainingEnrollmentsSpeechLength:e.remainingEnrollmentsSpeechLength?parseFloat(e.remainingEnrollmentsSpeechLength):0}}static getVerificationDetails(e){return{audioLength:e.audioLength?parseFloat(e.audioLength):0,audioSpeechLength:e.audioSpeechLength?parseFloat(e.audioSpeechLength):0,enrollmentStatus:e.enrollmentStatus,enrollmentsCount:e.enrollmentsCount,enrollmentsLength:e.enrollmentsLength?parseFloat(e.enrollmentsLength):0,enrollmentsSpeechLength:e.enrollmentsSpeechLength?parseFloat(e.enrollmentsSpeechLength):0,profileId:e.profileId||e.verificationProfileId,remainingEnrollmentsCount:e.remainingEnrollments||e.remainingEnrollmentsCount,remainingEnrollmentsSpeechLength:e.remainingEnrollmentsSpeechLength?parseFloat(e.remainingEnrollmentsSpeechLength):0}}};fo.VoiceProfileEnrollmentResult=PS;var wS=class r extends Ke.CancellationDetailsBase{constructor(e,t,i){super(e,t,i)}static fromResult(e){let t=Ke.CancellationReason.Error,i=Ke.CancellationErrorCode.NoError;return e.properties&&(i=Ke.CancellationErrorCode[e.properties.getProperty(rO.CancellationErrorCodePropertyName,Ke.CancellationErrorCode[Ke.CancellationErrorCode.NoError])]),new r(t,e.errorDetails,i)}};fo.VoiceProfileEnrollmentCancellationDetails=wS});var sO=h(vo=>{"use strict";Object.defineProperty(vo,"__esModule",{value:!0});vo.VoiceProfileCancellationDetails=vo.VoiceProfileResult=void 0;var nO=T(),P3=j(),Kr=P(),_S=class{constructor(e,t){this.privReason=e,this.privProperties=new Kr.PropertyCollection,e===Kr.ResultReason.Canceled&&(P3.Contracts.throwIfNullOrUndefined(t,"statusText"),this.privErrorDetails=t,this.privProperties.setProperty(nO.CancellationErrorCodePropertyName,Kr.CancellationErrorCode[Kr.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get properties(){return this.privProperties}get errorDetails(){return this.privErrorDetails}};vo.VoiceProfileResult=_S;var RS=class r extends Kr.CancellationDetailsBase{constructor(e,t,i){super(e,t,i)}static fromResult(e){let t=Kr.CancellationReason.Error,i=Kr.CancellationErrorCode.NoError;return e.properties&&(i=Kr.CancellationErrorCode[e.properties.getProperty(nO.CancellationErrorCodePropertyName,Kr.CancellationErrorCode[Kr.CancellationErrorCode.NoError])]),new r(t,e.errorDetails,i)}};vo.VoiceProfileCancellationDetails=RS});var oO=h(Ph=>{"use strict";Object.defineProperty(Ph,"__esModule",{value:!0});Ph.VoiceProfilePhraseResult=void 0;var w3=j(),_3=P(),ES=class extends _3.VoiceProfileResult{constructor(e,t,i,n){super(e,t),this.privPhrases=[],w3.Contracts.throwIfNullOrUndefined(n,"phrase array"),this.privType=i,n&&n[0]&&(this.privPhrases=n)}get phrases(){return this.privPhrases}get type(){return this.privType}};Ph.VoiceProfilePhraseResult=ES});var aO=h(_h=>{"use strict";Object.defineProperty(_h,"__esModule",{value:!0});_h.VoiceProfileClient=void 0;var IS=T(),R3=by(),wh=j(),Un=P(),TS=class r extends Un.Recognizer{constructor(e){wh.Contracts.throwIfNullOrUndefined(e,"speechConfig");let t=e;wh.Contracts.throwIfNull(t,"speechConfig"),super(R3.AudioConfig.fromStreamInput(Un.AudioInputStream.createPushStream()),t.properties,new IS.VoiceProfileConnectionFactory),this.privProperties=t.properties.clone(),this.privVoiceAdapter=this.privReco,this.privDisposedVoiceAdapter=!1}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(Un.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){wh.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Un.PropertyId.SpeechServiceAuthorization_Token,e)}createProfileAsync(e,t){return v(this,null,function*(){let i=yield this.privVoiceAdapter.createProfile(e,t);return new Un.VoiceProfile(i[0],e)})}retrieveEnrollmentResultAsync(e){return v(this,null,function*(){return this.privVoiceAdapter.retrieveEnrollmentResult(e)})}getAllProfilesAsync(e){return v(this,null,function*(){return this.privVoiceAdapter.getAllProfiles(e)})}getActivationPhrasesAsync(e,t){return v(this,null,function*(){return this.privVoiceAdapter.getActivationPhrases(e,t)})}enrollProfileAsync(e,t){return v(this,null,function*(){let i=t;return wh.Contracts.throwIfNullOrUndefined(i,"audioConfig"),this.audioConfig=t,this.privVoiceAdapter.SpeakerAudioSource=i,this.privVoiceAdapter.enrollProfile(e)})}deleteProfileAsync(e){return v(this,null,function*(){return this.privVoiceAdapter.deleteProfile(e)})}resetProfileAsync(e){return v(this,null,function*(){return this.privVoiceAdapter.resetProfile(e)})}close(){return v(this,null,function*(){yield this.dispose(!0)})}createServiceRecognizer(e,t,i,n){let s=i;return new IS.VoiceServiceRecognizer(e,t,s,n,this)}dispose(e){return v(this,null,function*(){this.privDisposedVoiceAdapter||(this.privDisposedVoiceAdapter=!0,e&&(yield Te(r.prototype,this,"dispose").call(this,e)))})}createRecognizerConfig(e){return new IS.RecognizerConfig(e,this.properties)}getResult(e,t){return new Un.VoiceProfileResult(e.ok?t:Un.ResultReason.Canceled,e.statusText)}};_h.VoiceProfileClient=TS});var cO=h(Rh=>{"use strict";Object.defineProperty(Rh,"__esModule",{value:!0});Rh.SpeakerRecognizer=void 0;var AS=T(),Wn=j(),OS=P(),DS=class r extends OS.Recognizer{constructor(e,t){Wn.Contracts.throwIfNullOrUndefined(e,"speechConfig");let i=e;Wn.Contracts.throwIfNullOrUndefined(i,"speechConfig"),super(t,i.properties,new AS.SpeakerRecognitionConnectionFactory),this.privAudioConfigImpl=t,Wn.Contracts.throwIfNull(this.privAudioConfigImpl,"audioConfig"),this.privDisposedSpeakerRecognizer=!1,this.privProperties=i.properties}get authorizationToken(){return this.properties.getProperty(OS.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){Wn.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(OS.PropertyId.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}recognizeOnceAsync(e){return v(this,null,function*(){return Wn.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),this.recognizeSpeakerOnceAsyncImpl(e)})}close(){return v(this,null,function*(){Wn.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),yield this.dispose(!0)})}recognizeSpeakerOnceAsyncImpl(e){return v(this,null,function*(){Wn.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),yield this.implRecognizerStop();let t=yield this.privReco.recognizeSpeaker(e);return yield this.implRecognizerStop(),t})}implRecognizerStop(){return v(this,null,function*(){this.privReco&&(yield this.privReco.stopRecognizing())})}createRecognizerConfig(e){return new AS.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,i,n){let s=i;return new AS.SpeakerServiceRecognizer(e,t,s,n,this)}dispose(e){return v(this,null,function*(){this.privDisposedSpeakerRecognizer||e&&(this.privDisposedSpeakerRecognizer=!0,yield Te(r.prototype,this,"dispose").call(this,e))})}};Rh.SpeakerRecognizer=DS});var uO=h(Eh=>{"use strict";Object.defineProperty(Eh,"__esModule",{value:!0});Eh.SpeakerIdentificationModel=void 0;var E3=j(),I3=P(),xS=class r{constructor(e){if(this.privVoiceProfiles=[],this.privProfileIds=[],E3.Contracts.throwIfNullOrUndefined(e,"VoiceProfiles"),e.length===0)throw new Error("Empty Voice Profiles array");for(let t of e){if(t.profileType!==I3.VoiceProfileType.TextIndependentIdentification)throw new Error("Identification model can only be created from Identification profile: "+t.profileId);this.privVoiceProfiles.push(t),this.privProfileIds.push(t.profileId)}}static fromProfiles(e){return new r(e)}get voiceProfileIds(){return this.privProfileIds.join(",")}get profileIds(){return this.privProfileIds}get scenario(){return"TextIndependentIdentification"}};Eh.SpeakerIdentificationModel=xS});var lO=h(Ih=>{"use strict";Object.defineProperty(Ih,"__esModule",{value:!0});Ih.SpeakerVerificationModel=void 0;var T3=j(),pO=P(),MS=class r{constructor(e){if(T3.Contracts.throwIfNullOrUndefined(e,"VoiceProfile"),e.profileType===pO.VoiceProfileType.TextIndependentIdentification)throw new Error("Verification model cannot be created from Identification profile");this.privVoiceProfile=e}static fromProfile(e){return new r(e)}get voiceProfile(){return this.privVoiceProfile}get profileIds(){return[this.voiceProfile.profileId]}get scenario(){return this.voiceProfile.profileType===pO.VoiceProfileType.TextDependentVerification?"TextDependentVerification":"TextIndependentVerification"}};Ih.SpeakerVerificationModel=MS});var kS=h(uc=>{"use strict";Object.defineProperty(uc,"__esModule",{value:!0});uc.LanguageIdMode=void 0;var A3;(function(r){r[r.AtStart=0]="AtStart",r[r.Continuous=1]="Continuous"})(A3=uc.LanguageIdMode||(uc.LanguageIdMode={}))});var dO=h(Th=>{"use strict";Object.defineProperty(Th,"__esModule",{value:!0});Th.AutoDetectSourceLanguageConfig=void 0;var O3=T(),D3=j(),Gr=P(),hO=kS(),NS=class r{constructor(){this.privProperties=new Gr.PropertyCollection,this.privProperties.setProperty(Gr.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=hO.LanguageIdMode.AtStart}static fromOpenRange(){let e=new r;return e.properties.setProperty(Gr.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,O3.AutoDetectSourceLanguagesOpenRangeOptionName),e}static fromLanguages(e){D3.Contracts.throwIfArrayEmptyOrWhitespace(e,"languages");let t=new r;return t.properties.setProperty(Gr.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,e.join()),t}static fromSourceLanguageConfigs(e){if(e.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");let t=new r,i=[];return e.forEach(n=>{if(i.push(n.language),n.endpointId!==void 0&&n.endpointId!==""){let s=n.language+Gr.PropertyId.SpeechServiceConnection_EndpointId.toString();t.properties.setProperty(s,n.endpointId)}}),t.properties.setProperty(Gr.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,i.join()),t}get properties(){return this.privProperties}set mode(e){e===hO.LanguageIdMode.Continuous?(this.privProperties.setProperty(Gr.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(Gr.PropertyId.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(Gr.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(Gr.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=e}};Th.AutoDetectSourceLanguageConfig=NS});var vO=h(Ah=>{"use strict";Object.defineProperty(Ah,"__esModule",{value:!0});Ah.AutoDetectSourceLanguageResult=void 0;var fO=j(),jS=class r{constructor(e,t){fO.Contracts.throwIfNullOrUndefined(e,"language"),fO.Contracts.throwIfNullOrUndefined(t,"languageDetectionConfidence"),this.privLanguage=e,this.privLanguageDetectionConfidence=t}static fromResult(e){return new r(e.language,e.languageDetectionConfidence)}static fromConversationTranscriptionResult(e){return new r(e.language,e.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}};Ah.AutoDetectSourceLanguageResult=jS});var gO=h(Oh=>{"use strict";Object.defineProperty(Oh,"__esModule",{value:!0});Oh.SourceLanguageConfig=void 0;var x3=j(),LS=class r{constructor(e,t){x3.Contracts.throwIfNullOrUndefined(e,"language"),this.privLanguage=e,this.privEndpointId=t}static fromLanguage(e,t){return new r(e,t)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}};Oh.SourceLanguageConfig=LS});var yO=h(mi=>{"use strict";Object.defineProperty(mi,"__esModule",{value:!0});mi.SpeakerRecognitionCancellationDetails=mi.SpeakerRecognitionResult=mi.SpeakerRecognitionResultType=void 0;var mO=T(),kt=P(),Dh;(function(r){r[r.Verify=0]="Verify",r[r.Identify=1]="Identify"})(Dh=mi.SpeakerRecognitionResultType||(mi.SpeakerRecognitionResultType={}));var qS=class{constructor(e,t=kt.ResultReason.RecognizedSpeaker,i=kt.CancellationErrorCode.NoError,n=""){this.privProperties=new kt.PropertyCollection;let s=e.scenario==="TextIndependentIdentification"?Dh.Identify:Dh.Verify;this.privReason=t,this.privReason!==kt.ResultReason.Canceled?s===Dh.Identify?(this.privProfileId=e.identificationResult.identifiedProfile.profileId,this.privScore=e.identificationResult.identifiedProfile.score,this.privReason=kt.ResultReason.RecognizedSpeakers):(this.privScore=e.verificationResult.score,e.verificationResult.recognitionResult.toLowerCase()!=="accept"&&(this.privReason=kt.ResultReason.NoMatch),e.verificationResult.profileId!==void 0&&e.verificationResult.profileId!==""&&(this.privProfileId=e.verificationResult.profileId)):(this.privErrorDetails=n,this.privProperties.setProperty(mO.CancellationErrorCodePropertyName,kt.CancellationErrorCode[i])),this.privProperties.setProperty(kt.PropertyId.SpeechServiceResponse_JsonResult,JSON.stringify(e))}get properties(){return this.privProperties}get reason(){return this.privReason}get profileId(){return this.privProfileId}get errorDetails(){return this.privErrorDetails}get score(){return this.privScore}};mi.SpeakerRecognitionResult=qS;var zS=class r extends kt.CancellationDetailsBase{constructor(e,t,i){super(e,t,i)}static fromResult(e){let t=kt.CancellationReason.Error,i=kt.CancellationErrorCode.NoError;return e.properties&&(i=kt.CancellationErrorCode[e.properties.getProperty(mO.CancellationErrorCodePropertyName,kt.CancellationErrorCode[kt.CancellationErrorCode.NoError])]),new r(t,e.errorDetails,i)}};mi.SpeakerRecognitionCancellationDetails=zS});var FS=h(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});go.ConversationImpl=go.Conversation=void 0;var ie=T(),pc=x(),E=j(),re=P(),xh=class{constructor(){}static createConversationAsync(e,t,i,n){E.Contracts.throwIfNullOrUndefined(e,ie.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),E.Contracts.throwIfNullOrUndefined(e.region,ie.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),!e.subscriptionKey&&!e.getProperty(re.PropertyId[re.PropertyId.SpeechServiceAuthorization_Token])&&E.Contracts.throwIfNullOrUndefined(e.subscriptionKey,ie.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));let s,o,a;return typeof t=="string"?(s=new lc(e,t),pc.marshalPromiseToCallbacks(v(this,null,function*(){}),i,n)):(s=new lc(e),o=t,a=i,s.createConversationAsync(()=>{o&&o()},c=>{a&&a(c)})),s}};go.Conversation=xh;var lc=class extends xh{constructor(e,t){if(super(),this.privErrors=ie.ConversationConnectionConfig.restErrors,this.onConnected=s=>{this.privIsConnected=!0;try{this.privConversationTranslator?.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,s)}catch{}},this.onDisconnected=s=>{try{this.privConversationTranslator?.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,s)}catch{}finally{this.close(!1)}},this.onCanceled=(s,o)=>{try{this.privConversationTranslator?.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,o)}catch{}},this.onParticipantUpdateCommandReceived=(s,o)=>{try{let a=this.privParticipants.getParticipant(o.id);if(a!==void 0){switch(o.key){case ie.ConversationTranslatorCommandTypes.changeNickname:a.displayName=o.value;break;case ie.ConversationTranslatorCommandTypes.setUseTTS:a.isUsingTts=o.value;break;case ie.ConversationTranslatorCommandTypes.setProfanityFiltering:a.profanity=o.value;break;case ie.ConversationTranslatorCommandTypes.setMute:a.isMuted=o.value;break;case ie.ConversationTranslatorCommandTypes.setTranslateToLanguages:a.translateToLanguages=o.value;break}this.privParticipants.addOrUpdateParticipant(a),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new re.ConversationParticipantsChangedEventArgs(re.ParticipantChangedReason.Updated,[this.toParticipant(a)],o.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(s,o)=>{try{this.privParticipants.participants.forEach(a=>a.isMuted=a.isHost?!1:o.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new re.ConversationParticipantsChangedEventArgs(re.ParticipantChangedReason.Updated,this.toParticipants(!1),o.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(s,o)=>{try{let a=this.privParticipants.addOrUpdateParticipant(o.participant);a!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new re.ConversationParticipantsChangedEventArgs(re.ParticipantChangedReason.JoinedConversation,[this.toParticipant(a)],o.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(s,o)=>{try{let a=this.privParticipants.getParticipant(o.participant.id);a!==void 0&&(this.privParticipants.deleteParticipant(o.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new re.ConversationParticipantsChangedEventArgs(re.ParticipantChangedReason.LeftConversation,[this.toParticipant(a)],o.sessionId)))}catch{}},this.onTranslationReceived=(s,o)=>{try{switch(o.command){case ie.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new re.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break;case ie.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new re.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break;case ie.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new re.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break}}catch{}},this.onParticipantsListReceived=(s,o)=>{try{if(o.sessionToken!==void 0&&o.sessionToken!==null&&(this.privRoom.token=o.sessionToken),this.privParticipants.participants=[...o.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new re.ConversationParticipantsChangedEventArgs(re.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),o.sessionId)),this.me.isHost){let a=this.privConversationTranslator?.properties.getProperty(re.PropertyId.ConversationTranslator_Name);a!==void 0&&a.length>0&&a!==this.me.displayName&&this.changeNicknameAsync(a)}}catch{}},this.onConversationExpiration=(s,o)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,o)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new re.PropertyCollection,this.privManager=new ie.ConversationManager,e.getProperty(re.PropertyId[re.PropertyId.SpeechServiceConnection_RecoLanguage])||e.setProperty(re.PropertyId[re.PropertyId.SpeechServiceConnection_RecoLanguage],ie.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=e.getProperty(re.PropertyId[re.PropertyId.SpeechServiceConnection_RecoLanguage]),t)this.privConversationId=t;else{e.targetLanguages.length===0&&e.addTargetLanguage(this.privLanguage),e.getProperty(re.PropertyId[re.PropertyId.SpeechServiceResponse_ProfanityOption])||e.setProfanity(re.ProfanityOption.Masked);let o=e.getProperty(re.PropertyId[re.PropertyId.ConversationTranslator_Name]);o==null&&(o="Host"),E.Contracts.throwIfNullOrTooLong(o,"nickname",50),E.Contracts.throwIfNullOrTooShort(o,"nickname",2),e.setProperty(re.PropertyId[re.PropertyId.ConversationTranslator_Name],o)}this.privConfig=e;let n=e;E.Contracts.throwIfNull(n,"speechConfig"),this.privProperties=n.properties.clone(),this.privIsConnected=!1,this.privParticipants=new ie.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){return this.privParticipants.me?.isHost?!1:this.privParticipants.me?.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){let e=this.conversationId,t=this.participants.map(s=>({id:s.id,preferredLanguage:s.preferredLanguage,voice:s.voice})),i={};for(let s of ie.ConversationConnectionConfig.transcriptionEventKeys){let o=this.properties.getProperty(s,"");o!==""&&(i[s]=o)}return{id:e,participants:t,conversationProperties:i}}get canSend(){return this.privIsConnected&&!this.privParticipants.me?.isMuted}get canSendAsHost(){return this.privIsConnected&&this.privParticipants.me?.isHost}get authorizationToken(){return this.privToken}set authorizationToken(e){E.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),this.privToken=e}set conversationTranslator(e){this.privConversationTranslator=e}onToken(e){this.privConversationTranslator.onToken(e)}createConversationAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),this.privManager.createOrJoin(this.privProperties,void 0,i=>{i||this.handleError(new Error(this.privErrors.permissionDeniedConnect),t),this.privRoom=i,this.handleCallback(e,t)},i=>{this.handleError(i,t)})}catch(i){this.handleError(i,t)}}startConversationAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),E.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=ie.ConversationRecognizerFactory.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(e,t)},i=>{this.handleError(i,t)})}catch(i){this.handleError(i,t)}}addParticipantAsync(e,t,i){E.Contracts.throwIfNullOrUndefined(e,"Participant"),pc.marshalPromiseToCallbacks(this.addParticipantImplAsync(e),t,i)}joinConversationAsync(e,t,i,n,s){try{E.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","conversationId")),E.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),E.Contracts.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,e,o=>{E.Contracts.throwIfNullOrUndefined(o,this.privErrors.permissionDeniedConnect),this.privRoom=o,this.privConfig.authorizationToken=o.cognitiveSpeechAuthToken,n&&n(o.cognitiveSpeechAuthToken)},o=>{this.handleError(o,s)})}catch(o){this.handleError(o,s)}}deleteConversationAsync(e,t){pc.marshalPromiseToCallbacks(this.deleteConversationImplAsync(),e,t)}deleteConversationImplAsync(){return v(this,null,function*(){E.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),E.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),yield this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()})}endConversationAsync(e,t){pc.marshalPromiseToCallbacks(this.endConversationImplAsync(),e,t)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(e,t){try{E.Contracts.throwIfDisposed(this.privIsDisposed),E.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),E.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(e,t)},i=>{this.handleError(i,t)})}catch(i){this.handleError(i,t)}}muteAllParticipantsAsync(e,t){try{E.Contracts.throwIfDisposed(this.privIsDisposed),E.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),E.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),E.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(e,t)},i=>{this.handleError(i,t)})}catch(i){this.handleError(i,t)}}muteParticipantAsync(e,t,i){try{E.Contracts.throwIfDisposed(this.privIsDisposed),E.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),E.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),E.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),!this.me.isHost&&this.me.id!==e&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),i),this.privParticipants.getParticipantIndex(e)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!0),()=>{this.handleCallback(t,i)},s=>{this.handleError(s,i)})}catch(n){this.handleError(n,i)}}removeParticipantAsync(e,t,i){try{if(E.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&e.hasOwnProperty("id"))pc.marshalPromiseToCallbacks(this.removeParticipantImplAsync(e),t,i);else{E.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),E.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),i);let n="";typeof e=="string"?n=e:e.hasOwnProperty("id")?n=e.id:e.hasOwnProperty("userId")&&(n=e.userId),E.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(o=>o.id===n)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(n),()=>{this.handleCallback(t,i)},o=>{this.handleError(o,i)})}}catch(n){this.handleError(n,i)}}unlockConversationAsync(e,t){try{E.Contracts.throwIfDisposed(this.privIsDisposed),E.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),E.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(e,t)},i=>{this.handleError(i,t)})}catch(i){this.handleError(i,t)}}unmuteAllParticipantsAsync(e,t){try{E.Contracts.throwIfDisposed(this.privIsDisposed),E.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),E.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(e,t)},i=>{this.handleError(i,t)})}catch(i){this.handleError(i,t)}}unmuteParticipantAsync(e,t,i){try{E.Contracts.throwIfDisposed(this.privIsDisposed),E.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),E.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),E.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),!this.me.isHost&&this.me.id!==e&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),i),this.privParticipants.getParticipantIndex(e)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!1),()=>{this.handleCallback(t,i)},s=>{this.handleError(s,i)})}catch(n){this.handleError(n,i)}}sendTextMessageAsync(e,t,i){try{E.Contracts.throwIfDisposed(this.privIsDisposed),E.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),E.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","message")),E.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),e.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(e),()=>{this.handleCallback(t,i)},n=>{this.handleError(n,i)})}catch(n){this.handleError(n,i)}}setTranslatedLanguagesAsync(e,t,i){try{E.Contracts.throwIfDisposed(this.privIsDisposed),E.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),E.Contracts.throwIfArrayEmptyOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","languages")),E.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(e),()=>{this.handleCallback(t,i)},n=>{this.handleError(n,i)})}catch(n){this.handleError(n,i)}}changeNicknameAsync(e,t,i){try{E.Contracts.throwIfDisposed(this.privIsDisposed),E.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),E.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","nickname")),E.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(e),()=>{this.handleCallback(t,i)},n=>{this.handleError(n,i)})}catch(n){this.handleError(n,i)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}connectTranscriberRecognizer(e){return v(this,null,function*(){this.privTranscriberRecognizer&&(yield this.privTranscriberRecognizer.close()),yield e.enforceAudioGating(),this.privTranscriberRecognizer=e,this.privTranscriberRecognizer.conversation=this})}getKeepAlive(){let e=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:e,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:ie.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(e){if(this.privParticipants.addOrUpdateParticipant(e)!==void 0&&this.privTranscriberRecognizer){let i=this.conversationInfo;return i.participants=[e],this.privTranscriberRecognizer.pushConversationEvent(i,"join")}}removeParticipantImplAsync(e){this.privParticipants.deleteParticipant(e.id);let t=this.conversationInfo;return t.participants=[e],this.privTranscriberRecognizer.pushConversationEvent(t,"leave")}close(e){return v(this,null,function*(){try{this.privIsConnected=!1,yield this.privConversationRecognizer?.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(t){throw t}e&&this.dispose()})}handleCallback(e,t){if(e){try{e()}catch(i){t&&t(i)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){let i=e;t(i.name+": "+i.message)}else t(e)}toParticipants(e){let t=this.privParticipants.participants.map(i=>this.toParticipant(i));return e?t:t.filter(i=>i.isHost===!1)}toParticipant(e){return new re.Participant(e.id,e.avatar,e.displayName,e.isHost,e.isMuted,e.isUsingTts,e.preferredLanguage,e.voice)}getMuteAllCommand(e){return E.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),E.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:ie.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:ie.ConversationTranslatorMessageTypes.participantCommand,value:e})}getMuteCommand(e,t){return E.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),E.Contracts.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:ie.ConversationTranslatorCommandTypes.setMute,participantId:e,roomid:this.privRoom.roomId,type:ie.ConversationTranslatorMessageTypes.participantCommand,value:t})}getLockCommand(e){return E.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),E.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:ie.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:ie.ConversationTranslatorMessageTypes.participantCommand,value:e})}getEjectCommand(e){return E.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),E.Contracts.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:ie.ConversationTranslatorCommandTypes.ejectParticipant,participantId:e,roomid:this.privRoom.roomId,type:ie.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(e){return E.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),E.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:ie.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:ie.ConversationTranslatorMessageTypes.participantCommand,value:e})}getChangeNicknameCommand(e){return E.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),E.Contracts.throwIfNullOrWhitespace(e,"nickname"),E.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:ie.ConversationTranslatorCommandTypes.changeNickname,nickname:e,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:ie.ConversationTranslatorMessageTypes.participantCommand,value:e})}getMessageCommand(e){return E.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),E.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),E.Contracts.throwIfNullOrWhitespace(e,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:e,type:ie.ConversationTranslatorMessageTypes.instantMessage})}};go.ConversationImpl=lc});var SO=h(Mh=>{"use strict";Object.defineProperty(Mh,"__esModule",{value:!0});Mh.ConversationCommon=void 0;var BS=class{constructor(e){this.privAudioConfig=e}handleCallback(e,t){if(e){try{e()}catch(i){t&&t(i)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){let i=e;t(i.name+": "+i.message)}else t(e)}};Mh.ConversationCommon=BS});var CO=h(kh=>{"use strict";Object.defineProperty(kh,"__esModule",{value:!0});kh.ConversationExpirationEventArgs=void 0;var M3=P(),US=class extends M3.SessionEventArgs{constructor(e,t){super(t),this.privExpirationTime=e}get expirationTime(){return this.privExpirationTime}};kh.ConversationExpirationEventArgs=US});var bO=h(Nh=>{"use strict";Object.defineProperty(Nh,"__esModule",{value:!0});Nh.ConversationParticipantsChangedEventArgs=void 0;var k3=P(),WS=class extends k3.SessionEventArgs{constructor(e,t,i){super(i),this.privReason=e,this.privParticipant=t}get reason(){return this.privReason}get participants(){return this.privParticipant}};Nh.ConversationParticipantsChangedEventArgs=WS});var PO=h(jh=>{"use strict";Object.defineProperty(jh,"__esModule",{value:!0});jh.ConversationTranslationCanceledEventArgs=void 0;var N3=so(),HS=class extends N3.CancellationEventArgsBase{};jh.ConversationTranslationCanceledEventArgs=HS});var wO=h(Lh=>{"use strict";Object.defineProperty(Lh,"__esModule",{value:!0});Lh.ConversationTranslationEventArgs=void 0;var j3=P(),VS=class extends j3.RecognitionEventArgs{constructor(e,t,i){super(t,i),this.privResult=e}get result(){return this.privResult}};Lh.ConversationTranslationEventArgs=VS});var _O=h(qh=>{"use strict";Object.defineProperty(qh,"__esModule",{value:!0});qh.ConversationTranslationResult=void 0;var L3=qy(),$S=class extends L3.TranslationRecognitionResult{constructor(e,t,i,n,s,o,a,c,u,p,l){super(t,n,s,o,a,c,void 0,void 0,u,p,l),this.privId=e,this.privOrigLang=i}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}};qh.ConversationTranslationResult=$S});var GS=h(zh=>{"use strict";Object.defineProperty(zh,"__esModule",{value:!0});zh.StringUtils=void 0;var KS=class{static formatString(e,t){if(!e)return"";if(!t)return e;let i="",n="",s=c=>{i+=c},o=c=>{n+=c},a=s;for(let c=0;c<e.length;c++){let u=e[c],p=c+1<e.length?e[c+1]:"";switch(u){case"{":p==="{"?(a("{"),c++):a=o;break;case"}":p==="}"?(a("}"),c++):(t.hasOwnProperty(n)&&(i+=t[n]),a=s,n="");break;default:a(u);break}}return i}};zh.StringUtils=KS});var IO=h(Uh=>{"use strict";Object.defineProperty(Uh,"__esModule",{value:!0});Uh.ConversationTranslatorConnectionFactory=void 0;var JS=Le(),RO=GS(),q3=j(),Fh=P(),z3=ot(),cr=gi(),EO=ar(),YS=T(),Bh=class r extends EO.ConnectionFactoryBase{constructor(e){super(),q3.Contracts.throwIfNullOrUndefined(e,"convGetter"),this.privConvGetter=e}create(e,t,i){let n=e.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase()==="TRUE",s=this.privConvGetter().room,o=s.cognitiveSpeechRegion||e.parameters.getProperty(Fh.PropertyId.SpeechServiceConnection_Region,""),a={hostSuffix:EO.ConnectionFactoryBase.getHostSuffix(o),path:r.CTS_VIRT_MIC_PATH,region:encodeURIComponent(o)};a[cr.QueryParameterNames.Language]=encodeURIComponent(e.parameters.getProperty(Fh.PropertyId.SpeechServiceConnection_RecoLanguage,"")),a[cr.QueryParameterNames.CtsMeetingId]=encodeURIComponent(s.roomId),a[cr.QueryParameterNames.CtsDeviceId]=encodeURIComponent(s.participantId),a[cr.QueryParameterNames.CtsIsParticipant]=s.isHost?"":"&"+cr.QueryParameterNames.CtsIsParticipant;let c="",u={},p={};if(n){c=e.parameters.getProperty(Fh.PropertyId.SpeechServiceConnection_Endpoint),c||(c="wss://"+e.parameters.getProperty(Fh.PropertyId.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"),c=RO.StringUtils.formatString(c,a);let d=new URL(c);d.searchParams.forEach((g,m)=>{u[m]=g}),new YS.TranscriberConnectionFactory().setQueryParams(u,e,c),u[cr.QueryParameterNames.CtsMeetingId]=a[cr.QueryParameterNames.CtsMeetingId],u[cr.QueryParameterNames.CtsDeviceId]=a[cr.QueryParameterNames.CtsDeviceId],s.isHost||(u[cr.QueryParameterNames.CtsIsParticipant]=""),cr.QueryParameterNames.Format in u||(u[cr.QueryParameterNames.Format]="simple"),d.searchParams.forEach((g,m)=>{d.searchParams.set(m,u[m]),delete u[m]}),c=d.toString()}else{let d=new YS.TranslationConnectionFactory;c=d.getEndpointUrl(e,!0),c=RO.StringUtils.formatString(c,a),d.setQueryParams(u,e,c)}p[z3.HeaderNames.ConnectionId]=i,p[JS.RestConfigBase.configParams.token]=s.token,t.token&&(p[t.headerName]=t.token);let l=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase()==="TRUE";return new JS.WebsocketConnection(c,u,p,new YS.WebsocketMessageFormatter,JS.ProxyInfo.fromRecognizerConfig(e),l,i)}};Uh.ConversationTranslatorConnectionFactory=Bh;Bh.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio"});var AO=h(Hn=>{"use strict";Object.defineProperty(Hn,"__esModule",{value:!0});Hn.ConversationTranslator=Hn.SpeechState=void 0;var hc=T(),F3=IO(),Wh=x(),Ir=j(),fe=P(),B3=FS(),TO=Hh(),Tr;(function(r){r[r.Inactive=0]="Inactive",r[r.Connecting=1]="Connecting",r[r.Connected=2]="Connected"})(Tr=Hn.SpeechState||(Hn.SpeechState={}));var QS=class extends fe.TranslationRecognizer{constructor(e,t,i,n){super(e,t,new F3.ConversationTranslatorConnectionFactory(n)),this.privSpeechState=Tr.Inactive,i&&(this.privTranslator=i,this.sessionStarted=()=>{this.privSpeechState=Tr.Connected},this.sessionStopped=()=>{this.privSpeechState=Tr.Inactive},this.recognizing=(s,o)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,o)},this.recognized=(s,o)=>v(this,null,function*(){o.result?.errorDetails?(yield this.cancelSpeech(),this.fireCancelEvent(o.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,o)}),this.canceled=()=>v(this,null,function*(){if(this.privSpeechState!==Tr.Inactive)try{yield this.cancelSpeech()}catch{this.privSpeechState=Tr.Inactive}}))}get state(){return this.privSpeechState}set state(e){this.privSpeechState=e}set authentication(e){this.privReco.authentication=e}onConnection(){this.privSpeechState=Tr.Connected}onCancelSpeech(){return v(this,null,function*(){this.privSpeechState=Tr.Inactive,yield this.cancelSpeech()})}fireCancelEvent(e){try{if(this.privTranslator.canceled){let t=new TO.ConversationTranslationCanceledEventArgs(fe.CancellationReason.Error,e,fe.CancellationErrorCode.RuntimeError);this.privTranslator.canceled(this.privTranslator,t)}}catch{}}cancelSpeech(){return v(this,null,function*(){try{this.stopContinuousRecognitionAsync(),yield this.privReco?.disconnect(),this.privSpeechState=Tr.Inactive}catch{}})}},XS=class extends TO.ConversationCommon{constructor(e){super(e),this.privErrors=hc.ConversationConnectionConfig.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new fe.PropertyCollection}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){return this.privConversation?.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer||this.privIsSpeaking||this.privCTRecognizer.state===Tr.Connected||this.privCTRecognizer.state===Tr.Connecting||this.privConversation.isMutedByHost)}onToken(e){this.privCTRecognizer.authentication=e}setServiceProperty(e,t){let i=JSON.parse(this.privProperties.getProperty(hc.ServicePropertiesPropertyName,"{}"));i[e]=t,this.privProperties.setProperty(hc.ServicePropertiesPropertyName,JSON.stringify(i))}joinConversationAsync(e,t,i,n,s){try{if(typeof e=="string"){Ir.Contracts.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","conversation id")),Ir.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),s);let o=i;(o==null||o==="")&&(o=hc.ConversationConnectionConfig.defaultLanguageCode),this.privSpeechTranslationConfig=fe.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(fe.ProfanityOption.Masked),this.privSpeechTranslationConfig.addTargetLanguage(o),this.privSpeechTranslationConfig.setProperty(fe.PropertyId[fe.PropertyId.SpeechServiceConnection_RecoLanguage],o),this.privSpeechTranslationConfig.setProperty(fe.PropertyId[fe.PropertyId.ConversationTranslator_Name],t);let a=[fe.PropertyId.SpeechServiceConnection_Host,fe.PropertyId.ConversationTranslator_Host,fe.PropertyId.SpeechServiceConnection_Endpoint,fe.PropertyId.SpeechServiceConnection_ProxyHostName,fe.PropertyId.SpeechServiceConnection_ProxyPassword,fe.PropertyId.SpeechServiceConnection_ProxyPort,fe.PropertyId.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(let u of a){let p=this.privProperties.getProperty(u);if(p){let l=typeof u=="string"?u:fe.PropertyId[u];this.privSpeechTranslationConfig.setProperty(l,p)}}let c=JSON.parse(this.privProperties.getProperty(hc.ServicePropertiesPropertyName,"{}"));for(let u of Object.keys(c))this.privSpeechTranslationConfig.setServiceProperty(u,c[u],fe.ServicePropertyChannel.UriQueryParameter);this.privConversation=new B3.ConversationImpl(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(e,t,o,u=>{u||this.handleError(new Error(this.privErrors.permissionDeniedConnect),s),this.privSpeechTranslationConfig.authorizationToken=u,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync(()=>{this.handleCallback(n,s)},p=>{this.handleError(p,s)})},u=>{this.handleError(u,s)})}else typeof e=="object"?(Ir.Contracts.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","conversation id")),Ir.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(fe.PropertyId.ConversationTranslator_Name,t),this.privConversation=e,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,Ir.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),Ir.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=e.config,this.handleCallback(i,n)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),n)}catch(o){this.handleError(o,typeof i=="string"?s:n)}}leaveConversationAsync(e,t){Wh.marshalPromiseToCallbacks(v(this,null,function*(){yield this.cancelSpeech(),yield this.privConversation.endConversationImplAsync(),yield this.privConversation.deleteConversationImplAsync(),this.dispose()}),e,t)}sendTextMessageAsync(e,t,i){try{Ir.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),Ir.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}",e)),this.privConversation.sendTextMessageAsync(e,t,i)}catch(n){this.handleError(n,i)}}startTranscribingAsync(e,t){Wh.marshalPromiseToCallbacks(v(this,null,function*(){try{Ir.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),Ir.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privCTRecognizer===void 0&&(yield this.connectTranslatorRecognizer()),Ir.Contracts.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),t),yield this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(i){throw this.privIsSpeaking=!1,yield this.cancelSpeech(),i}}),e,t)}stopTranscribingAsync(e,t){Wh.marshalPromiseToCallbacks(v(this,null,function*(){try{if(!this.privIsSpeaking){yield this.cancelSpeech();return}this.privIsSpeaking=!1,yield new Promise((i,n)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(i,n)})}catch{yield this.cancelSpeech()}}),e,t)}isDisposed(){return this.privIsDisposed}dispose(e,t,i){Wh.marshalPromiseToCallbacks(v(this,null,function*(){this.isDisposed&&!this.privIsSpeaking||(yield this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)}),t,i)}cancelSpeech(){return v(this,null,function*(){try{this.privIsSpeaking=!1,yield this.privCTRecognizer?.onCancelSpeech(),this.privCTRecognizer=void 0}catch{}})}connectTranslatorRecognizer(){return v(this,null,function*(){try{this.privAudioConfig===void 0&&(this.privAudioConfig=fe.AudioConfig.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(fe.PropertyId[fe.PropertyId.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(fe.PropertyId[fe.PropertyId.SpeechServiceConnection_Key],"");let e=()=>this.privConversation;this.privCTRecognizer=new QS(this.privSpeechTranslationConfig,this.privAudioConfig,this,e)}catch(e){throw yield this.cancelSpeech(),e}})}startContinuousRecognition(){return new Promise((e,t)=>{this.privCTRecognizer.startContinuousRecognitionAsync(e,t)})}};Hn.ConversationTranslator=XS});var OO=h(Vh=>{"use strict";Object.defineProperty(Vh,"__esModule",{value:!0});Vh.ConversationTranscriber=void 0;var dc=T(),ZS=x(),Vn=j(),St=P(),eC=class r extends St.Recognizer{constructor(e,t){let i=e;Vn.Contracts.throwIfNull(i,"speechConfig"),Vn.Contracts.throwIfNullOrWhitespace(i.properties.getProperty(St.PropertyId.SpeechServiceConnection_RecoLanguage),St.PropertyId[St.PropertyId.SpeechServiceConnection_RecoLanguage]),super(t,i.properties,new dc.ConversationTranscriberConnectionFactory),this.privProperties.setProperty(St.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privDisposedRecognizer=!1}static FromConfig(e,t,i){let n=e;return t.properties.mergeTo(n.properties),new r(e,i)}get endpointId(){return Vn.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(St.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(St.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){Vn.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(St.PropertyId.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return Vn.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(St.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return Vn.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(dc.OutputFormatPropertyName,St.OutputFormat[St.OutputFormat.Simple])===St.OutputFormat[St.OutputFormat.Simple]?St.OutputFormat.Simple:St.OutputFormat.Detailed}get properties(){return this.privProperties}startTranscribingAsync(e,t){ZS.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(dc.RecognitionMode.Conversation),e,t)}stopTranscribingAsync(e,t){ZS.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),e,t)}close(e,t){Vn.Contracts.throwIfDisposed(this.privDisposedRecognizer),ZS.marshalPromiseToCallbacks(this.dispose(!0),e,t)}dispose(e){return v(this,null,function*(){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,yield this.implRecognizerStop()),yield Te(r.prototype,this,"dispose").call(this,e))})}createRecognizerConfig(e){return new dc.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,i,n){let s=i;return n.isSpeakerDiarizationEnabled=!0,new dc.ConversationTranscriptionServiceRecognizer(e,t,s,n,this)}};Vh.ConversationTranscriber=eC});var DO=h(mo=>{"use strict";Object.defineProperty(mo,"__esModule",{value:!0});mo.Participant=mo.User=void 0;var U3=P(),tC=class{constructor(e){this.privUserId=e}get userId(){return this.privUserId}};mo.User=tC;var rC=class r{constructor(e,t,i,n,s,o,a,c){this.privId=e,this.privAvatar=t,this.privDisplayName=i,this.privIsHost=n,this.privIsMuted=s,this.privIsUsingTts=o,this.privPreferredLanguage=a,this.privVoice=c,this.privProperties=new U3.PropertyCollection}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(e,t,i){return new r(e,"",e,!1,!1,!1,t,i)}};mo.Participant=rC});var xO=h(fc=>{"use strict";Object.defineProperty(fc,"__esModule",{value:!0});fc.ParticipantChangedReason=void 0;var W3;(function(r){r[r.JoinedConversation=0]="JoinedConversation",r[r.LeftConversation=1]="LeftConversation",r[r.Updated=2]="Updated"})(W3=fc.ParticipantChangedReason||(fc.ParticipantChangedReason={}))});var MO=h(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});yo.MeetingImpl=yo.Meeting=void 0;var se=T(),vc=x(),I=j(),ge=P(),$h=class{constructor(){}static createMeetingAsync(e,t,i,n){if(I.Contracts.throwIfNullOrUndefined(e,se.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),I.Contracts.throwIfNullOrUndefined(e.region,se.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),I.Contracts.throwIfNull(t,"meetingId"),t.length===0)throw new Error("meetingId cannot be empty");!e.subscriptionKey&&!e.getProperty(ge.PropertyId[ge.PropertyId.SpeechServiceAuthorization_Token])&&I.Contracts.throwIfNullOrUndefined(e.subscriptionKey,se.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));let s=new Kh(e,t);return vc.marshalPromiseToCallbacks(v(this,null,function*(){}),i,n),s}};yo.Meeting=$h;var Kh=class extends $h{constructor(e,t){super(),this.privErrors=se.ConversationConnectionConfig.restErrors,this.onConnected=s=>{this.privIsConnected=!0;try{this.privConversationTranslator?.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,s)}catch{}},this.onDisconnected=s=>{try{this.privConversationTranslator?.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,s)}catch{}finally{this.close(!1)}},this.onCanceled=(s,o)=>{try{this.privConversationTranslator?.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,o)}catch{}},this.onParticipantUpdateCommandReceived=(s,o)=>{try{let a=this.privParticipants.getParticipant(o.id);if(a!==void 0){switch(o.key){case se.ConversationTranslatorCommandTypes.changeNickname:a.displayName=o.value;break;case se.ConversationTranslatorCommandTypes.setUseTTS:a.isUsingTts=o.value;break;case se.ConversationTranslatorCommandTypes.setProfanityFiltering:a.profanity=o.value;break;case se.ConversationTranslatorCommandTypes.setMute:a.isMuted=o.value;break;case se.ConversationTranslatorCommandTypes.setTranslateToLanguages:a.translateToLanguages=o.value;break}this.privParticipants.addOrUpdateParticipant(a),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new ge.ConversationParticipantsChangedEventArgs(ge.ParticipantChangedReason.Updated,[this.toParticipant(a)],o.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(s,o)=>{try{this.privParticipants.participants.forEach(a=>a.isMuted=a.isHost?!1:o.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new ge.ConversationParticipantsChangedEventArgs(ge.ParticipantChangedReason.Updated,this.toParticipants(!1),o.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(s,o)=>{try{let a=this.privParticipants.addOrUpdateParticipant(o.participant);a!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new ge.ConversationParticipantsChangedEventArgs(ge.ParticipantChangedReason.JoinedConversation,[this.toParticipant(a)],o.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(s,o)=>{try{let a=this.privParticipants.getParticipant(o.participant.id);a!==void 0&&(this.privParticipants.deleteParticipant(o.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new ge.ConversationParticipantsChangedEventArgs(ge.ParticipantChangedReason.LeftConversation,[this.toParticipant(a)],o.sessionId)))}catch{}},this.onTranslationReceived=(s,o)=>{try{switch(o.command){case se.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new ge.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break;case se.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new ge.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break;case se.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new ge.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break}}catch{}},this.onParticipantsListReceived=(s,o)=>{try{if(o.sessionToken!==void 0&&o.sessionToken!==null&&(this.privRoom.token=o.sessionToken),this.privParticipants.participants=[...o.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new ge.ConversationParticipantsChangedEventArgs(ge.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),o.sessionId)),this.me.isHost){let a=this.privConversationTranslator?.properties.getProperty(ge.PropertyId.ConversationTranslator_Name);a!==void 0&&a.length>0&&a!==this.me.displayName&&this.changeNicknameAsync(a)}}catch{}},this.onConversationExpiration=(s,o)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,o)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new ge.PropertyCollection,this.privManager=new se.ConversationManager,e.getProperty(ge.PropertyId[ge.PropertyId.SpeechServiceConnection_RecoLanguage])||e.setProperty(ge.PropertyId[ge.PropertyId.SpeechServiceConnection_RecoLanguage],se.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=e.getProperty(ge.PropertyId[ge.PropertyId.SpeechServiceConnection_RecoLanguage]),this.privConversationId=t,this.privConfig=e;let n=e;I.Contracts.throwIfNull(n,"speechConfig"),this.privProperties=n.properties.clone(),this.privIsConnected=!1,this.privParticipants=new se.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get meetingId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){return this.privParticipants.me?.isHost?!1:this.privParticipants.me?.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get meetingInfo(){let e=this.meetingId,t=this.participants.map(s=>({id:s.id,preferredLanguage:s.preferredLanguage,voice:s.voice})),i={};for(let s of se.ConversationConnectionConfig.transcriptionEventKeys){let o=this.properties.getProperty(s,"");o!==""&&(i[s]=o)}return{id:e,participants:t,meetingProperties:i}}get canSend(){return this.privIsConnected&&!this.privParticipants.me?.isMuted}get canSendAsHost(){return this.privIsConnected&&this.privParticipants.me?.isHost}get authorizationToken(){return this.privToken}set authorizationToken(e){I.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),this.privToken=e}createMeetingAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),this.privManager.createOrJoin(this.privProperties,void 0,i=>{i||this.handleError(new Error(this.privErrors.permissionDeniedConnect),t),this.privRoom=i,this.handleCallback(e,t)},i=>{this.handleError(i,t)})}catch(i){this.handleError(i,t)}}startMeetingAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(e,t)},i=>{this.handleError(i,t)})}catch(i){this.handleError(i,t)}}addParticipantAsync(e,t,i){I.Contracts.throwIfNullOrUndefined(e,"Participant"),vc.marshalPromiseToCallbacks(this.addParticipantImplAsync(e),t,i)}joinMeetingAsync(e,t,i,n,s){try{I.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","conversationId")),I.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),I.Contracts.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,e,o=>{I.Contracts.throwIfNullOrUndefined(o,this.privErrors.permissionDeniedConnect),this.privRoom=o,this.privConfig.authorizationToken=o.cognitiveSpeechAuthToken,n&&n(o.cognitiveSpeechAuthToken)},o=>{this.handleError(o,s)})}catch(o){this.handleError(o,s)}}deleteMeetingAsync(e,t){vc.marshalPromiseToCallbacks(this.deleteMeetingImplAsync(),e,t)}deleteMeetingImplAsync(){return v(this,null,function*(){I.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),I.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),yield this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()})}endMeetingAsync(e,t){vc.marshalPromiseToCallbacks(this.endMeetingImplAsync(),e,t)}endMeetingImplAsync(){return this.close(!0)}lockMeetingAsync(e,t){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(e,t)},i=>{this.handleError(i,t)})}catch(i){this.handleError(i,t)}}muteAllParticipantsAsync(e,t){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(e,t)},i=>{this.handleError(i,t)})}catch(i){this.handleError(i,t)}}muteParticipantAsync(e,t,i){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),!this.me.isHost&&this.me.id!==e&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),i),this.privParticipants.getParticipantIndex(e)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!0),()=>{this.handleCallback(t,i)},s=>{this.handleError(s,i)})}catch(n){this.handleError(n,i)}}removeParticipantAsync(e,t,i){try{if(I.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&e.hasOwnProperty("id"))vc.marshalPromiseToCallbacks(this.removeParticipantImplAsync(e),t,i);else{I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),i);let n="";typeof e=="string"?n=e:e.hasOwnProperty("id")?n=e.id:e.hasOwnProperty("userId")&&(n=e.userId),I.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(o=>o.id===n)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(n),()=>{this.handleCallback(t,i)},o=>{this.handleError(o,i)})}}catch(n){this.handleError(n,i)}}unlockMeetingAsync(e,t){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(e,t)},i=>{this.handleError(i,t)})}catch(i){this.handleError(i,t)}}unmuteAllParticipantsAsync(e,t){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(e,t)},i=>{this.handleError(i,t)})}catch(i){this.handleError(i,t)}}unmuteParticipantAsync(e,t,i){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),!this.me.isHost&&this.me.id!==e&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),i),this.privParticipants.getParticipantIndex(e)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!1),()=>{this.handleCallback(t,i)},s=>{this.handleError(s,i)})}catch(n){this.handleError(n,i)}}sendTextMessageAsync(e,t,i){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","message")),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),e.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(e),()=>{this.handleCallback(t,i)},n=>{this.handleError(n,i)})}catch(n){this.handleError(n,i)}}setTranslatedLanguagesAsync(e,t,i){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfArrayEmptyOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","languages")),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(e),()=>{this.handleCallback(t,i)},n=>{this.handleError(n,i)})}catch(n){this.handleError(n,i)}}changeNicknameAsync(e,t,i){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","nickname")),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(e),()=>{this.handleCallback(t,i)},n=>{this.handleError(n,i)})}catch(n){this.handleError(n,i)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}connectTranscriberRecognizer(e){return v(this,null,function*(){this.privTranscriberRecognizer&&(yield this.privTranscriberRecognizer.close()),yield e.enforceAudioGating(),this.privTranscriberRecognizer=e,this.privTranscriberRecognizer.meeting=this})}getKeepAlive(){let e=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:e,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:se.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(e){if(this.privParticipants.addOrUpdateParticipant(e)!==void 0&&this.privTranscriberRecognizer){let i=this.meetingInfo;return i.participants=[e],this.privTranscriberRecognizer.pushMeetingEvent(i,"join")}}removeParticipantImplAsync(e){this.privParticipants.deleteParticipant(e.id);let t=this.meetingInfo;return t.participants=[e],this.privTranscriberRecognizer.pushMeetingEvent(t,"leave")}close(e){return v(this,null,function*(){try{this.privIsConnected=!1,yield this.privConversationRecognizer?.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(t){throw t}e&&this.dispose()})}handleCallback(e,t){if(e){try{e()}catch(i){t&&t(i)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){let i=e;t(i.name+": "+i.message)}else t(e)}toParticipants(e){let t=this.privParticipants.participants.map(i=>this.toParticipant(i));return e?t:t.filter(i=>i.isHost===!1)}toParticipant(e){return new ge.Participant(e.id,e.avatar,e.displayName,e.isHost,e.isMuted,e.isUsingTts,e.preferredLanguage,e.voice)}getMuteAllCommand(e){return I.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingd"),I.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:se.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:se.ConversationTranslatorMessageTypes.participantCommand,value:e})}getMuteCommand(e,t){return I.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),I.Contracts.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:se.ConversationTranslatorCommandTypes.setMute,participantId:e,roomid:this.privRoom.roomId,type:se.ConversationTranslatorMessageTypes.participantCommand,value:t})}getLockCommand(e){return I.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),I.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:se.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:se.ConversationTranslatorMessageTypes.participantCommand,value:e})}getEjectCommand(e){return I.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),I.Contracts.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:se.ConversationTranslatorCommandTypes.ejectParticipant,participantId:e,roomid:this.privRoom.roomId,type:se.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(e){return I.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),I.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:se.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:se.ConversationTranslatorMessageTypes.participantCommand,value:e})}getChangeNicknameCommand(e){return I.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),I.Contracts.throwIfNullOrWhitespace(e,"nickname"),I.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:se.ConversationTranslatorCommandTypes.changeNickname,nickname:e,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:se.ConversationTranslatorMessageTypes.participantCommand,value:e})}getMessageCommand(e){return I.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),I.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),I.Contracts.throwIfNullOrWhitespace(e,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:e,type:se.ConversationTranslatorMessageTypes.instantMessage})}};yo.MeetingImpl=Kh});var kO=h(Gh=>{"use strict";Object.defineProperty(Gh,"__esModule",{value:!0});Gh.MeetingTranscriptionCanceledEventArgs=void 0;var H3=so(),iC=class extends H3.CancellationEventArgsBase{};Gh.MeetingTranscriptionCanceledEventArgs=iC});var NO=h(Jh=>{"use strict";Object.defineProperty(Jh,"__esModule",{value:!0});Jh.MeetingTranscriber=void 0;var V3=T(),nC=x(),gc=j(),mc=P(),$3=Hh(),sC=class{constructor(e){this.privAudioConfig=e,this.privProperties=new mc.PropertyCollection,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return gc.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(mc.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return mc.Connection.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(mc.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){gc.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(mc.PropertyId.SpeechServiceAuthorization_Token,e)}joinMeetingAsync(e,t,i){let n=e;gc.Contracts.throwIfNullOrUndefined($3.MeetingImpl,"Meeting"),this.privRecognizer=new V3.TranscriberRecognizer(e.config,this.privAudioConfig),gc.Contracts.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectMeetingCallbacks(this),nC.marshalPromiseToCallbacks(n.connectTranscriberRecognizer(this.privRecognizer),t,i)}startTranscribingAsync(e,t){this.privRecognizer.startContinuousRecognitionAsync(e,t)}stopTranscribingAsync(e,t){this.privRecognizer.stopContinuousRecognitionAsync(e,t)}leaveMeetingAsync(e,t){this.privRecognizer.disconnectCallbacks(),nC.marshalPromiseToCallbacks(v(this,null,function*(){}),e,t)}close(e,t){gc.Contracts.throwIfDisposed(this.privDisposedRecognizer),nC.marshalPromiseToCallbacks(this.dispose(!0),e,t)}dispose(e){return v(this,null,function*(){this.privDisposedRecognizer||(this.privRecognizer&&(yield this.privRecognizer.close(),this.privRecognizer=void 0),e&&(this.privDisposedRecognizer=!0))})}};Jh.MeetingTranscriber=sC});var jO=h(Yh=>{"use strict";Object.defineProperty(Yh,"__esModule",{value:!0});Yh.ConversationTranscriptionResult=void 0;var K3=P(),oC=class extends K3.RecognitionResult{constructor(e,t,i,n,s,o,a,c,u,p,l){super(e,t,i,n,s,o,a,u,p,l),this.privSpeakerId=c}get speakerId(){return this.privSpeakerId}};Yh.ConversationTranscriptionResult=oC});var Hh=h(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});var LO=FS();Object.defineProperty(xe,"Conversation",{enumerable:!0,get:function(){return LO.Conversation}});Object.defineProperty(xe,"ConversationImpl",{enumerable:!0,get:function(){return LO.ConversationImpl}});var G3=SO();Object.defineProperty(xe,"ConversationCommon",{enumerable:!0,get:function(){return G3.ConversationCommon}});var J3=CO();Object.defineProperty(xe,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return J3.ConversationExpirationEventArgs}});var Y3=bO();Object.defineProperty(xe,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return Y3.ConversationParticipantsChangedEventArgs}});var Q3=PO();Object.defineProperty(xe,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return Q3.ConversationTranslationCanceledEventArgs}});var X3=wO();Object.defineProperty(xe,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return X3.ConversationTranslationEventArgs}});var Z3=_O();Object.defineProperty(xe,"ConversationTranslationResult",{enumerable:!0,get:function(){return Z3.ConversationTranslationResult}});var e6=AO();Object.defineProperty(xe,"ConversationTranslator",{enumerable:!0,get:function(){return e6.ConversationTranslator}});var t6=OO();Object.defineProperty(xe,"ConversationTranscriber",{enumerable:!0,get:function(){return t6.ConversationTranscriber}});var qO=DO();Object.defineProperty(xe,"Participant",{enumerable:!0,get:function(){return qO.Participant}});Object.defineProperty(xe,"User",{enumerable:!0,get:function(){return qO.User}});var r6=xO();Object.defineProperty(xe,"ParticipantChangedReason",{enumerable:!0,get:function(){return r6.ParticipantChangedReason}});var zO=MO();Object.defineProperty(xe,"Meeting",{enumerable:!0,get:function(){return zO.Meeting}});Object.defineProperty(xe,"MeetingImpl",{enumerable:!0,get:function(){return zO.MeetingImpl}});var i6=kO();Object.defineProperty(xe,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return i6.MeetingTranscriptionCanceledEventArgs}});var n6=NO();Object.defineProperty(xe,"MeetingTranscriber",{enumerable:!0,get:function(){return n6.MeetingTranscriber}});var s6=jO();Object.defineProperty(xe,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return s6.ConversationTranscriptionResult}})});var Qh=h(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});So.SynthesisRequest=So.Synthesizer=void 0;var $n=T(),o6=x(),FO=j(),Xi=P(),aC=class r{constructor(e){let t=e;FO.Contracts.throwIfNull(t,"speechConfig"),this.privProperties=t.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.synthesisRequestQueue=new o6.Queue}get authorizationToken(){return this.properties.getProperty(Xi.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){FO.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Xi.PropertyId.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(Xi.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)===$n.AutoDetectSourceLanguagesOpenRangeOptionName}buildSsml(e){let t={"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-AvaMultilingualNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"},i=this.properties.getProperty(Xi.PropertyId.SpeechServiceConnection_SynthLanguage,"en-US"),n=this.properties.getProperty(Xi.PropertyId.SpeechServiceConnection_SynthVoice,""),s=r.XMLEncode(e);return this.autoDetectSourceLanguage?i="en-US":n=n||t[i],n&&(s=`<voice name='${n}'>${s}</voice>`),s=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${i}'>${s}</speak>`,s}dispose(e){return v(this,null,function*(){this.privDisposed||(e&&this.privAdapter&&(yield this.privAdapter.dispose()),this.privDisposed=!0)})}adapterSpeak(){return v(this,null,function*(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;let e=yield this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(e.text,e.isSSML,e.requestId,e.cb,e.err,e.dataStream)}})}createSynthesizerConfig(e){return new $n.SynthesizerConfig(e,this.privProperties)}implCommonSynthesizeSetup(){let e=typeof window<"u"?"Browser":"Node",t="unknown",i="unknown";typeof navigator<"u"&&(e=e+"/"+navigator.platform,t=navigator.userAgent,i=navigator.appVersion);let n=this.createSynthesizerConfig(new $n.SpeechServiceConfig(new $n.Context(new $n.OS(e,t,i)))),s=this.privProperties.getProperty(Xi.PropertyId.SpeechServiceConnection_Key,void 0),o=s&&s!==""?new $n.CognitiveSubscriptionKeyAuthentication(s):new $n.CognitiveTokenAuthentication(()=>{let a=this.privProperties.getProperty(Xi.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(a)},()=>{let a=this.privProperties.getProperty(Xi.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(a)});this.privAdapter=this.createSynthesisAdapter(o,this.privConnectionFactory,n),this.privRestAdapter=this.createRestSynthesisAdapter(o,n)}static XMLEncode(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}};So.Synthesizer=aC;var cC=class{constructor(e,t,i,n,s,o){this.requestId=e,this.text=t,this.isSSML=i,this.cb=n,this.err=s,this.dataStream=o}};So.SynthesisRequest=cC});var UO=h(Xh=>{"use strict";Object.defineProperty(Xh,"__esModule",{value:!0});Xh.SpeechSynthesizer=void 0;var uC=T(),pC=x(),a6=my(),c6=to(),u6=xn(),BO=j(),Zi=P(),p6=Qh(),lC=class r extends Zi.Synthesizer{constructor(e,t){super(e),t!==null&&(t===void 0?this.audioConfig=typeof window>"u"?void 0:Zi.AudioConfig.fromDefaultSpeakerOutput():this.audioConfig=t),this.privConnectionFactory=new uC.SpeechSynthesisConnectionFactory,this.implCommonSynthesizeSetup()}static FromConfig(e,t,i){let n=e;return t.properties.mergeTo(n.properties),new r(e,i)}speakTextAsync(e,t,i,n){this.speakImpl(e,!1,t,i,n)}speakSsmlAsync(e,t,i,n){this.speakImpl(e,!0,t,i,n)}getVoicesAsync(e=""){return v(this,null,function*(){return this.getVoices(e)})}close(e,t){BO.Contracts.throwIfDisposed(this.privDisposed),pC.marshalPromiseToCallbacks(this.dispose(!0),e,t)}get internalData(){return this.privAdapter}createSynthesisAdapter(e,t,i){return new uC.SpeechSynthesisAdapter(e,t,i,this,this.audioConfig)}createRestSynthesisAdapter(e,t){return new uC.SynthesisRestAdapter(t,e)}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=c6.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(Zi.SpeechSynthesisOutputFormat[this.properties.getProperty(Zi.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)])}speakImpl(e,t,i,n,s){try{BO.Contracts.throwIfDisposed(this.privDisposed);let o=pC.createNoDashGuid(),a;s instanceof Zi.PushAudioOutputStreamCallback?a=new u6.PushAudioOutputStreamImpl(s):s instanceof Zi.PullAudioOutputStream?a=s:s!==void 0?a=new a6.AudioFileWriter(s):a=void 0,this.synthesisRequestQueue.enqueue(new p6.SynthesisRequest(o,e,t,c=>{if(this.privSynthesizing=!1,i)try{i(c)}catch(u){n&&n(u)}i=void 0,this.adapterSpeak().catch(()=>{})},c=>{n&&n(c)},a)),this.adapterSpeak().catch(()=>{})}catch(o){if(n)if(o instanceof Error){let a=o;n(a.name+": "+a.message)}else n(o);this.dispose(!0).catch(()=>{})}}getVoices(e){return v(this,null,function*(){let t=pC.createNoDashGuid(),i=yield this.privRestAdapter.getVoicesList(t);if(i.ok&&Array.isArray(i.json)){let n=i.json;return e&&e.length>0&&(n=n.filter(s=>!!s.Locale&&s.Locale.toLowerCase()===e.toLowerCase())),new Zi.SynthesisVoicesResult(t,n,void 0)}else return new Zi.SynthesisVoicesResult(t,void 0,`Error: ${i.status}: ${i.statusText}`)})}};Xh.SpeechSynthesizer=lC});var WO=h(Zh=>{"use strict";Object.defineProperty(Zh,"__esModule",{value:!0});Zh.SynthesisResult=void 0;var hC=class{constructor(e,t,i,n){this.privResultId=e,this.privReason=t,this.privErrorDetails=i,this.privProperties=n}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}};Zh.SynthesisResult=hC});var HO=h(ed=>{"use strict";Object.defineProperty(ed,"__esModule",{value:!0});ed.SpeechSynthesisResult=void 0;var l6=P(),dC=class extends l6.SynthesisResult{constructor(e,t,i,n,s,o){super(e,t,n,s),this.privAudioData=i,this.privAudioDuration=o}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}};ed.SpeechSynthesisResult=dC});var VO=h(td=>{"use strict";Object.defineProperty(td,"__esModule",{value:!0});td.SpeechSynthesisEventArgs=void 0;var fC=class{constructor(e){this.privResult=e}get result(){return this.privResult}};td.SpeechSynthesisEventArgs=fC});var $O=h(rd=>{"use strict";Object.defineProperty(rd,"__esModule",{value:!0});rd.SpeechSynthesisWordBoundaryEventArgs=void 0;var vC=class{constructor(e,t,i,n,s,o){this.privAudioOffset=e,this.privDuration=t,this.privText=i,this.privWordLength=n,this.privTextOffset=s,this.privBoundaryType=o}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}};rd.SpeechSynthesisWordBoundaryEventArgs=vC});var KO=h(id=>{"use strict";Object.defineProperty(id,"__esModule",{value:!0});id.SpeechSynthesisBookmarkEventArgs=void 0;var gC=class{constructor(e,t){this.privAudioOffset=e,this.privText=t}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}};id.SpeechSynthesisBookmarkEventArgs=gC});var GO=h(nd=>{"use strict";Object.defineProperty(nd,"__esModule",{value:!0});nd.SpeechSynthesisVisemeEventArgs=void 0;var mC=class{constructor(e,t,i){this.privAudioOffset=e,this.privVisemeId=t,this.privAnimation=i}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}};nd.SpeechSynthesisVisemeEventArgs=mC});var JO=h(yc=>{"use strict";Object.defineProperty(yc,"__esModule",{value:!0});yc.SpeechSynthesisBoundaryType=void 0;var h6;(function(r){r.Word="WordBoundary",r.Punctuation="PunctuationBoundary",r.Sentence="SentenceBoundary"})(h6=yc.SpeechSynthesisBoundaryType||(yc.SpeechSynthesisBoundaryType={}))});var YO=h(sd=>{"use strict";Object.defineProperty(sd,"__esModule",{value:!0});sd.SynthesisVoicesResult=void 0;var Co=P(),yC=class extends Co.SynthesisResult{constructor(e,t,i){if(Array.isArray(t)){super(e,Co.ResultReason.VoicesListRetrieved,void 0,new Co.PropertyCollection),this.privVoices=[];for(let n of t)this.privVoices.push(new Co.VoiceInfo(n))}else super(e,Co.ResultReason.Canceled,i||"Error information unavailable",new Co.PropertyCollection)}get voices(){return this.privVoices}};sd.SynthesisVoicesResult=yC});var QO=h(Jr=>{"use strict";Object.defineProperty(Jr,"__esModule",{value:!0});Jr.VoiceInfo=Jr.SynthesisVoiceType=Jr.SynthesisVoiceGender=void 0;var Ar;(function(r){r[r.Unknown=0]="Unknown",r[r.Female=1]="Female",r[r.Male=2]="Male",r[r.Neutral=3]="Neutral"})(Ar=Jr.SynthesisVoiceGender||(Jr.SynthesisVoiceGender={}));var SC;(function(r){r[r.OnlineNeural=1]="OnlineNeural",r[r.OnlineStandard=2]="OnlineStandard",r[r.OfflineNeural=3]="OfflineNeural",r[r.OfflineStandard=4]="OfflineStandard"})(SC=Jr.SynthesisVoiceType||(Jr.SynthesisVoiceType={}));var d6={[Ar[Ar.Neutral]]:Ar.Neutral,[Ar[Ar.Male]]:Ar.Male,[Ar[Ar.Female]]:Ar.Female},CC=class{constructor(e){if(this.privStyleList=[],e){if(this.privName=e.Name,this.privLocale=e.Locale,this.privShortName=e.ShortName,this.privLocaleName=e.LocaleName,this.privDisplayName=e.DisplayName,this.privLocalName=e.LocalName,this.privVoiceType=e.VoiceType.endsWith("Standard")?SC.OnlineStandard:SC.OnlineNeural,this.privGender=d6[e.Gender]||Ar.Unknown,e.StyleList&&Array.isArray(e.StyleList))for(let t of e.StyleList)this.privStyleList.push(t);this.privSampleRateHertz=e.SampleRateHertz,this.privStatus=e.Status,e.ExtendedPropertyMap&&(this.privExtendedPropertyMap=e.ExtendedPropertyMap),this.privWordsPerMinute=e.WordsPerMinute,Array.isArray(e.SecondaryLocaleList)&&(this.privSecondaryLocaleList=[...e.SecondaryLocaleList]),Array.isArray(e.RolePlayList)&&(this.privRolePlayList=[...e.RolePlayList])}}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get displayName(){return this.privDisplayName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get sampleRateHertz(){return this.privSampleRateHertz}get status(){return this.privStatus}get extendedPropertyMap(){return this.privExtendedPropertyMap}get wordsPerMinute(){return this.privWordsPerMinute}get secondaryLocaleList(){return this.privSecondaryLocaleList}get rolePlayList(){return this.privRolePlayList}};Jr.VoiceInfo=CC});var ZO=h(od=>{"use strict";Object.defineProperty(od,"__esModule",{value:!0});od.SpeakerAudioDestination=void 0;var Kn=x(),f6=xn(),Nt=qi(),v6=60*30,XO={[Nt.AudioFormatTag.PCM]:"audio/wav",[Nt.AudioFormatTag.MuLaw]:"audio/x-wav",[Nt.AudioFormatTag.MP3]:"audio/mpeg",[Nt.AudioFormatTag.OGG_OPUS]:"audio/ogg",[Nt.AudioFormatTag.WEBM_OPUS]:"audio/webm; codecs=opus",[Nt.AudioFormatTag.ALaw]:"audio/x-wav",[Nt.AudioFormatTag.FLAC]:"audio/flac",[Nt.AudioFormatTag.AMR_WB]:"audio/amr-wb",[Nt.AudioFormatTag.G722]:"audio/G722"},bC=class{constructor(e){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=e||Kn.createNoDashGuid(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(e,t,i){this.privAudioBuffer!==void 0?(this.privAudioBuffer.push(e),this.updateSourceBuffer().then(()=>{t&&t()},n=>{i&&i(n)})):this.privAudioOutputStream!==void 0&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength)}close(e,t){if(this.privIsClosed=!0,this.privSourceBuffer!==void 0)this.handleSourceBufferUpdateEnd().then(()=>{e&&e()},i=>{t&&t(i)});else if(this.privAudioOutputStream!==void 0&&typeof window<"u")if((this.privFormat.formatTag===Nt.AudioFormatTag.PCM||this.privFormat.formatTag===Nt.AudioFormatTag.MuLaw||this.privFormat.formatTag===Nt.AudioFormatTag.ALaw)&&this.privFormat.hasHeader===!1)console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else{let i=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(i).then(()=>{i=this.privFormat.addHeader(i);let n=new Blob([i],{type:XO[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(n),this.notifyPlayback().then(()=>{e&&e()},s=>{t&&t(s)})},n=>{t&&t(n)})}else this.onAudioEnd&&this.onAudioEnd(this)}set format(e){if(typeof AudioContext<"u"||typeof window<"u"&&typeof window.webkitAudioContext<"u"){this.privFormat=e;let t=XO[this.privFormat.formatTag];t===void 0?console.warn(`Unknown mimeType for format ${Nt.AudioFormatTag[this.privFormat.formatTag]}; playback is not supported.`):typeof MediaSource<"u"&&MediaSource.isTypeSupported(t)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=v6,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(t),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch(i=>{Kn.Events.instance.onEvent(new Kn.BackgroundEvent(i))})},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch(i=>{Kn.Events.instance.onEvent(new Kn.BackgroundEvent(i))})},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch(i=>{Kn.Events.instance.onEvent(new Kn.BackgroundEvent(i))})):(console.warn(`Format ${Nt.AudioFormatTag[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new f6.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){return this.privAudio?.volume??-1}set volume(e){this.privAudio&&(this.privAudio.volume=e)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return this.privAudio!==void 0?this.privAudio.currentTime:-1}pause(){!this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.pause(),this.privIsPaused=!0)}resume(e,t){this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.play().then(()=>{e&&e()},i=>{t&&t(i)}),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}updateSourceBuffer(){return v(this,null,function*(){if(this.privAudioBuffer!==void 0&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;let e=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(e)}catch{this.privAudioBuffer.unshift(e),console.log("buffer filled, pausing addition of binaries until space is made");return}yield this.notifyPlayback()}else this.canEndStream()&&(yield this.handleSourceBufferUpdateEnd())})}handleSourceBufferUpdateEnd(){return v(this,null,function*(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),yield this.notifyPlayback())})}notifyPlayback(){return v(this,null,function*(){!this.privPlaybackStarted&&this.privAudio!==void 0&&(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||(yield this.privAudio.play()))})}canEndStream(){return this.isClosed&&this.privSourceBuffer!==void 0&&this.privAudioBuffer.length===0&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&this.privMediaSource.readyState==="open"}sourceBufferAvailable(){return this.privSourceBuffer!==void 0&&!this.privSourceBuffer.updating}};od.SpeakerAudioDestination=bC});var eD=h(ad=>{"use strict";Object.defineProperty(ad,"__esModule",{value:!0});ad.ConversationTranscriptionCanceledEventArgs=void 0;var g6=so(),PC=class extends g6.CancellationEventArgsBase{};ad.ConversationTranscriptionCanceledEventArgs=PC});var tD=h(cd=>{"use strict";Object.defineProperty(cd,"__esModule",{value:!0});cd.MeetingTranscriptionCanceledEventArgs=void 0;var m6=so(),wC=class extends m6.CancellationEventArgsBase{};cd.MeetingTranscriptionCanceledEventArgs=wC});var rD=h(Sc=>{"use strict";Object.defineProperty(Sc,"__esModule",{value:!0});Sc.PronunciationAssessmentGradingSystem=void 0;var y6;(function(r){r[r.FivePoint=1]="FivePoint",r[r.HundredMark=2]="HundredMark"})(y6=Sc.PronunciationAssessmentGradingSystem||(Sc.PronunciationAssessmentGradingSystem={}))});var iD=h(Cc=>{"use strict";Object.defineProperty(Cc,"__esModule",{value:!0});Cc.PronunciationAssessmentGranularity=void 0;var S6;(function(r){r[r.Phoneme=1]="Phoneme",r[r.Word=2]="Word",r[r.FullText=3]="FullText"})(S6=Cc.PronunciationAssessmentGranularity||(Cc.PronunciationAssessmentGranularity={}))});var nD=h(pd=>{"use strict";Object.defineProperty(pd,"__esModule",{value:!0});pd.PronunciationAssessmentConfig=void 0;var ud=j(),Ce=P(),_C=class r{constructor(e,t=Ce.PronunciationAssessmentGradingSystem.FivePoint,i=Ce.PronunciationAssessmentGranularity.Phoneme,n=!1){ud.Contracts.throwIfNullOrUndefined(e,"referenceText"),this.privProperties=new Ce.PropertyCollection,this.privProperties.setProperty(Ce.PropertyId.PronunciationAssessment_ReferenceText,e),this.privProperties.setProperty(Ce.PropertyId.PronunciationAssessment_GradingSystem,Ce.PronunciationAssessmentGradingSystem[t]),this.privProperties.setProperty(Ce.PropertyId.PronunciationAssessment_Granularity,Ce.PronunciationAssessmentGranularity[i]),this.privProperties.setProperty(Ce.PropertyId.PronunciationAssessment_EnableMiscue,String(n))}static fromJSON(e){ud.Contracts.throwIfNullOrUndefined(e,"json");let t=new r("");return t.privProperties=new Ce.PropertyCollection,t.properties.setProperty(Ce.PropertyId.PronunciationAssessment_Json,e),t}toJSON(){return this.updateJson(),this.privProperties.getProperty(Ce.PropertyId.PronunciationAssessment_Params)}applyTo(e){this.updateJson();let t=e.internalData;t.expectContentAssessmentResponse=!!this.privContentAssessmentTopic,t.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(Ce.PropertyId.PronunciationAssessment_Params),this.privContentAssessmentTopic,t.isSpeakerDiarizationEnabled)}get referenceText(){return this.properties.getProperty(Ce.PropertyId.PronunciationAssessment_ReferenceText)}set referenceText(e){ud.Contracts.throwIfNullOrWhitespace(e,"referenceText"),this.properties.setProperty(Ce.PropertyId.PronunciationAssessment_ReferenceText,e)}set phonemeAlphabet(e){ud.Contracts.throwIfNullOrWhitespace(e,"phonemeAlphabet"),this.privPhonemeAlphabet=e}set enableMiscue(e){let t=e?"true":"false";this.properties.setProperty(Ce.PropertyId.PronunciationAssessment_EnableMiscue,t)}get enableMiscue(){return this.properties.getProperty(Ce.PropertyId.PronunciationAssessment_EnableMiscue,"false").toLowerCase()==="true"}set nbestPhonemeCount(e){this.privNBestPhonemeCount=e}set enableProsodyAssessment(e){this.privEnableProsodyAssessment=e}enableContentAssessmentWithTopic(e){this.privContentAssessmentTopic=e}get properties(){return this.privProperties}updateJson(){let e=this.privProperties.getProperty(Ce.PropertyId.PronunciationAssessment_Json,"{}"),t=JSON.parse(e),i=this.privProperties.getProperty(Ce.PropertyId.PronunciationAssessment_ReferenceText);i&&(t.referenceText=i);let n=this.privProperties.getProperty(Ce.PropertyId.PronunciationAssessment_GradingSystem);n&&(t.gradingSystem=n);let s=this.privProperties.getProperty(Ce.PropertyId.PronunciationAssessment_Granularity);s&&(t.granularity=s),this.privPhonemeAlphabet&&(t.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(t.nbestPhonemeCount=this.privNBestPhonemeCount),t.enableProsodyAssessment=this.privEnableProsodyAssessment,t.dimension="Comprehensive",this.privProperties.getProperty(Ce.PropertyId.PronunciationAssessment_EnableMiscue)&&(t.enableMiscue=this.enableMiscue),this.privProperties.setProperty(Ce.PropertyId.PronunciationAssessment_Params,JSON.stringify(t))}};pd.PronunciationAssessmentConfig=_C});var sD=h(bo=>{"use strict";Object.defineProperty(bo,"__esModule",{value:!0});bo.PronunciationAssessmentResult=bo.ContentAssessmentResult=void 0;var RC=j(),C6=P(),ld=class{constructor(e){this.privPronJson=e}get grammarScore(){return this.privPronJson.ContentAssessment.GrammarScore}get vocabularyScore(){return this.privPronJson.ContentAssessment.VocabularyScore}get topicScore(){return this.privPronJson.ContentAssessment.TopicScore}};bo.ContentAssessmentResult=ld;var EC=class r{constructor(e){let t=JSON.parse(e);RC.Contracts.throwIfNullOrUndefined(t.NBest[0],"NBest"),this.privPronJson=t.NBest[0]}static fromResult(e){RC.Contracts.throwIfNullOrUndefined(e,"result");let t=e.properties.getProperty(C6.PropertyId.SpeechServiceResponse_JsonResult);return RC.Contracts.throwIfNullOrUndefined(t,"json"),new r(t)}get detailResult(){return this.privPronJson}get accuracyScore(){return this.detailResult.PronunciationAssessment?.AccuracyScore}get pronunciationScore(){return this.detailResult.PronunciationAssessment?.PronScore}get completenessScore(){return this.detailResult.PronunciationAssessment?.CompletenessScore}get fluencyScore(){return this.detailResult.PronunciationAssessment?.FluencyScore}get prosodyScore(){return this.detailResult.PronunciationAssessment?.ProsodyScore}get contentAssessmentResult(){if(this.detailResult.ContentAssessment!==void 0)return new ld(this.detailResult)}};bo.PronunciationAssessmentResult=EC});var oD=h(hd=>{"use strict";Object.defineProperty(hd,"__esModule",{value:!0});hd.AvatarConfig=void 0;var b6=j(),P6=P(),IC=class{constructor(e,t,i){this.privCustomized=!1,b6.Contracts.throwIfNullOrWhitespace(e,"character"),this.character=e,this.style=t,i===void 0&&(i=new P6.AvatarVideoFormat),this.videoFormat=i}get customized(){return this.privCustomized}set customized(e){this.privCustomized=e}get backgroundColor(){return this.privBackgroundColor}set backgroundColor(e){this.privBackgroundColor=e}get backgroundImage(){return this.privBackgroundImage}set backgroundImage(e){this.privBackgroundImage=e}get remoteIceServers(){return this.privRemoteIceServers}set remoteIceServers(e){this.privRemoteIceServers=e}};hd.AvatarConfig=IC});var aD=h(Gn=>{"use strict";Object.defineProperty(Gn,"__esModule",{value:!0});Gn.AvatarEventArgs=Gn.AvatarEventTypes=void 0;var w6;(function(r){r.SwitchedToSpeaking="SwitchedToSpeaking",r.SwitchedToIdle="SwitchedToIdle",r.SessionClosed="SessionClosed"})(w6=Gn.AvatarEventTypes||(Gn.AvatarEventTypes={}));var TC=class{constructor(e,t){this.privOffset=e,this.privDescription=t}get type(){return this.privType}get offset(){return this.privOffset}get description(){return this.privDescription}};Gn.AvatarEventArgs=TC});var OC=h(fd=>{"use strict";Object.defineProperty(fd,"__esModule",{value:!0});fd.SpeechSynthesisConnectionFactory=void 0;var cD=Le(),bc=P(),_6=ar(),R6=T(),E6=ot(),dd=gi(),AC=class{constructor(){this.synthesisUri="/cognitiveservices/websocket/v1"}create(e,t,i){let n=e.parameters.getProperty(bc.PropertyId.SpeechServiceConnection_Endpoint,void 0),s=e.parameters.getProperty(bc.PropertyId.SpeechServiceConnection_Region,void 0),o=_6.ConnectionFactoryBase.getHostSuffix(s),a=e.parameters.getProperty(bc.PropertyId.SpeechServiceConnection_EndpointId,void 0),c=a===void 0?"tts":"voice",u=e.parameters.getProperty(bc.PropertyId.SpeechServiceConnection_Host,"wss://"+s+"."+c+".speech"+o),p={},l={};t.token!==void 0&&t.token!==""&&(l[t.headerName]=t.token),l[E6.HeaderNames.ConnectionId]=i,a!==void 0&&a!==""&&(!n||n.search(dd.QueryParameterNames.CustomVoiceDeploymentId)===-1)&&(p[dd.QueryParameterNames.CustomVoiceDeploymentId]=a),e.avatarEnabled&&(!n||n.search(dd.QueryParameterNames.EnableAvatar)===-1)&&(p[dd.QueryParameterNames.EnableAvatar]="true"),n||(n=u+this.synthesisUri),e.parameters.setProperty(bc.PropertyId.SpeechServiceConnection_Url,n);let d=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new cD.WebsocketConnection(n,p,l,new R6.WebsocketMessageFormatter,cD.ProxyInfo.fromParameters(e.parameters),d,i)}};fd.SpeechSynthesisConnectionFactory=AC});var uD=h(gd=>{"use strict";Object.defineProperty(gd,"__esModule",{value:!0});gd.AvatarSynthesizer=void 0;var I6=OC(),T6=T(),Re=x(),A6=to(),yi=P(),vd=j(),O6=Qh(),DC=class extends yi.Synthesizer{constructor(e,t){super(e),vd.Contracts.throwIfNullOrUndefined(t,"avatarConfig"),this.privConnectionFactory=new I6.SpeechSynthesisConnectionFactory,this.privAvatarConfig=t,this.implCommonSynthesizeSetup()}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=A6.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(yi.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm)}startAvatarAsync(e){return v(this,null,function*(){vd.Contracts.throwIfNullOrUndefined(e,"peerConnection"),this.privIceServers=e.getConfiguration().iceServers,vd.Contracts.throwIfNullOrUndefined(this.privIceServers,"Ice servers must be set.");let t=new Re.Deferred;e.onicegatheringstatechange=()=>{Re.Events.instance.onEvent(new Re.PlatformEvent("peer connection: ice gathering state: "+e.iceGatheringState,Re.EventType.Debug)),e.iceGatheringState==="complete"&&(Re.Events.instance.onEvent(new Re.PlatformEvent("peer connection: ice gathering complete.",Re.EventType.Info)),t.resolve())},e.onicecandidate=a=>{a.candidate?Re.Events.instance.onEvent(new Re.PlatformEvent("peer connection: ice candidate: "+a.candidate.candidate,Re.EventType.Debug)):(Re.Events.instance.onEvent(new Re.PlatformEvent("peer connection: ice candidate: complete",Re.EventType.Debug)),t.resolve())},setTimeout(()=>{e.iceGatheringState!=="complete"&&(Re.Events.instance.onEvent(new Re.PlatformEvent("peer connection: ice gathering timeout.",Re.EventType.Warning)),t.resolve())},2e3);let i=yield e.createOffer();yield e.setLocalDescription(i),yield t.promise,Re.Events.instance.onEvent(new Re.PlatformEvent("peer connection: got local SDP.",Re.EventType.Info)),this.privProperties.setProperty(yi.PropertyId.TalkingAvatarService_WebRTC_SDP,JSON.stringify(e.localDescription));let n=yield this.speak("",!1);if(n.reason!==yi.ResultReason.SynthesizingAudioCompleted)return new yi.SynthesisResult(n.resultId,n.reason,n.errorDetails,n.properties);let s=atob(n.properties.getProperty(yi.PropertyId.TalkingAvatarService_WebRTC_SDP)),o=new RTCSessionDescription(JSON.parse(s));return yield e.setRemoteDescription(o),new yi.SynthesisResult(n.resultId,n.reason,void 0,n.properties)})}speakTextAsync(e){return v(this,null,function*(){let t=yield this.speak(e,!1);return new yi.SynthesisResult(t.resultId,t.reason,t.errorDetails,t.properties)})}speakSsmlAsync(e){return v(this,null,function*(){let t=yield this.speak(e,!0);return new yi.SynthesisResult(t.resultId,t.reason,t.errorDetails,t.properties)})}stopSpeakingAsync(){return v(this,null,function*(){for(;this.synthesisRequestQueue.length()>0;)(yield this.synthesisRequestQueue.dequeue()).err("Synthesis is canceled by user.");return this.privAdapter.stopSpeaking()})}stopAvatarAsync(){return v(this,null,function*(){return vd.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)})}close(){return v(this,null,function*(){if(!this.privDisposed)return this.dispose(!0)})}get iceServers(){return this.privIceServers}createSynthesisAdapter(e,t,i){return new T6.AvatarSynthesisAdapter(e,t,i,this,this.privAvatarConfig)}createRestSynthesisAdapter(e,t){}createSynthesizerConfig(e){let t=super.createSynthesizerConfig(e);return t.avatarEnabled=!0,t}speak(e,t){return v(this,null,function*(){let i=Re.createNoDashGuid(),n=new Re.Deferred;return this.synthesisRequestQueue.enqueue(new O6.SynthesisRequest(i,e,t,s=>{n.resolve(s),this.privSynthesizing=!1,this.adapterSpeak()},s=>{n.reject(s),this.privSynthesizing=!1})),this.adapterSpeak(),n.promise})}};gd.AvatarSynthesizer=DC});var pD=h(Po=>{"use strict";Object.defineProperty(Po,"__esModule",{value:!0});Po.AvatarVideoFormat=Po.Coordinate=void 0;var xC=class{constructor(e,t){this.x=e,this.y=t}};Po.Coordinate=xC;var MC=class{constructor(e="H264",t=2e6,i=1920,n=1080){this.codec=e,this.bitrate=t,this.width=i,this.height=n}setCropRange(e,t){this.cropRange={bottomRight:t,topLeft:e}}};Po.AvatarVideoFormat=MC});var lD=h(md=>{"use strict";Object.defineProperty(md,"__esModule",{value:!0});md.AvatarWebRTCConnectionResult=void 0;var D6=P(),kC=class extends D6.SynthesisResult{constructor(e,t,i,n,s){super(t,i,n,s),this.privSDPAnswer=e}get SDPAnswer(){return this.privSDPAnswer}};md.AvatarWebRTCConnectionResult=kC});var hD=h(Sd=>{"use strict";Object.defineProperty(Sd,"__esModule",{value:!0});Sd.Diagnostics=void 0;var x6=Le(),M6=x(),yd=class{static SetLoggingLevel(e){this.privListener=new x6.ConsoleLoggingListener(e),M6.Events.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(e){if(typeof window>"u")this.privListener&&(this.privListener.logPath=e);else throw new Error("File system logging not available in browser.")}static set onLogOutput(e){this.privListener&&(this.privListener.logCallback=e)}};Sd.Diagnostics=yd;yd.privListener=void 0});var P=h(S=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});var k6=by();Object.defineProperty(S,"AudioConfig",{enumerable:!0,get:function(){return k6.AudioConfig}});var dD=qi();Object.defineProperty(S,"AudioStreamFormat",{enumerable:!0,get:function(){return dD.AudioStreamFormat}});Object.defineProperty(S,"AudioFormatTag",{enumerable:!0,get:function(){return dD.AudioFormatTag}});var NC=yy();Object.defineProperty(S,"AudioInputStream",{enumerable:!0,get:function(){return NC.AudioInputStream}});Object.defineProperty(S,"PullAudioInputStream",{enumerable:!0,get:function(){return NC.PullAudioInputStream}});Object.defineProperty(S,"PushAudioInputStream",{enumerable:!0,get:function(){return NC.PushAudioInputStream}});var jC=xn();Object.defineProperty(S,"AudioOutputStream",{enumerable:!0,get:function(){return jC.AudioOutputStream}});Object.defineProperty(S,"PullAudioOutputStream",{enumerable:!0,get:function(){return jC.PullAudioOutputStream}});Object.defineProperty(S,"PushAudioOutputStream",{enumerable:!0,get:function(){return jC.PushAudioOutputStream}});var N6=ZA();Object.defineProperty(S,"CancellationReason",{enumerable:!0,get:function(){return N6.CancellationReason}});var j6=e1();Object.defineProperty(S,"PullAudioInputStreamCallback",{enumerable:!0,get:function(){return j6.PullAudioInputStreamCallback}});var L6=t1();Object.defineProperty(S,"PushAudioOutputStreamCallback",{enumerable:!0,get:function(){return L6.PushAudioOutputStreamCallback}});var q6=i1();Object.defineProperty(S,"KeywordRecognitionModel",{enumerable:!0,get:function(){return q6.KeywordRecognitionModel}});var z6=n1();Object.defineProperty(S,"SessionEventArgs",{enumerable:!0,get:function(){return z6.SessionEventArgs}});var F6=s1();Object.defineProperty(S,"RecognitionEventArgs",{enumerable:!0,get:function(){return F6.RecognitionEventArgs}});var B6=o1();Object.defineProperty(S,"OutputFormat",{enumerable:!0,get:function(){return B6.OutputFormat}});var U6=a1();Object.defineProperty(S,"IntentRecognitionEventArgs",{enumerable:!0,get:function(){return U6.IntentRecognitionEventArgs}});var W6=c1();Object.defineProperty(S,"RecognitionResult",{enumerable:!0,get:function(){return W6.RecognitionResult}});var H6=u1();Object.defineProperty(S,"SpeechRecognitionResult",{enumerable:!0,get:function(){return H6.SpeechRecognitionResult}});var V6=p1();Object.defineProperty(S,"IntentRecognitionResult",{enumerable:!0,get:function(){return V6.IntentRecognitionResult}});var $6=l1();Object.defineProperty(S,"LanguageUnderstandingModel",{enumerable:!0,get:function(){return $6.LanguageUnderstandingModel}});var LC=d1();Object.defineProperty(S,"SpeechRecognitionEventArgs",{enumerable:!0,get:function(){return LC.SpeechRecognitionEventArgs}});Object.defineProperty(S,"ConversationTranscriptionEventArgs",{enumerable:!0,get:function(){return LC.ConversationTranscriptionEventArgs}});Object.defineProperty(S,"MeetingTranscriptionEventArgs",{enumerable:!0,get:function(){return LC.MeetingTranscriptionEventArgs}});var K6=f1();Object.defineProperty(S,"SpeechRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return K6.SpeechRecognitionCanceledEventArgs}});var G6=v1();Object.defineProperty(S,"TranslationRecognitionEventArgs",{enumerable:!0,get:function(){return G6.TranslationRecognitionEventArgs}});var J6=g1();Object.defineProperty(S,"TranslationSynthesisEventArgs",{enumerable:!0,get:function(){return J6.TranslationSynthesisEventArgs}});var Y6=qy();Object.defineProperty(S,"TranslationRecognitionResult",{enumerable:!0,get:function(){return Y6.TranslationRecognitionResult}});var Q6=m1();Object.defineProperty(S,"TranslationSynthesisResult",{enumerable:!0,get:function(){return Q6.TranslationSynthesisResult}});var X6=y1();Object.defineProperty(S,"ResultReason",{enumerable:!0,get:function(){return X6.ResultReason}});var fD=S1();Object.defineProperty(S,"SpeechConfig",{enumerable:!0,get:function(){return fD.SpeechConfig}});Object.defineProperty(S,"SpeechConfigImpl",{enumerable:!0,get:function(){return fD.SpeechConfigImpl}});var vD=C1();Object.defineProperty(S,"SpeechTranslationConfig",{enumerable:!0,get:function(){return vD.SpeechTranslationConfig}});Object.defineProperty(S,"SpeechTranslationConfigImpl",{enumerable:!0,get:function(){return vD.SpeechTranslationConfigImpl}});var Z6=By();Object.defineProperty(S,"PropertyCollection",{enumerable:!0,get:function(){return Z6.PropertyCollection}});var e4=ql();Object.defineProperty(S,"PropertyId",{enumerable:!0,get:function(){return e4.PropertyId}});var t4=w1();Object.defineProperty(S,"Recognizer",{enumerable:!0,get:function(){return t4.Recognizer}});var r4=_1();Object.defineProperty(S,"SpeechRecognizer",{enumerable:!0,get:function(){return r4.SpeechRecognizer}});var i4=R1();Object.defineProperty(S,"IntentRecognizer",{enumerable:!0,get:function(){return i4.IntentRecognizer}});var n4=E1();Object.defineProperty(S,"VoiceProfileType",{enumerable:!0,get:function(){return n4.VoiceProfileType}});var s4=O1();Object.defineProperty(S,"TranslationRecognizer",{enumerable:!0,get:function(){return s4.TranslationRecognizer}});var o4=D1();Object.defineProperty(S,"Translations",{enumerable:!0,get:function(){return o4.Translations}});var a4=x1();Object.defineProperty(S,"NoMatchReason",{enumerable:!0,get:function(){return a4.NoMatchReason}});var c4=M1();Object.defineProperty(S,"NoMatchDetails",{enumerable:!0,get:function(){return c4.NoMatchDetails}});var u4=k1();Object.defineProperty(S,"TranslationRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return u4.TranslationRecognitionCanceledEventArgs}});var p4=N1();Object.defineProperty(S,"IntentRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return p4.IntentRecognitionCanceledEventArgs}});var l4=sS();Object.defineProperty(S,"CancellationDetailsBase",{enumerable:!0,get:function(){return l4.CancellationDetailsBase}});var h4=j1();Object.defineProperty(S,"CancellationDetails",{enumerable:!0,get:function(){return h4.CancellationDetails}});var d4=L1();Object.defineProperty(S,"CancellationErrorCode",{enumerable:!0,get:function(){return d4.CancellationErrorCode}});var f4=q1();Object.defineProperty(S,"ConnectionEventArgs",{enumerable:!0,get:function(){return f4.ConnectionEventArgs}});var v4=z1();Object.defineProperty(S,"ServiceEventArgs",{enumerable:!0,get:function(){return v4.ServiceEventArgs}});var g4=Qy();Object.defineProperty(S,"Connection",{enumerable:!0,get:function(){return g4.Connection}});var m4=F1();Object.defineProperty(S,"PhraseListGrammar",{enumerable:!0,get:function(){return m4.PhraseListGrammar}});var y4=ah();Object.defineProperty(S,"DialogServiceConfig",{enumerable:!0,get:function(){return y4.DialogServiceConfig}});var S4=B1();Object.defineProperty(S,"BotFrameworkConfig",{enumerable:!0,get:function(){return S4.BotFrameworkConfig}});var C4=U1();Object.defineProperty(S,"CustomCommandsConfig",{enumerable:!0,get:function(){return C4.CustomCommandsConfig}});var b4=K1();Object.defineProperty(S,"DialogServiceConnector",{enumerable:!0,get:function(){return b4.DialogServiceConnector}});var P4=G1();Object.defineProperty(S,"ActivityReceivedEventArgs",{enumerable:!0,get:function(){return P4.ActivityReceivedEventArgs}});var w4=Y1();Object.defineProperty(S,"TurnStatusReceivedEventArgs",{enumerable:!0,get:function(){return w4.TurnStatusReceivedEventArgs}});var _4=Q1();Object.defineProperty(S,"ServicePropertyChannel",{enumerable:!0,get:function(){return _4.ServicePropertyChannel}});var R4=X1();Object.defineProperty(S,"ProfanityOption",{enumerable:!0,get:function(){return R4.ProfanityOption}});var E4=Z1();Object.defineProperty(S,"BaseAudioPlayer",{enumerable:!0,get:function(){return E4.BaseAudioPlayer}});var I4=eO();Object.defineProperty(S,"ConnectionMessageEventArgs",{enumerable:!0,get:function(){return I4.ConnectionMessageEventArgs}});var T4=Ky();Object.defineProperty(S,"ConnectionMessage",{enumerable:!0,get:function(){return T4.ConnectionMessage}});var A4=tO();Object.defineProperty(S,"VoiceProfile",{enumerable:!0,get:function(){return A4.VoiceProfile}});var gD=iO();Object.defineProperty(S,"VoiceProfileEnrollmentResult",{enumerable:!0,get:function(){return gD.VoiceProfileEnrollmentResult}});Object.defineProperty(S,"VoiceProfileEnrollmentCancellationDetails",{enumerable:!0,get:function(){return gD.VoiceProfileEnrollmentCancellationDetails}});var mD=sO();Object.defineProperty(S,"VoiceProfileResult",{enumerable:!0,get:function(){return mD.VoiceProfileResult}});Object.defineProperty(S,"VoiceProfileCancellationDetails",{enumerable:!0,get:function(){return mD.VoiceProfileCancellationDetails}});var O4=oO();Object.defineProperty(S,"VoiceProfilePhraseResult",{enumerable:!0,get:function(){return O4.VoiceProfilePhraseResult}});var D4=aO();Object.defineProperty(S,"VoiceProfileClient",{enumerable:!0,get:function(){return D4.VoiceProfileClient}});var x4=cO();Object.defineProperty(S,"SpeakerRecognizer",{enumerable:!0,get:function(){return x4.SpeakerRecognizer}});var M4=uO();Object.defineProperty(S,"SpeakerIdentificationModel",{enumerable:!0,get:function(){return M4.SpeakerIdentificationModel}});var k4=lO();Object.defineProperty(S,"SpeakerVerificationModel",{enumerable:!0,get:function(){return k4.SpeakerVerificationModel}});var N4=dO();Object.defineProperty(S,"AutoDetectSourceLanguageConfig",{enumerable:!0,get:function(){return N4.AutoDetectSourceLanguageConfig}});var j4=vO();Object.defineProperty(S,"AutoDetectSourceLanguageResult",{enumerable:!0,get:function(){return j4.AutoDetectSourceLanguageResult}});var L4=gO();Object.defineProperty(S,"SourceLanguageConfig",{enumerable:!0,get:function(){return L4.SourceLanguageConfig}});var qC=yO();Object.defineProperty(S,"SpeakerRecognitionResult",{enumerable:!0,get:function(){return qC.SpeakerRecognitionResult}});Object.defineProperty(S,"SpeakerRecognitionResultType",{enumerable:!0,get:function(){return qC.SpeakerRecognitionResultType}});Object.defineProperty(S,"SpeakerRecognitionCancellationDetails",{enumerable:!0,get:function(){return qC.SpeakerRecognitionCancellationDetails}});var jt=Hh();Object.defineProperty(S,"Conversation",{enumerable:!0,get:function(){return jt.Conversation}});Object.defineProperty(S,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return jt.ConversationExpirationEventArgs}});Object.defineProperty(S,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return jt.ConversationParticipantsChangedEventArgs}});Object.defineProperty(S,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return jt.ConversationTranslationCanceledEventArgs}});Object.defineProperty(S,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return jt.ConversationTranslationEventArgs}});Object.defineProperty(S,"ConversationTranslationResult",{enumerable:!0,get:function(){return jt.ConversationTranslationResult}});Object.defineProperty(S,"ConversationTranslator",{enumerable:!0,get:function(){return jt.ConversationTranslator}});Object.defineProperty(S,"ConversationTranscriber",{enumerable:!0,get:function(){return jt.ConversationTranscriber}});Object.defineProperty(S,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return jt.ConversationTranscriptionResult}});Object.defineProperty(S,"Meeting",{enumerable:!0,get:function(){return jt.Meeting}});Object.defineProperty(S,"MeetingTranscriber",{enumerable:!0,get:function(){return jt.MeetingTranscriber}});Object.defineProperty(S,"Participant",{enumerable:!0,get:function(){return jt.Participant}});Object.defineProperty(S,"ParticipantChangedReason",{enumerable:!0,get:function(){return jt.ParticipantChangedReason}});Object.defineProperty(S,"User",{enumerable:!0,get:function(){return jt.User}});var q4=Qh();Object.defineProperty(S,"Synthesizer",{enumerable:!0,get:function(){return q4.Synthesizer}});var z4=Sy();Object.defineProperty(S,"SpeechSynthesisOutputFormat",{enumerable:!0,get:function(){return z4.SpeechSynthesisOutputFormat}});var F4=UO();Object.defineProperty(S,"SpeechSynthesizer",{enumerable:!0,get:function(){return F4.SpeechSynthesizer}});var B4=WO();Object.defineProperty(S,"SynthesisResult",{enumerable:!0,get:function(){return B4.SynthesisResult}});var U4=HO();Object.defineProperty(S,"SpeechSynthesisResult",{enumerable:!0,get:function(){return U4.SpeechSynthesisResult}});var W4=VO();Object.defineProperty(S,"SpeechSynthesisEventArgs",{enumerable:!0,get:function(){return W4.SpeechSynthesisEventArgs}});var H4=$O();Object.defineProperty(S,"SpeechSynthesisWordBoundaryEventArgs",{enumerable:!0,get:function(){return H4.SpeechSynthesisWordBoundaryEventArgs}});var V4=KO();Object.defineProperty(S,"SpeechSynthesisBookmarkEventArgs",{enumerable:!0,get:function(){return V4.SpeechSynthesisBookmarkEventArgs}});var $4=GO();Object.defineProperty(S,"SpeechSynthesisVisemeEventArgs",{enumerable:!0,get:function(){return $4.SpeechSynthesisVisemeEventArgs}});var K4=JO();Object.defineProperty(S,"SpeechSynthesisBoundaryType",{enumerable:!0,get:function(){return K4.SpeechSynthesisBoundaryType}});var G4=YO();Object.defineProperty(S,"SynthesisVoicesResult",{enumerable:!0,get:function(){return G4.SynthesisVoicesResult}});var J4=QO();Object.defineProperty(S,"VoiceInfo",{enumerable:!0,get:function(){return J4.VoiceInfo}});var Y4=ZO();Object.defineProperty(S,"SpeakerAudioDestination",{enumerable:!0,get:function(){return Y4.SpeakerAudioDestination}});var Q4=eD();Object.defineProperty(S,"ConversationTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return Q4.ConversationTranscriptionCanceledEventArgs}});var X4=tD();Object.defineProperty(S,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return X4.MeetingTranscriptionCanceledEventArgs}});var Z4=rD();Object.defineProperty(S,"PronunciationAssessmentGradingSystem",{enumerable:!0,get:function(){return Z4.PronunciationAssessmentGradingSystem}});var eU=iD();Object.defineProperty(S,"PronunciationAssessmentGranularity",{enumerable:!0,get:function(){return eU.PronunciationAssessmentGranularity}});var tU=nD();Object.defineProperty(S,"PronunciationAssessmentConfig",{enumerable:!0,get:function(){return tU.PronunciationAssessmentConfig}});var rU=sD();Object.defineProperty(S,"PronunciationAssessmentResult",{enumerable:!0,get:function(){return rU.PronunciationAssessmentResult}});var iU=kS();Object.defineProperty(S,"LanguageIdMode",{enumerable:!0,get:function(){return iU.LanguageIdMode}});var nU=oD();Object.defineProperty(S,"AvatarConfig",{enumerable:!0,get:function(){return nU.AvatarConfig}});var sU=aD();Object.defineProperty(S,"AvatarEventArgs",{enumerable:!0,get:function(){return sU.AvatarEventArgs}});var oU=uD();Object.defineProperty(S,"AvatarSynthesizer",{enumerable:!0,get:function(){return oU.AvatarSynthesizer}});var yD=pD();Object.defineProperty(S,"AvatarVideoFormat",{enumerable:!0,get:function(){return yD.AvatarVideoFormat}});Object.defineProperty(S,"Coordinate",{enumerable:!0,get:function(){return yD.Coordinate}});var aU=lD();Object.defineProperty(S,"AvatarWebRTCConnectionResult",{enumerable:!0,get:function(){return aU.AvatarWebRTCConnectionResult}});var cU=hD();Object.defineProperty(S,"Diagnostics",{enumerable:!0,get:function(){return cU.Diagnostics}});var uU=Og();Object.defineProperty(S,"LogLevel",{enumerable:!0,get:function(){return uU.LogLevel}})});var SD=h(bd=>{"use strict";Object.defineProperty(bd,"__esModule",{value:!0});bd.ProxyInfo=void 0;var Cd=P(),zC=class r{constructor(e,t,i,n){this.privProxyHostName=e,this.privProxyPort=t,this.privProxyUserName=i,this.privProxyPassword=n}static fromParameters(e){return new r(e.getProperty(Cd.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(e.getProperty(Cd.PropertyId.SpeechServiceConnection_ProxyPort),10),e.getProperty(Cd.PropertyId.SpeechServiceConnection_ProxyUserName),e.getProperty(Cd.PropertyId.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(e){return this.fromParameters(e.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}};bd.ProxyInfo=zC});var bD=h((qK,CD)=>{"use strict";var pU=new Set(["json","buffer","string"]);CD.exports=r=>(...e)=>{let t=new Set,i,n,s,o="";return e.forEach(a=>{if(typeof a=="string")if(a.toUpperCase()===a)if(i){let c=`Can't set method to ${a}, already set to ${i}.`;throw new Error(c)}else i=a;else if(a.startsWith("http:")||a.startsWith("https:"))o=a;else if(pU.has(a))n=a;else throw new Error(`Unknown encoding, ${a}`);else if(typeof a=="number")t.add(a);else if(typeof a=="object")if(Array.isArray(a)||a instanceof Set)a.forEach(c=>t.add(c));else{if(s)throw new Error("Cannot set headers twice.");s=a}else throw new Error(`Unknown type: ${typeof a}`)}),i||(i="GET"),t.size===0&&t.add(200),r(t,i,n,s,o)}});var _D=h((PD,wD)=>{"use strict";var lU=bD(),FC=class r extends Error{constructor(e,...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,r),this.name="StatusError",this.message=e.statusMessage,this.statusCode=e.status,this.res=e,this.json=e.json.bind(e),this.text=e.text.bind(e),this.arrayBuffer=e.arrayBuffer.bind(e);let i;Object.defineProperty(this,"responseBody",{get:()=>(i||(i=this.arrayBuffer()),i)}),this.headers={};for(let[s,o]of e.headers.entries())this.headers[s.toLowerCase()]=o}},hU=(r,e,t,i,n)=>(c,u,...p)=>v(PD,[c,u,...p],function*(s,o,a={}){s=n+(s||"");let l=new URL(s);if(i||(i={}),l.username&&(i.Authorization="Basic "+btoa(l.username+":"+l.password),l=new URL(l.protocol+"//"+l.host+l.pathname+l.search)),l.protocol!=="https:"&&l.protocol!=="http:")throw new Error(`Unknown protocol, ${l.protocol}`);if(o&&!(o instanceof ArrayBuffer||ArrayBuffer.isView(o)||typeof o=="string"))if(typeof o=="object")o=JSON.stringify(o),i["Content-Type"]="application/json";else throw new Error("Unknown body type.");a=new Headers(mr(mr({},i||{}),a));let d=yield fetch(l,{method:e,headers:a,body:o});if(d.statusCode=d.status,!r.has(d.status))throw new FC(d);return t==="json"?d.json():t==="buffer"?d.arrayBuffer():t==="string"?d.text():d});wD.exports=lU(hU)});var ED=h(Si=>{"use strict";var dU=Si&&Si.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Si,"__esModule",{value:!0});Si.RestMessageAdapter=Si.RestRequestType=void 0;var fU=dU(_D()),RD=x(),Pd;(function(r){r.Get="GET",r.Post="POST",r.Delete="DELETE",r.File="file"})(Pd=Si.RestRequestType||(Si.RestRequestType={}));var BC=class{constructor(e){if(!e)throw new RD.ArgumentNullError("configParams");this.privHeaders=e.headers,this.privIgnoreCache=e.ignoreCache}static extractHeaderValue(e,t){let i="";try{let n=t.trim().split(/[\r\n]+/),s={};n.forEach(o=>{let a=o.split(": "),c=a.shift().toLowerCase(),u=a.join(": ");s[c]=u}),i=s[e.toLowerCase()]}catch{}return i}set options(e){this.privHeaders=e.headers,this.privIgnoreCache=e.ignoreCache}setHeaders(e,t){this.privHeaders[e]=t}request(e,t,i={},n=null){let s=new RD.Deferred,o=e===Pd.File?"POST":e,a=(u,p={})=>{let l=u;return{data:JSON.stringify(p),headers:JSON.stringify(u.headers),json:p,ok:u.statusCode>=200&&u.statusCode<300,status:u.statusCode,statusText:p.error?p.error.message:l.statusText?l.statusText:l.statusMessage}},c=u=>{let p=fU.default(t,o,this.privHeaders,200,201,202,204,400,401,402,403,404),l=this.queryParams(i)===""?"":`?${this.queryParams(i)}`;p(l,u).then(d=>v(this,null,function*(){if(e===Pd.Delete||d.statusCode===204)s.resolve(a(d));else try{let f=yield d.json();s.resolve(a(d,f))}catch{s.resolve(a(d))}})).catch(d=>{s.reject(d)})};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),e===Pd.Post&&n&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),c(n),s.promise}queryParams(e={}){return Object.keys(e).map(t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t])).join("&")}};Si.RestMessageAdapter=BC});var UC=h(wd=>{"use strict";Object.defineProperty(wd,"__esModule",{value:!0});wd.RestConfigBase=void 0;var wo=class r{static get requestOptions(){return r.privDefaultRequestOptions}static get configParams(){return r.privDefaultParams}static get restErrors(){return r.privRestErrors}};wd.RestConfigBase=wo;wo.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4};wo.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."};wo.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"}});var Le=h(Ge=>{"use strict";var vU=Ge&&Ge.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Or=Ge&&Ge.__exportStar||function(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&vU(e,r,t)};Object.defineProperty(Ge,"__esModule",{value:!0});Or(gR(),Ge);Or(yR(),Ge);Or(bR(),Ge);Or(wR(),Ge);Or(_R(),Ge);Or(YA(),Ge);Or(py(),Ge);Or(QA(),Ge);Or(SD(),Ge);Or(ED(),Ge);Or(UC(),Ge)});var AD=h(_d=>{"use strict";Object.defineProperty(_d,"__esModule",{value:!0});_d.IntentConnectionFactory=void 0;var ID=Le(),Pc=P(),TD=ar(),gU=T(),mU=ot(),WC=class extends TD.ConnectionFactoryBase{create(e,t,i){let n=e.parameters.getProperty(Pc.PropertyId.SpeechServiceConnection_Endpoint);if(!n){let c=e.parameters.getProperty(Pc.PropertyId.SpeechServiceConnection_IntentRegion),u=TD.ConnectionFactoryBase.getHostSuffix(c);n=e.parameters.getProperty(Pc.PropertyId.SpeechServiceConnection_Host,"wss://"+c+".sr.speech"+u)+"/speech/recognition/interactive/cognitiveservices/v1"}let s={format:"simple",language:e.parameters.getProperty(Pc.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(e,s,n);let o={};t.token!==void 0&&t.token!==""&&(o[t.headerName]=t.token),o[mU.HeaderNames.ConnectionId]=i,e.parameters.setProperty(Pc.PropertyId.SpeechServiceConnection_Url,n);let a=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new ID.WebsocketConnection(n,s,o,new gU.WebsocketMessageFormatter,ID.ProxyInfo.fromRecognizerConfig(e),a,i)}getSpeechRegionFromIntentRegion(e){switch(e){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return e}}};_d.IntentConnectionFactory=WC});var MD=h(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.VoiceProfileConnectionFactory=_o.SpeakerRecognitionConnectionFactory=void 0;var OD=Le(),Jn=P(),DD=ar(),yU=T(),xD=ot(),Rd=class extends DD.ConnectionFactoryBase{create(e,t,i,n){let s=e.parameters.getProperty(Jn.PropertyId.SpeechServiceConnection_Endpoint);if(!s){let u=e.parameters.getProperty(Jn.PropertyId.SpeechServiceConnection_Region),p=DD.ConnectionFactoryBase.getHostSuffix(u),l=e.parameters.getProperty(Jn.PropertyId.SpeechServiceConnection_Host,`wss://${u}.spr-frontend.speech${p}`),d=e.parameters.getProperty(Jn.PropertyId.SpeechServiceConnection_SpeakerIdMode,"TextIndependentIdentification");s=`${l}/speaker/ws/${this.scenarioToPath(d)}/${i}`}let o={format:"simple",language:e.parameters.getProperty(Jn.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(e,o,s);let a={};t.token!==void 0&&t.token!==""&&(a[t.headerName]=t.token),a[xD.HeaderNames.ConnectionId]=n,a[xD.HeaderNames.SpIDAuthKey]=e.parameters.getProperty(Jn.PropertyId.SpeechServiceConnection_Key),e.parameters.setProperty(Jn.PropertyId.SpeechServiceConnection_Url,s);let c=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new OD.WebsocketConnection(s,o,a,new yU.WebsocketMessageFormatter,OD.ProxyInfo.fromRecognizerConfig(e),c,n)}scenarioToPath(e){switch(e){case"TextIndependentVerification":case"2":return"verification/text-independent";case"TextDependentVerification":case"1":return"verification/text-dependent";default:return"identification/text-independent"}}},HC=class extends Rd{create(e,t,i){return super.create(e,t,"recognition",i)}};_o.SpeakerRecognitionConnectionFactory=HC;var VC=class extends Rd{create(e,t,i){return super.create(e,t,"profile",i)}};_o.VoiceProfileConnectionFactory=VC});var Id=h(Je=>{"use strict";Object.defineProperty(Je,"__esModule",{value:!0});Je.RecognitionEndedEvent=Je.RecognitionCompletionStatus=Je.RecognitionStartedEvent=Je.ConnectingToServiceEvent=Je.ListeningStartedEvent=Je.RecognitionTriggeredEvent=Je.SpeechRecognitionEvent=void 0;var Ed=x(),en=class extends Ed.PlatformEvent{constructor(e,t,i,n=Ed.EventType.Info){super(e,n),this.privRequestId=t,this.privSessionId=i}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}};Je.SpeechRecognitionEvent=en;var $C=class extends en{constructor(e,t,i,n){super("RecognitionTriggeredEvent",e,t),this.privAudioSourceId=i,this.privAudioNodeId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}};Je.RecognitionTriggeredEvent=$C;var KC=class extends en{constructor(e,t,i,n){super("ListeningStartedEvent",e,t),this.privAudioSourceId=i,this.privAudioNodeId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}};Je.ListeningStartedEvent=KC;var GC=class extends en{constructor(e,t,i){super("ConnectingToServiceEvent",e,i),this.privAuthFetchEventid=t}get authFetchEventid(){return this.privAuthFetchEventid}};Je.ConnectingToServiceEvent=GC;var JC=class extends en{constructor(e,t,i,n,s){super("RecognitionStartedEvent",e,s),this.privAudioSourceId=t,this.privAudioNodeId=i,this.privAuthFetchEventId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}};Je.RecognitionStartedEvent=JC;var kD;(function(r){r[r.Success=0]="Success",r[r.AudioSourceError=1]="AudioSourceError",r[r.AudioSourceTimeout=2]="AudioSourceTimeout",r[r.AuthTokenFetchError=3]="AuthTokenFetchError",r[r.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",r[r.UnAuthorized=5]="UnAuthorized",r[r.ConnectTimeout=6]="ConnectTimeout",r[r.ConnectError=7]="ConnectError",r[r.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",r[r.UnknownError=9]="UnknownError"})(kD=Je.RecognitionCompletionStatus||(Je.RecognitionCompletionStatus={}));var YC=class extends en{constructor(e,t,i,n,s,o,a,c){super("RecognitionEndedEvent",e,s,a===kD.Success?Ed.EventType.Info:Ed.EventType.Error),this.privAudioSourceId=t,this.privAudioNodeId=i,this.privAuthFetchEventId=n,this.privStatus=a,this.privError=c,this.privServiceTag=o}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}get serviceTag(){return this.privServiceTag}get status(){return this.privStatus}get error(){return this.privError}};Je.RecognitionEndedEvent=YC});var Yn=h(Td=>{"use strict";Object.defineProperty(Td,"__esModule",{value:!0});Td.SpeechConnectionMessage=void 0;var QC=x(),Ci=ot(),XC=class r extends QC.ConnectionMessage{constructor(e,t,i,n,s,o,a,c){if(!t)throw new QC.ArgumentNullError("path");if(!i)throw new QC.ArgumentNullError("requestId");let u={};if(u[Ci.HeaderNames.Path]=t,u[Ci.HeaderNames.RequestId]=i,u[Ci.HeaderNames.RequestTimestamp]=new Date().toISOString(),n&&(u[Ci.HeaderNames.ContentType]=n),o&&(u[Ci.HeaderNames.RequestStreamId]=o),a)for(let p in a)p&&(u[p]=a[p]);c?super(e,s,u,c):super(e,s,u),this.privPath=t,this.privRequestId=i,this.privContentType=n,this.privStreamId=o,this.privAdditionalHeaders=a}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(e){let t=null,i=null,n=null,s=null,o={};if(e.headers)for(let a in e.headers)a&&(a.toLowerCase()===Ci.HeaderNames.Path.toLowerCase()?t=e.headers[a]:a.toLowerCase()===Ci.HeaderNames.RequestId.toLowerCase()?i=e.headers[a]:a.toLowerCase()===Ci.HeaderNames.ContentType.toLowerCase()?n=e.headers[a]:a.toLowerCase()===Ci.HeaderNames.RequestStreamId.toLowerCase()?s=e.headers[a]:o[a]=e.headers[a]);return new r(e.messageType,t,i,n,e.body,s,o,e.id)}};Td.SpeechConnectionMessage=XC});var ND=h(Od=>{"use strict";Object.defineProperty(Od,"__esModule",{value:!0});Od.ServiceRecognizerBase=void 0;var SU=Le(),Ee=x(),ce=P(),Yr=T(),tn=Yn(),Ad=class r{constructor(e,t,i,n,s){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.privAverageBytesPerMs=0,this.privEnableSpeakerId=!1,this.privExpectContentAssessmentResponse=!1,this.recognizeOverride=void 0,this.recognizeSpeaker=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!e)throw new Ee.ArgumentNullError("authentication");if(!t)throw new Ee.ArgumentNullError("connectionFactory");if(!i)throw new Ee.ArgumentNullError("audioSource");if(!n)throw new Ee.ArgumentNullError("recognizerConfig");this.privEnableSpeakerId=n.isSpeakerDiarizationEnabled,this.privMustReportEndOfStream=!1,this.privAuthentication=e,this.privConnectionFactory=t,this.privAudioSource=i,this.privRecognizerConfig=n,this.privIsDisposed=!1,this.privRecognizer=s,this.privRequestSession=new Yr.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new Ee.EventSource,this.privServiceEvents=new Ee.EventSource,this.privDynamicGrammar=new Yr.DynamicGrammarBuilder,this.privSpeechContext=new Yr.SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new Yr.AgentConfig,this.privRecognizerConfig.parameters.getProperty(ce.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?this.privSetTimeout=Ee.Timeout.setTimeout:(typeof window<"u"&&(this.privSetTimeout=window.setTimeout.bind(window)),typeof globalThis<"u"&&(this.privSetTimeout=globalThis.setTimeout.bind(globalThis))),this.connectionEvents.attach(a=>{if(a.name==="ConnectionClosedEvent"){let c=a;(c.statusCode===1003||c.statusCode===1007||c.statusCode===1002||c.statusCode===4e3||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(ce.CancellationReason.Error,c.statusCode===1007?ce.CancellationErrorCode.BadRequestParameters:ce.CancellationErrorCode.ConnectionFailure,`${c.reason} websocket error code: ${c.statusCode}`)}}),this.privEnableSpeakerId&&(this.privDiarizationSessionId=Ee.createNoDashGuid()),this.setLanguageIdJson(),this.setOutputDetailLevelJson()}setTranslationJson(){let e=this.privRecognizerConfig.parameters.getProperty(ce.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0);if(e!==void 0){let t=e.split(","),i=this.privRecognizerConfig.parameters.getProperty(ce.PropertyId.SpeechServiceConnection_TranslationVoice,void 0),n=i!==void 0?"Synthesize":"None";if(this.privSpeechContext.setSection("translation",{onSuccess:{action:n},output:{interimResults:{mode:"Always"}},targetLanguages:t}),i!==void 0){let s={};for(let o of t)s[o]=i;this.privSpeechContext.setSection("synthesis",{defaultVoices:s})}}}setSpeechSegmentationTimeoutJson(){let e=this.privRecognizerConfig.parameters.getProperty(ce.PropertyId.Speech_SegmentationSilenceTimeoutMs,void 0);if(e!==void 0){let t=this.recognitionMode===Yr.RecognitionMode.Conversation?"CONVERSATION":this.recognitionMode===Yr.RecognitionMode.Dictation?"DICTATION":"INTERACTIVE",i=parseInt(e,10),n=this.privSpeechContext.getSection("phraseDetection");n.mode=t,n[t]={segmentation:{mode:"Custom",segmentationSilenceTimeoutMs:i}},this.privSpeechContext.setSection("phraseDetection",n)}}setLanguageIdJson(){let e=this.privSpeechContext.getSection("phraseDetection");if(this.privRecognizerConfig.autoDetectSourceLanguages!==void 0){let i=this.privRecognizerConfig.autoDetectSourceLanguages.split(","),n;this.privRecognizerConfig.languageIdMode==="Continuous"?n="DetectContinuous":n="DetectAtAudioStart",this.privSpeechContext.setSection("languageId",{Priority:"PrioritizeLatency",languages:i,mode:n,onSuccess:{action:"Recognize"},onUnknown:{action:"None"}}),this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"Auto"},phraseResults:{resultType:"Always"}});let s=this.privRecognizerConfig.sourceLanguageModels;s!==void 0&&(e.customModels=s,e.onInterim={action:"None"},e.onSuccess={action:"None"})}this.privRecognizerConfig.parameters.getProperty(ce.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0&&(e.onInterim={action:"Translate"},e.onSuccess={action:"Translate"},this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"None"},phraseResults:{resultType:"None"}})),this.privSpeechContext.setSection("phraseDetection",e)}setOutputDetailLevelJson(){this.privEnableSpeakerId&&(this.privRecognizerConfig.parameters.getProperty(ce.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true"?this.privSpeechContext.setWordLevelTimings():this.privRecognizerConfig.parameters.getProperty(Yr.OutputFormatPropertyName,ce.OutputFormat[ce.OutputFormat.Simple]).toLowerCase()===ce.OutputFormat[ce.OutputFormat.Detailed].toLocaleLowerCase()&&this.privSpeechContext.setDetailedOutputFormat())}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(e){this.privRecognizerConfig.parameters.setProperty(ce.PropertyId.ConversationTranslator_Token,e)}set voiceProfileType(e){this.privRecognizerConfig.parameters.setProperty(ce.PropertyId.SpeechServiceConnection_SpeakerIdMode,e)}set authentication(e){this.privAuthentication=e}isDisposed(){return this.privIsDisposed}dispose(e){return v(this,null,function*(){if(this.privIsDisposed=!0,this.privConnectionConfigurationPromise!==void 0)try{yield(yield this.privConnectionConfigurationPromise).dispose(e)}catch{return}})}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}recognize(e,t,i){return v(this,null,function*(){if(this.recognizeOverride!==void 0){yield this.recognizeOverride(e,t,i);return}this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=e,this.setSpeechSegmentationTimeoutJson(),this.setTranslationJson(),this.privSuccessCallback=t,this.privErrorCallback=i,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);let n=this.connectImpl(),s;try{let c=yield this.audioSource.attach(this.privRequestSession.audioNodeId),u=yield this.audioSource.format,p=yield this.audioSource.deviceInfo;this.privIsLiveAudio=p.type&&p.type===Yr.type.Microphones,s=new SU.ReplayableAudioNode(c,u.avgBytesPerSec),yield this.privRequestSession.onAudioSourceAttachCompleted(s,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:p}}catch(c){throw yield this.privRequestSession.onStopRecognizing(),c}try{yield n}catch(c){yield this.cancelRecognitionLocal(ce.CancellationReason.Error,ce.CancellationErrorCode.ConnectionFailure,c);return}let o=new ce.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,o),this.receiveMessage(),this.sendAudio(s).catch(c=>v(this,null,function*(){yield this.cancelRecognitionLocal(ce.CancellationReason.Error,ce.CancellationErrorCode.RuntimeError,c)}))})}stopRecognizing(){return v(this,null,function*(){if(this.privRequestSession.isRecognizing)try{yield this.audioSource.turnOff(),yield this.sendFinalAudio(),yield this.privRequestSession.onStopRecognizing(),yield this.privRequestSession.turnCompletionPromise}finally{yield this.privRequestSession.dispose()}})}connect(){return v(this,null,function*(){return yield this.connectImpl(),Promise.resolve()})}connectAsync(e,t){this.connectImpl().then(()=>{try{e&&e()}catch(i){t&&t(i)}},i=>{try{t&&t(i)}catch{}})}disconnect(){return v(this,null,function*(){if(yield this.cancelRecognitionLocal(ce.CancellationReason.Error,ce.CancellationErrorCode.NoError,"Disconnecting"),this.disconnectOverride!==void 0&&(yield this.disconnectOverride()),this.privConnectionPromise!==void 0)try{yield(yield this.privConnectionPromise).dispose()}catch{}this.privConnectionPromise=void 0})}sendMessage(e){}sendNetworkMessage(e,t){return v(this,null,function*(){let i=typeof t=="string"?Ee.MessageType.Text:Ee.MessageType.Binary,n=typeof t=="string"?"application/json":"";return(yield this.fetchConnection()).send(new tn.SpeechConnectionMessage(i,e,this.privRequestSession.requestId,n,t))})}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}set expectContentAssessmentResponse(e){this.privExpectContentAssessmentResponse=e}sendTelemetryData(){return v(this,null,function*(){let e=this.privRequestSession.getTelemetry();if(r.telemetryDataEnabled!==!0||this.privIsDisposed||e===null)return;if(r.telemetryData)try{r.telemetryData(e)}catch{}yield(yield this.fetchConnection()).send(new tn.SpeechConnectionMessage(Ee.MessageType.Text,"telemetry",this.privRequestSession.requestId,"application/json",e))})}cancelRecognitionLocal(e,t,i){return v(this,null,function*(){this.privRequestSession.isRecognizing&&(yield this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,e,t,i))})}receiveMessage(){return v(this,null,function*(){try{if(this.privIsDisposed)return;let e=yield this.fetchConnection(),t=yield e.read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(!t)return this.receiveMessage();this.privServiceHasSentMessage=!0;let i=tn.SpeechConnectionMessage.fromConnectionMessage(t);if(i.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(i.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":let n=Yr.SpeechDetected.fromJSON(i.textBody),s=new ce.RecognitionEventArgs(n.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,s);break;case"speech.enddetected":let o;i.textBody.length>0?o=i.textBody:o="{ Offset: 0 }";let a=Yr.SpeechDetected.fromJSON(o),c=new ce.RecognitionEventArgs(a.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,c);break;case"turn.end":yield this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,yield this.cancelRecognitionLocal(ce.CancellationReason.EndOfStream,ce.CancellationErrorCode.NoError,void 0));let u=new ce.SessionEventArgs(this.privRequestSession.sessionId);if(yield this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing){this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,u);return}else e=yield this.fetchConnection(),yield this.sendPrePayloadJSON(e);break;default:(yield this.processTypeSpecificMessages(i))||this.privServiceEvents&&this.serviceEvents.onEvent(new Ee.ServiceEvent(i.path.toLowerCase(),i.textBody))}return this.receiveMessage()}catch{return null}})}updateSpeakerDiarizationAudioOffset(){let t=this.privRequestSession.recognitionBytesSent/this.privAverageBytesPerMs;this.privSpeechContext.setSpeakerDiarizationAudioOffsetMs(t)}sendSpeechContext(e,t){this.privEnableSpeakerId&&this.updateSpeakerDiarizationAudioOffset();let i=this.speechContext.toJSON();if(t&&this.privRequestSession.onSpeechContext(),i)return e.send(new tn.SpeechConnectionMessage(Ee.MessageType.Text,"speech.context",this.privRequestSession.requestId,"application/json",i))}noOp(){}sendPrePayloadJSON(e,t=!0){return v(this,null,function*(){if(this.sendPrePayloadJSONOverride!==void 0)return this.sendPrePayloadJSONOverride(e);yield this.sendSpeechContext(e,t),yield this.sendWaveHeader(e)})}sendWaveHeader(e){return v(this,null,function*(){let t=yield this.audioSource.format;return e.send(new tn.SpeechConnectionMessage(Ee.MessageType.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",t.header))})}connectImpl(){return this.privConnectionPromise!==void 0?this.privConnectionPromise.then(e=>e.state()===Ee.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl())):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch(()=>{}),this.postConnectImplOverride!==void 0?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(e,t,i){if(t.onSpeechContext(),r.telemetryDataEnabled!==!0){let s={context:{system:JSON.parse(i).context.system}};i=JSON.stringify(s)}if(this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()==="true"){let n=JSON.parse(i);n.context.DisableReferenceChannel="True",n.context.MicSpec="1_0_0",i=JSON.stringify(n)}if(i)return e.send(new tn.SpeechConnectionMessage(Ee.MessageType.Text,"speech.config",t.requestId,"application/json",i))}fetchConnection(){return v(this,null,function*(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(e=>e.state()===Ee.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),yield this.privConnectionConfigurationPromise)})}sendAudio(e){return v(this,null,function*(){let t=yield this.audioSource.format;this.privAverageBytesPerMs=t.avgBytesPerSec/1e3;let i=Date.now(),n=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),s=t.avgBytesPerSec/1e3*parseInt(n,10),o=this.privRequestSession.recogNumber,a=()=>v(this,null,function*(){if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===o){let c=yield this.fetchConnection(),u=yield e.read();if(this.privRequestSession.isSpeechEnded)return;let p,l;if(!u||u.isEnd?(p=null,l=0):(p=u.buffer,this.privRequestSession.onAudioSent(p.byteLength),s>=this.privRequestSession.bytesSent?l=0:l=Math.max(0,i-Date.now())),l!==0&&(yield this.delay(l)),p!==null&&(i=Date.now()+p.byteLength*1e3/(t.avgBytesPerSec*2)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===o)if(c.send(new tn.SpeechConnectionMessage(Ee.MessageType.Binary,"audio",this.privRequestSession.requestId,null,p)).catch(()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(()=>{})}),u?.isEnd)this.privIsLiveAudio||this.privRequestSession.onSpeechEnded();else return a()}});return a()})}retryableConnect(){return v(this,null,function*(){let e=!1;this.privAuthFetchEventId=Ee.createNoDashGuid();let t=this.privRequestSession.sessionId;this.privConnectionId=t!==void 0?t:Ee.createNoDashGuid(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let i=0,n="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){let o=yield e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);yield this.privRequestSession.onAuthCompleted(!1);let a=this.privConnectionFactory.create(this.privRecognizerConfig,o,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(a.events),a.events.attach(u=>{this.connectionEvents.onEvent(u)});let c=yield a.open();if(c.statusCode===200)return yield this.privRequestSession.onConnectionEstablishCompleted(c.statusCode),Promise.resolve(a);c.statusCode===1006&&(e=!0),i=c.statusCode,n=c.reason,this.privRequestSession.onRetryConnection()}return yield this.privRequestSession.onConnectionEstablishCompleted(i,n),Promise.reject(`Unable to contact server. StatusCode: ${i}, ${this.privRecognizerConfig.parameters.getProperty(ce.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${n}`)})}delay(e){return new Promise(t=>this.privSetTimeout(t,e))}writeBufferToConsole(e){let t="Buffer Size: ";if(e===null)t+="null";else{let i=new Uint8Array(e);t+=`${e.byteLength}\r
`;for(let n=0;n<e.byteLength;n++)t+=i[n].toString(16).padStart(2,"0")+" ",(n+1)%16===0&&(console.info(t),t="")}console.info(t)}sendFinalAudio(){return v(this,null,function*(){yield(yield this.fetchConnection()).send(new tn.SpeechConnectionMessage(Ee.MessageType.Binary,"audio",this.privRequestSession.requestId,null,null))})}configureConnection(){return v(this,null,function*(){let e=yield this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(e):(yield this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),yield this.sendPrePayloadJSON(e,!1),e)})}};Od.ServiceRecognizerBase=Ad;Ad.telemetryDataEnabled=!0});var jD=h(Dd=>{"use strict";Object.defineProperty(Dd,"__esModule",{value:!0});Dd.ConversationServiceRecognizer=void 0;var ur=P(),Qr=T(),ZC=class extends Qr.ServiceRecognizerBase{constructor(e,t,i,n,s){super(e,t,i,n,s),this.handleSpeechPhraseMessage=o=>v(this,null,function*(){return this.handleSpeechPhrase(o)}),this.handleSpeechHypothesisMessage=o=>this.handleSpeechHypothesis(o)}processTypeSpecificMessages(e){}handleRecognizedCallback(e,t,i){}handleRecognizingCallback(e,t,i){}processSpeechMessages(e){return v(this,null,function*(){let t=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(e.textBody),t=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&(yield this.handleSpeechPhraseMessage(e.textBody)),t=!0;break;default:break}return t})}cancelRecognition(e,t,i,n,s){}handleSpeechPhrase(e){return v(this,null,function*(){let t=Qr.SimpleSpeechPhrase.fromJSON(e),i=Qr.EnumTranslation.implTranslateRecognitionResult(t.RecognitionStatus),n,s=new ur.PropertyCollection;s.setProperty(ur.PropertyId.SpeechServiceResponse_JsonResult,e);let o=t.Offset+this.privRequestSession.currentTurnAudioOffset,a=o;if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+t.Offset+t.Duration),ur.ResultReason.Canceled===i){let c=Qr.EnumTranslation.implTranslateCancelResult(t.RecognitionStatus),u=Qr.EnumTranslation.implTranslateCancelErrorCode(t.RecognitionStatus);yield this.cancelRecognitionLocal(c,u,Qr.EnumTranslation.implTranslateErrorDetails(u))}else if(!(this.privRequestSession.isSpeechEnded&&i===ur.ResultReason.NoMatch&&t.RecognitionStatus!==Qr.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(Qr.OutputFormatPropertyName)===ur.OutputFormat[ur.OutputFormat.Simple])n=new ur.SpeechRecognitionResult(this.privRequestSession.requestId,i,t.DisplayText,t.Duration,o,t.Language,t.LanguageDetectionConfidence,t.SpeakerId,void 0,e,s);else{let c=Qr.DetailedSpeechPhrase.fromJSON(e),u=c.Offset+this.privRequestSession.currentTurnAudioOffset,p=c.getJsonWithCorrectedOffsets(u);n=new ur.SpeechRecognitionResult(this.privRequestSession.requestId,i,c.Text,c.Duration,u,c.Language,c.LanguageDetectionConfidence,c.SpeakerId,void 0,p,s),a=n.offset}this.handleRecognizedCallback(n,a,this.privRequestSession.sessionId)}})}handleSpeechHypothesis(e){let t=Qr.SpeechHypothesis.fromJSON(e),i=t.Offset+this.privRequestSession.currentTurnAudioOffset,n=new ur.PropertyCollection;n.setProperty(ur.PropertyId.SpeechServiceResponse_JsonResult,e);let s=new ur.SpeechRecognitionResult(this.privRequestSession.requestId,ur.ResultReason.RecognizingSpeech,t.Text,t.Duration,i,t.Language,t.LanguageDetectionConfidence,t.SpeakerId,void 0,e,n);this.privRequestSession.onHypothesis(i),this.handleRecognizingCallback(s,t.Duration,this.privRequestSession.sessionId)}};Dd.ConversationServiceRecognizer=ZC});var qD=h(Xr=>{"use strict";Object.defineProperty(Xr,"__esModule",{value:!0});Xr.RecognizerConfig=Xr.SpeechResultFormat=Xr.RecognitionMode=void 0;var xd=P(),LD=T(),Md;(function(r){r[r.Interactive=0]="Interactive",r[r.Conversation=1]="Conversation",r[r.Dictation=2]="Dictation"})(Md=Xr.RecognitionMode||(Xr.RecognitionMode={}));var CU;(function(r){r[r.Simple=0]="Simple",r[r.Detailed=1]="Detailed"})(CU=Xr.SpeechResultFormat||(Xr.SpeechResultFormat={}));var eb=class{constructor(e,t){this.privSpeechServiceConfig=e||new LD.SpeechServiceConfig(new LD.Context(null)),this.privParameters=t,this.privMaxRetryCount=parseInt(t.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=t.getProperty(xd.PropertyId.SpeechServiceConnection_LanguageIdMode,void 0),this.privEnableSpeakerId=!1}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(e){this.privRecognitionMode=e,this.privRecognitionActivityTimeout=e===Md.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=Md[e]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==Md.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(xd.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(xd.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,void 0)}get sourceLanguageModels(){let e=[],t=!1;if(this.autoDetectSourceLanguages!==void 0)for(let i of this.autoDetectSourceLanguages.split(",")){let n=i+xd.PropertyId.SpeechServiceConnection_EndpointId.toString(),s=this.parameters.getProperty(n,void 0);s!==void 0?(e.push({language:i,endpoint:s}),t=!0):e.push({language:i,endpoint:""})}return t?e:void 0}get maxRetryCount(){return this.privMaxRetryCount}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}set isSpeakerDiarizationEnabled(e){this.privEnableSpeakerId=e}};Xr.RecognizerConfig=eb});var FD=h(zD=>{"use strict";Object.defineProperty(zD,"__esModule",{value:!0})});var UD=h(kd=>{"use strict";Object.defineProperty(kd,"__esModule",{value:!0});kd.WebsocketMessageFormatter=void 0;var pr=x(),BD=`\r
`,tb=class{toConnectionMessage(e){let t=new pr.Deferred;try{if(e.messageType===pr.MessageType.Text){let i=e.textContent,n={},s=null;if(i){let o=i.split(`\r
\r
`);o&&o.length>0&&(n=this.parseHeaders(o[0]),o.length>1&&(s=o[1]))}t.resolve(new pr.ConnectionMessage(e.messageType,s,n,e.id))}else if(e.messageType===pr.MessageType.Binary){let i=e.binaryContent,n={},s=null;if(!i||i.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");let o=new DataView(i),a=o.getInt16(0);if(i.byteLength<a+2)throw new Error("Invalid binary message format. Header content missing.");let c="";for(let u=0;u<a;u++)c+=String.fromCharCode(o.getInt8(u+2));n=this.parseHeaders(c),i.byteLength>a+2&&(s=i.slice(2+a)),t.resolve(new pr.ConnectionMessage(e.messageType,s,n,e.id))}}catch(i){t.reject(`Error formatting the message. Error: ${i}`)}return t.promise}fromConnectionMessage(e){let t=new pr.Deferred;try{if(e.messageType===pr.MessageType.Text){let i=`${this.makeHeaders(e)}${BD}${e.textBody?e.textBody:""}`;t.resolve(new pr.RawWebsocketMessage(pr.MessageType.Text,i,e.id))}else if(e.messageType===pr.MessageType.Binary){let i=this.makeHeaders(e),n=e.binaryBody,s=this.stringToArrayBuffer(i),o=new Int8Array(s),a=o.byteLength,c=new Int8Array(2+a+(n?n.byteLength:0));if(c[0]=a>>8&255,c[1]=a&255,c.set(o,2),n){let p=new Int8Array(n);c.set(p,2+a)}let u=c.buffer;t.resolve(new pr.RawWebsocketMessage(pr.MessageType.Binary,u,e.id))}}catch(i){t.reject(`Error formatting the message. ${i}`)}return t.promise}makeHeaders(e){let t="";if(e.headers)for(let i in e.headers)i&&(t+=`${i}: ${e.headers[i]}${BD}`);return t}parseHeaders(e){let t={};if(e){let i=e.match(/[^\r\n]+/g);if(t){for(let n of i)if(n){let s=n.indexOf(":"),o=s>0?n.substr(0,s).trim().toLowerCase():n,a=s>0&&n.length>s+1?n.substr(s+1).trim():"";t[o]=a}}}return t}stringToArrayBuffer(e){let t=new ArrayBuffer(e.length),i=new DataView(t);for(let n=0;n<e.length;n++)i.setUint8(n,e.charCodeAt(n));return t}};kd.WebsocketMessageFormatter=tb});var $D=h(Nd=>{"use strict";Object.defineProperty(Nd,"__esModule",{value:!0});Nd.SpeechConnectionFactory=void 0;var WD=Le(),HD=T(),rn=P(),VD=ar(),rb=T(),bU=ot(),Qn=gi(),ib=class extends VD.ConnectionFactoryBase{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/speech/universal/v"}create(e,t,i){let n=e.parameters.getProperty(rn.PropertyId.SpeechServiceConnection_Endpoint,void 0),s=e.parameters.getProperty(rn.PropertyId.SpeechServiceConnection_Region,void 0),o=VD.ConnectionFactoryBase.getHostSuffix(s),a=e.parameters.getProperty(rn.PropertyId.SpeechServiceConnection_Host,"wss://"+s+".stt.speech"+o),c={},u=e.parameters.getProperty(rn.PropertyId.SpeechServiceConnection_EndpointId,void 0),p=e.parameters.getProperty(rn.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(u?(!n||n.search(Qn.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(c[Qn.QueryParameterNames.CustomSpeechDeploymentId]=u):p&&(!n||n.search(Qn.QueryParameterNames.Language)===-1)&&(c[Qn.QueryParameterNames.Language]=p),(!n||n.search(Qn.QueryParameterNames.Format)===-1)&&(c[Qn.QueryParameterNames.Format]=e.parameters.getProperty(HD.OutputFormatPropertyName,rn.OutputFormat[rn.OutputFormat.Simple]).toLowerCase()),e.autoDetectSourceLanguages!==void 0&&(c[Qn.QueryParameterNames.EnableLanguageId]="true"),this.setCommonUrlParams(e,c,n),!n)switch(e.recognitionMode){case rb.RecognitionMode.Conversation:e.parameters.getProperty(HD.ForceDictationPropertyName,"false")==="true"?n=a+this.dictationRelativeUri:e.recognitionEndpointVersion!==void 0&&parseInt(e.recognitionEndpointVersion,10)>1?n=`${a}${this.universalUri}${e.recognitionEndpointVersion}`:n=a+this.conversationRelativeUri;break;case rb.RecognitionMode.Dictation:n=a+this.dictationRelativeUri;break;default:e.recognitionEndpointVersion!==void 0&&parseInt(e.recognitionEndpointVersion,10)>1?n=`${a}${this.universalUri}${e.recognitionEndpointVersion}`:n=a+this.interactiveRelativeUri;break}let l={};t.token!==void 0&&t.token!==""&&(l[t.headerName]=t.token),l[bU.HeaderNames.ConnectionId]=i;let d=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",f=new WD.WebsocketConnection(n,c,l,new rb.WebsocketMessageFormatter,WD.ProxyInfo.fromRecognizerConfig(e),d,i),g=f.uri;return e.parameters.setProperty(rn.PropertyId.SpeechServiceConnection_Url,g),f}};Nd.SpeechConnectionFactory=ib});var JD=h(jd=>{"use strict";Object.defineProperty(jd,"__esModule",{value:!0});jd.ConversationTranscriberConnectionFactory=void 0;var KD=Le(),Vt=P(),PU=T(),GD=ar(),wU=T(),_U=ot(),lr=gi(),nb=class extends GD.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/speech/universal/v2"}create(e,t,i){let n=e.parameters.getProperty(Vt.PropertyId.SpeechServiceConnection_Endpoint,void 0),s=e.parameters.getProperty(Vt.PropertyId.SpeechServiceConnection_Region,void 0),o=GD.ConnectionFactoryBase.getHostSuffix(s),a=e.parameters.getProperty(Vt.PropertyId.SpeechServiceConnection_Host,"wss://"+s+".stt.speech"+o),c={},u=e.parameters.getProperty(Vt.PropertyId.SpeechServiceConnection_EndpointId,void 0),p=e.parameters.getProperty(Vt.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);u?(!n||n.search(lr.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(c[lr.QueryParameterNames.CustomSpeechDeploymentId]=u):p&&(!n||n.search(lr.QueryParameterNames.Language)===-1)&&(c[lr.QueryParameterNames.Language]=p),e.autoDetectSourceLanguages!==void 0&&(c[lr.QueryParameterNames.EnableLanguageId]="true"),this.setV2UrlParams(e,c,n),n||(n=`${a}${this.universalUri}`);let l={};t.token!==void 0&&t.token!==""&&(l[t.headerName]=t.token),l[_U.HeaderNames.ConnectionId]=i;let d=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",f=new KD.WebsocketConnection(n,c,l,new wU.WebsocketMessageFormatter,KD.ProxyInfo.fromRecognizerConfig(e),d,i),g=f.uri;return e.parameters.setProperty(Vt.PropertyId.SpeechServiceConnection_Url,g),f}setV2UrlParams(e,t,i){new Map([[Vt.PropertyId.Speech_SegmentationSilenceTimeoutMs,lr.QueryParameterNames.SegmentationSilenceTimeoutMs],[Vt.PropertyId.SpeechServiceConnection_EnableAudioLogging,lr.QueryParameterNames.EnableAudioLogging],[Vt.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,lr.QueryParameterNames.EndSilenceTimeoutMs],[Vt.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,lr.QueryParameterNames.InitialSilenceTimeoutMs],[Vt.PropertyId.SpeechServiceResponse_PostProcessingOption,lr.QueryParameterNames.Postprocessing],[Vt.PropertyId.SpeechServiceResponse_ProfanityOption,lr.QueryParameterNames.Profanity],[Vt.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,lr.QueryParameterNames.StableIntermediateThreshold]]).forEach((o,a)=>{this.setUrlParameter(a,o,e,t,i)});let s=JSON.parse(e.parameters.getProperty(PU.ServicePropertiesPropertyName,"{}"));Object.keys(s).forEach(o=>{t[o]=s[o]})}};jd.ConversationTranscriberConnectionFactory=nb});var ZD=h(Ld=>{"use strict";Object.defineProperty(Ld,"__esModule",{value:!0});Ld.TranscriberConnectionFactory=void 0;var YD=Le(),$t=P(),QD=ar(),XD=T(),RU=ot(),wc=gi(),sb=class extends QD.ConnectionFactoryBase{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(e,t,i){let n=e.parameters.getProperty($t.PropertyId.SpeechServiceConnection_Endpoint,void 0),s=e.parameters.getProperty($t.PropertyId.SpeechServiceConnection_Region,"centralus"),o=QD.ConnectionFactoryBase.getHostSuffix(s),a="wss://transcribe."+s+".cts.speech"+o+this.multiaudioRelativeUri,c=e.parameters.getProperty($t.PropertyId.SpeechServiceConnection_Host,a),u={};this.setQueryParams(u,e,n),n||(n=c);let p={};t.token!==void 0&&t.token!==""&&(p[t.headerName]=t.token),p[RU.HeaderNames.ConnectionId]=i,e.parameters.setProperty($t.PropertyId.SpeechServiceConnection_Url,n);let l=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new YD.WebsocketConnection(n,u,p,new XD.WebsocketMessageFormatter,YD.ProxyInfo.fromRecognizerConfig(e),l,i)}setQueryParams(e,t,i){let n=t.parameters.getProperty($t.PropertyId.SpeechServiceConnection_EndpointId,void 0),s=t.parameters.getProperty($t.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);n&&!(wc.QueryParameterNames.CustomSpeechDeploymentId in e)&&(e[wc.QueryParameterNames.CustomSpeechDeploymentId]=n),s&&!(wc.QueryParameterNames.Language in e)&&(e[wc.QueryParameterNames.Language]=s);let o=t.parameters.getProperty($t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true",a=t.parameters.getProperty(XD.OutputFormatPropertyName,$t.OutputFormat[$t.OutputFormat.Simple])!==$t.OutputFormat[$t.OutputFormat.Simple];(o||a)&&(e[wc.QueryParameterNames.Format]=$t.OutputFormat[$t.OutputFormat.Detailed].toLowerCase()),this.setCommonUrlParams(t,e,i)}};Ld.TranscriberConnectionFactory=sb});var ix=h(qd=>{"use strict";Object.defineProperty(qd,"__esModule",{value:!0});qd.TranslationConnectionFactory=void 0;var ex=Le(),EU=GS(),bi=P(),tx=ar(),ob=T(),IU=ot(),rx=gi(),ab=class extends tx.ConnectionFactoryBase{create(e,t,i){let n=this.getEndpointUrl(e),s={};e.autoDetectSourceLanguages!==void 0&&(s[rx.QueryParameterNames.EnableLanguageId]="true"),this.setQueryParams(s,e,n);let o={};t.token!==void 0&&t.token!==""&&(o[t.headerName]=t.token),o[IU.HeaderNames.ConnectionId]=i,e.parameters.setProperty(bi.PropertyId.SpeechServiceConnection_Url,n);let a=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new ex.WebsocketConnection(n,s,o,new ob.WebsocketMessageFormatter,ex.ProxyInfo.fromRecognizerConfig(e),a,i)}getEndpointUrl(e,t){let i=e.parameters.getProperty(bi.PropertyId.SpeechServiceConnection_Region),n=tx.ConnectionFactoryBase.getHostSuffix(i),s=e.parameters.getProperty(bi.PropertyId.SpeechServiceConnection_Endpoint,void 0);return s||(e.autoDetectSourceLanguages!==void 0?s=e.parameters.getProperty(bi.PropertyId.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+n)+"/speech/universal/v2":s=e.parameters.getProperty(bi.PropertyId.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+n)+"/speech/translation/cognitiveservices/v1"),t===!0?s:EU.StringUtils.formatString(s,{region:i})}setQueryParams(e,t,i){e.from=t.parameters.getProperty(bi.PropertyId.SpeechServiceConnection_RecoLanguage),e.to=t.parameters.getProperty(bi.PropertyId.SpeechServiceConnection_TranslationToLanguages),e.scenario=t.recognitionMode===ob.RecognitionMode.Interactive?"interactive":t.recognitionMode===ob.RecognitionMode.Conversation?"conversation":"",this.setCommonUrlParams(t,e,i),this.setUrlParameter(bi.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult,rx.QueryParameterNames.StableTranslation,t,e,i);let n=t.parameters.getProperty(bi.PropertyId.SpeechServiceConnection_TranslationVoice,void 0);n!==void 0&&(e.voice=n,e.features="texttospeech")}};qd.TranslationConnectionFactory=ab});var nx=h(zd=>{"use strict";Object.defineProperty(zd,"__esModule",{value:!0});zd.EnumTranslation=void 0;var ze=P(),Me=T(),cb=class{static implTranslateRecognitionResult(e,t=!1){let i=ze.ResultReason.Canceled;switch(e){case Me.RecognitionStatus.Success:i=ze.ResultReason.RecognizedSpeech;break;case Me.RecognitionStatus.EndOfDictation:i=t?ze.ResultReason.RecognizedSpeech:ze.ResultReason.NoMatch;break;case Me.RecognitionStatus.NoMatch:case Me.RecognitionStatus.InitialSilenceTimeout:case Me.RecognitionStatus.BabbleTimeout:i=ze.ResultReason.NoMatch;break;case Me.RecognitionStatus.Error:case Me.RecognitionStatus.BadRequest:case Me.RecognitionStatus.Forbidden:default:i=ze.ResultReason.Canceled;break}return i}static implTranslateCancelResult(e){let t=ze.CancellationReason.EndOfStream;switch(e){case Me.RecognitionStatus.Success:case Me.RecognitionStatus.EndOfDictation:case Me.RecognitionStatus.NoMatch:t=ze.CancellationReason.EndOfStream;break;case Me.RecognitionStatus.InitialSilenceTimeout:case Me.RecognitionStatus.BabbleTimeout:case Me.RecognitionStatus.Error:case Me.RecognitionStatus.BadRequest:case Me.RecognitionStatus.Forbidden:default:t=ze.CancellationReason.Error;break}return t}static implTranslateCancelErrorCode(e){let t=ze.CancellationErrorCode.NoError;switch(e){case Me.RecognitionStatus.Error:t=ze.CancellationErrorCode.ServiceError;break;case Me.RecognitionStatus.TooManyRequests:t=ze.CancellationErrorCode.TooManyRequests;break;case Me.RecognitionStatus.BadRequest:t=ze.CancellationErrorCode.BadRequestParameters;break;case Me.RecognitionStatus.Forbidden:t=ze.CancellationErrorCode.Forbidden;break;default:t=ze.CancellationErrorCode.NoError;break}return t}static implTranslateErrorDetails(e){let t="The speech service encountered an internal error and could not continue.";switch(e){case ze.CancellationErrorCode.Forbidden:t="The recognizer is using a free subscription that ran out of quota.";break;case ze.CancellationErrorCode.BadRequestParameters:t="Invalid parameter or unsupported audio format in the request.";break;case ze.CancellationErrorCode.TooManyRequests:t="The number of parallel requests exceeded the number of allowed concurrent transcriptions.";break;default:break}return t}};zd.EnumTranslation=cb});var sx=h(nn=>{"use strict";Object.defineProperty(nn,"__esModule",{value:!0});nn.RecognitionStatus=nn.SynthesisStatus=void 0;var TU;(function(r){r[r.Success=0]="Success",r[r.SynthesisEnd=1]="SynthesisEnd",r[r.Error=2]="Error"})(TU=nn.SynthesisStatus||(nn.SynthesisStatus={}));var AU;(function(r){r[r.Success=0]="Success",r[r.NoMatch=1]="NoMatch",r[r.InitialSilenceTimeout=2]="InitialSilenceTimeout",r[r.BabbleTimeout=3]="BabbleTimeout",r[r.Error=4]="Error",r[r.EndOfDictation=5]="EndOfDictation",r[r.TooManyRequests=6]="TooManyRequests",r[r.BadRequest=7]="BadRequest",r[r.Forbidden=8]="Forbidden"})(AU=nn.RecognitionStatus||(nn.RecognitionStatus={}))});var ax=h(Fd=>{"use strict";Object.defineProperty(Fd,"__esModule",{value:!0});Fd.TranslationSynthesisEnd=void 0;var ox=T(),ub=class r{constructor(e){this.privSynthesisEnd=JSON.parse(e),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=ox.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=ox.SynthesisStatus[this.privSynthesisEnd.Status])}static fromJSON(e){return new r(e)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}};Fd.TranslationSynthesisEnd=ub});var cx=h(Bd=>{"use strict";Object.defineProperty(Bd,"__esModule",{value:!0});Bd.TranslationHypothesis=void 0;var OU=j(),DU=Fu(),pb=class r{constructor(e){this.privTranslationHypothesis=e,this.privTranslationHypothesis.Translation.TranslationStatus=DU.TranslationStatus[this.privTranslationHypothesis.Translation.TranslationStatus]}static fromJSON(e){return new r(JSON.parse(e))}static fromTranslationResponse(e){OU.Contracts.throwIfNullOrUndefined(e,"translationHypothesis");let t=e.SpeechHypothesis;return e.SpeechHypothesis=void 0,t.Translation=e,new r(t)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}get Language(){return this.privTranslationHypothesis.PrimaryLanguage?.Language}};Bd.TranslationHypothesis=pb});var ux=h(Ud=>{"use strict";Object.defineProperty(Ud,"__esModule",{value:!0});Ud.TranslationPhrase=void 0;var xU=j(),MU=T(),kU=Fu(),lb=class r{constructor(e){this.privTranslationPhrase=e,this.privTranslationPhrase.RecognitionStatus=MU.RecognitionStatus[this.privTranslationPhrase.RecognitionStatus],this.privTranslationPhrase.Translation!==void 0&&(this.privTranslationPhrase.Translation.TranslationStatus=kU.TranslationStatus[this.privTranslationPhrase.Translation.TranslationStatus])}static fromJSON(e){return new r(JSON.parse(e))}static fromTranslationResponse(e){xU.Contracts.throwIfNullOrUndefined(e,"translationResponse");let t=e.SpeechPhrase;return e.SpeechPhrase=void 0,t.Translation=e,t.Text=t.DisplayText,new r(t)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){return this.privTranslationPhrase.PrimaryLanguage?.Language}get Confidence(){return this.privTranslationPhrase.PrimaryLanguage?.Confidence}get Translation(){return this.privTranslationPhrase.Translation}};Ud.TranslationPhrase=lb});var lx=h(Wd=>{"use strict";Object.defineProperty(Wd,"__esModule",{value:!0});Wd.TranslationServiceRecognizer=void 0;var px=x(),ne=P(),ut=T(),hb=class extends ut.ConversationServiceRecognizer{constructor(e,t,i,n,s){super(e,t,i,n,s),this.privTranslationRecognizer=s,this.connectionEvents.attach(o=>{o.name==="ConnectionEstablishedEvent"&&this.privTranslationRecognizer.onConnection()})}processTypeSpecificMessages(e){return v(this,null,function*(){let t=new ne.PropertyCollection,i=yield this.processSpeechMessages(e);if(i)return!0;let n=o=>v(this,null,function*(){if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+o.Offset+o.Duration),o.RecognitionStatus===ut.RecognitionStatus.Success){let a=this.fireEventForResult(o,t);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,a)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(a.result)}catch(c){this.privErrorCallback&&this.privErrorCallback(c)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{let a=ut.EnumTranslation.implTranslateRecognitionResult(o.RecognitionStatus),c=new ne.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,a,o.Text,o.Duration,this.privRequestSession.currentTurnAudioOffset+o.Offset,o.Language,o.Confidence,void 0,e.textBody,t);if(a===ne.ResultReason.Canceled){let u=ut.EnumTranslation.implTranslateCancelResult(o.RecognitionStatus),p=ut.EnumTranslation.implTranslateCancelErrorCode(o.RecognitionStatus);yield this.cancelRecognitionLocal(u,p,ut.EnumTranslation.implTranslateErrorDetails(p))}else{if(!(this.privRequestSession.isSpeechEnded&&a===ne.ResultReason.NoMatch&&o.RecognitionStatus!==ut.RecognitionStatus.InitialSilenceTimeout)){let u=new ne.TranslationRecognitionEventArgs(c,c.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,u)}catch{}}if(this.privSuccessCallback){try{this.privSuccessCallback(c)}catch(u){this.privErrorCallback&&this.privErrorCallback(u)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}i=!0}}),s=(o,a)=>{let c=this.fireEventForResult(o,a);if(this.privRequestSession.onHypothesis(this.privRequestSession.currentTurnAudioOffset+c.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,c)}catch{}i=!0};switch(e.messageType===px.MessageType.Text&&t.setProperty(ne.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"translation.hypothesis":s(ut.TranslationHypothesis.fromJSON(e.textBody),t);break;case"translation.response":let o=JSON.parse(e.textBody);if(o.SpeechPhrase)yield n(ut.TranslationPhrase.fromTranslationResponse(o));else{let c=JSON.parse(e.textBody);c.SpeechHypothesis&&s(ut.TranslationHypothesis.fromTranslationResponse(c),t)}break;case"translation.phrase":yield n(ut.TranslationPhrase.fromJSON(e.textBody));break;case"translation.synthesis":this.sendSynthesisAudio(e.binaryBody,this.privRequestSession.sessionId),i=!0;break;case"audio.end":case"translation.synthesis.end":let a=ut.TranslationSynthesisEnd.fromJSON(e.textBody);switch(a.SynthesisStatus){case ut.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){let c=new ne.TranslationSynthesisResult(ne.ResultReason.Canceled,void 0),u=new ne.TranslationSynthesisEventArgs(c,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,u)}catch{}}if(this.privTranslationRecognizer.canceled){let c=new ne.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,ne.CancellationReason.Error,a.FailureReason,ne.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,c)}catch{}}break;case ut.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId);break;default:break}i=!0;break;default:break}return i})}cancelRecognition(e,t,i,n,s){let o=new ne.PropertyCollection;if(o.setProperty(ut.CancellationErrorCodePropertyName,ne.CancellationErrorCode[n]),this.privTranslationRecognizer.canceled){let a=new ne.TranslationRecognitionCanceledEventArgs(e,i,s,n,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,a)}catch{}}if(this.privSuccessCallback){let a=new ne.TranslationRecognitionResult(void 0,t,ne.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,s,void 0,o);try{this.privSuccessCallback(a),this.privSuccessCallback=void 0}catch{}}}handleRecognizingCallback(e,t,i){try{let n=new ne.TranslationRecognitionEventArgs(ne.TranslationRecognitionResult.fromSpeechRecognitionResult(e),t,i);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,n)}catch{}}handleRecognizedCallback(e,t,i){try{let n=new ne.TranslationRecognitionEventArgs(ne.TranslationRecognitionResult.fromSpeechRecognitionResult(e),t,i);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,n)}catch{}}fireEventForResult(e,t){let i;if(e.Translation.Translations!==void 0){i=new ne.Translations;for(let p of e.Translation.Translations)i.set(p.Language,p.Text||p.DisplayText)}let n,s;e instanceof ut.TranslationPhrase?(e.Translation&&e.Translation.TranslationStatus===px.TranslationStatus.Success?n=ne.ResultReason.TranslatedSpeech:n=ne.ResultReason.RecognizedSpeech,s=e.Confidence):n=ne.ResultReason.TranslatingSpeech;let o=e.Language,a=e.Offset+this.privRequestSession.currentTurnAudioOffset,c=new ne.TranslationRecognitionResult(i,this.privRequestSession.requestId,n,e.Text,e.Duration,a,o,s,e.Translation.FailureReason,JSON.stringify(e),t);return new ne.TranslationRecognitionEventArgs(c,a,this.privRequestSession.sessionId)}sendSynthesisAudio(e,t){let i=e===void 0?ne.ResultReason.SynthesizingAudioCompleted:ne.ResultReason.SynthesizingAudio,n=new ne.TranslationSynthesisResult(i,e),s=new ne.TranslationSynthesisEventArgs(n,t);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,s)}catch{}}};Wd.TranslationServiceRecognizer=hb});var hx=h(Hd=>{"use strict";Object.defineProperty(Hd,"__esModule",{value:!0});Hd.SpeechDetected=void 0;var db=class r{constructor(e){this.privSpeechStartDetected=JSON.parse(e)}static fromJSON(e){return new r(e)}get Offset(){return this.privSpeechStartDetected.Offset}};Hd.SpeechDetected=db});var dx=h(Vd=>{"use strict";Object.defineProperty(Vd,"__esModule",{value:!0});Vd.SpeechHypothesis=void 0;var fb=class r{constructor(e){this.privSpeechHypothesis=JSON.parse(e)}static fromJSON(e){return new r(e)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}};Vd.SpeechHypothesis=fb});var fx=h($d=>{"use strict";Object.defineProperty($d,"__esModule",{value:!0});$d.SpeechKeyword=void 0;var vb=class r{constructor(e){this.privSpeechKeyword=JSON.parse(e)}static fromJSON(e){return new r(e)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}};$d.SpeechKeyword=vb});var vx=h(Kd=>{"use strict";Object.defineProperty(Kd,"__esModule",{value:!0});Kd.SpeechServiceRecognizer=void 0;var Ye=P(),hr=T(),gb=class extends hr.ServiceRecognizerBase{constructor(e,t,i,n,s){super(e,t,i,n,s),this.privSpeechRecognizer=s}processTypeSpecificMessages(e){return v(this,null,function*(){let t,i=new Ye.PropertyCollection;i.setProperty(Ye.PropertyId.SpeechServiceResponse_JsonResult,e.textBody);let n=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":let s=hr.SpeechHypothesis.fromJSON(e.textBody),o=s.Offset+this.privRequestSession.currentTurnAudioOffset;t=new Ye.SpeechRecognitionResult(this.privRequestSession.requestId,Ye.ResultReason.RecognizingSpeech,s.Text,s.Duration,o,s.Language,s.LanguageDetectionConfidence,void 0,void 0,e.textBody,i),this.privRequestSession.onHypothesis(o);let a=new Ye.SpeechRecognitionEventArgs(t,s.Duration,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,a)}catch{}n=!0;break;case"speech.phrase":let c=hr.SimpleSpeechPhrase.fromJSON(e.textBody),u=hr.EnumTranslation.implTranslateRecognitionResult(c.RecognitionStatus,this.privExpectContentAssessmentResponse);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+c.Offset+c.Duration),Ye.ResultReason.Canceled===u){let p=hr.EnumTranslation.implTranslateCancelResult(c.RecognitionStatus),l=hr.EnumTranslation.implTranslateCancelErrorCode(c.RecognitionStatus);yield this.cancelRecognitionLocal(p,l,hr.EnumTranslation.implTranslateErrorDetails(l))}else{if(!(this.privRequestSession.isSpeechEnded&&u===Ye.ResultReason.NoMatch&&c.RecognitionStatus!==hr.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(hr.OutputFormatPropertyName)===Ye.OutputFormat[Ye.OutputFormat.Simple])t=new Ye.SpeechRecognitionResult(this.privRequestSession.requestId,u,c.DisplayText,c.Duration,c.Offset+this.privRequestSession.currentTurnAudioOffset,c.Language,c.LanguageDetectionConfidence,void 0,void 0,e.textBody,i);else{let l=hr.DetailedSpeechPhrase.fromJSON(e.textBody),d=l.Offset+this.privRequestSession.currentTurnAudioOffset,f=l.getJsonWithCorrectedOffsets(d);t=new Ye.SpeechRecognitionResult(this.privRequestSession.requestId,u,l.RecognitionStatus===hr.RecognitionStatus.Success?l.NBest[0].Display:void 0,l.Duration,d,l.Language,l.LanguageDetectionConfidence,void 0,void 0,f,i)}let p=new Ye.SpeechRecognitionEventArgs(t,t.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,p)}catch{}}if(this.privSuccessCallback){try{this.privSuccessCallback(t)}catch(p){this.privErrorCallback&&this.privErrorCallback(p)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}n=!0;break;default:break}return n})}cancelRecognition(e,t,i,n,s){let o=new Ye.PropertyCollection;if(o.setProperty(hr.CancellationErrorCodePropertyName,Ye.CancellationErrorCode[n]),this.privSpeechRecognizer.canceled){let a=new Ye.SpeechRecognitionCanceledEventArgs(i,s,n,void 0,e);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,a)}catch{}}if(this.privSuccessCallback){let a=new Ye.SpeechRecognitionResult(t,Ye.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,s,void 0,o);try{this.privSuccessCallback(a),this.privSuccessCallback=void 0}catch{}}}};Kd.SpeechServiceRecognizer=gb});var gx=h(Gd=>{"use strict";Object.defineProperty(Gd,"__esModule",{value:!0});Gd.ConversationTranscriptionServiceRecognizer=void 0;var Ct=P(),dr=T(),mb=class extends dr.ServiceRecognizerBase{constructor(e,t,i,n,s){super(e,t,i,n,s),this.privConversationTranscriber=s,this.setSpeakerDiarizationJson()}setSpeakerDiarizationJson(){if(this.privEnableSpeakerId){let e=this.privSpeechContext.getSection("phraseDetection");e.mode="Conversation";let t={};t.mode="Anonymous",t.audioSessionId=this.privDiarizationSessionId,t.audioOffsetMs=0,e.speakerDiarization=t,this.privSpeechContext.setSection("phraseDetection",e)}}processTypeSpecificMessages(e){return v(this,null,function*(){let t,i=new Ct.PropertyCollection;i.setProperty(Ct.PropertyId.SpeechServiceResponse_JsonResult,e.textBody);let n=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":let s=dr.SpeechHypothesis.fromJSON(e.textBody),o=s.Offset+this.privRequestSession.currentTurnAudioOffset;t=new Ct.ConversationTranscriptionResult(this.privRequestSession.requestId,Ct.ResultReason.RecognizingSpeech,s.Text,s.Duration,o,s.Language,s.LanguageDetectionConfidence,void 0,void 0,e.textBody,i),this.privRequestSession.onHypothesis(o);let a=new Ct.ConversationTranscriptionEventArgs(t,s.Duration,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribing)try{this.privConversationTranscriber.transcribing(this.privConversationTranscriber,a)}catch{}n=!0;break;case"speech.phrase":let c=dr.SimpleSpeechPhrase.fromJSON(e.textBody),u=dr.EnumTranslation.implTranslateRecognitionResult(c.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+c.Offset+c.Duration),Ct.ResultReason.Canceled===u){let p=dr.EnumTranslation.implTranslateCancelResult(c.RecognitionStatus),l=dr.EnumTranslation.implTranslateCancelErrorCode(c.RecognitionStatus);yield this.cancelRecognitionLocal(p,l,dr.EnumTranslation.implTranslateErrorDetails(l))}else if(!(this.privRequestSession.isSpeechEnded&&u===Ct.ResultReason.NoMatch&&c.RecognitionStatus!==dr.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(dr.OutputFormatPropertyName)===Ct.OutputFormat[Ct.OutputFormat.Simple])t=new Ct.ConversationTranscriptionResult(this.privRequestSession.requestId,u,c.DisplayText,c.Duration,c.Offset+this.privRequestSession.currentTurnAudioOffset,c.Language,c.LanguageDetectionConfidence,c.SpeakerId,void 0,e.textBody,i);else{let l=dr.DetailedSpeechPhrase.fromJSON(e.textBody),d=l.Offset+this.privRequestSession.currentTurnAudioOffset,f=l.getJsonWithCorrectedOffsets(d);t=new Ct.ConversationTranscriptionResult(this.privRequestSession.requestId,u,l.RecognitionStatus===dr.RecognitionStatus.Success?l.NBest[0].Display:void 0,l.Duration,d,l.Language,l.LanguageDetectionConfidence,c.SpeakerId,void 0,f,i)}let p=new Ct.ConversationTranscriptionEventArgs(t,t.offset,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribed)try{this.privConversationTranscriber.transcribed(this.privConversationTranscriber,p)}catch{}}n=!0;break;default:break}return n})}cancelRecognition(e,t,i,n,s){if(new Ct.PropertyCollection().setProperty(dr.CancellationErrorCodePropertyName,Ct.CancellationErrorCode[n]),this.privConversationTranscriber.canceled){let a=new Ct.ConversationTranscriptionCanceledEventArgs(i,s,n,void 0,e);try{this.privConversationTranscriber.canceled(this.privConversationTranscriber,a)}catch{}}}};Gd.ConversationTranscriptionServiceRecognizer=mb});var yx=h(Jd=>{"use strict";Object.defineProperty(Jd,"__esModule",{value:!0});Jd.TranscriptionServiceRecognizer=void 0;var NU=x(),Pi=P(),mx=T(),jU=Yn(),yb=class extends mx.ConversationServiceRecognizer{constructor(e,t,i,n,s){super(e,t,i,n,s),this.privTranscriberRecognizer=s,this.sendPrePayloadJSONOverride=o=>this.sendTranscriptionStartJSON(o),this.privRecognizerConfig.parameters.getProperty(Pi.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps)==="true"&&this.privSpeechContext.setWordLevelTimings()}sendSpeechEventAsync(e,t){return v(this,null,function*(){if(this.privRequestSession.isRecognizing){let i=yield this.fetchConnection();yield this.sendSpeechEvent(i,this.createSpeechEventPayload(e,t))}})}sendMeetingSpeechEventAsync(e,t){return v(this,null,function*(){if(this.privRequestSession.isRecognizing){let i=yield this.fetchConnection();yield this.sendSpeechEvent(i,this.createMeetingSpeechEventPayload(e,t))}})}processTypeSpecificMessages(e){return this.processSpeechMessages(e)}handleRecognizedCallback(e,t,i){try{let n=new Pi.SpeechRecognitionEventArgs(e,t,i);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,n),this.privSuccessCallback){try{this.privSuccessCallback(e)}catch(s){this.privErrorCallback&&this.privErrorCallback(s)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch{}}handleRecognizingCallback(e,t,i){try{let n=new Pi.SpeechRecognitionEventArgs(e,t,i);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,n)}catch{}}cancelRecognition(e,t,i,n,s){let o=new Pi.PropertyCollection;if(o.setProperty(mx.CancellationErrorCodePropertyName,Pi.CancellationErrorCode[n]),this.privTranscriberRecognizer.IsMeetingRecognizer()){if(this.privTranscriberRecognizer.canceled){let a=new Pi.MeetingTranscriptionCanceledEventArgs(i,s,n,void 0,e);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,a)}catch{}}}else if(this.privTranscriberRecognizer.canceled){let a=new Pi.ConversationTranscriptionCanceledEventArgs(i,s,n,void 0,e);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,a)}catch{}}if(this.privSuccessCallback){let a=new Pi.SpeechRecognitionResult(t,Pi.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,s,void 0,o);try{this.privSuccessCallback(a),this.privSuccessCallback=void 0}catch{}}}sendTranscriptionStartJSON(e){return v(this,null,function*(){if(yield this.sendSpeechContext(e,!0),this.privTranscriberRecognizer.IsMeetingRecognizer()){let t=this.privTranscriberRecognizer.getMeetingInfo(),i=this.createMeetingSpeechEventPayload(t,"start");yield this.sendSpeechEvent(e,i)}else{let t=this.privTranscriberRecognizer.getConversationInfo(),i=this.createSpeechEventPayload(t,"start");yield this.sendSpeechEvent(e,i)}yield this.sendWaveHeader(e)})}sendSpeechEvent(e,t){let i=JSON.stringify(t);if(i)return e.send(new jU.SpeechConnectionMessage(NU.MessageType.Text,"speech.event",this.privRequestSession.requestId,"application/json",i))}createSpeechEventPayload(e,t){let i={id:"meeting",name:t,meeting:e.conversationProperties};return i.meeting.id=e.id,i.meeting.attendees=e.participants,i}createMeetingSpeechEventPayload(e,t){let i={id:"meeting",name:t,meeting:e.meetingProperties};return i.meeting.id=e.id,i.meeting.attendees=e.participants,i}};Jd.TranscriptionServiceRecognizer=yb});var Sx=h(Yd=>{"use strict";Object.defineProperty(Yd,"__esModule",{value:!0});Yd.DetailedSpeechPhrase=void 0;var LU=T(),Sb=class r{constructor(e){this.privDetailedSpeechPhrase=JSON.parse(e),this.privDetailedSpeechPhrase.RecognitionStatus=LU.RecognitionStatus[this.privDetailedSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new r(e)}getJsonWithCorrectedOffsets(e){if(this.privDetailedSpeechPhrase.NBest){let t;for(let i of this.privDetailedSpeechPhrase.NBest)if(i.Words&&i.Words[0]){t=i.Words[0].Offset;break}if(t&&t<e){let i=e-t;for(let n of this.privDetailedSpeechPhrase.NBest){if(n.Words)for(let s of n.Words)s.Offset+=i;if(n.DisplayWords)for(let s of n.DisplayWords)s.Offset+=i}}}return JSON.stringify(this.privDetailedSpeechPhrase)}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}};Yd.DetailedSpeechPhrase=Sb});var Cx=h(Qd=>{"use strict";Object.defineProperty(Qd,"__esModule",{value:!0});Qd.SimpleSpeechPhrase=void 0;var qU=T(),Cb=class r{constructor(e){this.privSimpleSpeechPhrase=JSON.parse(e),this.privSimpleSpeechPhrase.RecognitionStatus=qU.RecognitionStatus[this.privSimpleSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new r(e)}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}};Qd.SimpleSpeechPhrase=Cb});var bx=h(Xd=>{"use strict";Object.defineProperty(Xd,"__esModule",{value:!0});Xd.AddedLmIntent=void 0;var bb=class{constructor(e,t){this.modelImpl=e,this.intentName=t}};Xd.AddedLmIntent=bb});var wx=h(Zd=>{"use strict";Object.defineProperty(Zd,"__esModule",{value:!0});Zd.IntentServiceRecognizer=void 0;var Px=x(),ke=P(),Ro=T(),Pb=class extends Ro.ServiceRecognizerBase{constructor(e,t,i,n,s){super(e,t,i,n,s),this.privIntentRecognizer=s,this.privIntentDataSent=!1}setIntents(e,t){this.privAddedLmIntents=e,this.privUmbrellaIntent=t,this.privIntentDataSent=!0}processTypeSpecificMessages(e){let t,i,n=!1,s=new ke.PropertyCollection;switch(e.messageType===Px.MessageType.Text&&s.setProperty(ke.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.hypothesis":let a=Ro.SpeechHypothesis.fromJSON(e.textBody);if(t=new ke.IntentRecognitionResult(void 0,this.privRequestSession.requestId,ke.ResultReason.RecognizingIntent,a.Text,a.Duration,a.Offset+this.privRequestSession.currentTurnAudioOffset,a.Language,a.LanguageDetectionConfidence,void 0,e.textBody,s),this.privRequestSession.onHypothesis(t.offset),i=new ke.IntentRecognitionEventArgs(t,a.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,i)}catch{}n=!0;break;case"speech.phrase":let c=Ro.SimpleSpeechPhrase.fromJSON(e.textBody);t=new ke.IntentRecognitionResult(void 0,this.privRequestSession.requestId,Ro.EnumTranslation.implTranslateRecognitionResult(c.RecognitionStatus),c.DisplayText,c.Duration,c.Offset+this.privRequestSession.currentTurnAudioOffset,c.Language,c.LanguageDetectionConfidence,void 0,e.textBody,s),i=new ke.IntentRecognitionEventArgs(t,t.offset,this.privRequestSession.sessionId);let u=()=>{if(this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,i)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(t)}catch(l){this.privErrorCallback&&this.privErrorCallback(l)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}};this.privIntentDataSent===!1||ke.ResultReason.NoMatch===i.result.reason?(this.privRequestSession.onPhraseRecognized(i.offset+i.result.duration),u()):this.privPendingIntentArgs=i,n=!0;break;case"response":if(i=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,i===void 0){if(e.textBody==="")return;i=new ke.IntentRecognitionEventArgs(new ke.IntentRecognitionResult,0,this.privRequestSession.sessionId)}let p=Ro.IntentResponse.fromJSON(e.textBody);if(p!==null&&p.topScoringIntent&&p.topScoringIntent.intent){let l=this.privAddedLmIntents[p.topScoringIntent.intent];if(this.privUmbrellaIntent!==void 0&&(l=this.privUmbrellaIntent),l){let d=l===void 0||l.intentName===void 0?p.topScoringIntent.intent:l.intentName,f=i.result.reason;d!==void 0&&(f=ke.ResultReason.RecognizedIntent);let g=i.result.properties!==void 0?i.result.properties:new ke.PropertyCollection;g.setProperty(ke.PropertyId.LanguageUnderstandingServiceResponse_JsonResult,e.textBody),i=new ke.IntentRecognitionEventArgs(new ke.IntentRecognitionResult(d,i.result.resultId,f,i.result.text,i.result.duration,i.result.offset,void 0,void 0,i.result.errorDetails,i.result.json,g),i.offset,i.sessionId)}}if(this.privRequestSession.onPhraseRecognized(i.offset+i.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,i)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(i.result)}catch(l){this.privErrorCallback&&this.privErrorCallback(l)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}n=!0;break;default:break}let o=new Px.Deferred;return o.resolve(n),o.promise}cancelRecognition(e,t,i,n,s){let o=new ke.PropertyCollection;if(o.setProperty(Ro.CancellationErrorCodePropertyName,ke.CancellationErrorCode[n]),this.privIntentRecognizer.canceled){let a=new ke.IntentRecognitionCanceledEventArgs(i,s,n,void 0,void 0,e);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,a)}catch{}}if(this.privSuccessCallback){let a=new ke.IntentRecognitionResult(void 0,t,ke.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,s,void 0,o);try{this.privSuccessCallback(a),this.privSuccessCallback=void 0}catch{}}}};Zd.IntentServiceRecognizer=Pb});var _x=h(ef=>{"use strict";Object.defineProperty(ef,"__esModule",{value:!0});ef.IntentResponse=void 0;var wb=class r{constructor(e){e===""?this.privIntentResponse={}:this.privIntentResponse=JSON.parse(e)}static fromJSON(e){return new r(e)}get query(){return this.privIntentResponse.query}get topScoringIntent(){return this.privIntentResponse.topScoringIntent}get entities(){return this.privIntentResponse.entities}};ef.IntentResponse=wb});var Ex=h(Rx=>{"use strict";Object.defineProperty(Rx,"__esModule",{value:!0})});var Tx=h(tf=>{"use strict";Object.defineProperty(tf,"__esModule",{value:!0});tf.ServiceTelemetryListener=void 0;var wi=x(),Ix=Id(),_b=class{constructor(e,t,i){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=e,this.privAudioSourceId=t,this.privAudioNodeId=i,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(e){e>0&&this.privPhraseLatencies.push(Date.now()-e)}hypothesisReceived(e){e>0&&this.privHypothesisLatencies.push(Date.now()-e)}onEvent(e){this.privIsDisposed||(e instanceof Ix.RecognitionTriggeredEvent&&e.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:e.eventTime,Name:"ListeningTrigger",Start:e.eventTime}),e instanceof wi.AudioStreamNodeAttachingEvent&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof wi.AudioStreamNodeAttachedEvent&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof wi.AudioSourceErrorEvent&&e.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof wi.AudioStreamNodeErrorEvent&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof wi.AudioStreamNodeDetachedEvent&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Name:"Microphone",Start:this.privMicStartTime})),e instanceof Ix.ConnectingToServiceEvent&&e.requestId===this.privRequestId&&(this.privConnectionId=e.sessionId),e instanceof wi.ConnectionStartEvent&&e.connectionId===this.privConnectionId&&(this.privConnectionStartTime=e.eventTime),e instanceof wi.ConnectionEstablishedEvent&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof wi.ConnectionEstablishErrorEvent&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Error:this.getConnectionError(e.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof wi.ConnectionMessageReceivedEvent&&e.connectionId===this.privConnectionId&&e.message&&e.message.headers&&e.message.headers.path&&(this.privReceivedMessages[e.message.headers.path]||(this.privReceivedMessages[e.message.headers.path]=new Array),this.privReceivedMessages[e.message.headers.path].length<50&&this.privReceivedMessages[e.message.headers.path].push(e.networkReceivedTime)))}getTelemetry(){let e=new Array;this.privListeningTriggerMetric&&e.push(this.privListeningTriggerMetric),this.privMicMetric&&e.push(this.privMicMetric),this.privConnectionEstablishMetric&&e.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&e.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&e.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});let t={Metrics:e,ReceivedMessages:this.privReceivedMessages},i=JSON.stringify(t);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],i}get hasTelemetry(){return Object.keys(this.privReceivedMessages).length!==0||this.privListeningTriggerMetric!==null||this.privMicMetric!==null||this.privConnectionEstablishMetric!==null||this.privPhraseLatencies.length!==0||this.privHypothesisLatencies.length!==0}dispose(){this.privIsDisposed=!0}getConnectionError(e){switch(e){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+e.toString()}}};tf.ServiceTelemetryListener=_b});var Ax=h(nf=>{"use strict";Object.defineProperty(nf,"__esModule",{value:!0});nf.RequestSession=void 0;var Eo=x(),rf=Id(),zU=Tx(),Rb=class{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecognitionBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=e,this.privRequestId=Eo.createNoDashGuid(),this.privAudioNodeId=Eo.createNoDashGuid(),this.privTurnDeferral=new Eo.Deferred,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}get recognitionBytesSent(){return this.privRecognitionBytesSent}listenForServiceTelemetry(e){this.privServiceTelemetryListener&&this.privDetachables.push(e.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privRecognitionBytesSent=0,this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new zU.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new rf.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onAudioSourceAttachCompleted(e,t){return v(this,null,function*(){this.privAudioNode=e,this.privIsAudioNodeDetached=!1,t?yield this.onComplete():this.onEvent(new rf.ListeningStartedEvent(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))})}onPreConnectionStart(e,t){this.privAuthFetchEventId=e,this.privSessionId=t,this.onEvent(new rf.ConnectingToServiceEvent(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}onAuthCompleted(e){return v(this,null,function*(){e&&(yield this.onComplete())})}onConnectionEstablishCompleted(e,t){return v(this,null,function*(){if(e===200){this.onEvent(new rf.RecognitionStartedEvent(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privBytesSent=0;return}else e===403&&(yield this.onComplete())})}onServiceTurnEndResponse(e){return v(this,null,function*(){this.privTurnDeferral.resolve(),!e||this.isSpeechEnded?(yield this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())})}onSpeechContext(){this.privRequestId=Eo.createNoDashGuid()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new Eo.Deferred}onHypothesis(e){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(e)))}onPhraseRecognized(e){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(e)),this.onServiceRecognized(e)}onServiceRecognized(e){this.privLastRecoOffset=e,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(e),this.privConnectionAttempts=0}onAudioSent(e){this.privBytesSent+=e,this.privRecognitionBytesSent+=e}onRetryConnection(){this.privConnectionAttempts++}dispose(){return v(this,null,function*(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(let e of this.privDetachables)yield e.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}})}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}onStopRecognizing(){return v(this,null,function*(){yield this.onComplete()})}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(e){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(e),Eo.Events.instance.onEvent(e)}onComplete(){return v(this,null,function*(){this.privIsRecognizing&&(this.privIsRecognizing=!1,yield this.detachAudioNode())})}detachAudioNode(){return v(this,null,function*(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&(yield this.privAudioNode.detach()))})}};nf.RequestSession=Rb});var Ox=h(sf=>{"use strict";Object.defineProperty(sf,"__esModule",{value:!0});sf.SpeechContext=void 0;var Eb=class{constructor(e){this.privContext={},this.privDynamicGrammar=e}getSection(e){return this.privContext[e]||{}}setSection(e,t){this.privContext[e]=t}setPronunciationAssessmentParams(e,t,i=!1){this.privContext.phraseDetection===void 0&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment===void 0&&(this.privContext.phraseDetection.enrichment={pronunciationAssessment:{}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(e),i&&(this.privContext.phraseDetection.mode="Conversation"),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push("PronunciationAssessment"),this.privContext.phraseOutput.detailed.options.indexOf("SNR")===-1&&this.privContext.phraseOutput.detailed.options.push("SNR"),t&&(this.privContext.phraseDetection.enrichment.contentAssessment={topic:t},this.privContext.phraseOutput.detailed.options.push("ContentAssessment"))}setDetailedOutputFormat(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed"}setWordLevelTimings(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed",this.privContext.phraseOutput.detailed.options.indexOf("WordTimings")===-1&&this.privContext.phraseOutput.detailed.options.push("WordTimings")}setSpeakerDiarizationAudioOffsetMs(e){this.privContext.phraseDetection.speakerDiarization.audioOffsetMs=e}toJSON(){let e=this.privDynamicGrammar.generateGrammarObject();return this.setSection("dgi",e),JSON.stringify(this.privContext)}};sf.SpeechContext=Eb});var Dx=h(of=>{"use strict";Object.defineProperty(of,"__esModule",{value:!0});of.DynamicGrammarBuilder=void 0;var Ib=class{addPhrase(e){this.privPhrases||(this.privPhrases=[]),e instanceof Array?this.privPhrases=this.privPhrases.concat(e):this.privPhrases.push(e)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(e){this.privGrammars||(this.privGrammars=[]),e instanceof Array?this.privGrammars=this.privGrammars.concat(e):this.privGrammars.push(e)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(this.privGrammars===void 0&&this.privPhrases===void 0)return;let e={};if(e.ReferenceGrammars=this.privGrammars,this.privPhrases!==void 0&&this.privPhrases.length!==0){let t=[];this.privPhrases.forEach(i=>{t.push({Text:i})}),e.Groups=[{Type:"Generic",Items:t}]}return e}};of.DynamicGrammarBuilder=Ib});var Mx=h(xx=>{"use strict";Object.defineProperty(xx,"__esModule",{value:!0})});var Ab=h(Xn=>{"use strict";Object.defineProperty(Xn,"__esModule",{value:!0});Xn.MessageDataStreamType=Xn.ActivityPayloadResponse=void 0;var Tb=class r{constructor(e){this.privActivityResponse=JSON.parse(e)}static fromJSON(e){return new r(e)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}};Xn.ActivityPayloadResponse=Tb;var FU;(function(r){r[r.None=0]="None",r[r.TextToSpeechAudio=1]="TextToSpeechAudio"})(FU=Xn.MessageDataStreamType||(Xn.MessageDataStreamType={}))});var kx=h(af=>{"use strict";Object.defineProperty(af,"__esModule",{value:!0});af.DialogServiceTurnState=void 0;var BU=to(),UU=xn(),WU=Ab(),Ob=class{constructor(e,t){this.privRequestId=t,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=e,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(e,t){return e.messageDataStreamType===WU.MessageDataStreamType.TextToSpeechAudio&&(this.privAudioStream=UU.AudioOutputStream.createPullStream(),this.privAudioStream.format=t!==void 0?t:BU.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){this.privAudioStream!==null&&!this.privAudioStream.isClosed&&this.privAudioStream.close()}complete(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}};af.DialogServiceTurnState=Ob});var jx=h(cf=>{"use strict";Object.defineProperty(cf,"__esModule",{value:!0});cf.DialogServiceTurnStateManager=void 0;var Nx=Cr(),HU=kx(),Db=class{constructor(){this.privTurnMap=new Map}StartTurn(e){if(this.privTurnMap.has(e))throw new Nx.InvalidOperationError("Service error: There is already a turn with id:"+e);let t=new HU.DialogServiceTurnState(this,e);return this.privTurnMap.set(e,t),this.privTurnMap.get(e)}GetTurn(e){return this.privTurnMap.get(e)}CompleteTurn(e){if(!this.privTurnMap.has(e))throw new Nx.InvalidOperationError("Service error: Received turn end for an unknown turn id:"+e);let t=this.privTurnMap.get(e);return t.complete(),this.privTurnMap.delete(e),t}};cf.DialogServiceTurnStateManager=Db});var Lx=h(pf=>{"use strict";Object.defineProperty(pf,"__esModule",{value:!0});pf.DialogServiceAdapter=void 0;var VU=Le(),$U=Gv(),pt=x(),KU=to(),Q=P(),GU=jx(),Zr=T(),JU=Ab(),uf=Yn(),xb=class extends Zr.ServiceRecognizerBase{constructor(e,t,i,n,s){super(e,t,i,n,s),this.privEvents=new pt.EventSource,this.privDialogServiceConnector=s,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new GU.DialogServiceTurnStateManager,this.recognizeOverride=(o,a,c)=>this.listenOnce(o,a,c),this.postConnectImplOverride=o=>this.dialogConnectImpl(o),this.configConnectionOverride=o=>this.configConnection(o),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=i,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach(o=>{o.name==="ConnectionClosedEvent"&&(this.terminateMessageLoop=!0)})}sendMessage(e){return v(this,null,function*(){let t=pt.createGuid(),i=pt.createNoDashGuid(),n={context:{interactionId:t},messagePayload:JSON.parse(e),version:.5},s=JSON.stringify(n);yield(yield this.fetchConnection()).send(new uf.SpeechConnectionMessage(pt.MessageType.Text,"agent",i,"application/json",s))})}privDisconnect(){return v(this,null,function*(){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Q.CancellationReason.Error,Q.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1})}processTypeSpecificMessages(e){let t=new Q.PropertyCollection;e.messageType===pt.MessageType.Text&&t.setProperty(Q.PropertyId.SpeechServiceResponse_JsonResult,e.textBody);let i,n;switch(e.path.toLowerCase()){case"speech.phrase":let o=Zr.SimpleSpeechPhrase.fromJSON(e.textBody);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+o.Offset+o.Duration),o.RecognitionStatus!==Zr.RecognitionStatus.TooManyRequests&&o.RecognitionStatus!==Zr.RecognitionStatus.Error){let d=this.fireEventForResult(o,t);if(this.privLastResult=d.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,d)}catch{}}n=!0;break;case"speech.hypothesis":let a=Zr.SpeechHypothesis.fromJSON(e.textBody),c=a.Offset+this.privRequestSession.currentTurnAudioOffset;i=new Q.SpeechRecognitionResult(this.privRequestSession.requestId,Q.ResultReason.RecognizingSpeech,a.Text,a.Duration,c,a.Language,a.LanguageDetectionConfidence,void 0,void 0,e.textBody,t),this.privRequestSession.onHypothesis(c);let u=new Q.SpeechRecognitionEventArgs(i,a.Duration,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,u)}catch{}n=!0;break;case"speech.keyword":let p=Zr.SpeechKeyword.fromJSON(e.textBody);i=new Q.SpeechRecognitionResult(this.privRequestSession.requestId,p.Status==="Accepted"?Q.ResultReason.RecognizedKeyword:Q.ResultReason.NoMatch,p.Text,p.Duration,p.Offset,void 0,void 0,void 0,void 0,e.textBody,t),p.Status!=="Accepted"&&(this.privLastResult=i);let l=new Q.SpeechRecognitionEventArgs(i,i.duration,i.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,l)}catch{}n=!0;break;case"audio":{let d=e.requestId.toUpperCase(),f=this.privTurnStateManager.GetTurn(d);try{e.binaryBody?f.audioStream.write(e.binaryBody):f.endAudioStream()}catch{}}n=!0;break;case"response":this.handleResponseMessage(e),n=!0;break;default:break}let s=new pt.Deferred;return s.resolve(n),s.promise}cancelRecognition(e,t,i,n,s){return v(this,null,function*(){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&(yield this.privRequestSession.onStopRecognizing()),this.privDialogServiceConnector.canceled){let o=new Q.PropertyCollection;o.setProperty(Zr.CancellationErrorCodePropertyName,Q.CancellationErrorCode[n]);let a=new Q.SpeechRecognitionCanceledEventArgs(i,s,n,void 0,e);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,a)}catch{}if(this.privSuccessCallback){let c=new Q.SpeechRecognitionResult(void 0,Q.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,s,void 0,o);try{this.privSuccessCallback(c),this.privSuccessCallback=void 0}catch{}}}})}listenOnce(e,t,i){return v(this,null,function*(){this.privRecognizerConfig.recognitionMode=e,this.privSuccessCallback=t,this.privErrorCallback=i,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(Q.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);let n=this.connectImpl(),s=this.sendPreAudioMessages(),o=yield this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),a=yield this.privDialogAudioSource.format,c=yield this.privDialogAudioSource.deviceInfo,u=new VU.ReplayableAudioNode(o,a.avgBytesPerSec);yield this.privRequestSession.onAudioSourceAttachCompleted(u,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:c};try{yield n,yield s}catch(d){return yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Q.CancellationReason.Error,Q.CancellationErrorCode.ConnectionFailure,d),Promise.resolve()}let p=new Q.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,p),this.sendAudio(u).then(()=>{},d=>v(this,null,function*(){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Q.CancellationReason.Error,Q.CancellationErrorCode.RuntimeError,d)}))})}dialogConnectImpl(e){return this.privConnectionLoop=this.startMessageLoop(),e}receiveDialogMessageOverride(){let e=new pt.Deferred,t=()=>v(this,null,function*(){try{let i=this.isDisposed(),n=!this.isDisposed()&&this.terminateMessageLoop;if(i||n){e.resolve(void 0);return}let o=yield(yield this.fetchConnection()).read();if(!o)return t();let a=uf.SpeechConnectionMessage.fromConnectionMessage(o);switch(a.path.toLowerCase()){case"turn.start":{let g=a.requestId.toUpperCase(),m=this.privRequestSession.requestId.toUpperCase();g!==m?this.privTurnStateManager.StartTurn(g):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":let u=Zr.SpeechDetected.fromJSON(a.textBody),p=new Q.RecognitionEventArgs(u.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,p);break;case"speech.enddetected":let l;a.textBody.length>0?l=a.textBody:l="{ Offset: 0 }";let d=Zr.SpeechDetected.fromJSON(l);this.privRequestSession.onServiceRecognized(d.Offset+this.privRequestSession.currentTurnAudioOffset);let f=new Q.RecognitionEventArgs(d.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,f);break;case"turn.end":{let g=a.requestId.toUpperCase(),m=this.privRequestSession.requestId.toUpperCase();if(g!==m)this.privTurnStateManager.CompleteTurn(g);else{let y=new Q.SessionEventArgs(this.privRequestSession.sessionId);if(yield this.privRequestSession.onServiceTurnEndResponse(!1),(!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,y),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(w){this.privErrorCallback&&this.privErrorCallback(w)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{(yield this.processTypeSpecificMessages(a))||this.serviceEvents&&this.serviceEvents.onEvent(new pt.ServiceEvent(a.path.toLowerCase(),a.textBody))}catch{}}return t()}catch{this.terminateMessageLoop=!0,e.resolve()}});return t().catch(i=>{pt.Events.instance.onEvent(new pt.BackgroundEvent(i))}),e.promise}startMessageLoop(){return v(this,null,function*(){this.terminateMessageLoop=!1;try{yield this.receiveDialogMessageOverride()}catch(e){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Q.CancellationReason.Error,Q.CancellationErrorCode.RuntimeError,e)}return Promise.resolve()})}configConnection(e){return v(this,null,function*(){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(yield this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),yield this.sendAgentConfig(e),e)})}sendPreAudioMessages(){return v(this,null,function*(){let e=yield this.fetchConnection();this.addKeywordContextData(),yield this.sendSpeechContext(e,!0),yield this.sendAgentContext(e),yield this.sendWaveHeader(e)})}sendAgentConfig(e){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(Q.PropertyId.Conversation_DialogType)===Q.DialogServiceConfig.DialogTypes.CustomCommands){let i=this.agentConfig.get();i.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(Q.PropertyId.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(i)}this.onEvent(new $U.SendingAgentContextMessageEvent(this.agentConfig));let t=this.agentConfig.toJsonString();return this.agentConfigSent=!0,e.send(new uf.SpeechConnectionMessage(pt.MessageType.Text,"agent.config",this.privRequestSession.requestId,"application/json",t))}}sendAgentContext(e){let t=pt.createGuid(),i=this.privDialogServiceConnector.properties.getProperty(Q.PropertyId.Conversation_Speech_Activity_Template),s=JSON.stringify({channelData:"",context:{interactionId:t},messagePayload:typeof i===void 0?void 0:i,version:.5});return e.send(new uf.SpeechConnectionMessage(pt.MessageType.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",s))}fireEventForResult(e,t){let i=Zr.EnumTranslation.implTranslateRecognitionResult(e.RecognitionStatus),n=e.Offset+this.privRequestSession.currentTurnAudioOffset,s=new Q.SpeechRecognitionResult(this.privRequestSession.requestId,i,e.DisplayText,e.Duration,n,e.Language,e.LanguageDetectionConfidence,void 0,void 0,JSON.stringify(e),t);return new Q.SpeechRecognitionEventArgs(s,n,this.privRequestSession.sessionId)}handleResponseMessage(e){let t=JSON.parse(e.textBody);switch(t.messageType.toLowerCase()){case"message":let i=e.requestId.toUpperCase(),n=JU.ActivityPayloadResponse.fromJSON(e.textBody),s=this.privTurnStateManager.GetTurn(i);if(n.conversationId){let c=this.agentConfig.get();c.botInfo.conversationId=n.conversationId,this.agentConfig.set(c)}let o=s.processActivityPayload(n,KU.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(Q.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0))),a=new Q.ActivityReceivedEventArgs(n.messagePayload,o);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,a)}catch{}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new Q.TurnStatusReceivedEventArgs(e.textBody))}catch{}break;default:pt.Events.instance.onEvent(new pt.BackgroundEvent(`Unexpected response of type ${t.messageType}. Ignoring.`));break}}onEvent(e){this.privEvents.onEvent(e),pt.Events.instance.onEvent(e)}addKeywordContextData(){let e=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(e===void 0)return;let t=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),i=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),n=e.split(";"),s=t===void 0?[]:t.split(";"),o=i===void 0?[]:i.split(";"),a=[];for(let c=0;c<n.length;c++){let u={};u.text=n[c],c<s.length&&(u.offset=Number(s[c])),c<o.length&&(u.duration=Number(o[c])),a.push(u)}this.speechContext.setSection("invocationSource","VoiceActivationWithKeyword"),this.speechContext.setSection("keywordDetection",[{clientDetectedKeywords:a,onReject:{action:"EndOfTurn"},type:"startTrigger"}])}};pf.DialogServiceAdapter=xb});var qx=h(lf=>{"use strict";Object.defineProperty(lf,"__esModule",{value:!0});lf.AgentConfig=void 0;var Mb=class{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(e){this.iPrivConfig=e}};lf.AgentConfig=Mb});var df=h(hf=>{"use strict";Object.defineProperty(hf,"__esModule",{value:!0});hf.ConversationConnectionConfig=void 0;var YU=UC(),ei=class r extends YU.RestConfigBase{static get host(){return r.privHost}static get apiVersion(){return r.privApiVersion}static get clientAppId(){return r.privClientAppId}static get defaultLanguageCode(){return r.privDefaultLanguageCode}static get restPath(){return r.privRestPath}static get webSocketPath(){return r.privWebSocketPath}static get transcriptionEventKeys(){return r.privTranscriptionEventKeys}};hf.ConversationConnectionConfig=ei;ei.privHost="dev.microsofttranslator.com";ei.privRestPath="/capito/room";ei.privApiVersion="2.0";ei.privDefaultLanguageCode="en-US";ei.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15";ei.privWebSocketPath="/capito/translate";ei.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"]});var zx=h(vf=>{"use strict";Object.defineProperty(vf,"__esModule",{value:!0});vf.ConversationManager=void 0;var ff=Le(),sn=j(),_i=P(),Zn=df(),kb=class{constructor(){this.privRequestParams=Zn.ConversationConnectionConfig.configParams,this.privErrors=Zn.ConversationConnectionConfig.restErrors,this.privHost=Zn.ConversationConnectionConfig.host,this.privApiVersion=Zn.ConversationConnectionConfig.apiVersion,this.privRestPath=Zn.ConversationConnectionConfig.restPath,this.privRestAdapter=new ff.RestMessageAdapter({})}createOrJoin(e,t,i,n){try{sn.Contracts.throwIfNullOrUndefined(e,"args");let s=e.getProperty(_i.PropertyId.SpeechServiceConnection_RecoLanguage,Zn.ConversationConnectionConfig.defaultLanguageCode),o=e.getProperty(_i.PropertyId.ConversationTranslator_Name,"conversation_host"),a=e.getProperty(_i.PropertyId.ConversationTranslator_Host,this.privHost),c=e.getProperty(_i.PropertyId.ConversationTranslator_CorrelationId),u=e.getProperty(_i.PropertyId.SpeechServiceConnection_Key),p=e.getProperty(_i.PropertyId.SpeechServiceConnection_Region),l=e.getProperty(_i.PropertyId.SpeechServiceAuthorization_Token);sn.Contracts.throwIfNullOrWhitespace(s,"languageCode"),sn.Contracts.throwIfNullOrWhitespace(o,"nickname"),sn.Contracts.throwIfNullOrWhitespace(a,"endpointHost");let d={};d[this.privRequestParams.apiVersion]=this.privApiVersion,d[this.privRequestParams.languageCode]=s,d[this.privRequestParams.nickname]=o;let f={};c&&(f[this.privRequestParams.correlationId]=c),f[this.privRequestParams.clientAppId]=Zn.ConversationConnectionConfig.clientAppId,t!==void 0?d[this.privRequestParams.roomId]=t:(sn.Contracts.throwIfNullOrUndefined(p,this.privErrors.authInvalidSubscriptionRegion),f[this.privRequestParams.subscriptionRegion]=p,u?f[this.privRequestParams.subscriptionKey]=u:l?f[this.privRequestParams.authorization]=`Bearer ${l}`:sn.Contracts.throwIfNullOrUndefined(u,this.privErrors.authInvalidSubscriptionKey));let g={};g.headers=f,this.privRestAdapter.options=g;let m=`https://${a}${this.privRestPath}`;this.privRestAdapter.request(ff.RestRequestType.Post,m,d,null).then(y=>{let w=ff.RestMessageAdapter.extractHeaderValue(this.privRequestParams.requestId,y.headers);if(!y.ok){if(n){let C=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",y.status.toString()),R;try{R=JSON.parse(y.data),C+=` [${R.error.code}: ${R.error.message}]`}catch{C+=` [${y.data}]`}w&&(C+=` ${w}`),n(C)}return}let b=JSON.parse(y.data);if(b&&(b.requestId=w),i){try{i(b)}catch(C){n&&n(C)}i=void 0}}).catch(()=>{})}catch(s){if(n)if(s instanceof Error){let o=s;n(o.name+": "+o.message)}else n(s)}}leave(e,t){return new Promise((i,n)=>{try{sn.Contracts.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","config")),sn.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","token"));let s=e.getProperty(_i.PropertyId.ConversationTranslator_Host,this.privHost),o=e.getProperty(_i.PropertyId.ConversationTranslator_CorrelationId),a={};a[this.privRequestParams.apiVersion]=this.privApiVersion,a[this.privRequestParams.sessionToken]=t;let c={};o&&(c[this.privRequestParams.correlationId]=o);let u={};u.headers=c,this.privRestAdapter.options=u;let p=`https://${s}${this.privRestPath}`;this.privRestAdapter.request(ff.RestRequestType.Delete,p,a,null).then(l=>{l.ok,i()}).catch(()=>{})}catch(s){if(s instanceof Error){let o=s;n(o.name+": "+o.message)}else n(s)}})}};vf.ConversationManager=kb});var jb=h(gf=>{"use strict";Object.defineProperty(gf,"__esModule",{value:!0});gf.ConversationConnectionMessage=void 0;var QU=x(),Nb=class extends QU.ConnectionMessage{constructor(e,t,i,n){super(e,t,i,n);let s=JSON.parse(this.textBody);s.type!==void 0&&(this.privConversationMessageType=s.type)}get conversationMessageType(){return this.privConversationMessageType}};gf.ConversationConnectionMessage=Nb});var Bx=h(mf=>{"use strict";Object.defineProperty(mf,"__esModule",{value:!0});mf.ConversationWebsocketMessageFormatter=void 0;var es=x(),Fx=jb(),Lb=class{toConnectionMessage(e){let t=new es.Deferred;try{if(e.messageType===es.MessageType.Text){let i=new Fx.ConversationConnectionMessage(e.messageType,e.textContent,{},e.id);t.resolve(i)}else e.messageType===es.MessageType.Binary&&t.resolve(new Fx.ConversationConnectionMessage(e.messageType,e.binaryContent,void 0,e.id))}catch(i){t.reject(`Error formatting the message. Error: ${i}`)}return t.promise}fromConnectionMessage(e){let t=new es.Deferred;try{if(e.messageType===es.MessageType.Text){let i=`${e.textBody?e.textBody:""}`;t.resolve(new es.RawWebsocketMessage(es.MessageType.Text,i,e.id))}}catch(i){t.reject(`Error formatting the message. ${i}`)}return t.promise}};mf.ConversationWebsocketMessageFormatter=Lb});var Wx=h(yf=>{"use strict";Object.defineProperty(yf,"__esModule",{value:!0});yf.ConversationConnectionFactory=void 0;var Ux=Le(),XU=x(),ZU=j(),qb=P(),eW=ar(),Io=df(),tW=Bx(),zb=class extends eW.ConnectionFactoryBase{create(e,t,i){let n=e.parameters.getProperty(qb.PropertyId.ConversationTranslator_Host,Io.ConversationConnectionConfig.host),s=e.parameters.getProperty(qb.PropertyId.ConversationTranslator_CorrelationId,XU.createGuid()),o=`wss://${n}${Io.ConversationConnectionConfig.webSocketPath}`,a=e.parameters.getProperty(qb.PropertyId.ConversationTranslator_Token,void 0);ZU.Contracts.throwIfNullOrUndefined(a,"token");let c={};c[Io.ConversationConnectionConfig.configParams.apiVersion]=Io.ConversationConnectionConfig.apiVersion,c[Io.ConversationConnectionConfig.configParams.token]=a,c[Io.ConversationConnectionConfig.configParams.correlationId]=s;let u=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new Ux.WebsocketConnection(o,c,{},new tW.ConversationWebsocketMessageFormatter,Ux.ProxyInfo.fromRecognizerConfig(e),u,i)}};yf.ConversationConnectionFactory=zb});var Hx=h(Sf=>{"use strict";Object.defineProperty(Sf,"__esModule",{value:!0});Sf.ConversationRequestSession=void 0;var Fb=x(),Bb=class{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=e,this.privRequestId=Fb.createNoDashGuid(),this.privRequestCompletionDeferral=new Fb.Deferred}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(e,t){this.privSessionId=t}onAuthCompleted(e){e&&this.onComplete()}onConnectionEstablishCompleted(e){e!==200&&e===403&&this.onComplete()}onServiceTurnEndResponse(e){e?this.privRequestId=Fb.createNoDashGuid():this.onComplete()}dispose(){return v(this,null,function*(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(let e of this.privDetachables)yield e.detach()}})}onComplete(){}};Sf.ConversationRequestSession=Bb});var Gb=h(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.ConversationReceivedTranslationEventArgs=Lt.ParticipantsListEventArgs=Lt.ParticipantAttributeEventArgs=Lt.ParticipantEventArgs=Lt.LockRoomEventArgs=Lt.MuteAllEventArgs=void 0;var _c=P(),Ub=class extends _c.SessionEventArgs{constructor(e,t){super(t),this.privIsMuted=e}get isMuted(){return this.privIsMuted}};Lt.MuteAllEventArgs=Ub;var Wb=class extends _c.SessionEventArgs{constructor(e,t){super(t),this.privIsLocked=e}get isMuted(){return this.privIsLocked}};Lt.LockRoomEventArgs=Wb;var Hb=class extends _c.SessionEventArgs{constructor(e,t){super(t),this.privParticipant=e}get participant(){return this.privParticipant}};Lt.ParticipantEventArgs=Hb;var Vb=class extends _c.SessionEventArgs{constructor(e,t,i,n){super(n),this.privKey=t,this.privValue=i,this.privParticipantId=e}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}};Lt.ParticipantAttributeEventArgs=Vb;var $b=class extends _c.SessionEventArgs{constructor(e,t,i,n,s,o,a,c,u){super(u),this.privRoomId=e,this.privSessionToken=t,this.privTranslateTo=i,this.privProfanityFilter=n,this.privRoomProfanityFilter=s,this.privIsRoomLocked=o,this.privIsRoomLocked=a,this.privParticipants=c}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}};Lt.ParticipantsListEventArgs=$b;var Kb=class{constructor(e,t,i){this.privPayload=t,this.privCommand=e,this.privSessionId=i}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}};Lt.ConversationReceivedTranslationEventArgs=Kb});var Yb=h(on=>{"use strict";Object.defineProperty(on,"__esModule",{value:!0});on.ConversationTranslatorCommandTypes=on.ConversationTranslatorMessageTypes=on.InternalParticipants=void 0;var Jb=class{constructor(e=[],t){this.participants=e,this.meId=t}addOrUpdateParticipant(e){if(e===void 0)return;let t=this.getParticipantIndex(e.id);return t>-1?this.participants.splice(t,1,e):this.participants.push(e),this.getParticipant(e.id)}getParticipantIndex(e){return this.participants.findIndex(t=>t.id===e)}getParticipant(e){return this.participants.find(t=>t.id===e)}deleteParticipant(e){this.participants=this.participants.filter(t=>t.id!==e)}get host(){return this.participants.find(e=>e.isHost===!0)}get me(){return this.getParticipant(this.meId)}};on.InternalParticipants=Jb;on.ConversationTranslatorMessageTypes={command:"command",final:"final",info:"info",instantMessage:"instant_message",keepAlive:"keep_alive",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"};on.ConversationTranslatorCommandTypes={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"}});var Vx=h(Cf=>{"use strict";Object.defineProperty(Cf,"__esModule",{value:!0});Cf.CommandResponsePayload=void 0;var rW=r=>JSON.parse(r),Qb=class r{constructor(e){this.privCommandResponse=rW(e)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(e){return new r(e)}};Cf.CommandResponsePayload=Qb});var $x=h(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.ParticipantPayloadResponse=To.ParticipantsListPayloadResponse=void 0;var iW=r=>JSON.parse(r),nW=r=>JSON.parse(r),Xb=class r{constructor(e){this.privParticipantsPayloadResponse=iW(e)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(e){return new r(e)}};To.ParticipantsListPayloadResponse=Xb;var Zb=class r{constructor(e){this.privParticipantPayloadResponse=nW(e)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(e){return new r(e)}};To.ParticipantPayloadResponse=Zb});var Kx=h(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.TextResponsePayload=Ao.SpeechResponsePayload=void 0;var sW=r=>JSON.parse(r),oW=r=>JSON.parse(r),eP=class r{constructor(e){this.privSpeechResponse=sW(e)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return this.privSpeechResponse.type==="final"}static fromJSON(e){return new r(e)}};Ao.SpeechResponsePayload=eP;var tP=class r{constructor(e){this.privTextResponse=oW(e)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(e){return new r(e)}};Ao.TextResponsePayload=tP});var Yx=h(ts=>{"use strict";Object.defineProperty(ts,"__esModule",{value:!0});var aW=Vx();Object.defineProperty(ts,"CommandResponsePayload",{enumerable:!0,get:function(){return aW.CommandResponsePayload}});var Gx=$x();Object.defineProperty(ts,"ParticipantsListPayloadResponse",{enumerable:!0,get:function(){return Gx.ParticipantsListPayloadResponse}});Object.defineProperty(ts,"ParticipantPayloadResponse",{enumerable:!0,get:function(){return Gx.ParticipantPayloadResponse}});var Jx=Kx();Object.defineProperty(ts,"SpeechResponsePayload",{enumerable:!0,get:function(){return Jx.SpeechResponsePayload}});Object.defineProperty(ts,"TextResponsePayload",{enumerable:!0,get:function(){return Jx.TextResponsePayload}})});var Zx=h(bf=>{"use strict";Object.defineProperty(bf,"__esModule",{value:!0});bf.ConversationServiceAdapter=void 0;var Rc=x(),Dr=P(),Qx=T(),Xx=jb(),cW=Hx(),Kt=Gb(),an=Yb(),Ec=Yx(),rP=class r extends Qx.ServiceRecognizerBase{constructor(e,t,i,n,s){super(e,t,i,n,s),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=s,this.privConversationAuthentication=e,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=o=>this.conversationConnectImpl(o),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new cW.ConversationRequestSession(Rc.createNoDashGuid()),this.privConversationConnectionFactory=t,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}dispose(e){return v(this,null,function*(){this.privConversationIsDisposed=!0,this.privConnectionConfigPromise!==void 0&&(yield(yield this.privConnectionConfigPromise).dispose(e)),yield Te(r.prototype,this,"dispose").call(this,e)})}sendMessage(e){return v(this,null,function*(){return(yield this.fetchConnection()).send(new Xx.ConversationConnectionMessage(Rc.MessageType.Text,e))})}sendMessageAsync(e){return v(this,null,function*(){yield(yield this.fetchConnection()).send(new Xx.ConversationConnectionMessage(Rc.MessageType.Text,e))})}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,Dr.CancellationReason.Error,Dr.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}processTypeSpecificMessages(){return v(this,null,function*(){return!0})}cancelRecognition(e,t,i,n,s){this.terminateMessageLoop=!0;let o=new Dr.ConversationTranslationCanceledEventArgs(i,s,n,void 0,e);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,o)}catch{}}conversationConnectImpl(e){return v(this,null,function*(){return this.privConnectionLoop=this.startMessageLoop(),e})}receiveConversationMessageOverride(){return v(this,null,function*(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();let e=new Rc.Deferred;try{let i=yield(yield this.fetchConnection()).read();if(this.isDisposed()||this.terminateMessageLoop)return e.resolve(),Promise.resolve();if(!i)return this.receiveConversationMessageOverride();let n=this.privConversationRequestSession.sessionId,s=i.conversationMessageType.toLowerCase(),o=!1;try{switch(s){case"info":case"participant_command":case"command":let a=Ec.CommandResponsePayload.fromJSON(i.textBody);switch(a.command.toLowerCase()){case"participantlist":let f=Ec.ParticipantsListPayloadResponse.fromJSON(i.textBody),g=f.participants.map(R=>({avatar:R.avatar,displayName:R.nickname,id:R.participantId,isHost:R.ishost,isMuted:R.ismuted,isUsingTts:R.usetts,preferredLanguage:R.locale}));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new Kt.ParticipantsListEventArgs(f.roomid,f.token,f.translateTo,f.profanityFilter,f.roomProfanityFilter,f.roomLocked,f.muteAll,g,n));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new Kt.ParticipantAttributeEventArgs(a.participantId,an.ConversationTranslatorCommandTypes.setTranslateToLanguages,a.value,n));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new Kt.ParticipantAttributeEventArgs(a.participantId,an.ConversationTranslatorCommandTypes.setProfanityFiltering,a.value,n));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new Kt.ParticipantAttributeEventArgs(a.participantId,an.ConversationTranslatorCommandTypes.setMute,a.value,n));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new Kt.MuteAllEventArgs(a.value,n));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new Dr.ConversationExpirationEventArgs(a.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new Kt.ParticipantAttributeEventArgs(a.participantId,an.ConversationTranslatorCommandTypes.setUseTTS,a.value,n));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new Kt.LockRoomEventArgs(a.value,n));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new Kt.ParticipantAttributeEventArgs(a.participantId,an.ConversationTranslatorCommandTypes.changeNickname,a.value,n));break;case"joinsession":let m=Ec.ParticipantPayloadResponse.fromJSON(i.textBody),y={avatar:m.avatar,displayName:m.nickname,id:m.participantId,isHost:m.ishost,isMuted:m.ismuted,isUsingTts:m.usetts,preferredLanguage:m.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new Kt.ParticipantEventArgs(y,n));break;case"leavesession":let w={id:a.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new Kt.ParticipantEventArgs(w,n));break;case"disconnectsession":let b={id:a.participantId};break;case"token":let C=new Qx.CognitiveTokenAuthentication(()=>{let R=a.token;return Promise.resolve(R)},()=>{let R=a.token;return Promise.resolve(R)});this.authentication=C,this.privConversationServiceConnector.onToken(C);break;default:break}break;case"partial":case"final":let c=Ec.SpeechResponsePayload.fromJSON(i.textBody),u=s==="final"?Dr.ResultReason.TranslatedParticipantSpeech:Dr.ResultReason.TranslatingParticipantSpeech,p=new Dr.ConversationTranslationResult(c.participantId,this.getTranslations(c.translations),c.language,c.id,u,c.recognition,void 0,void 0,i.textBody,void 0);c.isFinal?((p.text!==void 0&&p.text.length>0||c.id===this.privLastPartialUtteranceId)&&(o=!0),o&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new Kt.ConversationReceivedTranslationEventArgs(an.ConversationTranslatorMessageTypes.final,p,n))):p.text!==void 0&&(this.privLastPartialUtteranceId=c.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new Kt.ConversationReceivedTranslationEventArgs(an.ConversationTranslatorMessageTypes.partial,p,n)));break;case"translated_message":let l=Ec.TextResponsePayload.fromJSON(i.textBody),d=new Dr.ConversationTranslationResult(l.participantId,this.getTranslations(l.translations),l.language,void 0,void 0,l.originalText,void 0,void 0,void 0,i.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new Kt.ConversationReceivedTranslationEventArgs(an.ConversationTranslatorMessageTypes.instantMessage,d,n));break;default:break}}catch{}return this.receiveConversationMessageOverride()}catch{this.terminateMessageLoop=!0}return e.promise})}startMessageLoop(){return v(this,null,function*(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;let e=this.receiveConversationMessageOverride();try{return yield e}catch(t){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",Dr.CancellationReason.Error,Dr.CancellationErrorCode.RuntimeError,t),null}})}configConnection(){return this.isDisposed()?Promise.resolve(void 0):this.privConnectionConfigPromise!==void 0?this.privConnectionConfigPromise.then(e=>e.state()===Rc.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise,()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection())):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then(e=>e),this.privConnectionConfigPromise)}getTranslations(e){let t;if(e!==void 0){t=new Dr.Translations;for(let i of e)t.set(i.lang,i.translation)}return t}};bf.ConversationServiceAdapter=rP});var eM=h(xo=>{"use strict";Object.defineProperty(xo,"__esModule",{value:!0});xo.ConversationTranslatorRecognizer=xo.ConversationRecognizerFactory=void 0;var uW=T(),Oo=x(),Do=j(),iP=P(),pW=Wx(),lW=Zx(),nP=class{static fromConfig(e,t,i){return new Pf(e,t,i)}};xo.ConversationRecognizerFactory=nP;var Pf=class r extends iP.Recognizer{constructor(e,t,i){let n=t;Do.Contracts.throwIfNull(n,"speechConfig");let s=e;Do.Contracts.throwIfNull(s,"conversationImpl"),super(i,n.properties,new pW.ConversationConnectionFactory),this.privConversation=s,this.privIsDisposed=!1,this.privProperties=n.properties.clone(),this.privConnection=iP.Connection.fromRecognizer(this),this.privProperties.getProperty(iP.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?(this.privSetTimeout=Oo.Timeout.setTimeout,this.privClearTimeout=Oo.Timeout.clearTimeout):typeof window<"u"?(this.privSetTimeout=window.setTimeout.bind(window),this.privClearTimeout=window.clearTimeout.bind(window)):(this.privSetTimeout=setTimeout,this.privClearTimeout=clearTimeout)}set connected(e){this.privConnection.connected=e}set disconnected(e){this.privConnection.disconnected=e}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(e,t,i){try{Do.Contracts.throwIfDisposed(this.privIsDisposed),Do.Contracts.throwIfNullOrWhitespace(e,"token"),this.privReco.conversationTranslatorToken=e,this.resetConversationTimeout(),this.privReco.connectAsync(t,i)}catch(n){if(i)if(n instanceof Error){let s=n;i(s.name+": "+s.message)}else i(n)}}disconnect(e,t){try{Do.Contracts.throwIfDisposed(this.privIsDisposed),this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then(()=>{e&&e()},i=>{t&&t(i)})}catch(i){if(t)if(i instanceof Error){let n=i;t(n.name+": "+n.message)}else t(i);this.dispose(!0).catch(n=>{Oo.Events.instance.onEvent(new Oo.BackgroundEvent(n))})}}sendRequest(e,t,i){try{Do.Contracts.throwIfDisposed(this.privIsDisposed),this.sendMessage(e,t,i)}catch(n){if(i)if(n instanceof Error){let s=n;i(s.name+": "+s.message)}else i(n);this.dispose(!0).catch(s=>{Oo.Events.instance.onEvent(new Oo.BackgroundEvent(s))})}}onToken(e){this.privConversation.onToken(e)}close(){return v(this,null,function*(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,yield this.dispose(!0))})}dispose(e){return v(this,null,function*(){this.privIsDisposed||e&&(this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),yield Te(r.prototype,this,"dispose").call(this,e))})}createRecognizerConfig(e){return new uW.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,i,n){let s=i;return new lW.ConversationServiceAdapter(e,t,s,n,this)}sendMessage(e,t,i){let n=this.privReco;((o,a,c)=>{o!==void 0?o.then(()=>{try{a&&a()}catch(u){c&&c(`'Unhandled error on promise callback: ${u}'`)}},u=>{try{c&&c(u)}catch{}}):c&&c("Null promise")})(n.sendMessageAsync(e),t,i),this.resetConversationTimeout()}resetConversationTimeout(){this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout(()=>{this.sendRequest(this.privConversation.getKeepAlive())},6e4)}};xo.ConversationTranslatorRecognizer=Pf});var rM=h(_f=>{"use strict";Object.defineProperty(_f,"__esModule",{value:!0});_f.TranscriberRecognizer=void 0;var tM=x(),xr=j(),Mo=P(),wf=T(),sP=class r extends Mo.Recognizer{constructor(e,t){let i=e;xr.Contracts.throwIfNull(i,"speechTranslationConfig");let n=t;xr.Contracts.throwIfNull(n,"audioConfigImpl"),xr.Contracts.throwIfNullOrWhitespace(i.speechRecognitionLanguage,Mo.PropertyId[Mo.PropertyId.SpeechServiceConnection_RecoLanguage]),super(t,i.properties,new wf.TranscriberConnectionFactory),this.privDisposedRecognizer=!1,this.isMeetingRecognizer=!1}get speechRecognitionLanguage(){return xr.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Mo.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(Mo.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){xr.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Mo.PropertyId.SpeechServiceAuthorization_Token,e)}set conversation(e){xr.Contracts.throwIfNullOrUndefined(e,"Conversation"),this.isMeetingRecognizer=!1,this.privConversation=e}getConversationInfo(){return xr.Contracts.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}set meeting(e){xr.Contracts.throwIfNullOrUndefined(e,"Meeting"),this.isMeetingRecognizer=!0,this.privMeeting=e}getMeetingInfo(){return xr.Contracts.throwIfNullOrUndefined(this.privMeeting,"Meeting"),this.privMeeting.meetingInfo}IsMeetingRecognizer(){return this.isMeetingRecognizer}startContinuousRecognitionAsync(e,t){tM.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(wf.RecognitionMode.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){tM.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),e,t)}close(){return v(this,null,function*(){this.privDisposedRecognizer||(yield this.dispose(!0))})}pushConversationEvent(e,t){return v(this,null,function*(){let i=this.privReco;xr.Contracts.throwIfNullOrUndefined(i,"serviceRecognizer"),yield i.sendSpeechEventAsync(e,t)})}pushMeetingEvent(e,t){return v(this,null,function*(){let i=this.privReco;xr.Contracts.throwIfNullOrUndefined(i,"serviceRecognizer"),yield i.sendMeetingSpeechEventAsync(e,t)})}enforceAudioGating(){return v(this,null,function*(){let i=(yield this.audioConfig.format).channels;if(i===1){if(this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()!=="true")throw new Error("Single channel audio configuration for MeetingTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(i!==8)throw new Error(`Unsupported audio configuration: Detected ${i}-channel audio`)})}connectMeetingCallbacks(e){this.isMeetingRecognizer=!0,this.canceled=(t,i)=>{e.canceled&&e.canceled(e,i)},this.recognizing=(t,i)=>{e.transcribing&&e.transcribing(e,i)},this.recognized=(t,i)=>{e.transcribed&&e.transcribed(e,i)},this.sessionStarted=(t,i)=>{e.sessionStarted&&e.sessionStarted(e,i)},this.sessionStopped=(t,i)=>{e.sessionStopped&&e.sessionStopped(e,i)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}dispose(e){return v(this,null,function*(){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,yield this.implRecognizerStop()),yield Te(r.prototype,this,"dispose").call(this,e))})}createRecognizerConfig(e){return new wf.RecognizerConfig(e,this.properties)}createServiceRecognizer(e,t,i,n){let s=i;return new wf.TranscriptionServiceRecognizer(e,t,s,n,this)}};_f.TranscriberRecognizer=sP});var iM=h(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});var hW=zx();Object.defineProperty(bt,"ConversationManager",{enumerable:!0,get:function(){return hW.ConversationManager}});var dW=df();Object.defineProperty(bt,"ConversationConnectionConfig",{enumerable:!0,get:function(){return dW.ConversationConnectionConfig}});var fW=eM();Object.defineProperty(bt,"ConversationRecognizerFactory",{enumerable:!0,get:function(){return fW.ConversationRecognizerFactory}});var vW=rM();Object.defineProperty(bt,"TranscriberRecognizer",{enumerable:!0,get:function(){return vW.TranscriberRecognizer}});var ko=Gb();Object.defineProperty(bt,"ConversationReceivedTranslationEventArgs",{enumerable:!0,get:function(){return ko.ConversationReceivedTranslationEventArgs}});Object.defineProperty(bt,"LockRoomEventArgs",{enumerable:!0,get:function(){return ko.LockRoomEventArgs}});Object.defineProperty(bt,"MuteAllEventArgs",{enumerable:!0,get:function(){return ko.MuteAllEventArgs}});Object.defineProperty(bt,"ParticipantAttributeEventArgs",{enumerable:!0,get:function(){return ko.ParticipantAttributeEventArgs}});Object.defineProperty(bt,"ParticipantEventArgs",{enumerable:!0,get:function(){return ko.ParticipantEventArgs}});Object.defineProperty(bt,"ParticipantsListEventArgs",{enumerable:!0,get:function(){return ko.ParticipantsListEventArgs}});var oP=Yb();Object.defineProperty(bt,"ConversationTranslatorCommandTypes",{enumerable:!0,get:function(){return oP.ConversationTranslatorCommandTypes}});Object.defineProperty(bt,"ConversationTranslatorMessageTypes",{enumerable:!0,get:function(){return oP.ConversationTranslatorMessageTypes}});Object.defineProperty(bt,"InternalParticipants",{enumerable:!0,get:function(){return oP.InternalParticipants}})});var cP=h(rs=>{"use strict";Object.defineProperty(rs,"__esModule",{value:!0});rs.SynthesisAudioMetadata=rs.MetadataType=void 0;var gW;(function(r){r.WordBoundary="WordBoundary",r.Bookmark="Bookmark",r.Viseme="Viseme",r.SentenceBoundary="SentenceBoundary",r.SessionEnd="SessionEnd",r.AvatarSignal="TalkingAvatarSignal"})(gW=rs.MetadataType||(rs.MetadataType={}));var aP=class r{constructor(e){this.privSynthesisAudioMetadata=JSON.parse(e)}static fromJSON(e){return new r(e)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}};rs.SynthesisAudioMetadata=aP});var sM=h(ti=>{"use strict";Object.defineProperty(ti,"__esModule",{value:!0});ti.SynthesisStartedEvent=ti.ConnectingToSynthesisServiceEvent=ti.SynthesisTriggeredEvent=ti.SpeechSynthesisEvent=void 0;var nM=x(),No=class extends nM.PlatformEvent{constructor(e,t,i=nM.EventType.Info){super(e,i),this.privRequestId=t}get requestId(){return this.privRequestId}};ti.SpeechSynthesisEvent=No;var uP=class extends No{constructor(e,t,i){super("SynthesisTriggeredEvent",e),this.privSessionAudioDestinationId=t,this.privTurnAudioDestinationId=i}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}};ti.SynthesisTriggeredEvent=uP;var pP=class extends No{constructor(e,t){super("ConnectingToSynthesisServiceEvent",e),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}};ti.ConnectingToSynthesisServiceEvent=pP;var lP=class extends No{constructor(e,t){super("SynthesisStartedEvent",e),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}};ti.SynthesisStartedEvent=lP});var oM=h(If=>{"use strict";Object.defineProperty(If,"__esModule",{value:!0});If.SynthesisTurn=void 0;var Rf=x(),mW=xn(),Ef=P(),yW=cP(),hP=sM(),dP=class r{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=Rf.createNoDashGuid(),this.privTurnDeferral=new Rf.Deferred,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(e){this.privStreamId=e}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(e){this.privAudioOutputFormat=e}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}get extraProperties(){if(this.privWebRTCSDP){let e=new Ef.PropertyCollection;return e.setProperty(Ef.PropertyId.TalkingAvatarService_WebRTC_SDP,this.privWebRTCSDP),e}}getAllReceivedAudio(){return v(this,null,function*(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(yield this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null})}getAllReceivedAudioWithHeader(){return v(this,null,function*(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){let e=yield this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=this.audioOutputFormat.addHeader(e),this.privReceivedAudioWithHeader}else return this.getAllReceivedAudio()})}startNewSynthesis(e,t,i,n){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=e,this.privRawText=t,this.privIsSSML=i,this.privAudioOutputStream=new mW.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",this.privWebRTCSDP="",n!==void 0&&(this.privTurnAudioDestination=n,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new hP.SynthesisTriggeredEvent(this.requestId,void 0,n===void 0?void 0:n.id()))}onPreConnectionStart(e){this.privAuthFetchEventId=e,this.onEvent(new hP.ConnectingToSynthesisServiceEvent(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(e){e&&this.onComplete()}onConnectionEstablishCompleted(e){if(e===200){this.onEvent(new hP.SynthesisStartedEvent(this.requestId,this.privAuthFetchEventId)),this.privBytesReceived=0;return}else e===403&&this.onComplete()}onServiceResponseMessage(e){let t=JSON.parse(e);this.streamId=t.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(e){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new Rf.Deferred;let t=JSON.parse(e);t.webrtc&&(this.privWebRTCSDP=t.webrtc.connectionString)}onAudioChunkReceived(e){this.isSynthesizing&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength,this.privTurnAudioDestination!==void 0&&this.privTurnAudioDestination.write(e))}onTextBoundaryEvent(e){this.updateTextOffset(e.Data.text.Text,e.Type)}onVisemeMetadataReceived(e){e.Data.AnimationChunk!==void 0&&(this.privPartialVisemeAnimation+=e.Data.AnimationChunk)}onSessionEnd(e){this.privAudioDuration=e.Data.Offset}constructSynthesisResult(){return v(this,null,function*(){let e=yield this.getAllReceivedAudioWithHeader();return new Ef.SpeechSynthesisResult(this.requestId,Ef.ResultReason.SynthesizingAudioCompleted,e,void 0,this.extraProperties,this.audioDuration)})}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){let e=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",e}onEvent(e){Rf.Events.instance.onEvent(e)}static isXmlTag(e){return e.length>=2&&e[0]==="<"&&e[e.length-1]===">"}updateTextOffset(e,t){t===yW.MetadataType.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(e,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+e.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!r.isXmlTag(e)&&this.updateTextOffset(e,t))):(this.privSentenceOffset=this.privRawText.indexOf(e,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+e.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!r.isXmlTag(e)&&this.updateTextOffset(e,t)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,this.privTurnAudioDestination!==void 0&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}readAllAudioFromStream(){return v(this,null,function*(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{yield this.privAudioOutputStream.read(this.privReceivedAudio)}catch{this.privReceivedAudio=new ArrayBuffer(0)}}})}withinXmlTag(e){return this.privRawText.indexOf("<",e+1)>this.privRawText.indexOf(">",e+1)}};If.SynthesisTurn=dP});var aM=h(Af=>{"use strict";Object.defineProperty(Af,"__esModule",{value:!0});Af.SynthesisAdapterBase=void 0;var lt=x(),Gt=P(),fr=T(),jo=Yn(),Tf=class{constructor(e,t,i,n){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!e)throw new lt.ArgumentNullError("authentication");if(!t)throw new lt.ArgumentNullError("connectionFactory");if(!i)throw new lt.ArgumentNullError("synthesizerConfig");this.privAuthentication=e,this.privConnectionFactory=t,this.privSynthesizerConfig=i,this.privIsDisposed=!1,this.privSessionAudioDestination=n,this.privSynthesisTurn=new fr.SynthesisTurn,this.privConnectionEvents=new lt.EventSource,this.privServiceEvents=new lt.EventSource,this.privSynthesisContext=new fr.SynthesisContext,this.privAgentConfig=new fr.AgentConfig,this.connectionEvents.attach(s=>{if(s.name==="ConnectionClosedEvent"){let o=s;o.statusCode!==1e3&&this.cancelSynthesisLocal(Gt.CancellationReason.Error,o.statusCode===1007?Gt.CancellationErrorCode.BadRequestParameters:Gt.CancellationErrorCode.ConnectionFailure,`${o.reason} websocket error code: ${o.statusCode}`)}})}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(e){this.privAudioOutputFormat=e,this.privSynthesisTurn.audioOutputFormat=e,this.privSessionAudioDestination!==void 0&&(this.privSessionAudioDestination.format=e),this.synthesisContext!==void 0&&(this.synthesisContext.audioOutputFormat=e)}isDisposed(){return this.privIsDisposed}dispose(e){return v(this,null,function*(){this.privIsDisposed=!0,this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise!==void 0&&(yield(yield this.privConnectionConfigurationPromise).dispose(e))})}connect(){return v(this,null,function*(){yield this.connectImpl()})}sendNetworkMessage(e,t){return v(this,null,function*(){let i=typeof t=="string"?lt.MessageType.Text:lt.MessageType.Binary,n=typeof t=="string"?"application/json":"";return(yield this.fetchConnection()).send(new jo.SpeechConnectionMessage(i,e,this.privSynthesisTurn.requestId,n,t))})}Speak(e,t,i,n,s,o){return v(this,null,function*(){let a;if(t?a=e:a=this.privSynthesizer.buildSsml(e),this.speakOverride!==void 0)return this.speakOverride(a,i,n,s);this.privSuccessCallback=n,this.privErrorCallback=s,this.privSynthesisTurn.startNewSynthesis(i,e,t,o);try{yield this.connectImpl();let c=yield this.fetchConnection();yield this.sendSynthesisContext(c),yield this.sendSsmlMessage(c,a,i),this.onSynthesisStarted(i),this.receiveMessage()}catch(c){return this.cancelSynthesisLocal(Gt.CancellationReason.Error,Gt.CancellationErrorCode.ConnectionFailure,c),Promise.reject(c)}})}stopSpeaking(){return v(this,null,function*(){return yield this.connectImpl(),(yield this.fetchConnection()).send(new jo.SpeechConnectionMessage(lt.MessageType.Text,"synthesis.control",this.privSynthesisTurn.requestId,"application/json",JSON.stringify({action:"stop"})))})}cancelSynthesis(e,t,i,n){let s=new Gt.PropertyCollection;s.setProperty(fr.CancellationErrorCodePropertyName,Gt.CancellationErrorCode[i]);let o=new Gt.SpeechSynthesisResult(e,Gt.ResultReason.Canceled,void 0,n,s);if(this.onSynthesisCancelled(o),this.privSuccessCallback)try{this.privSuccessCallback(o)}catch{}}cancelSynthesisLocal(e,t,i){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,e,t,i))}processTypeSpecificMessages(e){return!0}receiveMessage(){return v(this,null,function*(){try{let t=yield(yield this.fetchConnection()).read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!t)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;let i=jo.SpeechConnectionMessage.fromConnectionMessage(t);if(i.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(i.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse(i.textBody);break;case"response":this.privSynthesisTurn.onServiceResponseMessage(i.textBody);break;case"audio":this.privSynthesisTurn.streamId.toLowerCase()===i.streamId.toLowerCase()&&i.binaryBody&&(this.privSynthesisTurn.onAudioChunkReceived(i.binaryBody),this.onSynthesizing(i.binaryBody),this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.write(i.binaryBody));break;case"audio.metadata":let n=fr.SynthesisAudioMetadata.fromJSON(i.textBody).Metadata;for(let o of n)switch(o.Type){case fr.MetadataType.WordBoundary:case fr.MetadataType.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(o);let a=new Gt.SpeechSynthesisWordBoundaryEventArgs(o.Data.Offset,o.Data.Duration,o.Data.text.Text,o.Data.text.Length,o.Type===fr.MetadataType.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,o.Data.text.BoundaryType);this.onWordBoundary(a);break;case fr.MetadataType.Bookmark:let c=new Gt.SpeechSynthesisBookmarkEventArgs(o.Data.Offset,o.Data.Bookmark);this.onBookmarkReached(c);break;case fr.MetadataType.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(o),o.Data.IsLastAnimation){let u=new Gt.SpeechSynthesisVisemeEventArgs(o.Data.Offset,o.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());this.onVisemeReceived(u)}break;case fr.MetadataType.AvatarSignal:this.onAvatarEvent(o);break;case fr.MetadataType.SessionEnd:this.privSynthesisTurn.onSessionEnd(o);break}break;case"turn.end":this.privSynthesisTurn.onServiceTurnEndResponse();let s;try{s=yield this.privSynthesisTurn.constructSynthesisResult(),this.privSuccessCallback&&this.privSuccessCallback(s)}catch(o){this.privErrorCallback&&this.privErrorCallback(o)}this.onSynthesisCompleted(s);break;default:this.processTypeSpecificMessages(i)||this.privServiceEvents&&this.serviceEvents.onEvent(new lt.ServiceEvent(i.path.toLowerCase(),i.textBody))}return this.receiveMessage()}catch{}})}sendSynthesisContext(e){this.setSynthesisContextSynthesisSection();let t=this.synthesisContext.toJSON();if(t)return e.send(new jo.SpeechConnectionMessage(lt.MessageType.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",t))}setSpeechConfigSynthesisSection(){}connectImpl(e=!1){if(this.privConnectionPromise!=null)return this.privConnectionPromise.then(i=>i.state()===lt.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()));this.privAuthFetchEventId=lt.createNoDashGuid(),this.privConnectionId=lt.createNoDashGuid(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);let t=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=t.then(i=>v(this,null,function*(){this.privSynthesisTurn.onAuthCompleted(!1);let n=this.privConnectionFactory.create(this.privSynthesizerConfig,i,this.privConnectionId);n.events.attach(o=>{this.connectionEvents.onEvent(o)});let s=yield n.open();return s.statusCode===200?(this.privSynthesisTurn.onConnectionEstablishCompleted(s.statusCode),Promise.resolve(n)):s.statusCode===403&&!e?this.connectImpl(!0):(this.privSynthesisTurn.onConnectionEstablishCompleted(s.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${s.statusCode},
                    ${this.privSynthesizerConfig.parameters.getProperty(Gt.PropertyId.SpeechServiceConnection_Url)} Reason: ${s.reason}`))}),i=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(i)}),this.privConnectionPromise.catch(()=>{}),this.privConnectionPromise}sendSpeechServiceConfig(e,t){if(t)return e.send(new jo.SpeechConnectionMessage(lt.MessageType.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",t))}sendSsmlMessage(e,t,i){return e.send(new jo.SpeechConnectionMessage(lt.MessageType.Text,"ssml",i,"application/ssml+xml",t))}fetchConnection(){return v(this,null,function*(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(e=>e.state()===lt.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),yield this.privConnectionConfigurationPromise)})}configureConnection(){return v(this,null,function*(){let e=yield this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(e):(this.setSpeechConfigSynthesisSection(),yield this.sendSpeechServiceConfig(e,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),e)})}onAvatarEvent(e){}onSynthesisStarted(e){}onSynthesizing(e){}onSynthesisCancelled(e){}onSynthesisCompleted(e){}onWordBoundary(e){}onVisemeReceived(e){}onBookmarkReached(e){}};Af.SynthesisAdapterBase=Tf;Tf.telemetryDataEnabled=!0});var uM=h(Of=>{"use strict";Object.defineProperty(Of,"__esModule",{value:!0});Of.AvatarSynthesisAdapter=void 0;var cM=P(),SW=T(),fP=class extends SW.SynthesisAdapterBase{constructor(e,t,i,n,s){super(e,t,i,void 0),this.privAvatarSynthesizer=n,this.privSynthesizer=n,this.privAvatarConfig=s}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(void 0)}setSpeechConfigSynthesisSection(){this.privSynthesizerConfig.synthesisVideoSection={format:{bitrate:this.privAvatarConfig.videoFormat?.bitrate,codec:this.privAvatarConfig.videoFormat?.codec,crop:{bottomRight:{x:this.privAvatarConfig.videoFormat?.cropRange?.bottomRight?.x,y:this.privAvatarConfig.videoFormat?.cropRange?.bottomRight?.y},topLeft:{x:this.privAvatarConfig.videoFormat?.cropRange?.topLeft?.x,y:this.privAvatarConfig.videoFormat?.cropRange?.topLeft?.y}},resolution:{height:this.privAvatarConfig.videoFormat?.height,width:this.privAvatarConfig.videoFormat?.width}},protocol:{name:"WebRTC",webrtcConfig:{clientDescription:btoa(this.privSynthesizerConfig.parameters.getProperty(cM.PropertyId.TalkingAvatarService_WebRTC_SDP)),iceServers:this.privAvatarConfig.remoteIceServers??this.privAvatarSynthesizer.iceServers}},talkingAvatar:{background:{color:this.privAvatarConfig.backgroundColor,image:{url:this.privAvatarConfig.backgroundImage?.toString()}},character:this.privAvatarConfig.character,customized:this.privAvatarConfig.customized,style:this.privAvatarConfig.style}}}onAvatarEvent(e){if(this.privAvatarSynthesizer.avatarEventReceived){let t=new cM.AvatarEventArgs(e.Data.Offset,e.Data.Name);try{this.privAvatarSynthesizer.avatarEventReceived(this.privAvatarSynthesizer,t)}catch{}}}};Of.AvatarSynthesisAdapter=fP});var pM=h(Df=>{"use strict";Object.defineProperty(Df,"__esModule",{value:!0});Df.SpeechSynthesisAdapter=void 0;var cn=P(),CW=T(),vP=class extends CW.SynthesisAdapterBase{constructor(e,t,i,n,s){super(e,t,i,s),this.privSpeechSynthesizer=n,this.privSynthesizer=n}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(this.privSpeechSynthesizer)}onSynthesisStarted(e){let t=new cn.SpeechSynthesisEventArgs(new cn.SpeechSynthesisResult(e,cn.ResultReason.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,t)}onSynthesizing(e){if(this.privSpeechSynthesizer.synthesizing)try{let t=this.privSynthesisTurn.audioOutputFormat.addHeader(e),i=new cn.SpeechSynthesisEventArgs(new cn.SpeechSynthesisResult(this.privSynthesisTurn.requestId,cn.ResultReason.SynthesizingAudio,t));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,i)}catch{}}onSynthesisCancelled(e){if(this.privSpeechSynthesizer.SynthesisCanceled){let t=new cn.SpeechSynthesisEventArgs(e);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,t)}catch{}}}onSynthesisCompleted(e){if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new cn.SpeechSynthesisEventArgs(e))}catch{}}onWordBoundary(e){if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,e)}catch{}}onVisemeReceived(e){if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,e)}catch{}}onBookmarkReached(e){if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,e)}catch{}}};Df.SpeechSynthesisAdapter=vP});var lM=h(xf=>{"use strict";Object.defineProperty(xf,"__esModule",{value:!0});xf.SynthesisRestAdapter=void 0;var gP=Le(),mP=P(),bW=ar(),PW=ot(),yP=class{constructor(e,t){let i=e.parameters.getProperty(mP.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!i){let s=e.parameters.getProperty(mP.PropertyId.SpeechServiceConnection_Region,"westus"),o=bW.ConnectionFactoryBase.getHostSuffix(s);i=e.parameters.getProperty(mP.PropertyId.SpeechServiceConnection_Host,`https://${s}.tts.speech${o}`)}this.privUri=`${i}/cognitiveservices/voices/list`;let n=gP.RestConfigBase.requestOptions;this.privRestAdapter=new gP.RestMessageAdapter(n),this.privAuthentication=t}getVoicesList(e){return this.privRestAdapter.setHeaders(PW.HeaderNames.ConnectionId,e),this.privAuthentication.fetch(e).then(t=>(this.privRestAdapter.setHeaders(t.headerName,t.token),this.privRestAdapter.request(gP.RestRequestType.Get,this.privUri)))}};xf.SynthesisRestAdapter=yP});var fM=h(is=>{"use strict";Object.defineProperty(is,"__esModule",{value:!0});is.SynthesizerConfig=is.SynthesisServiceType=void 0;var hM=T(),dM;(function(r){r[r.Standard=0]="Standard",r[r.Custom=1]="Custom"})(dM=is.SynthesisServiceType||(is.SynthesisServiceType={}));var SP=class{constructor(e,t){this.privSynthesisServiceType=dM.Standard,this.avatarEnabled=!1,this.privSpeechServiceConfig=e||new hM.SpeechServiceConfig(new hM.Context(null)),this.privParameters=t}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(e){this.privSynthesisServiceType=e}set synthesisVideoSection(e){this.privSpeechServiceConfig.Context.synthesis={video:e}}get SpeechServiceConfig(){return this.privSpeechServiceConfig}};is.SynthesizerConfig=SP});var vM=h(Mf=>{"use strict";Object.defineProperty(Mf,"__esModule",{value:!0});Mf.SynthesisContext=void 0;var CP=P(),bP=class{constructor(){this.privContext={}}setSection(e,t){this.privContext[e]=t}set audioOutputFormat(e){this.privAudioOutputFormat=e}toJSON(){return JSON.stringify(this.privContext)}setSynthesisSection(e){let t=this.buildSynthesisContext(e);this.setSection("synthesis",t)}buildSynthesisContext(e){return{audio:{metadataOptions:{bookmarkEnabled:!!e?.bookmarkReached,punctuationBoundaryEnabled:e?.properties.getProperty(CP.PropertyId.SpeechServiceResponse_RequestPunctuationBoundary,!!e?.wordBoundary),sentenceBoundaryEnabled:e?.properties.getProperty(CP.PropertyId.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!e?.visemeReceived,wordBoundaryEnabled:e?.properties.getProperty(CP.PropertyId.SpeechServiceResponse_RequestWordBoundary,!!e?.wordBoundary)},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:e?.autoDetectSourceLanguage}}}};Mf.SynthesisContext=bP});var gM=h(kf=>{"use strict";Object.defineProperty(kf,"__esModule",{value:!0});kf.SpeakerRecognitionConfig=void 0;var wW=T(),PP=class{constructor(e,t){this.privContext=e||new wW.Context(null),this.privParameters=t}get parameters(){return this.privParameters}get Context(){return this.privContext}};kf.SpeakerRecognitionConfig=PP});var yM=h(jf=>{"use strict";Object.defineProperty(jf,"__esModule",{value:!0});jf.SpeakerServiceRecognizer=void 0;var _W=Le(),Nf=x(),Qe=P(),mM=T(),RW=Yn(),wP=class extends mM.ServiceRecognizerBase{constructor(e,t,i,n,s){super(e,t,i,n,s),this.privSpeakerRecognizer=s,this.privSpeakerAudioSource=i,this.recognizeSpeaker=o=>this.recognizeSpeakerOnce(o),this.sendPrePayloadJSONOverride=()=>this.noOp()}processTypeSpecificMessages(e){let t=!1,i=new Qe.PropertyCollection;switch(e.messageType===Nf.MessageType.Text&&i.setProperty(Qe.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speaker.response":let s=JSON.parse(e.textBody),o;s.status.statusCode.toLowerCase()!=="success"?o=new Qe.SpeakerRecognitionResult(s,Qe.ResultReason.Canceled,Qe.CancellationErrorCode.ServiceError,s.status.reason):o=new Qe.SpeakerRecognitionResult(s,Qe.ResultReason.RecognizedSpeaker),this.privResultDeferral&&this.privResultDeferral.resolve(o),t=!0;break;default:break}let n=new Nf.Deferred;return n.resolve(t),n.promise}cancelRecognition(e,t,i,n,s){if(new Qe.PropertyCollection().setProperty(mM.CancellationErrorCodePropertyName,Qe.CancellationErrorCode[n]),this.privResultDeferral){let a=new Qe.SpeakerRecognitionResult({scenario:this.privSpeakerModel.scenario,status:{statusCode:s,reason:s}},Qe.ResultReason.Canceled,n,s);try{this.privResultDeferral.resolve(a)}catch(c){this.privResultDeferral.reject(c)}}}recognizeSpeakerOnce(e){return v(this,null,function*(){this.privSpeakerModel=e,this.voiceProfileType=e.scenario,this.privResultDeferral||(this.privResultDeferral=new Nf.Deferred),this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(Qe.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);let t=this.connectImpl(),i=this.sendPreAudioMessages(this.extractSpeakerContext(e)),n=yield this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),s=yield this.privSpeakerAudioSource.format,o=yield this.privSpeakerAudioSource.deviceInfo,a=new _W.ReplayableAudioNode(n,s.avgBytesPerSec);yield this.privRequestSession.onAudioSourceAttachCompleted(a,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:o};try{yield t,yield i}catch(p){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Qe.CancellationReason.Error,Qe.CancellationErrorCode.ConnectionFailure,p)}let c=new Qe.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,c),this.receiveMessage(),this.sendAudio(a).then(()=>{},p=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Qe.CancellationReason.Error,Qe.CancellationErrorCode.RuntimeError,p)}),this.privResultDeferral.promise})}sendPreAudioMessages(e){return v(this,null,function*(){let t=yield this.fetchConnection();yield this.sendSpeakerRecognition(t,e)})}sendSpeakerRecognition(e,t){return v(this,null,function*(){let i=JSON.stringify(t);return e.send(new RW.SpeechConnectionMessage(Nf.MessageType.Text,"speaker.context",this.privRequestSession.requestId,"application/json; charset=utf-8",i))})}extractSpeakerContext(e){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:e.profileIds,scenario:e.scenario}}};jf.SpeakerServiceRecognizer=wP});var CM=h(Lf=>{"use strict";Object.defineProperty(Lf,"__esModule",{value:!0});Lf.VoiceServiceRecognizer=void 0;var EW=Le(),ri=x(),oe=P(),SM=T(),_P=Yn(),RP=class extends SM.ServiceRecognizerBase{constructor(e,t,i,n,s){super(e,t,i,n,s),this.privDeferralMap=new ri.DeferralMap,this.privSpeakerAudioSource=i,this.sendPrePayloadJSONOverride=()=>this.noOp()}set SpeakerAudioSource(e){this.privSpeakerAudioSource=e}processTypeSpecificMessages(e){let t=!1,i=new oe.PropertyCollection;switch(e.messageType===ri.MessageType.Text&&i.setProperty(oe.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speaker.profiles":let s=JSON.parse(e.textBody);switch(s.operation.toLowerCase()){case"create":this.handleCreateResponse(s,e.requestId);break;case"delete":case"reset":this.handleResultResponse(s,e.requestId);break;case"fetch":let u=JSON.parse(e.textBody);this.handleFetchResponse(u,e.requestId);break;default:break}t=!0;break;case"speaker.phrases":let o=JSON.parse(e.textBody);this.handlePhrasesResponse(o,e.requestId),t=!0;break;case"speaker.profile.enrollment":let a=JSON.parse(e.textBody),c=new oe.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(a.enrollment?a.enrollment.enrollmentStatus:a.status.statusCode),a.enrollment?JSON.stringify(a.enrollment):void 0,a.status.reason);this.privDeferralMap.getId(e.requestId)&&this.privDeferralMap.complete(e.requestId,c),this.privRequestSession.onSpeechEnded(),t=!0;break;default:break}let n=new ri.Deferred;return n.resolve(t),n.promise}cancelRecognition(e,t,i,n,s){new oe.PropertyCollection().setProperty(SM.CancellationErrorCodePropertyName,oe.CancellationErrorCode[n]);let a=new oe.VoiceProfileEnrollmentResult(oe.ResultReason.Canceled,s,s);this.privDeferralMap.getId(t)&&this.privDeferralMap.complete(t,a)}createProfile(e,t){return v(this,null,function*(){this.voiceProfileType=e.toString();let i=this.connectImpl();try{let n=new ri.Deferred;return yield i,yield this.sendCreateProfile(n,e,t),this.receiveMessage(),n.promise}catch(n){throw n}})}resetProfile(e){return v(this,null,function*(){return this.voiceProfileType=e.profileType.toString(),this.sendCommonRequest("reset",e.profileType,e)})}deleteProfile(e){return v(this,null,function*(){return this.voiceProfileType=e.profileType.toString(),this.sendCommonRequest("delete",e.profileType,e)})}retrieveEnrollmentResult(e){return v(this,null,function*(){return this.voiceProfileType=e.profileType.toString(),this.privExpectedProfileId=e.profileId,this.sendCommonRequest("fetch",e.profileType,e)})}getAllProfiles(e){return v(this,null,function*(){return this.voiceProfileType=e.toString(),this.sendCommonRequest("fetch",e)})}getActivationPhrases(e,t){return v(this,null,function*(){this.voiceProfileType=e.toString();let i=this.connectImpl();try{let n=new ri.Deferred;return yield i,yield this.sendPhrasesRequest(n,e,t),this.receiveMessage(),n.promise}catch(n){throw n}})}enrollProfile(e){return v(this,null,function*(){this.voiceProfileType=e.profileType.toString();let t=new ri.Deferred;this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(oe.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);let i=this.connectImpl(),n=this.sendPreAudioMessages(e,t),s=yield this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),o=yield this.privSpeakerAudioSource.format,a=yield this.privSpeakerAudioSource.deviceInfo,c=new EW.ReplayableAudioNode(s,o.avgBytesPerSec);yield this.privRequestSession.onAudioSourceAttachCompleted(c,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:a};try{yield i,yield n}catch(l){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,oe.CancellationReason.Error,oe.CancellationErrorCode.ConnectionFailure,l)}let u=new oe.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,u),this.receiveMessage(),this.sendAudio(c).then(()=>{},l=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,oe.CancellationReason.Error,oe.CancellationErrorCode.RuntimeError,l)}),t.promise})}sendPreAudioMessages(e,t){return v(this,null,function*(){let i=yield this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,t),yield this.sendBaseRequest(i,"enroll",this.scenarioFrom(e.profileType),e)})}sendPhrasesRequest(e,t,i){return v(this,null,function*(){let n=yield this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,e);let s=this.scenarioFrom(t),o={locale:i,scenario:s};return n.send(new _P.SpeechConnectionMessage(ri.MessageType.Text,"speaker.profile.phrases",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(o)))})}sendCreateProfile(e,t,i){return v(this,null,function*(){let n=yield this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,e);let s=t===oe.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":t===oe.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification",o={locale:i,number:"1",scenario:s};return n.send(new _P.SpeechConnectionMessage(ri.MessageType.Text,"speaker.profile.create",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(o)))})}sendCommonRequest(e,t,i=void 0){return v(this,null,function*(){let n=this.connectImpl();try{let s=new ri.Deferred;this.privRequestSession.onSpeechContext(),yield n;let o=yield this.fetchConnection();return this.privDeferralMap.add(this.privRequestSession.requestId,s),yield this.sendBaseRequest(o,e,this.scenarioFrom(t),i),this.receiveMessage(),s.promise}catch(s){throw s}})}sendBaseRequest(e,t,i,n){return v(this,null,function*(){let s={scenario:i};return n?s.profileIds=[n.profileId]:s.maxPageSize=-1,e.send(new _P.SpeechConnectionMessage(ri.MessageType.Text,`speaker.profile.${t}`,this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(s)))})}extractSpeakerContext(e){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:e.profileIds,scenario:e.scenario}}handlePhrasesResponse(e,t){if(this.privDeferralMap.getId(t))if(e.status.statusCode.toLowerCase()!=="success"){let i=oe.ResultReason.Canceled,n=new oe.VoiceProfilePhraseResult(i,e.status.statusCode,e.passPhraseType,[]);this.privDeferralMap.complete(t,n)}else if(e.phrases&&e.phrases.length>0){let i=oe.ResultReason.EnrollingVoiceProfile,n=new oe.VoiceProfilePhraseResult(i,e.status.statusCode,e.passPhraseType,e.phrases);this.privDeferralMap.complete(t,n)}else throw new Error("Voice Profile get activation phrases failed, no phrases received");else throw new Error(`Voice Profile get activation phrases request for requestID ${t} not found`)}handleCreateResponse(e,t){if(e.profiles&&e.profiles.length>0)if(this.privDeferralMap.getId(t)){let i=e.profiles.map(n=>n.profileId);this.privDeferralMap.complete(t,i)}else throw new Error(`Voice Profile create request for requestID ${t} not found`);else throw new Error("Voice Profile create failed, no profile id received")}handleResultResponse(e,t){if(this.privDeferralMap.getId(t)){let i=e.operation.toLowerCase()==="delete"?oe.ResultReason.DeletedVoiceProfile:oe.ResultReason.ResetVoiceProfile,n=e.status.statusCode.toLowerCase()==="success"?i:oe.ResultReason.Canceled,s=new oe.VoiceProfileResult(n,`statusCode: ${e.status.statusCode}, errorDetails: ${e.status.reason}`);this.privDeferralMap.complete(t,s)}else throw new Error(`Voice Profile create request for requestID ${t} not found`)}handleFetchResponse(e,t){if(this.privDeferralMap.getId(t)&&e.profiles[0]){if(this.privExpectedProfileId&&e.profiles.length===1&&e.profiles[0].profileId===this.privExpectedProfileId){this.privExpectedProfileId=void 0;let i=e.profiles[0],n=new oe.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(i.enrollmentStatus),JSON.stringify(i),e.status.reason);this.privDeferralMap.complete(t,n)}else if(e.profiles.length>0){let i=e.profiles,n=[];for(let s of i)n.push(new oe.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(s.enrollmentStatus),JSON.stringify(s),e.status.reason));this.privDeferralMap.complete(t,n)}}else throw new Error(`Voice Profile fetch request for requestID ${t} not found`)}enrollmentReasonFrom(e){switch(e.toLowerCase()){case"enrolled":return oe.ResultReason.EnrolledVoiceProfile;case"invalidlocale":case"invalidphrase":case"invalidaudioformat":case"invalidscenario":case"invalidprofilecount":case"invalidoperation":case"audiotooshort":case"audiotoolong":case"toomanyenrollments":case"storageconflict":case"profilenotfound":case"incompatibleprofiles":case"incompleteenrollment":return oe.ResultReason.Canceled;default:return oe.ResultReason.EnrollingVoiceProfile}}scenarioFrom(e){return e===oe.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":e===oe.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification"}};Lf.VoiceServiceRecognizer=RP});var bM=h(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.type=Fe.connectivity=Fe.Device=Fe.OS=Fe.System=Fe.Context=Fe.SpeechServiceConfig=void 0;var EP=class{constructor(e){this.context=e}serialize(){return JSON.stringify(this,(e,t)=>{if(t&&typeof t=="object"&&!Array.isArray(t)){let i={};for(let n in t)Object.hasOwnProperty.call(t,n)&&(i[n&&n.charAt(0).toLowerCase()+n.substring(1)]=t[n]);return i}return t})}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(e){this.recognition=e.toLowerCase()}};Fe.SpeechServiceConfig=EP;var IP=class{constructor(e){this.system=new qf,this.os=e}};Fe.Context=IP;var qf=class{constructor(){let e="1.40.0";this.name="SpeechSDK",this.version=e,this.build="JavaScript",this.lang="JavaScript"}};Fe.System=qf;var TP=class{constructor(e,t,i){this.platform=e,this.name=t,this.version=i}};Fe.OS=TP;var AP=class{constructor(e,t,i){this.manufacturer=e,this.model=t,this.version=i}};Fe.Device=AP;var IW;(function(r){r.Bluetooth="Bluetooth",r.Wired="Wired",r.WiFi="WiFi",r.Cellular="Cellular",r.InBuilt="InBuilt",r.Unknown="Unknown"})(IW=Fe.connectivity||(Fe.connectivity={}));var TW;(function(r){r.Phone="Phone",r.Speaker="Speaker",r.Car="Car",r.Headset="Headset",r.Thermostat="Thermostat",r.Microphones="Microphones",r.Deskphone="Deskphone",r.RemoteControl="RemoteControl",r.Unknown="Unknown",r.File="File",r.Stream="Stream"})(TW=Fe.type||(Fe.type={}))});var T=h(_=>{"use strict";var AW=_&&_.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),M=_&&_.__exportStar||function(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&AW(e,r,t)};Object.defineProperty(_,"__esModule",{value:!0});_.AutoDetectSourceLanguagesOpenRangeOptionName=_.ForceDictationPropertyName=_.ServicePropertiesPropertyName=_.CancellationErrorCodePropertyName=_.OutputFormatPropertyName=void 0;M(oR(),_);M(pR(),_);M($u(),_);M(hR(),_);M(fR(),_);M(AD(),_);M(MD(),_);M(Id(),_);M(ND(),_);M(jD(),_);M(qD(),_);M(FD(),_);M(UD(),_);M($D(),_);M(JD(),_);M(ZD(),_);M(ix(),_);M(OC(),_);M(nx(),_);M(sx(),_);M(ax(),_);M(cx(),_);M(ux(),_);M(lx(),_);M(hx(),_);M(dx(),_);M(fx(),_);M(vx(),_);M(gx(),_);M(yx(),_);M(Sx(),_);M(Cx(),_);M(bx(),_);M(wx(),_);M(_x(),_);M(Ex(),_);M(Ax(),_);M(Ox(),_);M(Dx(),_);M(Mx(),_);M(Lx(),_);M(qx(),_);M(iM(),_);M(cP(),_);M(oM(),_);M(aM(),_);var OW=uM();Object.defineProperty(_,"AvatarSynthesisAdapter",{enumerable:!0,get:function(){return OW.AvatarSynthesisAdapter}});var DW=pM();Object.defineProperty(_,"SpeechSynthesisAdapter",{enumerable:!0,get:function(){return DW.SpeechSynthesisAdapter}});M(lM(),_);M(fM(),_);M(vM(),_);M(gM(),_);M(yM(),_);M(CM(),_);M(bM(),_);_.OutputFormatPropertyName="OutputFormat";_.CancellationErrorCodePropertyName="CancellationErrorCode";_.ServicePropertiesPropertyName="ServiceProperties";_.ForceDictationPropertyName="ForceDictation";_.AutoDetectSourceLanguagesOpenRangeOptionName="OpenRange"});var PM=h(ns=>{"use strict";var xW=ns&&ns.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),MW=ns&&ns.__exportStar||function(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&xW(e,r,t)};Object.defineProperty(ns,"__esModule",{value:!0});var kW=T();new kW.AgentConfig;MW(P(),ns)});function Bc(r){return class extends r{destroy$=new ue;ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.destroy$.unsubscribe()}}}var xi=class r{urlService=W(Oi);http=W(Ai);store=W(Lr);startStream(e){return this.http.post(this.urlService.URLS.AVATAR+"/start-stream",{},{params:mr({},e?{size:"life-size"}:void 0)}).pipe(wt(t=>this.store.updateStreamId(t.data.id)))}closeStream(){let e=this.store.streamId();return this.store.updateStreamId(""),this.http.delete(this.urlService.URLS.AVATAR+`/close-stream/${e}`)}sendCandidate(e){return this.http.post(this.urlService.URLS.AVATAR+`/send-candidate/${this.store.streamId()}`,{candidate:e})}sendAnswer(e){return this.http.put(this.urlService.URLS.AVATAR+`/send-answer/${this.store.streamId()}`,{answer:e})}interruptAvatar(){return this.http.delete(this.urlService.URLS.AVATAR+`/stop-render/${this.store.streamId()}`)}renderText(){return this.http.post(this.urlService.URLS.AVATAR+`/render-text/${this.store.streamId()}`,{})}static \u0275fac=function(t){return new(t||r)};static \u0275prov=Ft({token:r,factory:r.\u0275fac,providedIn:"root"})};function ms(r=!1){return e=>e.pipe(ln(t=>(r&&console.log(t),os("CUSTOM_ERROR")))).pipe(as(t=>t!=="CUSTOM_ERROR"))}function vw(){let r=new Date().getTime(),e=typeof performance<"u"&&performance.now&&performance.now()*1e3||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){let i=Math.random()*16;return r>0?(i=(r+i)%16|0,r=Math.floor(r/16)):(i=(e+i)%16|0,e=Math.floor(e/16)),(t==="x"?i:i&3|8).toString(16)})}function _M(r){return/[\u0600-\u06FF]+/.test(r)}var Uc=r=>(r.split(" ").map(e=>(_M(e)?"\u202A":"\u202C")+e).join(" "),r);function Wc(r,e){let t=r.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),i=Array.from(new Map(e.context.citations.map(s=>[s.url+s.title,s])).values()),n=new Set;return t=t.replace(/\[(.*?)\]/g,(s,o)=>{let a=Number(o.replace(/[^0-9]/g,""))-1,c=i[a];if(!c||n.has(c.url+c.title))return"";n.add(c.url+c.title);let u=c.title;return`<br /><small class="px-1 text-primary"><a target="_blank" href="${c.url}">${u}</a><i class="link-icon"></i></small>`}),t.trim()}var RM=["video"],EM=["idleVideo"],IM=r=>({"scale-50 left-0":r}),gw=(r,e,t)=>({"bg-red-600":r,"bg-green-700":e,"bg-orange-500":t}),mw=(r,e)=>({"h-full":r,"w-full":e});function TM(r,e){if(r&1&&(N(0,"span",7),_e(1),F()),r&2){let t=et();q(),Bt(t.onlineStatus())}}function AM(r,e){if(r&1&&(N(0,"video",9,1),de(2,"source",10),F()),r&2){let t=et();pe("ngClass",Ti(2,mw,t.hasSize(),!t.hasSize()))("hidden",t.store.isStreamStarted())}}var Hc=class r extends Bc(class{}){size=Uo();hasSize=Zf(()=>!!this.size());fullWidth="w-full h-full block ";video=fn.required("video");idleVideo=fn("idleVideo");avatarService=W(xi);lang=W(gs);start$=new Kf(1);stop$=new Kf(1);store=W(Lr);init$=this.start$.asObservable().pipe(wt(()=>this.store.updateStreamStatus("InProgress"))).pipe(Nr(this.destroy$)).pipe(Tc(()=>this.avatarService.startStream(this.size()).pipe(ln(e=>{throw this.store.updateStreamStatus("Stopped"),e})).pipe(ms()))).pipe(ni(e=>{let{data:{webrtcData:{offer:t,iceServers:i}}}=e;return this.pc=new RTCPeerConnection({iceServers:i,iceTransportPolicy:"relay"}),this.pc.addEventListener("icecandidate",n=>{n.candidate&&this.avatarService.sendCandidate(n.candidate).subscribe()}),this.pc.addEventListener("icegatheringstatechange",n=>{n.target.iceGatheringState=="complete"&&this.video().nativeElement.paused&&(this.video().nativeElement.play().then(),this.store.updateStreamStatus("Started"))}),this.pc.addEventListener("track",n=>{this.video().nativeElement.srcObject=n.streams[0]}),this.pc.addEventListener("connectionstatechange",n=>{let s=n.target.connectionState;s==="connected"&&this.store.updateStreamStatus("Started"),s==="disconnected"&&this.store.updateStreamStatus("Stopped")}),Ic(this.pc.setRemoteDescription(new RTCSessionDescription(t))).pipe(ni(()=>Ic(this.pc.createAnswer()))).pipe(ni(n=>Ic(this.pc.setLocalDescription(n)).pipe(Ae(()=>n)))).pipe(ni(n=>this.avatarService.sendAnswer(n)))})).pipe(Ae(()=>""));onlineStatus=Zf(()=>{switch(this.lang.localChange(),this.store.streamingStatus()){case"Started":return this.lang.locals.connected;case"InProgress":return this.lang.locals.connecting;case"Disconnecting":return this.lang.locals.disconnecting;default:return this.lang.locals.not_connected}});ngOnInit(){return v(this,null,function*(){qo(this.destroy$).pipe(wt(()=>this.store.updateStreamStatus("Stopped"))).pipe(ni(()=>this.avatarService.closeStream().pipe(ms()))).subscribe(()=>{console.log("COMPONENT DESTROYED")}),this.stop$.pipe(as(()=>this.store.hasStream())).pipe(wt(()=>this.store.updateStreamStatus("Disconnecting"))).pipe(Nr(this.destroy$)).pipe(ni(()=>this.avatarService.closeStream().pipe(ms()))).subscribe(()=>{console.log("MANUAL CLOSE")}),this.size()||this.start$.next()})}ngAfterViewInit(){this.playIdle()}playIdle(){this.idleVideo()&&this.idleVideo()?.nativeElement&&(this.idleVideo().nativeElement.src="assets/videos/idle-full.webm",this.idleVideo().nativeElement.muted=!0,this.idleVideo().nativeElement.loop=!0,this.idleVideo().nativeElement.play().then())}static \u0275fac=(()=>{let e;return function(i){return(e||(e=us(r)))(i||r)}})();static \u0275cmp=Qt({type:r,selectors:[["app-avatar-video"]],viewQuery:function(t,i){t&1&&(vn(i.video,RM,5),vn(i.idleVideo,EM,5)),t&2&&ls(2)},hostVars:1,hostBindings:function(t,i){t&2&&Wo("class",i.fullWidth)},inputs:{size:[1,"size"]},standalone:!0,features:[Oc,Xt],decls:11,vars:23,consts:[["video",""],["idleVideo",""],["id","video-wrapper",1,"flex","items-center","w-full","h-full","justify-center"],[1,"flex","flex-col","items-center","w-full","h-full","justify-center","absolute"],[1,"flex","gap-1","shadow-2xl","shadow-white","bg-black/20","p-1","mt-2","absolute","z-50","top-0","rounded-md",3,"ngClass"],[1,"p-4","rounded-full",3,"ngClass"],[1,"p-4","absolute","pulse","rounded-full",3,"ngClass"],[1,"text-white","font-semibold"],["autoplay","",3,"hidden","ngClass"],[3,"ngClass","hidden"],["src","assets/videos/idle-full.webm","type","video/webm"]],template:function(t,i){t&1&&(N(0,"div",2)(1,"div",3)(2,"div",4),de(3,"div",5)(4,"div",6),jr(5,TM,2,1,"span",7),F(),de(6,"video",8,0),jr(8,AM,3,5,"video",9),F(),_e(9),xc(10,"async"),F()),t&2&&(q(2),pe("ngClass",fs(10,IM,!i.hasSize())),q(),pe("ngClass",Qf(12,gw,i.store.isStreamStopped(),i.store.isStreamStarted(),i.store.isStreamLoading())),q(),pe("ngClass",Qf(16,gw,i.store.isStreamStopped(),i.store.isStreamStarted(),i.store.isStreamLoading())),q(),Et(i.hasSize()?5:-1),q(),pe("hidden",i.store.isStreamStopped()||i.store.isStreamLoading())("ngClass",Ti(20,mw,i.hasSize(),!i.hasSize())),q(2),Et(i.hasSize()?8:-1),q(),ds(" ",Mc(10,8,i.init$),`
`))},dependencies:[jc,vs]})};function qr(r){return getComputedStyle(r)}function At(r,e){for(var t in e){var i=e[t];typeof i=="number"&&(i=i+"px"),r.style[t]=i}return r}function $c(r){var e=document.createElement("div");return e.className=r,e}var yw=typeof Element<"u"&&(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);function Mi(r,e){if(!yw)throw new Error("No element matching method supported");return yw.call(r,e)}function Ss(r){r.remove?r.remove():r.parentNode&&r.parentNode.removeChild(r)}function Sw(r,e){return Array.prototype.filter.call(r.children,function(t){return Mi(t,e)})}var Oe={main:"ps",rtl:"ps__rtl",element:{thumb:function(r){return"ps__thumb-"+r},rail:function(r){return"ps__rail-"+r},consuming:"ps__child--consume"},state:{focus:"ps--focus",clicking:"ps--clicking",active:function(r){return"ps--active-"+r},scrolling:function(r){return"ps--scrolling-"+r}}},Pw={x:null,y:null};function ww(r,e){var t=r.element.classList,i=Oe.state.scrolling(e);t.contains(i)?clearTimeout(Pw[e]):t.add(i)}function _w(r,e){Pw[e]=setTimeout(function(){return r.isAlive&&r.element.classList.remove(Oe.state.scrolling(e))},r.settings.scrollingThreshold)}function OM(r,e){ww(r,e),_w(r,e)}var Go=function(e){this.element=e,this.handlers={}},Rw={isEmpty:{configurable:!0}};Go.prototype.bind=function(e,t){typeof this.handlers[e]>"u"&&(this.handlers[e]=[]),this.handlers[e].push(t),this.element.addEventListener(e,t,!1)};Go.prototype.unbind=function(e,t){var i=this;this.handlers[e]=this.handlers[e].filter(function(n){return t&&n!==t?!0:(i.element.removeEventListener(e,n,!1),!1)})};Go.prototype.unbindAll=function(){for(var e in this.handlers)this.unbind(e)};Rw.isEmpty.get=function(){var r=this;return Object.keys(this.handlers).every(function(e){return r.handlers[e].length===0})};Object.defineProperties(Go.prototype,Rw);var Cs=function(){this.eventElements=[]};Cs.prototype.eventElement=function(e){var t=this.eventElements.filter(function(i){return i.element===e})[0];return t||(t=new Go(e),this.eventElements.push(t)),t};Cs.prototype.bind=function(e,t,i){this.eventElement(e).bind(t,i)};Cs.prototype.unbind=function(e,t,i){var n=this.eventElement(e);n.unbind(t,i),n.isEmpty&&this.eventElements.splice(this.eventElements.indexOf(n),1)};Cs.prototype.unbindAll=function(){this.eventElements.forEach(function(e){return e.unbindAll()}),this.eventElements=[]};Cs.prototype.once=function(e,t,i){var n=this.eventElement(e),s=function(o){n.unbind(t,s),i(o)};n.bind(t,s)};function Kc(r){if(typeof window.CustomEvent=="function")return new CustomEvent(r);var e=document.createEvent("CustomEvent");return e.initCustomEvent(r,!1,!1,void 0),e}function Jc(r,e,t,i,n){i===void 0&&(i=!0),n===void 0&&(n=!1);var s;if(e==="top")s=["contentHeight","containerHeight","scrollTop","y","up","down"];else if(e==="left")s=["contentWidth","containerWidth","scrollLeft","x","left","right"];else throw new Error("A proper axis should be provided");DM(r,t,s,i,n)}function DM(r,e,t,i,n){var s=t[0],o=t[1],a=t[2],c=t[3],u=t[4],p=t[5];i===void 0&&(i=!0),n===void 0&&(n=!1);var l=r.element;r.reach[c]=null,l[a]<1&&(r.reach[c]="start"),l[a]>r[s]-r[o]-1&&(r.reach[c]="end"),e&&(l.dispatchEvent(Kc("ps-scroll-"+c)),e<0?l.dispatchEvent(Kc("ps-scroll-"+u)):e>0&&l.dispatchEvent(Kc("ps-scroll-"+p)),i&&OM(r,c)),r.reach[c]&&(e||n)&&l.dispatchEvent(Kc("ps-"+c+"-reach-"+r.reach[c]))}function ye(r){return parseInt(r,10)||0}function xM(r){return Mi(r,"input,[contenteditable]")||Mi(r,"select,[contenteditable]")||Mi(r,"textarea,[contenteditable]")||Mi(r,"button,[contenteditable]")}function MM(r){var e=qr(r);return ye(e.width)+ye(e.paddingLeft)+ye(e.paddingRight)+ye(e.borderLeftWidth)+ye(e.borderRightWidth)}var ys={isWebKit:typeof document<"u"&&"WebkitAppearance"in document.documentElement.style,supportsTouch:typeof window<"u"&&("ontouchstart"in window||"maxTouchPoints"in window.navigator&&window.navigator.maxTouchPoints>0||window.DocumentTouch&&document instanceof window.DocumentTouch),supportsIePointer:typeof navigator<"u"&&navigator.msMaxTouchPoints,isChrome:typeof navigator<"u"&&/Chrome/i.test(navigator&&navigator.userAgent)};function oi(r){var e=r.element,t=Math.floor(e.scrollTop),i=e.getBoundingClientRect();r.containerWidth=Math.floor(i.width),r.containerHeight=Math.floor(i.height),r.contentWidth=e.scrollWidth,r.contentHeight=e.scrollHeight,e.contains(r.scrollbarXRail)||(Sw(e,Oe.element.rail("x")).forEach(function(n){return Ss(n)}),e.appendChild(r.scrollbarXRail)),e.contains(r.scrollbarYRail)||(Sw(e,Oe.element.rail("y")).forEach(function(n){return Ss(n)}),e.appendChild(r.scrollbarYRail)),!r.settings.suppressScrollX&&r.containerWidth+r.settings.scrollXMarginOffset<r.contentWidth?(r.scrollbarXActive=!0,r.railXWidth=r.containerWidth-r.railXMarginWidth,r.railXRatio=r.containerWidth/r.railXWidth,r.scrollbarXWidth=Cw(r,ye(r.railXWidth*r.containerWidth/r.contentWidth)),r.scrollbarXLeft=ye((r.negativeScrollAdjustment+e.scrollLeft)*(r.railXWidth-r.scrollbarXWidth)/(r.contentWidth-r.containerWidth))):r.scrollbarXActive=!1,!r.settings.suppressScrollY&&r.containerHeight+r.settings.scrollYMarginOffset<r.contentHeight?(r.scrollbarYActive=!0,r.railYHeight=r.containerHeight-r.railYMarginHeight,r.railYRatio=r.containerHeight/r.railYHeight,r.scrollbarYHeight=Cw(r,ye(r.railYHeight*r.containerHeight/r.contentHeight)),r.scrollbarYTop=ye(t*(r.railYHeight-r.scrollbarYHeight)/(r.contentHeight-r.containerHeight))):r.scrollbarYActive=!1,r.scrollbarXLeft>=r.railXWidth-r.scrollbarXWidth&&(r.scrollbarXLeft=r.railXWidth-r.scrollbarXWidth),r.scrollbarYTop>=r.railYHeight-r.scrollbarYHeight&&(r.scrollbarYTop=r.railYHeight-r.scrollbarYHeight),kM(e,r),r.scrollbarXActive?e.classList.add(Oe.state.active("x")):(e.classList.remove(Oe.state.active("x")),r.scrollbarXWidth=0,r.scrollbarXLeft=0,e.scrollLeft=r.isRtl===!0?r.contentWidth:0),r.scrollbarYActive?e.classList.add(Oe.state.active("y")):(e.classList.remove(Oe.state.active("y")),r.scrollbarYHeight=0,r.scrollbarYTop=0,e.scrollTop=0)}function Cw(r,e){return r.settings.minScrollbarLength&&(e=Math.max(e,r.settings.minScrollbarLength)),r.settings.maxScrollbarLength&&(e=Math.min(e,r.settings.maxScrollbarLength)),e}function kM(r,e){var t={width:e.railXWidth},i=Math.floor(r.scrollTop);e.isRtl?t.left=e.negativeScrollAdjustment+r.scrollLeft+e.containerWidth-e.contentWidth:t.left=r.scrollLeft,e.isScrollbarXUsingBottom?t.bottom=e.scrollbarXBottom-i:t.top=e.scrollbarXTop+i,At(e.scrollbarXRail,t);var n={top:i,height:e.railYHeight};e.isScrollbarYUsingRight?e.isRtl?n.right=e.contentWidth-(e.negativeScrollAdjustment+r.scrollLeft)-e.scrollbarYRight-e.scrollbarYOuterWidth-9:n.right=e.scrollbarYRight-r.scrollLeft:e.isRtl?n.left=e.negativeScrollAdjustment+r.scrollLeft+e.containerWidth*2-e.contentWidth-e.scrollbarYLeft-e.scrollbarYOuterWidth:n.left=e.scrollbarYLeft+r.scrollLeft,At(e.scrollbarYRail,n),At(e.scrollbarX,{left:e.scrollbarXLeft,width:e.scrollbarXWidth-e.railBorderXWidth}),At(e.scrollbarY,{top:e.scrollbarYTop,height:e.scrollbarYHeight-e.railBorderYWidth})}function NM(r){r.event.bind(r.scrollbarY,"mousedown",function(e){return e.stopPropagation()}),r.event.bind(r.scrollbarYRail,"mousedown",function(e){var t=e.pageY-window.pageYOffset-r.scrollbarYRail.getBoundingClientRect().top,i=t>r.scrollbarYTop?1:-1;r.element.scrollTop+=i*r.containerHeight,oi(r),e.stopPropagation()}),r.event.bind(r.scrollbarX,"mousedown",function(e){return e.stopPropagation()}),r.event.bind(r.scrollbarXRail,"mousedown",function(e){var t=e.pageX-window.pageXOffset-r.scrollbarXRail.getBoundingClientRect().left,i=t>r.scrollbarXLeft?1:-1;r.element.scrollLeft+=i*r.containerWidth,oi(r),e.stopPropagation()})}var Gc=null;function jM(r){bw(r,["containerHeight","contentHeight","pageY","railYHeight","scrollbarY","scrollbarYHeight","scrollTop","y","scrollbarYRail"]),bw(r,["containerWidth","contentWidth","pageX","railXWidth","scrollbarX","scrollbarXWidth","scrollLeft","x","scrollbarXRail"])}function bw(r,e){var t=e[0],i=e[1],n=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],p=e[8],l=r.element,d=null,f=null,g=null;function m(b){b.touches&&b.touches[0]&&(b[n]=b.touches[0]["page"+u.toUpperCase()]),Gc===o&&(l[c]=d+g*(b[n]-f),ww(r,u),oi(r),b.stopPropagation(),b.preventDefault())}function y(){_w(r,u),r[p].classList.remove(Oe.state.clicking),document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",y),document.removeEventListener("touchmove",m),document.removeEventListener("touchend",y),Gc=null}function w(b){Gc===null&&(Gc=o,d=l[c],b.touches&&(b[n]=b.touches[0]["page"+u.toUpperCase()]),f=b[n],g=(r[i]-r[t])/(r[s]-r[a]),b.touches?(document.addEventListener("touchmove",m,{passive:!1}),document.addEventListener("touchend",y)):(document.addEventListener("mousemove",m),document.addEventListener("mouseup",y)),r[p].classList.add(Oe.state.clicking)),b.stopPropagation(),b.cancelable&&b.preventDefault()}r[o].addEventListener("mousedown",w),r[o].addEventListener("touchstart",w)}function LM(r){var e=r.element,t=function(){return Mi(e,":hover")},i=function(){return Mi(r.scrollbarX,":focus")||Mi(r.scrollbarY,":focus")};function n(s,o){var a=Math.floor(e.scrollTop);if(s===0){if(!r.scrollbarYActive)return!1;if(a===0&&o>0||a>=r.contentHeight-r.containerHeight&&o<0)return!r.settings.wheelPropagation}var c=e.scrollLeft;if(o===0){if(!r.scrollbarXActive)return!1;if(c===0&&s<0||c>=r.contentWidth-r.containerWidth&&s>0)return!r.settings.wheelPropagation}return!0}r.event.bind(r.ownerDocument,"keydown",function(s){if(!(s.isDefaultPrevented&&s.isDefaultPrevented()||s.defaultPrevented)&&!(!t()&&!i())){var o=document.activeElement?document.activeElement:r.ownerDocument.activeElement;if(o){if(o.tagName==="IFRAME")o=o.contentDocument.activeElement;else for(;o.shadowRoot;)o=o.shadowRoot.activeElement;if(xM(o))return}var a=0,c=0;switch(s.which){case 37:s.metaKey?a=-r.contentWidth:s.altKey?a=-r.containerWidth:a=-30;break;case 38:s.metaKey?c=r.contentHeight:s.altKey?c=r.containerHeight:c=30;break;case 39:s.metaKey?a=r.contentWidth:s.altKey?a=r.containerWidth:a=30;break;case 40:s.metaKey?c=-r.contentHeight:s.altKey?c=-r.containerHeight:c=-30;break;case 32:s.shiftKey?c=r.containerHeight:c=-r.containerHeight;break;case 33:c=r.containerHeight;break;case 34:c=-r.containerHeight;break;case 36:c=r.contentHeight;break;case 35:c=-r.contentHeight;break;default:return}r.settings.suppressScrollX&&a!==0||r.settings.suppressScrollY&&c!==0||(e.scrollTop-=c,e.scrollLeft+=a,oi(r),n(a,c)&&s.preventDefault())}})}function qM(r){var e=r.element;function t(o,a){var c=Math.floor(e.scrollTop),u=e.scrollTop===0,p=c+e.offsetHeight===e.scrollHeight,l=e.scrollLeft===0,d=e.scrollLeft+e.offsetWidth===e.scrollWidth,f;return Math.abs(a)>Math.abs(o)?f=u||p:f=l||d,f?!r.settings.wheelPropagation:!0}function i(o){var a=o.deltaX,c=-1*o.deltaY;return(typeof a>"u"||typeof c>"u")&&(a=-1*o.wheelDeltaX/6,c=o.wheelDeltaY/6),o.deltaMode&&o.deltaMode===1&&(a*=10,c*=10),a!==a&&c!==c&&(a=0,c=o.wheelDelta),o.shiftKey?[-c,-a]:[a,c]}function n(o,a,c){if(!ys.isWebKit&&e.querySelector("select:focus"))return!0;if(!e.contains(o))return!1;for(var u=o;u&&u!==e;){if(u.classList.contains(Oe.element.consuming))return!0;var p=qr(u);if(c&&p.overflowY.match(/(scroll|auto)/)){var l=u.scrollHeight-u.clientHeight;if(l>0&&(u.scrollTop>0&&c<0||u.scrollTop<l&&c>0))return!0}if(a&&p.overflowX.match(/(scroll|auto)/)){var d=u.scrollWidth-u.clientWidth;if(d>0&&(u.scrollLeft>0&&a<0||u.scrollLeft<d&&a>0))return!0}u=u.parentNode}return!1}function s(o){var a=i(o),c=a[0],u=a[1];if(!n(o.target,c,u)){var p=!1;r.settings.useBothWheelAxes?r.scrollbarYActive&&!r.scrollbarXActive?(u?e.scrollTop-=u*r.settings.wheelSpeed:e.scrollTop+=c*r.settings.wheelSpeed,p=!0):r.scrollbarXActive&&!r.scrollbarYActive&&(c?e.scrollLeft+=c*r.settings.wheelSpeed:e.scrollLeft-=u*r.settings.wheelSpeed,p=!0):(e.scrollTop-=u*r.settings.wheelSpeed,e.scrollLeft+=c*r.settings.wheelSpeed),oi(r),p=p||t(c,u),p&&!o.ctrlKey&&(o.stopPropagation(),o.preventDefault())}}typeof window.onwheel<"u"?r.event.bind(e,"wheel",s):typeof window.onmousewheel<"u"&&r.event.bind(e,"mousewheel",s)}function zM(r){if(!ys.supportsTouch&&!ys.supportsIePointer)return;var e=r.element,t={startOffset:{},startTime:0,speed:{},easingLoop:null};function i(l,d){var f=Math.floor(e.scrollTop),g=e.scrollLeft,m=Math.abs(l),y=Math.abs(d);if(y>m){if(d<0&&f===r.contentHeight-r.containerHeight||d>0&&f===0)return window.scrollY===0&&d>0&&ys.isChrome}else if(m>y&&(l<0&&g===r.contentWidth-r.containerWidth||l>0&&g===0))return!0;return!0}function n(l,d){e.scrollTop-=d,e.scrollLeft-=l,oi(r)}function s(l){return l.targetTouches?l.targetTouches[0]:l}function o(l){return l.target===r.scrollbarX||l.target===r.scrollbarY||l.pointerType&&l.pointerType==="pen"&&l.buttons===0?!1:!!(l.targetTouches&&l.targetTouches.length===1||l.pointerType&&l.pointerType!=="mouse"&&l.pointerType!==l.MSPOINTER_TYPE_MOUSE)}function a(l){if(o(l)){var d=s(l);t.startOffset.pageX=d.pageX,t.startOffset.pageY=d.pageY,t.startTime=new Date().getTime(),t.easingLoop!==null&&clearInterval(t.easingLoop)}}function c(l,d,f){if(!e.contains(l))return!1;for(var g=l;g&&g!==e;){if(g.classList.contains(Oe.element.consuming))return!0;var m=qr(g);if(f&&m.overflowY.match(/(scroll|auto)/)){var y=g.scrollHeight-g.clientHeight;if(y>0&&(g.scrollTop>0&&f<0||g.scrollTop<y&&f>0))return!0}if(d&&m.overflowX.match(/(scroll|auto)/)){var w=g.scrollWidth-g.clientWidth;if(w>0&&(g.scrollLeft>0&&d<0||g.scrollLeft<w&&d>0))return!0}g=g.parentNode}return!1}function u(l){if(o(l)){var d=s(l),f={pageX:d.pageX,pageY:d.pageY},g=f.pageX-t.startOffset.pageX,m=f.pageY-t.startOffset.pageY;if(c(l.target,g,m))return;n(g,m),t.startOffset=f;var y=new Date().getTime(),w=y-t.startTime;w>0&&(t.speed.x=g/w,t.speed.y=m/w,t.startTime=y),i(g,m)&&l.cancelable&&l.preventDefault()}}function p(){r.settings.swipeEasing&&(clearInterval(t.easingLoop),t.easingLoop=setInterval(function(){if(r.isInitialized){clearInterval(t.easingLoop);return}if(!t.speed.x&&!t.speed.y){clearInterval(t.easingLoop);return}if(Math.abs(t.speed.x)<.01&&Math.abs(t.speed.y)<.01){clearInterval(t.easingLoop);return}n(t.speed.x*30,t.speed.y*30),t.speed.x*=.8,t.speed.y*=.8},10))}ys.supportsTouch?(r.event.bind(e,"touchstart",a),r.event.bind(e,"touchmove",u),r.event.bind(e,"touchend",p)):ys.supportsIePointer&&(window.PointerEvent?(r.event.bind(e,"pointerdown",a),r.event.bind(e,"pointermove",u),r.event.bind(e,"pointerup",p)):window.MSPointerEvent&&(r.event.bind(e,"MSPointerDown",a),r.event.bind(e,"MSPointerMove",u),r.event.bind(e,"MSPointerUp",p)))}var FM=function(){return{handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollingThreshold:1e3,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:!1,suppressScrollY:!1,swipeEasing:!0,useBothWheelAxes:!1,wheelPropagation:!0,wheelSpeed:1}},BM={"click-rail":NM,"drag-thumb":jM,keyboard:LM,wheel:qM,touch:zM},Jo=function(e,t){var i=this;if(t===void 0&&(t={}),typeof e=="string"&&(e=document.querySelector(e)),!e||!e.nodeName)throw new Error("no element is specified to initialize PerfectScrollbar");this.element=e,e.classList.add(Oe.main),this.settings=FM();for(var n in t)this.settings[n]=t[n];this.containerWidth=null,this.containerHeight=null,this.contentWidth=null,this.contentHeight=null;var s=function(){return e.classList.add(Oe.state.focus)},o=function(){return e.classList.remove(Oe.state.focus)};this.isRtl=qr(e).direction==="rtl",this.isRtl===!0&&e.classList.add(Oe.rtl),this.isNegativeScroll=function(){var u=e.scrollLeft,p=null;return e.scrollLeft=-1,p=e.scrollLeft<0,e.scrollLeft=u,p}(),this.negativeScrollAdjustment=this.isNegativeScroll?e.scrollWidth-e.clientWidth:0,this.event=new Cs,this.ownerDocument=e.ownerDocument||document,this.scrollbarXRail=$c(Oe.element.rail("x")),e.appendChild(this.scrollbarXRail),this.scrollbarX=$c(Oe.element.thumb("x")),this.scrollbarXRail.appendChild(this.scrollbarX),this.scrollbarX.setAttribute("tabindex",0),this.event.bind(this.scrollbarX,"focus",s),this.event.bind(this.scrollbarX,"blur",o),this.scrollbarXActive=null,this.scrollbarXWidth=null,this.scrollbarXLeft=null;var a=qr(this.scrollbarXRail);this.scrollbarXBottom=parseInt(a.bottom,10),isNaN(this.scrollbarXBottom)?(this.isScrollbarXUsingBottom=!1,this.scrollbarXTop=ye(a.top)):this.isScrollbarXUsingBottom=!0,this.railBorderXWidth=ye(a.borderLeftWidth)+ye(a.borderRightWidth),At(this.scrollbarXRail,{display:"block"}),this.railXMarginWidth=ye(a.marginLeft)+ye(a.marginRight),At(this.scrollbarXRail,{display:""}),this.railXWidth=null,this.railXRatio=null,this.scrollbarYRail=$c(Oe.element.rail("y")),e.appendChild(this.scrollbarYRail),this.scrollbarY=$c(Oe.element.thumb("y")),this.scrollbarYRail.appendChild(this.scrollbarY),this.scrollbarY.setAttribute("tabindex",0),this.event.bind(this.scrollbarY,"focus",s),this.event.bind(this.scrollbarY,"blur",o),this.scrollbarYActive=null,this.scrollbarYHeight=null,this.scrollbarYTop=null;var c=qr(this.scrollbarYRail);this.scrollbarYRight=parseInt(c.right,10),isNaN(this.scrollbarYRight)?(this.isScrollbarYUsingRight=!1,this.scrollbarYLeft=ye(c.left)):this.isScrollbarYUsingRight=!0,this.scrollbarYOuterWidth=this.isRtl?MM(this.scrollbarY):null,this.railBorderYWidth=ye(c.borderTopWidth)+ye(c.borderBottomWidth),At(this.scrollbarYRail,{display:"block"}),this.railYMarginHeight=ye(c.marginTop)+ye(c.marginBottom),At(this.scrollbarYRail,{display:""}),this.railYHeight=null,this.railYRatio=null,this.reach={x:e.scrollLeft<=0?"start":e.scrollLeft>=this.contentWidth-this.containerWidth?"end":null,y:e.scrollTop<=0?"start":e.scrollTop>=this.contentHeight-this.containerHeight?"end":null},this.isAlive=!0,this.settings.handlers.forEach(function(u){return BM[u](i)}),this.lastScrollTop=Math.floor(e.scrollTop),this.lastScrollLeft=e.scrollLeft,this.event.bind(this.element,"scroll",function(u){return i.onScroll(u)}),oi(this)};Jo.prototype.update=function(){this.isAlive&&(this.negativeScrollAdjustment=this.isNegativeScroll?this.element.scrollWidth-this.element.clientWidth:0,At(this.scrollbarXRail,{display:"block"}),At(this.scrollbarYRail,{display:"block"}),this.railXMarginWidth=ye(qr(this.scrollbarXRail).marginLeft)+ye(qr(this.scrollbarXRail).marginRight),this.railYMarginHeight=ye(qr(this.scrollbarYRail).marginTop)+ye(qr(this.scrollbarYRail).marginBottom),At(this.scrollbarXRail,{display:"none"}),At(this.scrollbarYRail,{display:"none"}),oi(this),Jc(this,"top",0,!1,!0),Jc(this,"left",0,!1,!0),At(this.scrollbarXRail,{display:""}),At(this.scrollbarYRail,{display:""}))};Jo.prototype.onScroll=function(e){this.isAlive&&(oi(this),Jc(this,"top",this.element.scrollTop-this.lastScrollTop),Jc(this,"left",this.element.scrollLeft-this.lastScrollLeft),this.lastScrollTop=Math.floor(this.element.scrollTop),this.lastScrollLeft=this.element.scrollLeft)};Jo.prototype.destroy=function(){this.isAlive&&(this.event.unbindAll(),Ss(this.scrollbarX),Ss(this.scrollbarY),Ss(this.scrollbarXRail),Ss(this.scrollbarYRail),this.removePsClasses(),this.element=null,this.scrollbarX=null,this.scrollbarY=null,this.scrollbarXRail=null,this.scrollbarYRail=null,this.isAlive=!1)};Jo.prototype.removePsClasses=function(){this.element.className=this.element.className.split(" ").filter(function(e){return!e.match(/^ps([-_].+|)$/)}).join(" ")};var Ew=Jo;function Iw(r){return class extends r{clone(t){let i=this.constructor;return Object.assign(new i,this,t)}}}var bs=class{context;conversation_id;content;role;id;constructor(){this.id=vw()}isUser(){return this.role==="user"}isAssistant(){return this.role==="assistant"}isError(){return this.role==="error"}};var Ps=class extends Iw(bs){constructor(t="",i="user"){super();this.content=t;this.role=i}end_turn;function_call;tool_calls};var Yc=class r{http=W(Ai);urlService=W(Oi);fb=W(pw);crawlWeb(e){let t=`${this.urlService.URLS.ADMIN}/crawler`;return this.http.post(t,e)}getContainers(){let e=`${this.urlService.URLS.ADMIN}/get-containers`;return this.http.get(e).pipe(Ae(t=>t.containers))}getSubfolder(e){let t=`${this.urlService.URLS.ADMIN}/get-subfolders/${e}`;return this.http.post(t,null).pipe(Ae(i=>i.subfolders))}deleteSubfolder(e,t){let i=`${this.urlService.URLS.ADMIN}/delete-subfolder`,n=new Tt().appendAll({container_name:e,subfolder_name:t});return this.http.delete(i,{params:n})}deleteByMetadata(e,t){let i=`${this.urlService.URLS.ADMIN}/delete-blob-by-metadata`,n=new Tt().appendAll({metadata_key:e,metadata_value:t});return this.http.delete(i,{params:n})}deleteByListOfTitles(e,t,i){let n=`${this.urlService.URLS.ADMIN}/delete-blob-by-list-of-titles`,s=new Tt().appendAll({container_name:e,subfolder_name:t});return this.http.delete(n,{params:s,body:i})}getBlobs(e,t){let i=`${this.urlService.URLS.ADMIN}/get-blobs/${e}`,n=new Tt().append("subfolder_name",t);return this.http.post(i,null,{params:n}).pipe(Ae(s=>s.blobs))}uploadBlobs(e,t){let i=`${this.urlService.URLS.ADMIN}/upload-blobs`,n=new Tt({fromObject:t}),s=new FormData;return e.forEach(o=>{s.append("files",o)}),this.http.post(i,s,{params:n})}getIndexInfo(e){let t=`${this.urlService.URLS.ADMIN}/index-info/${e}`;return this.http.get(t)}getIndexes(){let e=`${this.urlService.URLS.ADMIN}/indexes-name`;return this.http.get(e).pipe(Ae(t=>t.indexes))}resetIndex(e,t="chunk_id",i){let n=`${this.urlService.URLS.ADMIN}/reset-index/${e}`,s=new Tt;return i&&(s=new Tt().append("key",t).append("value",i)),this.http.post(n,null,{params:s})}runIndexer(e){let t=`${this.urlService.URLS.ADMIN}/run-indexer/${e}`;return this.http.post(t,null)}secureUrl(e){let t=`${this.urlService.URLS.ADMIN}/sas-token`,i=new Tt().append("blob_url",e);return this.http.get(t,{params:i})}createUrlGroup(){return this.fb.group({link:this.fb.control(""),headers:this.fb.array([]),cookies:this.fb.array([]),payload:this.fb.array([]),settings:this.createSettingsGroup()})}createSettingsGroup(){return this.fb.group({deep:this.fb.control(!1),selectors:this.fb.control([]),mediaCrawling:this.fb.control(!1),containerName:this.fb.control("rera-storage")})}getReportsCount(){let e=`${this.urlService.URLS.ADMIN}/get-blobs/rera-media-reports`;return this.http.post(e,null).pipe(Ae(t=>t.blobs.length))}getUrlsCount(){let e=`${this.urlService.URLS.ADMIN}/get-blobs/rera-media`;return this.http.post(e,null).pipe(Ae(t=>t.blobs.length))}getCrawlingStatistics(){let e=`${this.urlService.URLS.ADMIN}/get-subfolders-blobs/rera-media`;return this.http.get(e)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=Ft({token:r,factory:r.\u0275fac,providedIn:"root"})};var Qc=class r{http=W(Ai);urlService=W(Oi);adminService=W(Yc);store=W(Lr);sendMessage(e,t){let i=`${this.urlService.URLS.CHAT}/${t}`;return this.messages.update(n=>[...n,new Ps(e,"user")]),this.http.post(i,mr(mr({messages:this.messages()},this.store.streamId()?{stream_id:this.store.streamId()}:null),this.conversationId()?{conversation_id:this.conversationId()}:null)).pipe(ln(n=>{throw new Ps().clone({content:n.message,role:"error"}),new Error(n)}),Ae(n=>(n.message.content=Uc(Wc(n.message.content,n.message)),n.message=new Ps().clone(n.message),this.conversationId.set(n.message.conversation_id),this.messages.update(s=>[...s,n.message]),n)))}processFormattedText(e){let t=[...e.matchAll(/href="(.*?)"/g)];if(t.length===0)return console.log("No matches found in formatted text."),os(e);let i=t.map(n=>{let s=n[1];return s.includes("blob.core.windows.net")?this.adminService.secureUrl(s).pipe(Ae(o=>({match:n[0],replacement:n[0].replace(s,o)})),ln(()=>os({match:n[0],replacement:n[0]}))):os({match:n[0],replacement:n[0]})});return kP(i).pipe(Ae(n=>(n.forEach(({match:s,replacement:o})=>{e=e.replace(s,o)}),e)))}static \u0275fac=function(t){return new(t||r)};static \u0275prov=Ft({token:r,factory:r.\u0275fac,providedIn:"root"})};var ws=class r extends Qc{messages=vt([]);status=vt(!1);conversationId=vt("");botNameCtrl=new sw("",{nonNullable:!0});onBotNameChange(){return this.botNameCtrl.valueChanges.pipe(LP(),wt(()=>{this.conversationId.set(""),this.messages.set([])}))}static \u0275fac=(()=>{let e;return function(i){return(e||(e=us(r)))(i||r)}})();static \u0275prov=Ft({token:r,factory:r.\u0275fac,providedIn:"root"})};var Xc=class r{constructor(e){this.elementRef=e}text="";speed=2;stop=!1;animating=new si;ngOnInit(){this.animateText()}animateText(){this.animating.emit(!0);let e=0,t="",i=()=>{if(this.stop){this.animating.emit(!1);return}t+=this.text.charAt(e),this.elementRef.nativeElement.innerHTML=t,e++,e<this.text.length?setTimeout(i,this.speed*Math.random()):this.animating.emit(!1)};i()}static \u0275fac=function(t){return new(t||r)(Ze(dn))};static \u0275dir=Fo({type:r,selectors:[["","appTextWriterAnimator",""]],inputs:{text:"text",speed:"speed",stop:"stop"},outputs:{animating:"animating"},standalone:!0})};var UM=["container"],WM=(r,e)=>e.id,HM=(r,e)=>({"mdi-chevron-down":r,"mdi-chevron-up":e});function VM(r,e){if(r&1){let t=Ii();N(0,"div",7),It("animating",function(n){_t(t);let s=et(2);return Rt(s.animationStatus.set(n))}),F()}if(r&2){let t=et().$implicit;pe("text",t.content)}}function $M(r,e){if(r&1&&de(0,"div",6),r&2){let t=et().$implicit;pe("innerHtml",t.content,BP)}}function KM(r,e){if(r&1&&(N(0,"div",12)(1,"div",13)(2,"small",14),_e(3),de(4,"i",15),F()(),N(5,"a",16),_e(6),F()()),r&2){let t=e.$implicit,i=e.$index;q(3),ds(" doc ",i+1," "),q(3),Bt(t.filepath)}}function GM(r,e){if(r&1){let t=Ii();N(0,"div")(1,"div",8),It("click",function(){_t(t);let n=hs(6);return Rt(n.hidden=!n.hidden)}),de(2,"i",9),N(3,"span",10),_e(4,"References"),F()(),N(5,"div",11,1),Ho(7,KM,7,2,"div",12,Dc),F()()}if(r&2){let t=hs(6),i=et().$implicit;q(2),pe("ngClass",Ti(1,HM,t.hidden,!t.hidden)),q(5),Vo(i.context.citations)}}function JM(r,e){if(r&1&&(N(0,"div"),jr(1,VM,1,1,"div",5)(2,$M,1,1,"div",6)(3,GM,9,4,"div"),F()),r&2){let t=e.$implicit;VP("message ",t.role,""),q(),Et(t.role==="assistant"?1:2),q(2),Et(t.context&&t.context.citations.length?3:-1)}}var Zc=class r{container=fn.required("container");injector=W(ps);service=W(ws);animationStatus=vt(!1);ngOnInit(){kc(()=>{new Ew(this.container().nativeElement,{})},{injector:this.injector})}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=Qt({type:r,selectors:[["app-overlay-chat"]],viewQuery:function(t,i){t&1&&vn(i.container,UM,5),t&2&&ls()},standalone:!0,features:[Xt],decls:5,vars:0,consts:[["container",""],["linkRef",""],["id","chat-container",1,"flex","flex-col","bg-black/40","max-h-80","w-screen","absolute","overflow-hidden","bottom-0","left-0"],[1,"min-h-0","px-6","py-6","flex-auto","flex","flex-col","w-full","h-full","relative","overflow-hidden","space-y-4","[&>.message.user]:justify-end","[&>.message]:text-white"],[3,"class"],["appTextWriterAnimator","",1,"whitespace-pre-wrap","break-words",3,"text"],[1,"whitespace-pre-wrap","break-words",3,"innerHtml"],["appTextWriterAnimator","",1,"whitespace-pre-wrap","break-words",3,"animating","text"],[1,"icon-with-title",3,"click"],[1,"mdi",3,"ngClass"],[1,"title"],["hidden",""],["dir","auto"],[1,"d-inline"],[1,"px-1","text-primary"],[1,"mdi","mdi-link-variant"],[1,"d-inline","citation-link",2,"cursor","pointer"]],template:function(t,i){t&1&&(N(0,"div",2)(1,"div",3,0),Ho(3,JM,4,5,"div",4,WM),F()()),t&2&&(q(3),Vo(i.service.messages()))},dependencies:[vs,Xc],styles:['.message[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;font-size:1.875rem;line-height:2.25rem}.message.user[_ngcontent-%COMP%]{align-items:flex-end}.message.user[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-radius:.375rem;border-top-right-radius:0;background-color:#00000080;padding:.5rem}.message.user[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{content:"";position:absolute;right:-12px;top:0;width:12px;height:12px;clip-path:polygon(0 0,100% 0,0 100%);background-color:inherit}.message.assistant[_ngcontent-%COMP%]{align-items:flex-start}.message.assistant[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-radius:.375rem;border-top-left-radius:0;background-color:#0003;padding:.5rem}.message.assistant[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{content:"";position:absolute;left:-12px;top:0;background-color:inherit;width:12px;height:12px;clip-path:polygon(0 0,100% 0,100% 100%)}']})};function Ww(r){let e=r.cloneNode(!0),t=e.querySelectorAll("[id]"),i=r.nodeName.toLowerCase();e.removeAttribute("id");for(let n=0;n<t.length;n++)t[n].removeAttribute("id");return i==="canvas"?Ow(r,e):(i==="input"||i==="select"||i==="textarea")&&Aw(r,e),Tw("canvas",r,e,Ow),Tw("input, textarea, select",r,e,Aw),e}function Tw(r,e,t,i){let n=e.querySelectorAll(r);if(n.length){let s=t.querySelectorAll(r);for(let o=0;o<n.length;o++)i(n[o],s[o])}}var YM=0;function Aw(r,e){e.type!=="file"&&(e.value=r.value),e.type==="radio"&&e.name&&(e.name=`mat-clone-${e.name}-${YM++}`)}function Ow(r,e){let t=e.getContext("2d");if(t)try{t.drawImage(r,0,0)}catch{}}function av(r){let e=r.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}function tv(r,e,t){let{top:i,bottom:n,left:s,right:o}=r;return t>=i&&t<=n&&e>=s&&e<=o}function Qo(r,e,t){r.top+=e,r.bottom=r.top+r.height,r.left+=t,r.right=r.left+r.width}function Dw(r,e,t,i){let{top:n,right:s,bottom:o,left:a,width:c,height:u}=r,p=c*e,l=u*e;return i>n-l&&i<o+l&&t>a-p&&t<s+p}var iu=class{constructor(e){this._document=e,this.positions=new Map}clear(){this.positions.clear()}cache(e){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),e.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:av(t)})})}handleScroll(e){let t=Ko(e),i=this.positions.get(t);if(!i)return null;let n=i.scrollPosition,s,o;if(t===this._document){let u=this.getViewportScrollPosition();s=u.top,o=u.left}else s=t.scrollTop,o=t.scrollLeft;let a=n.top-s,c=n.left-o;return this.positions.forEach((u,p)=>{u.clientRect&&t!==p&&t.contains(p)&&Qo(u.clientRect,a,c)}),n.top=s,n.left=o,{top:a,left:c}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function Hw(r,e){let t=r.rootNodes;if(t.length===1&&t[0].nodeType===e.ELEMENT_NODE)return t[0];let i=e.createElement("div");return t.forEach(n=>i.appendChild(n)),i}function cv(r,e,t){for(let i in e)if(e.hasOwnProperty(i)){let n=e[i];n?r.setProperty(i,n,t?.has(i)?"important":""):r.removeProperty(i)}return r}function _s(r,e){let t=e?"":"none";cv(r.style,{"touch-action":e?"":"none","-webkit-user-drag":e?"":"none","-webkit-tap-highlight-color":e?"":"transparent","user-select":t,"-ms-user-select":t,"-webkit-user-select":t,"-moz-user-select":t})}function xw(r,e,t){cv(r.style,{position:e?"":"fixed",top:e?"":"0",opacity:e?"":"0",left:e?"":"-999em"},t)}function nu(r,e){return e&&e!="none"?r+" "+e:r}function Mw(r,e){r.style.width=`${e.width}px`,r.style.height=`${e.height}px`,r.style.transform=su(e.left,e.top)}function su(r,e){return`translate3d(${Math.round(r)}px, ${Math.round(e)}px, 0)`}function kw(r){let e=r.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(r)*e}function QM(r){let e=getComputedStyle(r),t=ev(e,"transition-property"),i=t.find(a=>a==="transform"||a==="all");if(!i)return 0;let n=t.indexOf(i),s=ev(e,"transition-duration"),o=ev(e,"transition-delay");return kw(s[n])+kw(o[n])}function ev(r,e){return r.getPropertyValue(e).split(",").map(i=>i.trim())}var XM=new Set(["position"]),rv=class{get element(){return this._preview}constructor(e,t,i,n,s,o,a,c,u){this._document=e,this._rootElement=t,this._direction=i,this._initialDomRect=n,this._previewTemplate=s,this._previewClass=o,this._pickupPositionOnPage=a,this._initialTransform=c,this._zIndex=u}attach(e){this._preview=this._createPreview(),e.appendChild(this._preview),Nw(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(e){this._preview.style.transform=e}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(e){this._preview.classList.add(e)}getTransitionDuration(){return QM(this._preview)}addEventListener(e,t){this._preview.addEventListener(e,t)}removeEventListener(e,t){this._preview.removeEventListener(e,t)}_createPreview(){let e=this._previewTemplate,t=this._previewClass,i=e?e.template:null,n;if(i&&e){let s=e.matchSize?this._initialDomRect:null,o=e.viewContainer.createEmbeddedView(i,e.context);o.detectChanges(),n=Hw(o,this._document),this._previewEmbeddedView=o,e.matchSize?Mw(n,s):n.style.transform=su(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else n=Ww(this._rootElement),Mw(n,this._initialDomRect),this._initialTransform&&(n.style.transform=this._initialTransform);return cv(n.style,{"pointer-events":"none",margin:Nw(n)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},XM),_s(n,!1),n.classList.add("cdk-drag-preview"),n.setAttribute("popover","manual"),n.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(s=>n.classList.add(s)):n.classList.add(t)),n}};function Nw(r){return"showPopover"in r}var jw=$o({passive:!0}),eu=$o({passive:!1}),Lw=$o({passive:!1,capture:!0}),ZM=800,qw=new Set(["position"]),iv=class{get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(e){e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions(),this._handles.forEach(t=>_s(t,e)))}constructor(e,t,i,n,s,o){this._config=t,this._document=i,this._ngZone=n,this._viewportRuler=s,this._dragDropRegistry=o,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=vt(!1),this._moveEvents=new ue,this._pointerMoveSubscription=ss.EMPTY,this._pointerUpSubscription=ss.EMPTY,this._scrollSubscription=ss.EMPTY,this._resizeSubscription=ss.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this.scale=1,this._disabled=!1,this.beforeStarted=new ue,this.started=new ue,this.released=new ue,this.ended=new ue,this.entered=new ue,this.exited=new ue,this.dropped=new ue,this.moved=this._moveEvents,this._pointerDown=a=>{if(this.beforeStarted.next(),this._handles.length){let c=this._getTargetHandle(a);c&&!this._disabledHandles.has(c)&&!this.disabled&&this._initializeDragSequence(c,a)}else this.disabled||this._initializeDragSequence(this._rootElement,a)},this._pointerMove=a=>{let c=this._getPointerPositionOnPage(a);if(!this._hasStartedDragging()){let p=Math.abs(c.x-this._pickupPositionOnPage.x),l=Math.abs(c.y-this._pickupPositionOnPage.y);if(p+l>=this._config.dragStartThreshold){let f=Date.now()>=this._dragStartTime+this._getDragStartDelay(a),g=this._dropContainer;if(!f){this._endDragSequence(a);return}(!g||!g.isDragging()&&!g.isReceiving())&&(a.cancelable&&a.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(a)))}return}a.cancelable&&a.preventDefault();let u=this._getConstrainedPointerPosition(c);if(this._hasMoved=!0,this._lastKnownPointerPosition=c,this._updatePointerDirectionDelta(u),this._dropContainer)this._updateActiveDropContainer(u,c);else{let p=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,l=this._activeTransform;l.x=u.x-p.x+this._passiveTransform.x,l.y=u.y-p.y+this._passiveTransform.y,this._applyRootElementTransform(l.x,l.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:u,event:a,distance:this._getDragDistance(u),delta:this._pointerDirectionDelta})})},this._pointerUp=a=>{this._endDragSequence(a)},this._nativeDragStart=a=>{if(this._handles.length){let c=this._getTargetHandle(a);c&&!this._disabledHandles.has(c)&&!this.disabled&&a.preventDefault()}else this.disabled||a.preventDefault()},this.withRootElement(e).withParent(t.parentDragRef||null),this._parentPositions=new iu(i),o.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(e){this._handles=e.map(i=>Di(i)),this._handles.forEach(i=>_s(i,this.disabled)),this._toggleNativeDragInteractions();let t=new Set;return this._disabledHandles.forEach(i=>{this._handles.indexOf(i)>-1&&t.add(i)}),this._disabledHandles=t,this}withPreviewTemplate(e){return this._previewTemplate=e,this}withPlaceholderTemplate(e){return this._placeholderTemplate=e,this}withRootElement(e){let t=Di(e);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,eu),t.addEventListener("touchstart",this._pointerDown,jw),t.addEventListener("dragstart",this._nativeDragStart,eu)}),this._initialTransform=void 0,this._rootElement=t),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(e){return this._boundaryElement=e?Di(e):null,this._resizeSubscription.unsubscribe(),e&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(e){return this._parentDragRef=e,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(e){!this._disabledHandles.has(e)&&this._handles.indexOf(e)>-1&&(this._disabledHandles.add(e),_s(e,!0))}enableHandle(e){this._disabledHandles.has(e)&&(this._disabledHandles.delete(e),_s(e,this.disabled))}withDirection(e){return this._direction=e,this}_withDropContainer(e){this._dropContainer=e}getFreeDragPosition(){let e=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:e.x,y:e.y}}setFreeDragPosition(e){return this._activeTransform={x:0,y:0},this._passiveTransform.x=e.x,this._passiveTransform.y=e.y,this._dropContainer||this._applyRootElementTransform(e.x,e.y),this}withPreviewContainer(e){return this._previewContainer=e,this}_sortFromLastPointerPosition(){let e=this._lastKnownPointerPosition;e&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(e),e)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._getShadowRoot()?.removeEventListener("selectstart",Fw,Lw)}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(e){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:e}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(e),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let t=this._getPointerPositionOnPage(e);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(t),dropPoint:t,event:e})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(e){Yo(e)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let t=this._getShadowRoot(),i=this._dropContainer;if(t&&this._ngZone.runOutsideAngular(()=>{t.addEventListener("selectstart",Fw,Lw)}),i){let n=this._rootElement,s=n.parentNode,o=this._placeholder=this._createPlaceholderElement(),a=this._anchor=this._anchor||this._document.createComment("");s.insertBefore(a,n),this._initialTransform=n.style.transform||"",this._preview=new rv(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3),this._preview.attach(this._getPreviewInsertionPoint(s,t)),xw(n,!1,qw),this._document.body.appendChild(s.replaceChild(o,n)),this.started.next({source:this,event:e}),i.start(),this._initialContainer=i,this._initialIndex=i.getItemIndex(this)}else this.started.next({source:this,event:e}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(i?i.getScrollableParents():[])}_initializeDragSequence(e,t){this._parentDragRef&&t.stopPropagation();let i=this.isDragging(),n=Yo(t),s=!n&&t.button!==0,o=this._rootElement,a=Ko(t),c=!n&&this._lastTouchEventTime&&this._lastTouchEventTime+ZM>Date.now(),u=n?XP(t):QP(t);if(a&&a.draggable&&t.type==="mousedown"&&t.preventDefault(),i||s||c||u)return;if(this._handles.length){let d=o.style;this._rootElementTapHighlight=d.webkitTapHighlightColor||"",d.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(d=>this._updateOnScroll(d)),this._boundaryElement&&(this._boundaryRect=av(this._boundaryElement));let p=this._previewTemplate;this._pickupPositionInElement=p&&p.template&&!p.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,e,t);let l=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:l.x,y:l.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(e){xw(this._rootElement,!0,qw),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let t=this._dropContainer,i=t.getItemIndex(this),n=this._getPointerPositionOnPage(e),s=this._getDragDistance(n),o=t._isOverContainer(n.x,n.y);this.ended.next({source:this,distance:s,dropPoint:n,event:e}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:o,distance:s,dropPoint:n,event:e}),t.drop(this,i,this._initialIndex,this._initialContainer,o,s,n,e),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:e,y:t},{x:i,y:n}){let s=this._initialContainer._getSiblingContainerFromPosition(this,e,t);!s&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(e,t)&&(s=this._initialContainer),s&&s!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=s,this._dropContainer.enter(this,e,t,s===this._initialContainer&&s.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:s,currentIndex:s.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(i,n),this._dropContainer._sortItem(this,e,t,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(e,t):this._applyPreviewTransform(e-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let e=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(e.left,e.top);let t=this._preview.getTransitionDuration();return t===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(i=>{let n=o=>{(!o||this._preview&&Ko(o)===this._preview.element&&o.propertyName==="transform")&&(this._preview?.removeEventListener("transitionend",n),i(),clearTimeout(s))},s=setTimeout(n,t*1.5);this._preview.addEventListener("transitionend",n)}))}_createPlaceholderElement(){let e=this._placeholderTemplate,t=e?e.template:null,i;return t?(this._placeholderRef=e.viewContainer.createEmbeddedView(t,e.context),this._placeholderRef.detectChanges(),i=Hw(this._placeholderRef,this._document)):i=Ww(this._rootElement),i.style.pointerEvents="none",i.classList.add("cdk-drag-placeholder"),i}_getPointerPositionInElement(e,t,i){let n=t===this._rootElement?null:t,s=n?n.getBoundingClientRect():e,o=Yo(i)?i.targetTouches[0]:i,a=this._getViewportScrollPosition(),c=o.pageX-s.left-a.left,u=o.pageY-s.top-a.top;return{x:s.left-e.left+c,y:s.top-e.top+u}}_getPointerPositionOnPage(e){let t=this._getViewportScrollPosition(),i=Yo(e)?e.touches[0]||e.changedTouches[0]||{pageX:0,pageY:0}:e,n=i.pageX-t.left,s=i.pageY-t.top;if(this._ownerSVGElement){let o=this._ownerSVGElement.getScreenCTM();if(o){let a=this._ownerSVGElement.createSVGPoint();return a.x=n,a.y=s,a.matrixTransform(o.inverse())}}return{x:n,y:s}}_getConstrainedPointerPosition(e){let t=this._dropContainer?this._dropContainer.lockAxis:null,{x:i,y:n}=this.constrainPosition?this.constrainPosition(e,this,this._initialDomRect,this._pickupPositionInElement):e;if(this.lockAxis==="x"||t==="x"?n=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||t==="y")&&(i=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:s,y:o}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,a=this._boundaryRect,{width:c,height:u}=this._getPreviewRect(),p=a.top+o,l=a.bottom-(u-o),d=a.left+s,f=a.right-(c-s);i=zw(i,d,f),n=zw(n,p,l)}return{x:i,y:n}}_updatePointerDirectionDelta(e){let{x:t,y:i}=e,n=this._pointerDirectionDelta,s=this._pointerPositionAtLastDirectionChange,o=Math.abs(t-s.x),a=Math.abs(i-s.y);return o>this._config.pointerDirectionChangeThreshold&&(n.x=t>s.x?1:-1,s.x=t),a>this._config.pointerDirectionChangeThreshold&&(n.y=i>s.y?1:-1,s.y=i),n}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let e=this._handles.length>0||!this.isDragging();e!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=e,_s(this._rootElement,e))}_removeRootElementListeners(e){e.removeEventListener("mousedown",this._pointerDown,eu),e.removeEventListener("touchstart",this._pointerDown,jw),e.removeEventListener("dragstart",this._nativeDragStart,eu)}_applyRootElementTransform(e,t){let i=1/this.scale,n=su(e*i,t*i),s=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=s.transform&&s.transform!="none"?s.transform:""),s.transform=nu(n,this._initialTransform)}_applyPreviewTransform(e,t){let i=this._previewTemplate?.template?void 0:this._initialTransform,n=su(e,t);this._preview.setTransform(nu(n,i))}_getDragDistance(e){let t=this._pickupPositionOnPage;return t?{x:e.x-t.x,y:e.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:e,y:t}=this._passiveTransform;if(e===0&&t===0||this.isDragging()||!this._boundaryElement)return;let i=this._rootElement.getBoundingClientRect(),n=this._boundaryElement.getBoundingClientRect();if(n.width===0&&n.height===0||i.width===0&&i.height===0)return;let s=n.left-i.left,o=i.right-n.right,a=n.top-i.top,c=i.bottom-n.bottom;n.width>i.width?(s>0&&(e+=s),o>0&&(e-=o)):e=0,n.height>i.height?(a>0&&(t+=a),c>0&&(t-=c)):t=0,(e!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:e})}_getDragStartDelay(e){let t=this.dragStartDelay;return typeof t=="number"?t:Yo(e)?t.touch:t?t.mouse:0}_updateOnScroll(e){let t=this._parentPositions.handleScroll(e);if(t){let i=Ko(e);this._boundaryRect&&i!==this._boundaryElement&&i.contains(this._boundaryElement)&&Qo(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=Lc(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(e,t){let i=this._previewContainer||"global";if(i==="parent")return e;if(i==="global"){let n=this._document;return t||n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement||n.msFullscreenElement||n.body}return Di(i)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_getTargetHandle(e){return this._handles.find(t=>e.target&&(e.target===t||t.contains(e.target)))}};function zw(r,e,t){return Math.max(e,Math.min(t,r))}function Yo(r){return r.type[0]==="t"}function Fw(r){r.preventDefault()}function Vw(r,e,t){let i=Bw(e,r.length-1),n=Bw(t,r.length-1);if(i===n)return;let s=r[i],o=n<i?-1:1;for(let a=i;a!==n;a+=o)r[a]=r[a+o];r[n]=s}function Bw(r,e){return Math.max(0,Math.min(e,r))}var ou=class{constructor(e){this._dragDropRegistry=e,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(e){this.withItems(e)}sort(e,t,i,n){let s=this._itemPositions,o=this._getItemIndexFromPointerPosition(e,t,i,n);if(o===-1&&s.length>0)return null;let a=this.orientation==="horizontal",c=s.findIndex(y=>y.drag===e),u=s[o],p=s[c].clientRect,l=u.clientRect,d=c>o?1:-1,f=this._getItemOffsetPx(p,l,d),g=this._getSiblingOffsetPx(c,s,d),m=s.slice();return Vw(s,c,o),s.forEach((y,w)=>{if(m[w]===y)return;let b=y.drag===e,C=b?f:g,R=b?e.getPlaceholderElement():y.drag.getRootElement();y.offset+=C;let A=Math.round(y.offset*(1/y.drag.scale));a?(R.style.transform=nu(`translate3d(${A}px, 0, 0)`,y.initialTransform),Qo(y.clientRect,0,C)):(R.style.transform=nu(`translate3d(0, ${A}px, 0)`,y.initialTransform),Qo(y.clientRect,C,0))}),this._previousSwap.overlaps=tv(l,t,i),this._previousSwap.drag=u.drag,this._previousSwap.delta=a?n.x:n.y,{previousIndex:c,currentIndex:o}}enter(e,t,i,n){let s=n==null||n<0?this._getItemIndexFromPointerPosition(e,t,i):n,o=this._activeDraggables,a=o.indexOf(e),c=e.getPlaceholderElement(),u=o[s];if(u===e&&(u=o[s+1]),!u&&(s==null||s===-1||s<o.length-1)&&this._shouldEnterAsFirstChild(t,i)&&(u=o[0]),a>-1&&o.splice(a,1),u&&!this._dragDropRegistry.isDragging(u)){let p=u.getRootElement();p.parentElement.insertBefore(c,p),o.splice(s,0,e)}else this._element.appendChild(c),o.push(e);c.style.transform="",this._cacheItemPositions()}withItems(e){this._activeDraggables=e.slice(),this._cacheItemPositions()}withSortPredicate(e){this._sortPredicate=e}reset(){this._activeDraggables?.forEach(e=>{let t=e.getRootElement();if(t){let i=this._itemPositions.find(n=>n.drag===e)?.initialTransform;t.style.transform=i||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(e){return(this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions).findIndex(i=>i.drag===e)}updateOnScroll(e,t){this._itemPositions.forEach(({clientRect:i})=>{Qo(i,e,t)}),this._itemPositions.forEach(({drag:i})=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})}withElementContainer(e){this._element=e}_cacheItemPositions(){let e=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(t=>{let i=t.getVisibleElement();return{drag:t,offset:0,initialTransform:i.style.transform||"",clientRect:av(i)}}).sort((t,i)=>e?t.clientRect.left-i.clientRect.left:t.clientRect.top-i.clientRect.top)}_getItemOffsetPx(e,t,i){let n=this.orientation==="horizontal",s=n?t.left-e.left:t.top-e.top;return i===-1&&(s+=n?t.width-e.width:t.height-e.height),s}_getSiblingOffsetPx(e,t,i){let n=this.orientation==="horizontal",s=t[e].clientRect,o=t[e+i*-1],a=s[n?"width":"height"]*i;if(o){let c=n?"left":"top",u=n?"right":"bottom";i===-1?a-=o.clientRect[c]-s[u]:a+=s[c]-o.clientRect[u]}return a}_shouldEnterAsFirstChild(e,t){if(!this._activeDraggables.length)return!1;let i=this._itemPositions,n=this.orientation==="horizontal";if(i[0].drag!==this._activeDraggables[0]){let o=i[i.length-1].clientRect;return n?e>=o.right:t>=o.bottom}else{let o=i[0].clientRect;return n?e<=o.left:t<=o.top}}_getItemIndexFromPointerPosition(e,t,i,n){let s=this.orientation==="horizontal",o=this._itemPositions.findIndex(({drag:a,clientRect:c})=>{if(a===e)return!1;if(n){let u=s?n.x:n.y;if(a===this._previousSwap.drag&&this._previousSwap.overlaps&&u===this._previousSwap.delta)return!1}return s?t>=Math.floor(c.left)&&t<Math.floor(c.right):i>=Math.floor(c.top)&&i<Math.floor(c.bottom)});return o===-1||!this._sortPredicate(o,e)?-1:o}},nv=class{constructor(e,t){this._document=e,this._dragDropRegistry=t,this._previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1},this._relatedNodes=[]}start(e){let t=this._element.childNodes;this._relatedNodes=[];for(let i=0;i<t.length;i++){let n=t[i];this._relatedNodes.push([n,n.nextSibling])}this.withItems(e)}sort(e,t,i,n){let s=this._getItemIndexFromPointerPosition(e,t,i),o=this._previousSwap;if(s===-1||this._activeItems[s]===e)return null;let a=this._activeItems[s];if(o.drag===a&&o.overlaps&&o.deltaX===n.x&&o.deltaY===n.y)return null;let c=this.getItemIndex(e),u=e.getPlaceholderElement(),p=a.getRootElement();s>c?p.after(u):p.before(u),Vw(this._activeItems,c,s);let l=this._getRootNode().elementFromPoint(t,i);return o.deltaX=n.x,o.deltaY=n.y,o.drag=a,o.overlaps=p===l||p.contains(l),{previousIndex:c,currentIndex:s}}enter(e,t,i,n){let s=n==null||n<0?this._getItemIndexFromPointerPosition(e,t,i):n;s===-1&&(s=this._getClosestItemIndexToPointer(e,t,i));let o=this._activeItems[s],a=this._activeItems.indexOf(e);a>-1&&this._activeItems.splice(a,1),o&&!this._dragDropRegistry.isDragging(o)?(this._activeItems.splice(s,0,e),o.getRootElement().before(e.getPlaceholderElement())):(this._activeItems.push(e),this._element.appendChild(e.getPlaceholderElement()))}withItems(e){this._activeItems=e.slice()}withSortPredicate(e){this._sortPredicate=e}reset(){let e=this._element,t=this._previousSwap;for(let i=this._relatedNodes.length-1;i>-1;i--){let[n,s]=this._relatedNodes[i];n.parentNode===e&&n.nextSibling!==s&&(s===null?e.appendChild(n):s.parentNode===e&&e.insertBefore(n,s))}this._relatedNodes=[],this._activeItems=[],t.drag=null,t.deltaX=t.deltaY=0,t.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(e){return this._activeItems.indexOf(e)}updateOnScroll(){this._activeItems.forEach(e=>{this._dragDropRegistry.isDragging(e)&&e._sortFromLastPointerPosition()})}withElementContainer(e){e!==this._element&&(this._element=e,this._rootNode=void 0)}_getItemIndexFromPointerPosition(e,t,i){let n=this._getRootNode().elementFromPoint(Math.floor(t),Math.floor(i)),s=n?this._activeItems.findIndex(o=>{let a=o.getRootElement();return n===a||a.contains(n)}):-1;return s===-1||!this._sortPredicate(s,e)?-1:s}_getRootNode(){return this._rootNode||(this._rootNode=Lc(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(e,t,i){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let n=1/0,s=-1;for(let o=0;o<this._activeItems.length;o++){let a=this._activeItems[o];if(a!==e){let{x:c,y:u}=a.getRootElement().getBoundingClientRect(),p=Math.hypot(t-c,i-u);p<n&&(n=p,s=o)}}return s}},Uw=.05,$w=.05,Zt=function(r){return r[r.NONE=0]="NONE",r[r.UP=1]="UP",r[r.DOWN=2]="DOWN",r}(Zt||{}),gt=function(r){return r[r.NONE=0]="NONE",r[r.LEFT=1]="LEFT",r[r.RIGHT=2]="RIGHT",r}(gt||{}),sv=class{constructor(e,t,i,n,s){this._dragDropRegistry=t,this._ngZone=n,this._viewportRuler=s,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new ue,this.entered=new ue,this.exited=new ue,this.dropped=new ue,this.sorted=new ue,this.receivingStarted=new ue,this.receivingStopped=new ue,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=ss.EMPTY,this._verticalScrollDirection=Zt.NONE,this._horizontalScrollDirection=gt.NONE,this._stopScrollTimers=new ue,this._cachedShadowRoot=null,this._scrollableElements=[],this._direction="ltr",this._startScrollInterval=()=>{this._stopScrolling(),NP(0,MP).pipe(Nr(this._stopScrollTimers)).subscribe(()=>{let a=this._scrollNode,c=this.autoScrollStep;this._verticalScrollDirection===Zt.UP?a.scrollBy(0,-c):this._verticalScrollDirection===Zt.DOWN&&a.scrollBy(0,c),this._horizontalScrollDirection===gt.LEFT?a.scrollBy(-c,0):this._horizontalScrollDirection===gt.RIGHT&&a.scrollBy(c,0)})};let o=this.element=Di(e);this._document=i,this.withOrientation("vertical").withElementContainer(o),t.registerDropContainer(this),this._parentPositions=new iu(i)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(e,t,i,n){this._draggingStarted(),n==null&&this.sortingDisabled&&(n=this._draggables.indexOf(e)),this._sortStrategy.enter(e,t,i,n),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:e,container:this,currentIndex:this.getItemIndex(e)})}exit(e){this._reset(),this.exited.next({item:e,container:this})}drop(e,t,i,n,s,o,a,c={}){this._reset(),this.dropped.next({item:e,currentIndex:t,previousIndex:i,container:this,previousContainer:n,isPointerOverContainer:s,distance:o,dropPoint:a,event:c})}withItems(e){let t=this._draggables;return this._draggables=e,e.forEach(i=>i._withDropContainer(this)),this.isDragging()&&(t.filter(n=>n.isDragging()).every(n=>e.indexOf(n)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(e){return this._direction=e,this._sortStrategy instanceof ou&&(this._sortStrategy.direction=e),this}connectedTo(e){return this._siblings=e.slice(),this}withOrientation(e){if(e==="mixed")this._sortStrategy=new nv(this._document,this._dragDropRegistry);else{let t=new ou(this._dragDropRegistry);t.direction=this._direction,t.orientation=e,this._sortStrategy=t}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((t,i)=>this.sortPredicate(t,i,this)),this}withScrollableParents(e){let t=this._container;return this._scrollableElements=e.indexOf(t)===-1?[t,...e]:e.slice(),this}withElementContainer(e){if(e===this._container)return this;let t=Di(this.element),i=this._scrollableElements.indexOf(this._container),n=this._scrollableElements.indexOf(e);return i>-1&&this._scrollableElements.splice(i,1),n>-1&&this._scrollableElements.splice(n,1),this._sortStrategy&&this._sortStrategy.withElementContainer(e),this._cachedShadowRoot=null,this._scrollableElements.unshift(e),this._container=e,this}getScrollableParents(){return this._scrollableElements}getItemIndex(e){return this._isDragging?this._sortStrategy.getItemIndex(e):this._draggables.indexOf(e)}isReceiving(){return this._activeSiblings.size>0}_sortItem(e,t,i,n){if(this.sortingDisabled||!this._domRect||!Dw(this._domRect,Uw,t,i))return;let s=this._sortStrategy.sort(e,t,i,n);s&&this.sorted.next({previousIndex:s.previousIndex,currentIndex:s.currentIndex,container:this,item:e})}_startScrollingIfNecessary(e,t){if(this.autoScrollDisabled)return;let i,n=Zt.NONE,s=gt.NONE;if(this._parentPositions.positions.forEach((o,a)=>{a===this._document||!o.clientRect||i||Dw(o.clientRect,Uw,e,t)&&([n,s]=ek(a,o.clientRect,this._direction,e,t),(n||s)&&(i=a))}),!n&&!s){let{width:o,height:a}=this._viewportRuler.getViewportSize(),c={width:o,height:a,top:0,right:o,bottom:a,left:0};n=Kw(c,t),s=Gw(c,e),i=window}i&&(n!==this._verticalScrollDirection||s!==this._horizontalScrollDirection||i!==this._scrollNode)&&(this._verticalScrollDirection=n,this._horizontalScrollDirection=s,this._scrollNode=i,(n||s)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let e=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=e.msScrollSnapType||e.scrollSnapType||"",e.scrollSnapType=e.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let e=this._container.style;e.scrollSnapType=e.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(t=>t._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(e,t){return this._domRect!=null&&tv(this._domRect,e,t)}_getSiblingContainerFromPosition(e,t,i){return this._siblings.find(n=>n._canReceive(e,t,i))}_canReceive(e,t,i){if(!this._domRect||!tv(this._domRect,t,i)||!this.enterPredicate(e,this))return!1;let n=this._getShadowRoot().elementFromPoint(t,i);return n?n===this._container||this._container.contains(n):!1}_startReceiving(e,t){let i=this._activeSiblings;!i.has(e)&&t.every(n=>this.enterPredicate(n,this)||this._draggables.indexOf(n)>-1)&&(i.add(e),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:e,receiver:this,items:t}))}_stopReceiving(e){this._activeSiblings.delete(e),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:e,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(e=>{if(this.isDragging()){let t=this._parentPositions.handleScroll(e);t&&this._sortStrategy.updateOnScroll(t.top,t.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let e=Lc(this._container);this._cachedShadowRoot=e||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let e=this._sortStrategy.getActiveItemsSnapshot().filter(t=>t.isDragging());this._siblings.forEach(t=>t._startReceiving(this,e))}};function Kw(r,e){let{top:t,bottom:i,height:n}=r,s=n*$w;return e>=t-s&&e<=t+s?Zt.UP:e>=i-s&&e<=i+s?Zt.DOWN:Zt.NONE}function Gw(r,e){let{left:t,right:i,width:n}=r,s=n*$w;return e>=t-s&&e<=t+s?gt.LEFT:e>=i-s&&e<=i+s?gt.RIGHT:gt.NONE}function ek(r,e,t,i,n){let s=Kw(e,n),o=Gw(e,i),a=Zt.NONE,c=gt.NONE;if(s){let u=r.scrollTop;s===Zt.UP?u>0&&(a=Zt.UP):r.scrollHeight-u>r.clientHeight&&(a=Zt.DOWN)}if(o){let u=r.scrollLeft;t==="rtl"?o===gt.RIGHT?u<0&&(c=gt.RIGHT):r.scrollWidth+u>r.clientWidth&&(c=gt.LEFT):o===gt.LEFT?u>0&&(c=gt.LEFT):r.scrollWidth-u>r.clientWidth&&(c=gt.RIGHT)}return[a,c]}var tu=$o({passive:!1,capture:!0}),ru=new Set,tk=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=Qt({type:r,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],standalone:!0,features:[Xt],decls:0,vars:0,template:function(i,n){},styles:["@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}"],encapsulation:2,changeDetection:0})}}return r})(),rk=(()=>{class r{constructor(t,i){this._ngZone=t,this._appRef=W($P),this._environmentInjector=W(zP),this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=vt([]),this._globalListeners=new Map,this._draggingPredicate=n=>n.isDragging(),this.pointerMove=new ue,this.pointerUp=new ue,this.scroll=new ue,this._preventDefaultWhileDragging=n=>{this._activeDragInstances().length>0&&n.preventDefault()},this._persistentTouchmoveListener=n=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&n.preventDefault(),this.pointerMove.next(n))},this._document=i}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,tu)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),this._dragInstances.size===0&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,tu)}startDragging(t,i){if(!(this._activeDragInstances().indexOf(t)>-1)&&(this._loadResets(),this._activeDragInstances.update(n=>[...n,t]),this._activeDragInstances().length===1)){let n=i.type.startsWith("touch");this._globalListeners.set(n?"touchend":"mouseup",{handler:s=>this.pointerUp.next(s),options:!0}).set("scroll",{handler:s=>this.scroll.next(s),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:tu}),n||this._globalListeners.set("mousemove",{handler:s=>this.pointerMove.next(s),options:tu}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((s,o)=>{this._document.addEventListener(o,s.handler,s.options)})})}}stopDragging(t){this._activeDragInstances.update(i=>{let n=i.indexOf(t);return n>-1?(i.splice(n,1),[...i]):i}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(t){return this._activeDragInstances().indexOf(t)>-1}scrolled(t){let i=[this.scroll];return t&&t!==this._document&&i.push(new $f(n=>this._ngZone.runOutsideAngular(()=>{let o=a=>{this._activeDragInstances().length&&n.next(a)};return t.addEventListener("scroll",o,!0),()=>{t.removeEventListener("scroll",o,!0)}}))),qo(...i)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,i)=>{this._document.removeEventListener(i,t.handler,t.options)}),this._globalListeners.clear()}_loadResets(){if(!ru.has(this._appRef)){ru.add(this._appRef);let t=JP(tk,{environmentInjector:this._environmentInjector});this._appRef.onDestroy(()=>{ru.delete(this._appRef),ru.size===0&&t.destroy()})}}static{this.\u0275fac=function(i){return new(i||r)(hn(Ac),hn(Nc))}}static{this.\u0275prov=Ft({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),ik={dragStartThreshold:5,pointerDirectionChangeThreshold:5},nk=(()=>{class r{constructor(t,i,n,s){this._document=t,this._ngZone=i,this._viewportRuler=n,this._dragDropRegistry=s}createDrag(t,i=ik){return new iv(t,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new sv(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static{this.\u0275fac=function(i){return new(i||r)(hn(Nc),hn(Ac),hn(hw),hn(rk))}}static{this.\u0275prov=Ft({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),ov=new zo("CDK_DRAG_PARENT");var Jw=new zo("CdkDragHandle"),Yw=(()=>{class r{get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._stateChanges.next(this)}constructor(t,i){this.element=t,this._parentDrag=i,this._stateChanges=new ue,this._disabled=!1,i?._addHandle(this)}ngOnDestroy(){this._parentDrag?._removeHandle(this),this._stateChanges.complete()}static{this.\u0275fac=function(i){return new(i||r)(Ze(dn),Ze(ov,12))}}static{this.\u0275dir=Fo({type:r,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:[2,"cdkDragHandleDisabled","disabled",Xf]},standalone:!0,features:[Yf([{provide:Jw,useExisting:r}]),Jf]})}}return r})(),sk=new zo("CDK_DRAG_CONFIG"),ok="cdk-drag",ak=new zo("CdkDropList"),Qw=(()=>{class r{static{this._dragInstances=[]}get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(t){this._disabled=t,this._dragRef.disabled=this._disabled}constructor(t,i,n,s,o,a,c,u,p,l,d){this.element=t,this.dropContainer=i,this._ngZone=s,this._viewContainerRef=o,this._dir=c,this._changeDetectorRef=p,this._selfHandle=l,this._parentDrag=d,this._destroyed=new ue,this._handles=new xP([]),this.scale=1,this.started=new si,this.released=new si,this.ended=new si,this.entered=new si,this.exited=new si,this.dropped=new si,this.moved=new $f(f=>{let g=this._dragRef.moved.pipe(Ae(m=>({source:this,pointerPosition:m.pointerPosition,event:m.event,delta:m.delta,distance:m.distance}))).subscribe(f);return()=>{g.unsubscribe()}}),this._injector=W(ps),this._dragRef=u.createDrag(t,{dragStartThreshold:a&&a.dragStartThreshold!=null?a.dragStartThreshold:5,pointerDirectionChangeThreshold:a&&a.pointerDirectionChangeThreshold!=null?a.pointerDirectionChangeThreshold:5,zIndex:a?.zIndex}),this._dragRef.data=this,r._dragInstances.push(this),a&&this._assignDefaults(a),i&&(this._dragRef._withDropContainer(i._dropListRef),i.addItem(this),i._dropListRef.beforeStarted.pipe(Nr(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(t){this._dragRef.setFreeDragPosition(t)}ngAfterViewInit(){WP(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(t){let i=t.rootElementSelector,n=t.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,n&&!n.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);let t=r._dragInstances.indexOf(this);t>-1&&r._dragInstances.splice(t,1),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(t){let i=this._handles.getValue();i.push(t),this._handles.next(i)}_removeHandle(t){let i=this._handles.getValue(),n=i.indexOf(t);n>-1&&(i.splice(n,1),this._handles.next(i))}_setPreviewTemplate(t){this._previewTemplate=t}_resetPreviewTemplate(t){t===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(t){this._placeholderTemplate=t}_resetPlaceholderTemplate(t){t===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let t=this.element.nativeElement,i=t;this.rootElementSelector&&(i=t.closest!==void 0?t.closest(this.rootElementSelector):t.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(i||t)}_getBoundaryElement(){let t=this.boundaryElement;return t?typeof t=="string"?this.element.nativeElement.closest(t):Di(t):null}_syncInputs(t){t.beforeStarted.subscribe(()=>{if(!t.isDragging()){let i=this._dir,n=this.dragStartDelay,s=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,o=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.scale=this.scale,t.dragStartDelay=typeof n=="object"&&n?n:YP(n),t.constrainPosition=this.constrainPosition,t.previewClass=this.previewClass,t.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(s).withPreviewTemplate(o).withPreviewContainer(this.previewContainer||"global"),i&&t.withDirection(i.value)}}),t.beforeStarted.pipe(cs(1)).subscribe(()=>{if(this._parentDrag){t.withParent(this._parentDrag._dragRef);return}let i=this.element.nativeElement.parentElement;for(;i;){if(i.classList.contains(ok)){t.withParent(r._dragInstances.find(n=>n.element.nativeElement===i)?._dragRef||null);break}i=i.parentElement}})}_handleEvents(t){t.started.subscribe(i=>{this.started.emit({source:this,event:i.event}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(i=>{this.released.emit({source:this,event:i.event})}),t.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),t.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),t.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event})})}_assignDefaults(t){let{lockAxis:i,dragStartDelay:n,constrainPosition:s,previewClass:o,boundaryElement:a,draggingDisabled:c,rootElementSelector:u,previewContainer:p}=t;this.disabled=c??!1,this.dragStartDelay=n||0,i&&(this.lockAxis=i),s&&(this.constrainPosition=s),o&&(this.previewClass=o),a&&(this.boundaryElement=a),u&&(this.rootElementSelector=u),p&&(this.previewContainer=p)}_setupHandlesListener(){this._handles.pipe(wt(t=>{let i=t.map(n=>n.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),ni(t=>qo(...t.map(i=>i._stateChanges.pipe(qP(i))))),Nr(this._destroyed)).subscribe(t=>{let i=this._dragRef,n=t.element.nativeElement;t.disabled?i.disableHandle(n):i.enableHandle(n)})}static{this.\u0275fac=function(i){return new(i||r)(Ze(dn),Ze(ak,12),Ze(Nc),Ze(Ac),Ze(UP),Ze(sk,8),Ze(ZP,8),Ze(nk),Ze(KP),Ze(Jw,10),Ze(ov,12))}}static{this.\u0275dir=Fo({type:r,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(i,n){i&2&&HP("cdk-drag-disabled",n.disabled)("cdk-drag-dragging",n._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",Xf],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",GP]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],standalone:!0,features:[Yf([{provide:ov,useExisting:r}]),Jf,FP]})}}return r})();function tt(r,e,t,i){return new(t||(t=Promise))(function(n,s){function o(u){try{c(i.next(u))}catch(p){s(p)}}function a(u){try{c(i.throw(u))}catch(p){s(p)}}function c(u){var p;u.done?n(u.value):(p=u.value,p instanceof t?p:new t(function(l){l(p)})).then(o,a)}c((i=i.apply(r,e||[])).next())})}var gn=class{constructor(){this.listeners={}}on(e,t,i){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),i?.once){let n=()=>{this.un(e,n),this.un(e,t)};return this.on(e,n),n}return()=>this.un(e,t)}un(e,t){var i;(i=this.listeners[e])===null||i===void 0||i.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(i=>i(...t))}},Xw={decode:function(r,e){return tt(this,void 0,void 0,function*(){let t=new AudioContext({sampleRate:e});return t.decodeAudioData(r).finally(()=>t.close())})},createBuffer:function(r,e){return typeof r[0]=="number"&&(r=[r]),function(t){let i=t[0];if(i.some(n=>n>1||n<-1)){let n=i.length,s=0;for(let o=0;o<n;o++){let a=Math.abs(i[o]);a>s&&(s=a)}for(let o of t)for(let a=0;a<n;a++)o[a]/=s}}(r),{duration:e,length:r[0].length,sampleRate:r[0].length/e,numberOfChannels:r.length,getChannelData:t=>r?.[t],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function e_(r,e){let t=e.xmlns?document.createElementNS(e.xmlns,r):document.createElement(r);for(let[i,n]of Object.entries(e))if(i==="children")for(let[s,o]of Object.entries(e))typeof o=="string"?t.appendChild(document.createTextNode(o)):t.appendChild(e_(s,o));else i==="style"?Object.assign(t.style,n):i==="textContent"?t.textContent=n:t.setAttribute(i,n.toString());return t}function Zw(r,e,t){let i=e_(r,e||{});return t?.appendChild(i),i}var ck=Object.freeze({__proto__:null,createElement:Zw,default:Zw}),uk={fetchBlob:function(r,e,t){return tt(this,void 0,void 0,function*(){let i=yield fetch(r,t);if(i.status>=400)throw new Error(`Failed to fetch ${r}: ${i.status} (${i.statusText})`);return function(n,s){tt(this,void 0,void 0,function*(){if(!n.body||!n.headers)return;let o=n.body.getReader(),a=Number(n.headers.get("Content-Length"))||0,c=0,u=l=>tt(this,void 0,void 0,function*(){c+=l?.length||0;let d=Math.round(c/a*100);s(d)}),p=()=>tt(this,void 0,void 0,function*(){let l;try{l=yield o.read()}catch{return}l.done||(u(l.value),yield p())});p()})}(i.clone(),e),i.blob()})}},uv=class extends gn{constructor(e){super(),this.isExternalMedia=!1,e.media?(this.media=e.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),e.mediaControls&&(this.media.controls=!0),e.autoplay&&(this.media.autoplay=!0),e.playbackRate!=null&&this.onMediaEvent("canplay",()=>{e.playbackRate!=null&&(this.media.playbackRate=e.playbackRate)},{once:!0})}onMediaEvent(e,t,i){return this.media.addEventListener(e,t,i),()=>this.media.removeEventListener(e,t,i)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){let e=this.getSrc();e.startsWith("blob:")&&URL.revokeObjectURL(e)}canPlayType(e){return this.media.canPlayType(e)!==""}setSrc(e,t){let i=this.getSrc();if(e&&i===e)return;this.revokeSrc();let n=t instanceof Blob&&(this.canPlayType(t.type)||!e)?URL.createObjectURL(t):e;try{this.media.src=n}catch{this.media.src=e}}destroy(){this.media.pause(),this.isExternalMedia||(this.media.remove(),this.revokeSrc(),this.media.src="",this.media.load())}setMediaElement(e){this.media=e}play(){return tt(this,void 0,void 0,function*(){return this.media.play()})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(e){this.media.currentTime=e}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(e){this.media.volume=e}getMuted(){return this.media.muted}setMuted(e){this.media.muted=e}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(e,t){t!=null&&(this.media.preservesPitch=t),this.media.playbackRate=e}getMediaElement(){return this.media}setSinkId(e){return this.media.setSinkId(e)}},Xo=class r extends gn{constructor(e,t){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.subscriptions=[],this.options=e;let i=this.parentFromOptionsContainer(e.container);this.parent=i;let[n,s]=this.initHtml();i.appendChild(n),this.container=n,this.scrollContainer=s.querySelector(".scroll"),this.wrapper=s.querySelector(".wrapper"),this.canvasWrapper=s.querySelector(".canvases"),this.progressWrapper=s.querySelector(".progress"),this.cursor=s.querySelector(".cursor"),t&&s.appendChild(t),this.initEvents()}parentFromOptionsContainer(e){let t;if(typeof e=="string"?t=document.querySelector(e):e instanceof HTMLElement&&(t=e),!t)throw new Error("Container not found");return t}initEvents(){let e=t=>{let i=this.wrapper.getBoundingClientRect(),n=t.clientX-i.left,s=t.clientY-i.top;return[n/i.width,s/i.height]};if(this.wrapper.addEventListener("click",t=>{let[i,n]=e(t);this.emit("click",i,n)}),this.wrapper.addEventListener("dblclick",t=>{let[i,n]=e(t);this.emit("dblclick",i,n)}),this.options.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{let{scrollLeft:t,scrollWidth:i,clientWidth:n}=this.scrollContainer,s=t/i,o=(t+n)/i;this.emit("scroll",s,o,t,t+n)}),typeof ResizeObserver=="function"){let t=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{t().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}}onContainerResize(){let e=this.parent.clientWidth;e===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=e,this.reRender())}initDrag(){this.subscriptions.push(function(e,t,i,n,s=3,o=0,a=100){if(!e)return()=>{};let c=matchMedia("(pointer: coarse)").matches,u=()=>{},p=l=>{if(l.button!==o)return;l.preventDefault(),l.stopPropagation();let d=l.clientX,f=l.clientY,g=!1,m=Date.now(),y=A=>{if(A.preventDefault(),A.stopPropagation(),c&&Date.now()-m<a)return;let D=A.clientX,ee=A.clientY,$=D-d,X=ee-f;if(g||Math.abs($)>s||Math.abs(X)>s){let le=e.getBoundingClientRect(),{left:qt,top:Pt}=le;g||(i?.(d-qt,f-Pt),g=!0),t($,X,D-qt,ee-Pt),d=D,f=ee}},w=A=>{if(g){let D=A.clientX,ee=A.clientY,$=e.getBoundingClientRect(),{left:X,top:le}=$;n?.(D-X,ee-le)}u()},b=A=>{A.relatedTarget&&A.relatedTarget!==document.documentElement||w(A)},C=A=>{g&&(A.stopPropagation(),A.preventDefault())},R=A=>{g&&A.preventDefault()};document.addEventListener("pointermove",y),document.addEventListener("pointerup",w),document.addEventListener("pointerout",b),document.addEventListener("pointercancel",b),document.addEventListener("touchmove",R,{passive:!1}),document.addEventListener("click",C,{capture:!0}),u=()=>{document.removeEventListener("pointermove",y),document.removeEventListener("pointerup",w),document.removeEventListener("pointerout",b),document.removeEventListener("pointercancel",b),document.removeEventListener("touchmove",R),setTimeout(()=>{document.removeEventListener("click",C,{capture:!0})},10)}};return e.addEventListener("pointerdown",p),()=>{u(),e.removeEventListener("pointerdown",p)}}(this.wrapper,(e,t,i)=>{this.emit("drag",Math.max(0,Math.min(1,i/this.wrapper.getBoundingClientRect().width)))},e=>{this.isDragging=!0,this.emit("dragstart",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))},e=>{this.isDragging=!1,this.emit("dragend",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))}))}getHeight(e,t){var i;let n=((i=this.audioData)===null||i===void 0?void 0:i.numberOfChannels)||1;if(e==null)return 128;if(!isNaN(Number(e)))return Number(e);if(e==="auto"){let s=this.parent.clientHeight||128;return t?.every(o=>!o.overlay)?s/n:s}return 128}initHtml(){let e=document.createElement("div"),t=e.attachShadow({mode:"open"}),i=this.options.cspNonce&&typeof this.options.cspNonce=="string"?this.options.cspNonce.replace(/"/g,""):"";return t.innerHTML=`
      <style${i?` nonce="${i}"`:""}>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height,this.options.splitChannels)}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[e,t]}setOptions(e){if(this.options.container!==e.container){let t=this.parentFromOptionsContainer(e.container);t.appendChild(this.container),this.parent=t}e.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.options=e,this.reRender()}getWrapper(){return this.wrapper}getWidth(){return this.scrollContainer.clientWidth}getScroll(){return this.scrollContainer.scrollLeft}setScroll(e){this.scrollContainer.scrollLeft=e}setScrollPercentage(e){let{scrollWidth:t}=this.scrollContainer,i=t*e;this.setScroll(i)}destroy(){var e,t;this.subscriptions.forEach(i=>i()),this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.unsubscribeOnScroll)===null||t===void 0||t.call(this)}createDelay(e=10){let t,i,n=()=>{t&&clearTimeout(t),i&&i()};return this.timeouts.push(n),()=>new Promise((s,o)=>{n(),i=o,t=setTimeout(()=>{t=void 0,i=void 0,s()},e)})}convertColorValues(e){if(!Array.isArray(e))return e||"";if(e.length<2)return e[0]||"";let t=document.createElement("canvas"),i=t.getContext("2d"),n=t.height*(window.devicePixelRatio||1),s=i.createLinearGradient(0,0,0,n),o=1/(e.length-1);return e.forEach((a,c)=>{let u=c*o;s.addColorStop(u,a)}),s}getPixelRatio(){return Math.max(1,window.devicePixelRatio||1)}renderBarWaveform(e,t,i,n){let s=e[0],o=e[1]||e[0],a=s.length,{width:c,height:u}=i.canvas,p=u/2,l=this.getPixelRatio(),d=t.barWidth?t.barWidth*l:1,f=t.barGap?t.barGap*l:t.barWidth?d/2:0,g=t.barRadius||0,m=c/(d+f)/a,y=g&&"roundRect"in i?"roundRect":"rect";i.beginPath();let w=0,b=0,C=0;for(let R=0;R<=a;R++){let A=Math.round(R*m);if(A>w){let $=Math.round(b*p*n),X=$+Math.round(C*p*n)||1,le=p-$;t.barAlign==="top"?le=0:t.barAlign==="bottom"&&(le=u-X),i[y](w*(d+f),le,d,X,g),w=A,b=0,C=0}let D=Math.abs(s[R]||0),ee=Math.abs(o[R]||0);D>b&&(b=D),ee>C&&(C=ee)}i.fill(),i.closePath()}renderLineWaveform(e,t,i,n){let s=o=>{let a=e[o]||e[0],c=a.length,{height:u}=i.canvas,p=u/2,l=i.canvas.width/c;i.moveTo(0,p);let d=0,f=0;for(let g=0;g<=c;g++){let m=Math.round(g*l);if(m>d){let w=p+(Math.round(f*p*n)||1)*(o===0?-1:1);i.lineTo(d,w),d=m,f=0}let y=Math.abs(a[g]||0);y>f&&(f=y)}i.lineTo(d,p)};i.beginPath(),s(0),s(1),i.fill(),i.closePath()}renderWaveform(e,t,i){if(i.fillStyle=this.convertColorValues(t.waveColor),t.renderFunction)return void t.renderFunction(e,i);let n=t.barHeight||1;if(t.normalize){let s=Array.from(e[0]).reduce((o,a)=>Math.max(o,Math.abs(a)),0);n=s?1/s:1}t.barWidth||t.barGap||t.barAlign?this.renderBarWaveform(e,t,i,n):this.renderLineWaveform(e,t,i,n)}renderSingleCanvas(e,t,i,n,s,o,a){let c=this.getPixelRatio(),u=document.createElement("canvas");u.width=Math.round(i*c),u.height=Math.round(n*c),u.style.width=`${i}px`,u.style.height=`${n}px`,u.style.left=`${Math.round(s)}px`,o.appendChild(u);let p=u.getContext("2d");if(this.renderWaveform(e,t,p),u.width>0&&u.height>0){let l=u.cloneNode(),d=l.getContext("2d");d.drawImage(u,0,0),d.globalCompositeOperation="source-in",d.fillStyle=this.convertColorValues(t.progressColor),d.fillRect(0,0,u.width,u.height),a.appendChild(l)}}renderMultiCanvas(e,t,i,n,s,o){let a=this.getPixelRatio(),{clientWidth:c}=this.scrollContainer,u=i/a,p=Math.min(r.MAX_CANVAS_WIDTH,c,u),l={};if(t.barWidth||t.barGap){let y=t.barWidth||.5,w=y+(t.barGap||y/2);p%w!=0&&(p=Math.floor(p/w)*w)}let d=y=>{if(y<0||y>=f||l[y])return;l[y]=!0;let w=y*p,b=Math.min(u-w,p);if(b<=0)return;let C=e.map(R=>{let A=Math.floor(w/u*R.length),D=Math.floor((w+b)/u*R.length);return R.slice(A,D)});this.renderSingleCanvas(C,t,b,n,w,s,o)},f=Math.ceil(u/p);if(!this.isScrollable){for(let y=0;y<f;y++)d(y);return}let g=this.scrollContainer.scrollLeft/u,m=Math.floor(g*f);d(m-1),d(m),d(m+1),f>1&&(this.unsubscribeOnScroll=this.on("scroll",()=>{let{scrollLeft:y}=this.scrollContainer,w=Math.floor(y/u*f);Object.keys(l).length>r.MAX_NODES&&(s.innerHTML="",o.innerHTML="",l={}),d(w-1),d(w),d(w+1)}))}renderChannel(e,t,i,n){var{overlay:s}=t,o=function(p,l){var d={};for(var f in p)Object.prototype.hasOwnProperty.call(p,f)&&l.indexOf(f)<0&&(d[f]=p[f]);if(p!=null&&typeof Object.getOwnPropertySymbols=="function"){var g=0;for(f=Object.getOwnPropertySymbols(p);g<f.length;g++)l.indexOf(f[g])<0&&Object.prototype.propertyIsEnumerable.call(p,f[g])&&(d[f[g]]=p[f[g]])}return d}(t,["overlay"]);let a=document.createElement("div"),c=this.getHeight(o.height,o.splitChannels);a.style.height=`${c}px`,s&&n>0&&(a.style.marginTop=`-${c}px`),this.canvasWrapper.style.minHeight=`${c}px`,this.canvasWrapper.appendChild(a);let u=a.cloneNode();this.progressWrapper.appendChild(u),this.renderMultiCanvas(e,o,i,c,a,u)}render(e){return tt(this,void 0,void 0,function*(){var t;this.timeouts.forEach(c=>c()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);let i=this.getPixelRatio(),n=this.scrollContainer.clientWidth,s=Math.ceil(e.duration*(this.options.minPxPerSec||0));this.isScrollable=s>n;let o=this.options.fillParent&&!this.isScrollable,a=(o?n:s)*i;if(this.wrapper.style.width=o?"100%":`${s}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=e,this.emit("render"),this.options.splitChannels)for(let c=0;c<e.numberOfChannels;c++){let u=Object.assign(Object.assign({},this.options),(t=this.options.splitChannels)===null||t===void 0?void 0:t[c]);this.renderChannel([e.getChannelData(c)],u,a,c)}else{let c=[e.getChannelData(0)];e.numberOfChannels>1&&c.push(e.getChannelData(1)),this.renderChannel(c,this.options,a,0)}Promise.resolve().then(()=>this.emit("rendered"))})}reRender(){var e;if((e=this.unsubscribeOnScroll)===null||e===void 0||e.call(this),delete this.unsubscribeOnScroll,!this.audioData)return;let{scrollWidth:t}=this.scrollContainer,{right:i}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&t!==this.scrollContainer.scrollWidth){let{right:n}=this.progressWrapper.getBoundingClientRect(),s=n-i;s*=2,s=s<0?Math.floor(s):Math.ceil(s),s/=2,this.scrollContainer.scrollLeft+=s}}zoom(e){this.options.minPxPerSec=e,this.reRender()}scrollIntoView(e,t=!1){let{scrollLeft:i,scrollWidth:n,clientWidth:s}=this.scrollContainer,o=e*n,a=i,c=i+s,u=s/2;if(this.isDragging)o+30>c?this.scrollContainer.scrollLeft+=30:o-30<a&&(this.scrollContainer.scrollLeft-=30);else{(o<a||o>c)&&(this.scrollContainer.scrollLeft=o-(this.options.autoCenter?u:0));let p=o-i-u;t&&this.options.autoCenter&&p>0&&(this.scrollContainer.scrollLeft+=Math.min(p,10))}{let p=this.scrollContainer.scrollLeft,l=p/n,d=(p+s)/n;this.emit("scroll",l,d,p,p+s)}}renderProgress(e,t){if(isNaN(e))return;let i=100*e;this.canvasWrapper.style.clipPath=`polygon(${i}% 0, 100% 0, 100% 100%, ${i}% 100%)`,this.progressWrapper.style.width=`${i}%`,this.cursor.style.left=`${i}%`,this.cursor.style.transform=`translateX(-${Math.round(i)===100?this.options.cursorWidth:0}px)`,this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(e,t)}exportImage(e,t,i){return tt(this,void 0,void 0,function*(){let n=this.canvasWrapper.querySelectorAll("canvas");if(!n.length)throw new Error("No waveform data");if(i==="dataURL"){let s=Array.from(n).map(o=>o.toDataURL(e,t));return Promise.resolve(s)}return Promise.all(Array.from(n).map(s=>new Promise((o,a)=>{s.toBlob(c=>{c?o(c):a(new Error("Could not export image"))},e,t)})))})}};Xo.MAX_CANVAS_WIDTH=8e3,Xo.MAX_NODES=10;var pv=class extends gn{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}},au=class extends gn{constructor(e=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=e,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return tt(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(e){if(this.currentSrc=e,this._duration=void 0,!e)return this.buffer=null,void this.emit("emptied");fetch(e).then(t=>{if(t.status>=400)throw new Error(`Failed to fetch ${e}: ${t.status} (${t.statusText})`);return t.arrayBuffer()}).then(t=>this.currentSrc!==e?null:this.audioContext.decodeAudioData(t)).then(t=>{this.currentSrc===e&&(this.buffer=t,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())})}_play(){var e;if(!this.paused)return;this.paused=!1,(e=this.bufferNode)===null||e===void 0||e.disconnect(),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let t=this.playedDuration*this._playbackRate;t>=this.duration&&(t=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,t),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var e;this.paused=!0,(e=this.bufferNode)===null||e===void 0||e.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return tt(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(e){var t,i;let n=e-this.currentTime;(t=this.bufferNode)===null||t===void 0||t.stop(this.audioContext.currentTime+n),(i=this.bufferNode)===null||i===void 0||i.addEventListener("ended",()=>{this.bufferNode=null,this.pause()},{once:!0})}setSinkId(e){return tt(this,void 0,void 0,function*(){return this.audioContext.setSinkId(e)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this.bufferNode&&(this.bufferNode.playbackRate.value=e)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(e){let t=!this.paused;t&&this._pause(),this.playedDuration=e/this._playbackRate,t&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var e,t;return(e=this._duration)!==null&&e!==void 0?e:((t=this.buffer)===null||t===void 0?void 0:t.duration)||0}set duration(e){this._duration=e}get volume(){return this.gainNode.gain.value}set volume(e){this.gainNode.gain.value=e,this.emit("volumechange")}get muted(){return this._muted}set muted(e){this._muted!==e&&(this._muted=e,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(e){return/^(audio|video)\//.test(e)}getGainNode(){return this.gainNode}getChannelData(){let e=[];if(!this.buffer)return e;let t=this.buffer.numberOfChannels;for(let i=0;i<t;i++)e.push(this.buffer.getChannelData(i));return e}},pk={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3},Rs=class r extends uv{static create(e){return new r(e)}constructor(e){let t=e.media||(e.backend==="WebAudio"?new au:void 0);super({media:t,mediaControls:e.mediaControls,autoplay:e.autoplay,playbackRate:e.audioRate}),this.plugins=[],this.decodedData=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.options=Object.assign({},pk,e),this.timer=new pv;let i=t?void 0:this.getMediaElement();this.renderer=new Xo(this.options,i),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins();let n=this.options.url||this.getSrc()||"";Promise.resolve().then(()=>{this.emit("init");let{peaks:s,duration:o}=this.options;(n||s&&o)&&this.load(n,s,o).catch(()=>null)})}updateProgress(e=this.getCurrentTime()){return this.renderer.renderProgress(e/this.getDuration(),this.isPlaying()),e}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){let e=this.updateProgress();this.emit("timeupdate",e),this.emit("audioprocess",e)}}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{let e=this.updateProgress();this.emit("timeupdate",e)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop()}),this.onMediaEvent("emptied",()=>{this.timer.stop()}),this.onMediaEvent("ended",()=>{this.emit("finish")}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",e=>{this.emit("error",e.error)}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(e,t)=>{this.options.interact&&(this.seekTo(e),this.emit("interaction",e*this.getDuration()),this.emit("click",e,t))}),this.renderer.on("dblclick",(e,t)=>{this.emit("dblclick",e,t)}),this.renderer.on("scroll",(e,t,i,n)=>{let s=this.getDuration();this.emit("scroll",e*s,t*s,i,n)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",e=>{this.emit("dragstart",e)}),this.renderer.on("dragend",e=>{this.emit("dragend",e)}));{let e;this.subscriptions.push(this.renderer.on("drag",t=>{if(!this.options.interact)return;let i;this.renderer.renderProgress(t),clearTimeout(e),this.isPlaying()?i=0:this.options.dragToSeek===!0?i=200:typeof this.options.dragToSeek=="object"&&this.options.dragToSeek!==void 0&&(i=this.options.dragToSeek.debounceTime),e=setTimeout(()=>{this.seekTo(t)},i),this.emit("interaction",t*this.getDuration()),this.emit("drag",t)}))}}initPlugins(){var e;!((e=this.options.plugins)===null||e===void 0)&&e.length&&this.options.plugins.forEach(t=>{this.registerPlugin(t)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(e=>e()),this.mediaSubscriptions=[]}setOptions(e){this.options=Object.assign({},this.options,e),this.renderer.setOptions(this.options),e.audioRate&&this.setPlaybackRate(e.audioRate),e.mediaControls!=null&&(this.getMediaElement().controls=e.mediaControls)}registerPlugin(e){return e._init(this),this.plugins.push(e),this.subscriptions.push(e.once("destroy",()=>{this.plugins=this.plugins.filter(t=>t!==e)})),e}getWrapper(){return this.renderer.getWrapper()}getWidth(){return this.renderer.getWidth()}getScroll(){return this.renderer.getScroll()}setScroll(e){return this.renderer.setScroll(e)}setScrollTime(e){let t=e/this.getDuration();this.renderer.setScrollPercentage(t)}getActivePlugins(){return this.plugins}loadAudio(e,t,i,n){return tt(this,void 0,void 0,function*(){var s;if(this.emit("load",e),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,!t&&!i){let a=this.options.fetchParams||{};window.AbortController&&!a.signal&&(this.abortController=new AbortController,a.signal=(s=this.abortController)===null||s===void 0?void 0:s.signal);let c=u=>this.emit("loading",u);t=yield uk.fetchBlob(e,c,a)}this.setSrc(e,t);let o=yield new Promise(a=>{let c=n||this.getDuration();c?a(c):this.mediaSubscriptions.push(this.onMediaEvent("loadedmetadata",()=>a(this.getDuration()),{once:!0}))});if(!e&&!t){let a=this.getMediaElement();a instanceof au&&(a.duration=o)}if(i)this.decodedData=Xw.createBuffer(i,o||0);else if(t){let a=yield t.arrayBuffer();this.decodedData=yield Xw.decode(a,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(e,t,i){return tt(this,void 0,void 0,function*(){try{return yield this.loadAudio(e,void 0,t,i)}catch(n){throw this.emit("error",n),n}})}loadBlob(e,t,i){return tt(this,void 0,void 0,function*(){try{return yield this.loadAudio("",e,t,i)}catch(n){throw this.emit("error",n),n}})}zoom(e){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(e),this.emit("zoom",e)}getDecodedData(){return this.decodedData}exportPeaks({channels:e=2,maxLength:t=8e3,precision:i=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");let n=Math.min(e,this.decodedData.numberOfChannels),s=[];for(let o=0;o<n;o++){let a=this.decodedData.getChannelData(o),c=[],u=a.length/t;for(let p=0;p<t;p++){let l=a.slice(Math.floor(p*u),Math.ceil((p+1)*u)),d=0;for(let f=0;f<l.length;f++){let g=l[f];Math.abs(g)>Math.abs(d)&&(d=g)}c.push(Math.round(d*i)/i)}s.push(c)}return s}getDuration(){let e=super.getDuration()||0;return e!==0&&e!==1/0||!this.decodedData||(e=this.decodedData.duration),e}toggleInteraction(e){this.options.interact=e}setTime(e){super.setTime(e),this.updateProgress(e),this.emit("timeupdate",e)}seekTo(e){let t=this.getDuration()*e;this.setTime(t)}playPause(){return tt(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(e){this.setTime(this.getCurrentTime()+e)}empty(){this.load("",[[0]],.001)}setMediaElement(e){this.unsubscribePlayerEvents(),super.setMediaElement(e),this.initPlayerEvents()}exportImage(){return tt(this,arguments,void 0,function*(e="image/png",t=1,i="dataURL"){return this.renderer.exportImage(e,t,i)})}destroy(){var e;this.emit("destroy"),(e=this.abortController)===null||e===void 0||e.abort(),this.plugins.forEach(t=>t.destroy()),this.subscriptions.forEach(t=>t()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}};Rs.BasePlugin=class extends gn{constructor(r){super(),this.subscriptions=[],this.options=r}onInit(){}_init(r){this.wavesurfer=r,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(r=>r())}},Rs.dom=ck;function lv(r,e,t,i){return new(t||(t=Promise))(function(n,s){function o(u){try{c(i.next(u))}catch(p){s(p)}}function a(u){try{c(i.throw(u))}catch(p){s(p)}}function c(u){var p;u.done?n(u.value):(p=u.value,p instanceof t?p:new t(function(l){l(p)})).then(o,a)}c((i=i.apply(r,e||[])).next())})}var cu=class{constructor(){this.listeners={}}on(e,t,i){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),i?.once){let n=()=>{this.un(e,n),this.un(e,t)};return this.on(e,n),n}return()=>this.un(e,t)}un(e,t){var i;(i=this.listeners[e])===null||i===void 0||i.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(i=>i(...t))}},hv=class extends cu{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}_init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}},dv=class extends cu{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}},lk=["audio/webm","audio/wav","audio/mpeg","audio/mp4","audio/mp3"],uu=class r extends hv{constructor(e){var t,i,n,s,o,a;super(Object.assign(Object.assign({},e),{audioBitsPerSecond:(t=e.audioBitsPerSecond)!==null&&t!==void 0?t:128e3,scrollingWaveform:(i=e.scrollingWaveform)!==null&&i!==void 0&&i,scrollingWaveformWindow:(n=e.scrollingWaveformWindow)!==null&&n!==void 0?n:5,continuousWaveform:(s=e.continuousWaveform)!==null&&s!==void 0&&s,renderRecordedAudio:(o=e.renderRecordedAudio)===null||o===void 0||o,mediaRecorderTimeslice:(a=e.mediaRecorderTimeslice)!==null&&a!==void 0?a:void 0})),this.stream=null,this.mediaRecorder=null,this.dataWindow=null,this.isWaveformPaused=!1,this.lastStartTime=0,this.lastDuration=0,this.duration=0,this.timer=new dv,this.subscriptions.push(this.timer.on("tick",()=>{let c=performance.now()-this.lastStartTime;this.duration=this.isPaused()?this.duration:this.lastDuration+c,this.emit("record-progress",this.duration)}))}static create(e){return new r(e||{})}renderMicStream(e){var t;let i=new AudioContext,n=i.createMediaStreamSource(e),s=i.createAnalyser();n.connect(s),this.options.continuousWaveform&&(s.fftSize=32);let o=s.frequencyBinCount,a=new Float32Array(o),c=0;this.wavesurfer&&((t=this.originalOptions)!==null&&t!==void 0||(this.originalOptions=Object.assign({},this.wavesurfer.options)),this.wavesurfer.options.interact=!1,this.options.scrollingWaveform&&(this.wavesurfer.options.cursorWidth=0));let u=setInterval(()=>{var p,l,d,f;if(!this.isWaveformPaused){if(s.getFloatTimeDomainData(a),this.options.scrollingWaveform){let g=Math.floor((this.options.scrollingWaveformWindow||0)*i.sampleRate),m=Math.min(g,this.dataWindow?this.dataWindow.length+o:o),y=new Float32Array(g);if(this.dataWindow){let w=Math.max(0,g-this.dataWindow.length);y.set(this.dataWindow.slice(-m+o),w)}y.set(a,g-o),this.dataWindow=y}else if(this.options.continuousWaveform){if(!this.dataWindow){let m=this.options.continuousWaveformDuration?Math.round(100*this.options.continuousWaveformDuration):((l=(p=this.wavesurfer)===null||p===void 0?void 0:p.getWidth())!==null&&l!==void 0?l:0)*window.devicePixelRatio;this.dataWindow=new Float32Array(m)}let g=0;for(let m=0;m<o;m++){let y=Math.abs(a[m]);y>g&&(g=y)}if(c+1>this.dataWindow.length){let m=new Float32Array(2*this.dataWindow.length);m.set(this.dataWindow,0),this.dataWindow=m}this.dataWindow[c]=g,c++}else this.dataWindow=a;if(this.wavesurfer){let g=((f=(d=this.dataWindow)===null||d===void 0?void 0:d.length)!==null&&f!==void 0?f:0)/100;this.wavesurfer.load("",[this.dataWindow],this.options.scrollingWaveform?this.options.scrollingWaveformWindow:g).then(()=>{this.wavesurfer&&this.options.continuousWaveform&&(this.wavesurfer.setTime(this.getDuration()/1e3),this.wavesurfer.options.minPxPerSec||this.wavesurfer.setOptions({minPxPerSec:this.wavesurfer.getWidth()/this.wavesurfer.getDuration()}))}).catch(m=>{console.error("Error rendering real-time recording data:",m)})}}},10);return{onDestroy:()=>{clearInterval(u),n?.disconnect(),i?.close()},onEnd:()=>{this.isWaveformPaused=!0,clearInterval(u),this.stopMic()}}}startMic(e){return lv(this,void 0,void 0,function*(){let t;try{t=yield navigator.mediaDevices.getUserMedia({audio:!e?.deviceId||{deviceId:e.deviceId}})}catch(s){throw new Error("Error accessing the microphone: "+s.message)}let{onDestroy:i,onEnd:n}=this.renderMicStream(t);return this.subscriptions.push(this.once("destroy",i)),this.subscriptions.push(this.once("record-end",n)),this.stream=t,t})}stopMic(){this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null,this.mediaRecorder=null)}startRecording(e){return lv(this,void 0,void 0,function*(){let t=this.stream||(yield this.startMic(e));this.dataWindow=null;let i=this.mediaRecorder||new MediaRecorder(t,{mimeType:this.options.mimeType||lk.find(o=>MediaRecorder.isTypeSupported(o)),audioBitsPerSecond:this.options.audioBitsPerSecond});this.mediaRecorder=i,this.stopRecording();let n=[];i.ondataavailable=o=>{o.data.size>0&&n.push(o.data),this.emit("record-data-available",o.data)};let s=o=>{var a;let c=new Blob(n,{type:i.mimeType});this.emit(o,c),this.options.renderRecordedAudio&&(this.applyOriginalOptionsIfNeeded(),(a=this.wavesurfer)===null||a===void 0||a.load(URL.createObjectURL(c)))};i.onpause=()=>s("record-pause"),i.onstop=()=>s("record-end"),i.start(this.options.mediaRecorderTimeslice),this.lastStartTime=performance.now(),this.lastDuration=0,this.duration=0,this.isWaveformPaused=!1,this.timer.start(),this.emit("record-start")})}getDuration(){return this.duration}isRecording(){var e;return((e=this.mediaRecorder)===null||e===void 0?void 0:e.state)==="recording"}isPaused(){var e;return((e=this.mediaRecorder)===null||e===void 0?void 0:e.state)==="paused"}isActive(){var e;return((e=this.mediaRecorder)===null||e===void 0?void 0:e.state)!=="inactive"}stopRecording(){var e;this.isActive()&&((e=this.mediaRecorder)===null||e===void 0||e.stop(),this.timer.stop())}pauseRecording(){var e,t;this.isRecording()&&(this.isWaveformPaused=!0,(e=this.mediaRecorder)===null||e===void 0||e.requestData(),(t=this.mediaRecorder)===null||t===void 0||t.pause(),this.timer.stop(),this.lastDuration=this.duration)}resumeRecording(){var e;this.isPaused()&&(this.isWaveformPaused=!1,(e=this.mediaRecorder)===null||e===void 0||e.resume(),this.timer.start(),this.lastStartTime=performance.now(),this.emit("record-resume"))}static getAvailableAudioDevices(){return lv(this,void 0,void 0,function*(){return navigator.mediaDevices.enumerateDevices().then(e=>e.filter(t=>t.kind==="audioinput"))})}destroy(){this.applyOriginalOptionsIfNeeded(),super.destroy(),this.stopRecording(),this.stopMic()}applyOriginalOptionsIfNeeded(){this.wavesurfer&&this.originalOptions&&(this.wavesurfer.setOptions(this.originalOptions),delete this.originalOptions)}};var Mr=wM(PM());var zf=class r{avatarService=W(xi);lang=W(gs);interruptAvatar(){this.avatarService.interruptAvatar().pipe(cs(1)).subscribe()}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=Qt({type:r,selectors:[["app-avatar-interrupter-btn"]],standalone:!0,features:[Xt],decls:12,vars:1,consts:[[1,"text-white",3,"click","matTooltip"],["fill","currentColor","xmlns","http://www.w3.org/2000/svg","x","0px","y","0px","viewBox","0 0 100 125",1,"w-full"],["d","M26.547,64.063c-0.187,0-0.374-0.071-0.518-0.212c-2.761-2.731-4.221-6.021-4.221-9.516c0-2.814,0.979-5.564,2.833-7.953   c0.25-0.321,0.711-0.381,1.034-0.131c0.321,0.25,0.38,0.713,0.13,1.034c-1.651,2.128-2.523,4.565-2.523,7.049   c0,3.092,1.309,6.02,3.783,8.467c0.289,0.286,0.292,0.753,0.006,1.042C26.928,63.99,26.737,64.063,26.547,64.063z"],["d","M28.144,62.235c-0.188,0-0.375-0.071-0.519-0.213c-2.18-2.156-3.332-4.758-3.332-7.522c0-2.227,0.774-4.402,2.239-6.29   c0.249-0.321,0.712-0.381,1.034-0.13c0.321,0.25,0.38,0.712,0.131,1.034c-1.263,1.627-1.931,3.49-1.931,5.387   c0,2.362,1.001,4.601,2.895,6.475c0.29,0.286,0.292,0.753,0.007,1.042C28.523,62.162,28.333,62.235,28.144,62.235z"],["d","M29.549,59.614c-0.188,0-0.375-0.071-0.519-0.213c-1.329-1.315-2.061-2.971-2.061-4.665c0-1.385,0.479-2.736,1.387-3.905   c0.25-0.321,0.713-0.38,1.034-0.131c0.321,0.25,0.38,0.712,0.131,1.034c-0.705,0.909-1.078,1.947-1.078,3.002   c0,1.315,0.562,2.566,1.624,3.616c0.288,0.287,0.291,0.753,0.005,1.042C29.928,59.542,29.738,59.614,29.549,59.614z"],["d","M64.743,57.484c1.783-3.587,5.967-10.445,6.667-15.297c0.902-6.253-1.999-17.147-11.604-19.727   c-9.604-2.578-18.19,1.069-21.595,3.997c-0.813,0.699-1.447,1.597-1.956,2.564L64.743,57.484z"],["d","M33.92,40.824c-1.134,1.348-3.885,4.769-4.089,6.455c-0.257,2.127,3.242,2.192,3.242,2.192l-0.405,4.19l2.321,1.031   l-1.934,0.387c0,0,0.772,2.192,0.257,3.481s-0.516,6.188,3.353,5.028c3.867-1.16,6.188,14.827,6.188,14.827L61.21,68.09   L33.92,40.824z"],["d","M50.25,9.33c-22.472,0-40.753,18.282-40.753,40.753S27.778,90.835,50.25,90.835s40.753-18.282,40.753-40.753  S72.722,9.33,50.25,9.33z M85.003,50.083c0,8.496-3.068,16.285-8.149,22.329L27.898,23.499c6.048-5.093,13.846-8.169,22.352-8.169  C69.413,15.33,85.003,30.92,85.003,50.083z M15.497,50.083c0-8.501,3.073-16.295,8.16-22.341l48.956,48.914  c-6.049,5.099-13.852,8.18-22.363,8.18C31.087,84.835,15.497,69.245,15.497,50.083z"]],template:function(t,i){t&1&&(N(0,"button",0),It("click",function(){return i.interruptAvatar()}),Ei(),N(1,"svg",1)(2,"g"),de(3,"path",2),F(),N(4,"g"),de(5,"path",3),F(),N(6,"g"),de(7,"path",4),F(),N(8,"g"),de(9,"path",5)(10,"path",6),F(),de(11,"path",7),F()()),t&2&&pe("matTooltip",i.lang.locals.stop_talking)},dependencies:[Fc]})};var Ff=class{partitionKey;rowKey;user_id;conversation_id;feedback;sentiment;bot_name;title;timestamp;getEmojiPerSetiment(){switch(this.sentiment){case"negative":return"\u{1F61F}";case"mixed":return"\u{1F615}";case"positive":return"\u{1F60A}";case"neutral":return"\u{1F610}";default:return"\u2753"}}};var Bf=class extends bs{partitionKey;rowKey;constructor(){super()}};var Lo=class Lo{http=W(Ai);urlService=W(Oi);getAllConversations(e){let t=`${this.urlService.URLS.CHAT_HISTORY}/all-conversations`,i=new Tt;return e&&(i=i.set("bot_name",e)),this.http.get(t,{params:i})}getConversationsByUserId(e){let t=`${this.urlService.URLS.CHAT_HISTORY}/conversations`,i=new Tt().set("user_id",e);return this.http.get(t,{params:i})}getChatByConversationId(e){let t=`${this.urlService.URLS.CHAT_HISTORY}/chat`,i=new Tt().set("conv_id",e);return this.http.get(t,{params:i}).pipe(Ae(n=>n.map(s=>{let o=new Bf;return o.context=JSON.parse(s.context),o.content=Uc(Wc(s.content,o)),o.partitionKey=s.partitionKey,o.rowKey=s.rowKey,o.role=s.role,o}))).pipe(ms())}applyAnalysis(){let e=`${this.urlService.URLS.CHAT_HISTORY}/sentiment-analysis`;return this.http.post(e,null)}addFeedback(e,t){let i=`${this.urlService.URLS.CHAT_HISTORY}/add-feedback`,n=new Tt().set("conv_id",e).set("feedback",t);return this.http.post(i,null,{params:n})}getAllBotNames(){let e=`${this.urlService.URLS.CHAT_HISTORY}/bot-names`;return this.http.get(e)}static \u0275fac=function(t){return new(t||Lo)};static \u0275prov=Ft({token:Lo,factory:Lo.\u0275fac,providedIn:"root"})};DP([fw(()=>Ff)],Lo.prototype,"getAllConversations",1);var Uf=Lo;var NW=["waves"],jW=r=>({"!-right-14":r}),LW=(r,e)=>({"bg-red-500":r,"bg-green-500":e}),qW=r=>({hidden:r}),zW=r=>({"-translate-x-full":r}),FW=(r,e)=>({"bg-green-700":r,"bg-red-600":e});function BW(r,e){if(r&1&&(N(0,"span",12),_e(1),F()),r&2){let t=et();q(),Bt(t.lang.locals.loading)}}function UW(r,e){if(r&1&&(N(0,"span",13),_e(1),F()),r&2){let t=et();q(),Bt(t.lang.locals.click_to_speak)}}function WW(r,e){if(r&1&&(N(0,"span",12),_e(1),F()),r&2){let t=et();q(),Bt(t.lang.locals.listening_ongoing)}}function HW(r,e){if(r&1&&(N(0,"span",12),_e(1),F()),r&2){let t=et();q(),Bt(t.lang.locals.click_to_send)}}function VW(r,e){if(r&1&&(N(0,"option",20),_e(1),F()),r&2){let t=e.$implicit;pe("value",t),q(),Bt(t)}}function $W(r,e){if(r&1&&(N(0,"button",26)(1,"div",31)(2,"span"),_e(3),F()()()),r&2){let t=et();q(3),Bt(t.avatarVideoComponent().onlineStatus())}}function KW(r,e){if(r&1){let t=Ii();N(0,"button",32),It("click",function(){_t(t);let n=et();return Rt(n.toggleStream())}),_e(1),F()}if(r&2){let t=et();pe("ngClass",Ti(2,FW,t.store.isStreamStarted(),t.store.isStreamStopped())),q(),ds(" ",t.avatarVideoComponent().onlineStatus()," ")}}var Wf=class r extends Bc(class{}){avatarVideoComponent=Uo.required();overlayChatComponent=Uo.required();waves=fn.required("waves");store=W(Lr);chatService=W(ws);chatHistoryService=W(Uf);avatarService=W(xi);injector=W(ps);fullscreen=Gf();recognizedText=vt("");recognizingText=vt("");speechService=W(dw);recognizing$=Gf();recognized$=new ue;accept$=new ue;recognizingStatus=vt(!1);botNames$=this.chatHistoryService.getAllBotNames().pipe(wt(e=>this.chatService.botNameCtrl.patchValue(e.at(0))));settingsOpened=!1;lang=W(gs);ngOnInit(){return v(this,null,function*(){this.listenToAccept(),this.listenToBotNameChange(),yield this.prepareRecorder()})}listenToBotNameChange(){this.chatService.onBotNameChange().pipe(Nr(this.destroy$)).subscribe()}prepareRecorder(){return v(this,null,function*(){this.recordingStream=yield navigator.mediaDevices.getUserMedia({audio:!0,video:!1}),this.waveSurfer=new Rs({waveColor:"white",progressColor:"white",container:this.waves().nativeElement,height:"auto"}),this.recorder=this.waveSurfer.registerPlugin(uu.create({scrollingWaveform:!1})),this.recorder.renderMicStream(this.recordingStream);let e=Mr.AudioConfig.fromDefaultMicrophoneInput(),t=Mr.AutoDetectSourceLanguageConfig.fromLanguages(["ar-QA","en-US"]);this.recognizer=Mr.SpeechRecognizer.FromConfig(Mr.SpeechConfig.fromAuthorizationToken(this.store.speechToken.token(),this.store.speechToken.region()),t,e),this.recognizer.recognizing=(i,n)=>{n.result.reason===Mr.ResultReason.RecognizingSpeech&&(this.recognizingText.set(this.recognizedText()+" "+n.result.text),this.recognizing$.emit(this.recognizingText()),this.recognizingStatus.set(!0))},this.recognizer.recognized=(i,n)=>{n.result.reason===Mr.ResultReason.RecognizedSpeech&&this.store.isRecordingStarted()&&(this.recognizedText.update(s=>s+" "+n.result.text),this.recognized$.next(),this.recognizingStatus.set(!1))},this.recognizer.canceled=()=>{this.store.recordingInProgress(),this.speechService.generateSpeechToken().pipe(cs(1)).subscribe(()=>{this.prepareRecorder().then(()=>this.startRecording())})}})}startRecording(){this.store.recordingInProgress(),this.recognizer.startContinuousRecognitionAsync(()=>{this.recognizer.internalData.privConnectionPromise.__zone_symbol__state===!0&&this.store.recordingStarted(),this.recognizingStatus.set(!0)})}stopRecording(){this.recognizer.stopContinuousRecognitionAsync(()=>{this.store.recordingStopped()})}toggleRecording(){this.store.isRecordingLoading()||(this.store.isRecordingStarted()?this.acceptText():this.startRecording())}acceptText(){this.accept$.next()}rejectText(){this.recognizingText.set(""),this.recognizedText.set(""),this.recognizing$.emit(""),this.recognizingStatus.set(!1),this.stopRecording()}goToEndOfChat(){setTimeout(()=>{let e=this.overlayChatComponent().container().nativeElement.querySelectorAll(".user");e[e.length-1].scrollIntoView(!0)},100)}listenToAccept(){this.accept$.pipe(Ae(()=>this.recognizedText())).pipe(as(e=>!!e)).pipe(Nr(this.destroy$)).pipe(wt(()=>{this.recognizedText.set(""),this.recognizingText.set(""),this.recognizingStatus.set(!1),this.recognizing$.emit(""),this.stopRecording()})).pipe(wt(()=>this.goToEndOfChat())).pipe(Tc(e=>this.chatService.sendMessage(e,this.chatService.botNameCtrl.value))).pipe(jP(200)).subscribe(()=>{let e=this.overlayChatComponent().container().nativeElement.querySelectorAll(".assistant"),t=setInterval(()=>e[e.length-1].scrollIntoView(!1),200),i=kc(()=>{this.overlayChatComponent().animationStatus()||(clearInterval(t),i.destroy())},{injector:this.injector})})}clearChat(){this.chatService.messages.set([])}toggleStream(){this.store.isStreamLoading()||(this.store.isStreamStopped()?this.avatarVideoComponent().start$.next():this.avatarVideoComponent().stop$.next())}toggleSettings(){this.settingsOpened=!this.settingsOpened}static \u0275fac=(()=>{let e;return function(i){return(e||(e=us(r)))(i||r)}})();static \u0275cmp=Qt({type:r,selectors:[["app-screen-control"]],viewQuery:function(t,i){t&1&&vn(i.waves,NW,5),t&2&&ls()},inputs:{avatarVideoComponent:[1,"avatarVideoComponent"],overlayChatComponent:[1,"overlayChatComponent"]},outputs:{fullscreen:"fullscreen",recognizing$:"recognizing$"},standalone:!0,features:[Oc,Xt],decls:44,vars:28,consts:[["waves",""],["id","toolbar","cdkDrag","",1,"w-24","relative","flex","justify-center","items-start","text-white","flex-col","rounded-md","p-2","pt-36","bg-black/50"],["cdkDragHandle",""],["width","24px","fill","currentColor","viewBox","0 0 24 24",1,"absolute","cursor-move","top-1","right-1"],["d","M10 9h4V6h3l-5-5-5 5h3v3zm-1 1H6V7l-5 5 5 5v-3h3v-4zm14 2l-5-5v3h-3v4h3v3l5-5zm-9 3h-4v3H7l5 5 5-5h-3v-3z"],["d","M0 0h24v24H0z","fill","none"],[1,"absolute","w-1/2","right-0","top-16","transition-all","duration-300",3,"ngClass"],[1,"w-full","bg-red-500","rounded-full",3,"click","matTooltip"],["fill","currentColor","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24"],["d","M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"],["aria-label","record",1,"absolute","top-8","left-1/2","disabled:bg-gray-400","-translate-x-1/2","flex","flex-col","p-2","bg-white","size-28","overflow-hidden","rounded-full",3,"pointerdown","contextmenu","disabled"],[1,"relative","flex","items-center","justify-center"],[1,"absolute","z-20","font-semibold","text-white"],[1,"absolute","z-20","font-semibold","text-black"],[1,"size-24","overflow-hidden","transition-all","rounded-full","relative",3,"ngClass"],[1,"w-full","mt-5","pointer-events-none","h-full","opacity-90",3,"ngClass"],["matRipple","",1,"text-white",3,"click","matTooltip"],["fill","currentColor","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"w-full"],["d","M15.46 15.88L16.88 14.46L19 16.59L21.12 14.47L22.54 15.88L20.41 18L22.54 20.12L21.12 21.54L19 19.41L16.88 21.54L15.46 20.12L17.59 18L15.47 15.88M12 3C17.5 3 22 6.58 22 11C22 11.58 21.92 12.14 21.78 12.68C20.95 12.25 20 12 19 12C15.69 12 13 14.69 13 18L13.08 18.95L12 19C10.76 19 9.57 18.82 8.47 18.5C5.55 21 2 21 2 21C4.33 18.67 4.7 17.1 4.75 16.5C3.05 15.07 2 13.14 2 11C2 6.58 6.5 3 12 3Z"],[1,"block","p-1","w-full","truncate","text-gray-200","text-sm","border-b-2","border-gray-300","bg-transparent","focus:ring-primary","focus:border-primary","outline-none",3,"matTooltip","matTooltipClass","formControl"],[1,"text-gray-800","truncate",3,"value"],["id","settings",1,"bg-black/50","fixed","left-0","rounded","p-4","transition-transform",3,"ngClass"],[1,"relative","flex","flex-col"],["aria-label","Settings",1,"absolute","-top-2","-right-14","z-20","bg-black/50","rounded-r","text-white",3,"click","matTooltip"],["fill","currentColor","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"size-10"],["d","M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"],["aria-label","close stream",1,"text-white","cursor-progress","size-20","bg-orange-500","rounded-full"],["matRipple","","aria-label","close stream",1,"text-white","size-20","rounded-full",3,"ngClass"],["matRipple","",1,"text-white",3,"click"],["fill","currentColor","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"size-20"],["d","M5,5H10V7H7V10H5V5M14,5H19V10H17V7H14V5M17,14H19V19H14V17H17V14M10,17V19H5V14H7V17H10Z"],[1,"pulse","rounded-full","w-full","h-full","bg-primary","flex","justify-center","items-center"],["matRipple","","aria-label","close stream",1,"text-white","size-20","rounded-full",3,"click","ngClass"]],template:function(t,i){if(t&1){let n=Ii();N(0,"div",1)(1,"button",2),Ei(),N(2,"svg",3),de(3,"path",4)(4,"path",5),F()(),Bo(),N(5,"div",6)(6,"button",7),It("click",function(){return _t(n),Rt(i.rejectText())}),Ei(),N(7,"svg",8)(8,"title"),_e(9,"close"),F(),de(10,"path",9),F()()(),Bo(),N(11,"button",10),It("pointerdown",function(){return _t(n),Rt(i.toggleRecording())})("contextmenu",function(o){return _t(n),Rt(o.preventDefault())}),N(12,"div",11),jr(13,BW,2,1,"span",12)(14,UW,2,1,"span",13)(15,WW,2,1,"span",12)(16,HW,2,1,"span",12),N(17,"div",14),de(18,"div",15,0),F()()(),N(20,"button",16),It("click",function(){return _t(n),Rt(i.clearChat())}),Ei(),N(21,"svg",17)(22,"title"),_e(23,"remove chat"),F(),de(24,"path",18),F()(),Bo(),de(25,"app-avatar-interrupter-btn"),N(26,"select",19),Ho(27,VW,2,2,"option",20,Dc),xc(29,"async"),F()(),N(30,"div",21)(31,"div",22)(32,"button",23),It("click",function(){return _t(n),Rt(i.toggleSettings())}),Ei(),N(33,"svg",24)(34,"title"),_e(35,"cog"),F(),de(36,"path",25),F()(),jr(37,$W,4,1,"button",26)(38,KW,2,5,"button",27),Bo(),N(39,"button",28),It("click",function(){return _t(n),Rt(i.fullscreen.emit())}),Ei(),N(40,"svg",29)(41,"title"),_e(42,"fullscreen"),F(),de(43,"path",30),F()()()()}t&2&&(q(5),pe("ngClass",fs(19,jW,i.store.isRecordingStarted())),q(),pe("matTooltip",i.lang.locals.cancel_recording),q(5),pe("disabled",i.store.isRecordingLoading()||i.recognizingStatus()),q(2),Et(i.store.isRecordingLoading()?13:-1),q(),Et(i.store.isRecordingStopped()?14:-1),q(),Et(i.store.isRecordingStarted()&&i.recognizingStatus()?15:-1),q(),Et(i.store.isRecordingStarted()&&!i.recognizingStatus()?16:-1),q(),pe("@recordButton",i.store.recording())("ngClass",Ti(21,LW,i.recognizingStatus(),!i.recognizingStatus())),q(),pe("ngClass",fs(24,qW,!i.store.isRecordingStarted())),q(2),pe("matTooltip",i.lang.locals.clear_chat_history),q(6),pe("matTooltip",i.lang.locals.change_bot+`
`+i.lang.locals.change_bot_note)("matTooltipClass","whitespace-pre-line")("formControl",i.chatService.botNameCtrl),q(),Vo(Mc(29,17,i.botNames$)),q(3),pe("ngClass",fs(26,zW,!i.settingsOpened)),q(2),pe("matTooltip",i.lang.locals.settings),q(5),Et(i.store.isStreamLoading()?37:38))},dependencies:[Qw,Yw,vs,ew,Fc,zf,lw,cw,uw,aw,nw,ow,jc],data:{animation:[tw("recordButton",[zc("InProgress",qc({transform:"scale(1)",backgroundColor:"gray"})),zc("Started",qc({transform:"scale(1)"})),zc("Stopped",qc({transform:"scale(0)"})),iw("* <=> *",[rw("150ms ease-in-out")])])]}})};function GW(r,e){r&1&&(N(0,"div",5)(1,"div",6),de(2,"div")(3,"div")(4,"div")(5,"div"),F()())}var OP=class r{fullScreen="h-screen w-screen flex items-center justify-center";text=vt("");element=W(dn);store=W(Lr);recognizing(e){this.text.set(e)}toggleFullScreen(){document.fullscreenElement?document.exitFullscreen().then():this.element.nativeElement.requestFullscreen().then()}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=Qt({type:r,selectors:[["app-avatar"]],hostVars:1,hostBindings:function(t,i){t&2&&Wo("class",i.fullScreen)},standalone:!0,features:[Xt],decls:8,vars:5,consts:[["avatarVideoComponent",""],["overlayChatComponent",""],[3,"size"],[1,"absolute","top-10","right-10","size-28",3,"recognizing$","fullscreen","overlayChatComponent","avatarVideoComponent"],[1,"bg-black/40","absolute","top-1/2","text-white","font-sans","left-1/2","-translate-x-1/2"],[1,"z-50","flex","items-center","justify-center","w-full","bg-black/50","h-full","fixed"],[1,"lds-ellipsis"]],template:function(t,i){if(t&1){let n=Ii();de(0,"app-avatar-video",2,0)(2,"app-overlay-chat",null,1),N(4,"app-screen-control",3),It("recognizing$",function(o){return _t(n),Rt(i.recognizing(o))})("fullscreen",function(){return _t(n),Rt(i.toggleFullScreen())}),F(),N(5,"div",4),_e(6),F(),jr(7,GW,6,0,"div",5)}if(t&2){let n=hs(1),s=hs(3);pe("size","life-size"),q(4),pe("overlayChatComponent",s)("avatarVideoComponent",n),q(2),Bt(i.text()),q(),Et(i.store.isStreamLoading()?7:-1)}},dependencies:[Hc,Zc,Wf]})};export{OP as default};
